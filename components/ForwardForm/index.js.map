{"version":3,"sources":["components/ForwardForm/index.tsx"],"names":["cleanRegex","ForwardNumbers","numbers","onSelect","selected","formatPhone","styles","map","number","index","id","label","toLowerCase","active","colon","phoneNumber","propTypes","PropTypes","array","isRequired","func","ForwardForm","props","_onCustomValueChange","value","setState","customValue","_clearToNumber","_setRecipient","recipient","_clearRecipient","state","selectedIndex","handling","filter","replace","onChange","getValue","onForward","result","_mounted","onCancel","onSelectCustomNumber","forwardingNumbers","length","setTimeout","customInput","focus","forwardingNumber","className","currentLocale","searchContact","searchContactList","phoneTypeRenderer","phoneSourceNameRenderer","autoFocus","disableButton","root","custromNumber","customLabel","i18n","getString","ref","buttonGroup","cancelButton","forwardButton","disabled","buttonText","Component","string","bool","defaultProps","undefined"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\n\nimport classnames from 'classnames';\nimport PropTypes from 'prop-types';\n\nimport isBlank from '@ringcentral-integration/commons/lib/isBlank';\n\nimport { Button } from '../Button';\nimport RecipientsInput from '../RecipientsInput';\nimport i18n from './i18n';\nimport styles from './styles.scss';\n\nconst cleanRegex = /[^\\d+*-\\s]/g;\n\nfunction ForwardNumbers({ numbers, onSelect, selected, formatPhone }) {\n  return (\n    <div className={styles.numbers}>\n      {numbers.map((number, index) => (\n        <div\n          key={number.id}\n          data-sign={`forward-number-${number.label.toLowerCase()}`}\n          className={classnames(\n            styles.number,\n            index === selected ? styles.active : null,\n          )}\n          onClick={() => onSelect(index)}\n        >\n          <span className={styles.label} title={number.label}>\n            {number.label}\n          </span>\n          <span className={styles.colon}>:</span>\n          <span>{formatPhone(number.phoneNumber)}</span>\n        </div>\n      ))}\n    </div>\n  );\n}\n\nForwardNumbers.propTypes = {\n  numbers: PropTypes.array.isRequired,\n  onSelect: PropTypes.func.isRequired,\n  selected: PropTypes.number.isRequired,\n  formatPhone: PropTypes.func.isRequired,\n};\n\nclass ForwardForm extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      selectedIndex: 0,\n      customValue: '',\n      handling: false,\n      recipient: null,\n    };\n\n    this.filter = (value) => value.replace(cleanRegex, '');\n\n    this.onSelect = (index) => {\n      this.setState({\n        selectedIndex: index,\n      });\n      if (typeof this.props.onChange === 'function') {\n        this.props.onChange(this.getValue());\n      }\n    };\n\n    this.onForward = async () => {\n      this.setState({\n        handling: true,\n      });\n      const result = await this.props.onForward(this.getValue());\n      if (!this._mounted) {\n        return;\n      }\n      this.setState({\n        handling: false,\n      });\n      if (result) {\n        this.props.onCancel();\n      }\n    };\n\n    this.onSelectCustomNumber = () => {\n      this.onSelect(this.props.forwardingNumbers.length);\n      setTimeout(() => {\n        if (this.customInput) {\n          this.customInput.focus();\n        }\n      }, 100);\n    };\n  }\n\n  componentDidMount() {\n    this._mounted = true;\n  }\n\n  componentWillUnmount() {\n    this._mounted = false;\n  }\n\n  getValue() {\n    if (this.state.selectedIndex < this.props.forwardingNumbers.length) {\n      const forwardingNumber =\n        this.props.forwardingNumbers[this.state.selectedIndex];\n      return forwardingNumber && forwardingNumber.phoneNumber;\n    }\n    if (this.state.recipient) {\n      return this.state.recipient.phoneNumber;\n    }\n    return this.state.customValue;\n  }\n\n  _onCustomValueChange = (value) => {\n    this.setState({\n      customValue: value,\n    });\n  };\n\n  _clearToNumber = () => {\n    this.setState({\n      customValue: '',\n    });\n  };\n\n  _setRecipient = (recipient) => {\n    this.setState({\n      recipient,\n    });\n    this._clearToNumber();\n  };\n\n  _clearRecipient = () => {\n    this.setState({\n      recipient: null,\n    });\n  };\n\n  render() {\n    const {\n      className,\n      onCancel,\n      currentLocale,\n      forwardingNumbers,\n      formatPhone,\n      searchContact,\n      searchContactList,\n      phoneTypeRenderer,\n      phoneSourceNameRenderer,\n      autoFocus,\n    } = this.props;\n    const value = this.getValue();\n    const disableButton = isBlank(value) || this.state.handling;\n    return (\n      <div\n        data-sign=\"forwardPage\"\n        className={classnames(styles.root, className)}\n      >\n        <ForwardNumbers\n          formatPhone={formatPhone}\n          numbers={forwardingNumbers}\n          onSelect={this.onSelect}\n          selected={this.state.selectedIndex}\n        />\n        <div\n          data-sign=\"customNumber\"\n          className={classnames(\n            styles.custromNumber,\n            this.state.selectedIndex === forwardingNumbers.length\n              ? styles.active\n              : null,\n          )}\n          onClick={this.onSelectCustomNumber}\n        >\n          <div className={styles.customLabel}>\n            {i18n.getString('customNumber', currentLocale)}\n          </div>\n          <RecipientsInput\n            label=\"\"\n            placeholder=\"\"\n            inputRef={(ref) => {\n              this.customInput = ref;\n            }}\n            value={this.state.customValue}\n            className={styles.customInput}\n            onChange={this._onCustomValueChange}\n            onClean={this._clearToNumber}\n            recipient={this.state.recipient}\n            addToRecipients={this._setRecipient}\n            removeFromRecipients={this._clearRecipient}\n            searchContact={searchContact}\n            searchContactList={searchContactList}\n            phoneTypeRenderer={phoneTypeRenderer}\n            phoneSourceNameRenderer={phoneSourceNameRenderer}\n            formatContactPhone={formatPhone}\n            currentLocale={currentLocale}\n            titleEnabled\n            autoFocus={autoFocus}\n          />\n        </div>\n        <div className={styles.buttonGroup}>\n          <Button\n            dataSign=\"cancel\"\n            className={styles.cancelButton}\n            onClick={onCancel}\n          >\n            {i18n.getString('cancel', currentLocale)}\n          </Button>\n          <Button\n            dataSign=\"forwardCall\"\n            className={classnames(\n              styles.forwardButton,\n              disableButton ? styles.disabled : null,\n            )}\n            onClick={this.onForward}\n            disabled={disableButton}\n          >\n            <span className={styles.buttonText}>\n              {i18n.getString('forward', currentLocale)}\n            </span>\n          </Button>\n        </div>\n      </div>\n    );\n  }\n}\n\nForwardForm.propTypes = {\n  className: PropTypes.string,\n  onCancel: PropTypes.func.isRequired,\n  currentLocale: PropTypes.string.isRequired,\n  forwardingNumbers: PropTypes.array.isRequired,\n  formatPhone: PropTypes.func.isRequired,\n  onForward: PropTypes.func.isRequired,\n  onChange: PropTypes.func,\n  searchContactList: PropTypes.array.isRequired,\n  searchContact: PropTypes.func.isRequired,\n  phoneTypeRenderer: PropTypes.func,\n  phoneSourceNameRenderer: PropTypes.func,\n  autoFocus: PropTypes.bool,\n};\n\nForwardForm.defaultProps = {\n  className: null,\n  onChange: undefined,\n  phoneTypeRenderer: undefined,\n  phoneSourceNameRenderer: undefined,\n  autoFocus: true,\n};\n\nexport default ForwardForm;\n"],"file":"index.js"}
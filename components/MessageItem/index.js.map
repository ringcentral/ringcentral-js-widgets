{"version":3,"sources":["components/MessageItem/index.tsx"],"names":["MessageItem","props","_userSelection","contactDisplay","_mounted","toggleExtended","setState","preState","extended","preventEventPropagating","e","target","currentTarget","stopPropagation","onSelectContact","value","idx","showContactDisplayPlaceholder","autoLog","conversation","shouldLogSelectRecord","selected","parseInt","logConversation","redirect","prefill","correspondentEntity","getSelectedContact","state","contactMatches","correspondentMatches","length","viewSelectedContact","onViewContact","contact","getMatchEntities","phoneNumber","getPhoneNumber","matchEntitiesIds","getMatchEntitiesIds","createSelectedContact","entityType","onCreateContact","isCreating","name","enableContactFallback","getFallbackContactName","onLogConversation","isLogging","conversationId","clickToDial","onClickToDial","fromType","type","onClickToSms","updateTypeFilter","messageTypes","text","onClickItem","contains","onClickWrapper","showConversationDetail","onPlayVoicemail","unreadCounts","readMessage","onMarkMessage","markMessage","onUnmarkMessage","unmarkMessage","onPreviewFax","uri","previewFaxMessages","onDeleteMessage","deleteMessage","getDisableClickToSms","areaCode","countryCode","internalSmsPermission","outboundSmsPermission","disableClickToSms","parsedInfo","isExtension","hasPlus","number","getInitialContactIndex","nextProps","conversationMatches","lastMatchedCorrespondentEntity","index","findIndex","id","map","item","correspondents","extensionNumber","undefined","groupNumbers","correspondent","currentLocale","mmsAttachments","imageCount","filter","m","contentType","indexOf","i18n","getString","count","subject","voicemailAttachment","duration","pageCount","faxPageCount","nameKey","direction","messageDirection","inbound","creationTime","dateTimeFormatter","utcTimestamp","console","error","brand","currentSiteCode","isMultipleSiteEnabled","faxAttachment","parentDisableLinks","disableLinks","disableCallButton","disableClickToDial","createEntityTypes","contactPlaceholder","sourceIcons","phoneTypeRenderer","phoneSourceNameRenderer","showGroupNumberName","renderExtraButton","onFaxDownload","showChooseEntityModal","renderContactList","dropdownClassName","enableCDC","isVoicemail","voiceMail","isFax","fax","getGroupPhoneNumbers","shouldHideNumber","isContactMatchesHidden","fallbackName","detail","getDetail","player","slideMenuHeight","styles","extraButton","msgItem","root","wrapper","unread","infoWrapper","embellishInfoWrapper","ref","selectedValue","dropdownSelect","detailsWithTime","details","separatrix","extendIcon","slideMenu","playContainer","actionMenuList","extensionTypes","ivrMenu","Component","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\n\nimport classnames from 'classnames';\nimport formatMessage from 'format-message';\n\nimport { extensionTypes } from '@ringcentral-integration/commons/enums/extensionTypes';\nimport messageDirection from '@ringcentral-integration/commons/enums/messageDirection';\nimport messageTypes from '@ringcentral-integration/commons/enums/messageTypes';\nimport { Message } from '@ringcentral-integration/commons/interfaces/MessageStore.model';\nimport {\n  messageIsFax,\n  messageIsTextMessage,\n} from '@ringcentral-integration/commons/lib/messageHelper';\nimport parseNumber from '@ringcentral-integration/commons/lib/parseNumber';\n\nimport { checkShouldHideContactUser } from '../../lib/checkShouldHideContactUser';\nimport { checkShouldHidePhoneNumber } from '../../lib/checkShouldHidePhoneNumber';\nimport formatDuration from '../../lib/formatDuration';\nimport ActionMenuList from '../ActionMenuList';\nimport ContactDisplay from '../ContactDisplay';\nimport { ContactDisplayItemProps } from '../ContactDisplay/ContactDisplayItem';\nimport SlideMenu from '../SlideMenu';\nimport VoicemailPlayer from '../VoicemailPlayer';\nimport { ConversationIcon } from './ConversationIcon';\nimport i18n from './i18n';\nimport styles from './styles.scss';\n\ntype MessageItemProps = {\n  conversation: Message;\n  areaCode: string;\n  brand: string;\n  countryCode: string;\n  currentLocale: string;\n  currentSiteCode?: string;\n  isMultipleSiteEnabled?: boolean;\n  onLogConversation?: (...args: any[]) => any;\n  onViewContact?: (...args: any[]) => any;\n  onCreateContact?: (...args: any[]) => any;\n  createEntityTypes?: any[];\n  onClickToDial?: (...args: any[]) => any;\n  onClickToSms?: (...args: any[]) => any;\n  disableLinks?: boolean;\n  disableCallButton?: boolean;\n  disableClickToDial?: boolean;\n  dateTimeFormatter: (...args: any[]) => any;\n  showConversationDetail: (...args: any[]) => any;\n  readMessage: (...args: any[]) => any;\n  markMessage: (...args: any[]) => any;\n  unmarkMessage: (...args: any[]) => any;\n  autoLog?: boolean;\n  enableContactFallback?: boolean;\n  showContactDisplayPlaceholder?: boolean;\n  contactPlaceholder?: string;\n  sourceIcons?: ContactDisplayItemProps['sourceIcons'];\n  phoneTypeRenderer?: (...args: any[]) => any;\n  phoneSourceNameRenderer?: (...args: any[]) => any;\n  showGroupNumberName?: boolean;\n  deleteMessage?: (...args: any[]) => any;\n  previewFaxMessages?: (...args: any[]) => any;\n  renderExtraButton?: (...args: any[]) => any;\n  internalSmsPermission?: boolean;\n  outboundSmsPermission?: boolean;\n  updateTypeFilter?: (...args: any[]) => any;\n  onFaxDownload?: (...args: any[]) => any;\n  showChooseEntityModal?: boolean;\n  shouldLogSelectRecord?: boolean;\n  onSelectContact?: (...args: any[]) => any;\n  renderContactList?: (...args: any[]) => any;\n  dropdownClassName?: string;\n  enableCDC?: boolean;\n};\n\ntype MessageItemState = {\n  selected: number;\n  isLogging: boolean;\n  isCreating: boolean;\n  extended: boolean;\n};\n\nclass MessageItem extends Component<MessageItemProps, MessageItemState> {\n  _userSelection = false;\n  contactDisplay: any;\n  private _mounted = false;\n\n  static defaultProps: Partial<MessageItemProps> = {\n    currentSiteCode: '',\n    isMultipleSiteEnabled: false,\n    disableClickToDial: false,\n    disableLinks: false,\n    disableCallButton: false,\n    autoLog: false,\n    showContactDisplayPlaceholder: true,\n    contactPlaceholder: '',\n    showGroupNumberName: false,\n    deleteMessage() {},\n    internalSmsPermission: true,\n    outboundSmsPermission: true,\n    showChooseEntityModal: true,\n    shouldLogSelectRecord: false,\n    dropdownClassName: null,\n    enableCDC: false,\n  };\n\n  constructor(props: MessageItemProps) {\n    super(props);\n    this.state = {\n      selected: this.getInitialContactIndex(),\n      isLogging: false,\n      isCreating: false,\n      extended: false,\n    };\n\n    /* [RCINT-4301] onSelection would trigger some state changes that would push new\n     * properties before the state has been changed. Which would reset the selected value.\n     */\n  }\n\n  toggleExtended = () => {\n    this.setState((preState) => ({\n      extended: !preState.extended,\n    }));\n  };\n\n  componentDidMount() {\n    this._mounted = true;\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps: MessageItemProps) {\n    if (\n      !this._userSelection &&\n      (nextProps.conversation.conversationMatches !==\n        this.props.conversation.conversationMatches ||\n        nextProps.conversation.correspondentMatches !==\n          this.props.conversation.correspondentMatches)\n    ) {\n      this.setState({\n        selected: this.getInitialContactIndex(nextProps),\n      });\n    }\n  }\n\n  componentWillUnmount() {\n    this._mounted = false;\n  }\n\n  preventEventPropagating: React.MouseEventHandler<HTMLDivElement> = (e) => {\n    if (e.target !== e.currentTarget) {\n      e.stopPropagation();\n    }\n  };\n\n  onSelectContact = (value: any, idx: string) => {\n    const {\n      showContactDisplayPlaceholder,\n      autoLog,\n      conversation,\n      shouldLogSelectRecord,\n      onSelectContact,\n    } = this.props;\n    const selected = showContactDisplayPlaceholder\n      ? parseInt(idx, 10) - 1\n      : parseInt(idx, 10);\n    this._userSelection = true;\n    this.setState({\n      selected,\n    });\n    if (autoLog) {\n      this.logConversation({ redirect: false, selected, prefill: false });\n    }\n    if (shouldLogSelectRecord && typeof onSelectContact === 'function') {\n      onSelectContact({\n        correspondentEntity: this.getSelectedContact(selected),\n        conversation,\n      });\n    }\n  };\n\n  getInitialContactIndex(nextProps = this.props) {\n    const { correspondentMatches, lastMatchedCorrespondentEntity } =\n      nextProps.conversation;\n    if (lastMatchedCorrespondentEntity) {\n      const index = correspondentMatches.findIndex(\n        (contact) => contact.id === lastMatchedCorrespondentEntity.id,\n      );\n      if (index > -1) return index;\n    }\n    return this.props.showContactDisplayPlaceholder ? -1 : 0;\n  }\n\n  getSelectedContact = (selected = this.state.selected) => {\n    const contactMatches = this.props.conversation.correspondentMatches;\n    return (\n      (selected > -1 && contactMatches[selected]) ||\n      (contactMatches.length === 1 && contactMatches[0]) ||\n      null\n    );\n  };\n\n  getMatchEntities() {\n    return this.props.conversation.correspondentMatches || [];\n  }\n\n  getMatchEntitiesIds() {\n    const contactMatches = this.props.conversation.correspondentMatches || [];\n    return contactMatches.map((item) => item.id);\n  }\n\n  getPhoneNumber() {\n    const { correspondents } = this.props.conversation;\n    return (\n      (correspondents.length === 1 &&\n        correspondents[0] &&\n        (correspondents[0].phoneNumber || correspondents[0].extensionNumber)) ||\n      undefined\n    );\n  }\n\n  getGroupPhoneNumbers() {\n    const { correspondents } = this.props.conversation;\n    const groupNumbers =\n      correspondents.length > 1\n        ? correspondents.map(\n            (correspondent) =>\n              correspondent.extensionNumber ||\n              correspondent.phoneNumber ||\n              undefined,\n          )\n        : null;\n    return groupNumbers;\n  }\n\n  getFallbackContactName() {\n    const { correspondents } = this.props.conversation;\n    return (correspondents.length === 1 && correspondents[0].name) || undefined;\n  }\n\n  viewSelectedContact = () => {\n    if (typeof this.props.onViewContact === 'function') {\n      this.props.onViewContact({\n        contact: this.getSelectedContact(),\n        contactMatches: this.getMatchEntities(),\n        phoneNumber: this.getPhoneNumber(),\n        matchEntitiesIds: this.getMatchEntitiesIds(),\n      });\n    }\n  };\n\n  createSelectedContact = async (entityType: unknown) => {\n    // console.log('click createSelectedContact!!', entityType);\n    if (\n      typeof this.props.onCreateContact === 'function' &&\n      this._mounted &&\n      !this.state.isCreating\n    ) {\n      this.setState({\n        isCreating: true,\n      });\n      // console.log('start to create: isCreating...', this.state.isCreating);\n      const phoneNumber = this.getPhoneNumber();\n      await this.props.onCreateContact({\n        phoneNumber,\n        name: this.props.enableContactFallback\n          ? this.getFallbackContactName()\n          : '',\n        entityType,\n      });\n\n      if (this._mounted) {\n        this.setState({\n          isCreating: false,\n        });\n        // console.log('created: isCreating...', this.state.isCreating);\n      }\n    }\n  };\n\n  logConversation = async ({\n    redirect = true,\n    selected,\n    prefill = true,\n  }: {\n    redirect?: boolean;\n    selected?: number;\n    prefill?: boolean;\n  } = {}) => {\n    if (\n      typeof this.props.onLogConversation === 'function' &&\n      this._mounted &&\n      !this.state.isLogging\n    ) {\n      this.setState({\n        isLogging: true,\n      });\n      await this.props.onLogConversation({\n        correspondentEntity: this.getSelectedContact(selected),\n        conversationId: this.props.conversation.conversationId,\n        redirect,\n        prefill,\n      });\n      if (this._mounted) {\n        this.setState({\n          isLogging: false,\n        });\n      }\n    }\n  };\n\n  clickToDial = () => {\n    if (this.props.onClickToDial) {\n      const contact = this.getSelectedContact() || {};\n      const phoneNumber = this.getPhoneNumber();\n\n      if (phoneNumber) {\n        this.props.onClickToDial({\n          ...contact,\n          phoneNumber,\n          fromType: this.props.conversation.type,\n        });\n      }\n    }\n  };\n\n  onClickToSms = () => {\n    if (this.props.onClickToSms) {\n      const contact = this.getSelectedContact() || {};\n      const phoneNumber = this.getPhoneNumber();\n\n      if (phoneNumber) {\n        this.props.updateTypeFilter(messageTypes.text);\n        this.props.onClickToSms({\n          ...contact,\n          phoneNumber,\n        });\n      }\n    }\n  };\n\n  onClickItem: React.MouseEventHandler<HTMLDivElement> = (e) => {\n    if (this.contactDisplay && this.contactDisplay.contains(e.target)) {\n      return;\n    }\n\n    this.toggleExtended();\n  };\n\n  onClickWrapper: React.MouseEventHandler<HTMLDivElement> = (e) => {\n    if (this.contactDisplay && this.contactDisplay.contains(e.target)) {\n      return;\n    }\n    if (messageIsTextMessage(this.props.conversation)) {\n      this.props.showConversationDetail(this.props.conversation.conversationId);\n    }\n  };\n\n  onPlayVoicemail = () => {\n    if (this.props.conversation.unreadCounts > 0) {\n      this.props.readMessage(this.props.conversation.conversationId);\n    }\n  };\n\n  onMarkMessage = () => {\n    if (this.props.conversation.unreadCounts === 0) {\n      this.props.markMessage(this.props.conversation.conversationId);\n    }\n  };\n\n  onUnmarkMessage = () => {\n    if (this.props.conversation.unreadCounts > 0) {\n      this.props.unmarkMessage(this.props.conversation.conversationId);\n    }\n  };\n\n  onPreviewFax = (uri: string) => {\n    this.props.previewFaxMessages(uri, this.props.conversation.conversationId);\n  };\n\n  getDetail() {\n    const { conversation, currentLocale } = this.props;\n    if (messageIsTextMessage(conversation)) {\n      if (\n        conversation.mmsAttachments &&\n        conversation.mmsAttachments.length > 0\n      ) {\n        const imageCount = conversation.mmsAttachments.filter(\n          (m) => m.contentType.indexOf('image') > -1,\n        ).length;\n        if (imageCount > 0) {\n          return formatMessage(\n            i18n.getString('imageAttachment', currentLocale),\n            {\n              count: imageCount,\n            },\n          );\n        }\n        return formatMessage(i18n.getString('fileAttachment', currentLocale), {\n          count: conversation.mmsAttachments.length,\n        });\n      }\n      return conversation.subject;\n    }\n    if (conversation.voicemailAttachment) {\n      const { duration } = conversation.voicemailAttachment;\n      return `${i18n.getString(\n        'voiceMessage',\n        currentLocale,\n      )} (${formatDuration(duration)})`;\n    }\n    if (messageIsFax(conversation)) {\n      const pageCount = +conversation.faxPageCount;\n      const nameKey = pageCount === 1 ? 'page' : 'pages';\n      if (conversation.direction === messageDirection.inbound) {\n        return `${i18n.getString(\n          'faxReceived',\n          currentLocale,\n        )}(${pageCount} ${i18n.getString(nameKey, currentLocale)})`;\n      }\n      return `${i18n.getString(\n        'faxSent',\n        currentLocale,\n      )}(${pageCount} ${i18n.getString(nameKey, currentLocale)})`;\n    }\n    return '';\n  }\n\n  onDeleteMessage = () => {\n    this.props.deleteMessage(this.props.conversation.conversationId);\n  };\n\n  dateTimeFormatter(creationTime: number) {\n    try {\n      return this.props.dateTimeFormatter({ utcTimestamp: creationTime });\n    } catch (e) {\n      console.error('Format date time error', creationTime);\n      return creationTime;\n    }\n  }\n\n  getDisableClickToSms = () => {\n    const {\n      areaCode,\n      countryCode,\n      onClickToSms,\n      internalSmsPermission,\n      outboundSmsPermission,\n    } = this.props;\n    const phoneNumber = this.getPhoneNumber();\n    let disableClickToSms = false;\n    if (phoneNumber) {\n      const parsedInfo = parseNumber({\n        phoneNumber,\n        countryCode,\n        areaCode,\n      });\n      const isExtension =\n        !parsedInfo.hasPlus &&\n        parsedInfo.number &&\n        parsedInfo.number.length <= 6;\n      disableClickToSms = !(\n        onClickToSms &&\n        (isExtension ? internalSmsPermission : outboundSmsPermission)\n      );\n    }\n    return disableClickToSms;\n  };\n\n  render() {\n    const {\n      areaCode,\n      brand,\n      countryCode,\n      currentLocale,\n      currentSiteCode,\n      isMultipleSiteEnabled,\n      conversation: {\n        conversationId,\n        unreadCounts,\n        correspondents,\n        correspondentMatches,\n        creationTime,\n        isLogging,\n        conversationMatches,\n        type,\n        direction,\n        voicemailAttachment,\n        faxAttachment,\n      },\n      disableLinks: parentDisableLinks,\n      disableCallButton,\n      disableClickToDial,\n      onClickToDial,\n      onClickToSms,\n      onLogConversation,\n      onViewContact,\n      onCreateContact,\n      createEntityTypes,\n      enableContactFallback,\n      contactPlaceholder,\n      showContactDisplayPlaceholder,\n      sourceIcons,\n      phoneTypeRenderer,\n      phoneSourceNameRenderer,\n      showGroupNumberName,\n      renderExtraButton,\n      onFaxDownload,\n      showChooseEntityModal,\n      renderContactList,\n      dropdownClassName,\n      enableCDC,\n    } = this.props;\n    let disableLinks = parentDisableLinks;\n    const isVoicemail = type === messageTypes.voiceMail;\n    const isFax = type === messageTypes.fax;\n    if (isVoicemail && !voicemailAttachment) {\n      disableLinks = true;\n    }\n    if (isFax && !faxAttachment) {\n      disableLinks = true;\n    }\n    const groupNumbers = this.getGroupPhoneNumbers();\n    const phoneNumber = this.getPhoneNumber();\n    /**\n     * TODO:\n     * * Group message is supported for internal paging:\n     * * What is the requirement when a hidden contact is part of a group conversation?\n     * * Is it possible to ignore this edge case initially as group conversations are rare, especially when most people use glip now for internal conversations?\n     */\n    const shouldHideNumber =\n      enableCDC &&\n      checkShouldHidePhoneNumber(phoneNumber, correspondentMatches);\n    const isContactMatchesHidden =\n      enableCDC && checkShouldHideContactUser(correspondentMatches);\n    const fallbackName = this.getFallbackContactName();\n    const detail = this.getDetail();\n    const disableClickToSms = this.getDisableClickToSms();\n    let player;\n    let slideMenuHeight = 60;\n    if (isVoicemail) {\n      player = (\n        <VoicemailPlayer\n          className={styles.player}\n          uri={voicemailAttachment.uri}\n          duration={voicemailAttachment.duration}\n          onPlay={this.onPlayVoicemail}\n          disabled={disableLinks}\n          currentLocale={currentLocale}\n        />\n      );\n      slideMenuHeight = 88;\n    }\n    const extraButton = renderExtraButton\n      ? renderExtraButton(this.props.conversation, {\n          logConversation: this.logConversation,\n          isLogging: isLogging || this.state.isLogging,\n        })\n      : null;\n    const msgItem = `${type}MessageItem`;\n\n    return (\n      <div\n        data-sign={msgItem}\n        data-id={conversationId}\n        className={styles.root}\n        onClick={this.onClickItem}\n      >\n        <div\n          data-sign=\"unread\"\n          className={classnames(styles.wrapper, unreadCounts && styles.unread)}\n          onClick={this.onClickWrapper}\n        >\n          <ConversationIcon\n            group={correspondents.length > 1}\n            type={type}\n            currentLocale={currentLocale}\n            direction={direction}\n          />\n          <div\n            className={classnames(\n              styles.infoWrapper,\n              !extraButton && styles.embellishInfoWrapper,\n            )}\n          >\n            <ContactDisplay\n              reference={(ref) => {\n                this.contactDisplay = ref;\n              }}\n              className={classnames(\n                styles.contactDisplay,\n                unreadCounts && styles.unread,\n              )}\n              unread={!!unreadCounts}\n              selectedClassName={styles.selectedValue}\n              selectClassName={styles.dropdownSelect}\n              brand={brand}\n              contactMatches={correspondentMatches}\n              selected={this.state.selected}\n              onSelectContact={this.onSelectContact}\n              disabled={disableLinks}\n              isLogging={isLogging || this.state.isLogging}\n              fallBackName={fallbackName}\n              areaCode={areaCode}\n              countryCode={countryCode}\n              phoneNumber={shouldHideNumber ? null : phoneNumber}\n              groupNumbers={groupNumbers}\n              showGroupNumberName={showGroupNumberName}\n              currentLocale={currentLocale}\n              currentSiteCode={currentSiteCode}\n              isMultipleSiteEnabled={isMultipleSiteEnabled}\n              enableContactFallback={enableContactFallback}\n              stopPropagation={false}\n              showType={false}\n              showPlaceholder={showContactDisplayPlaceholder}\n              placeholder={contactPlaceholder}\n              sourceIcons={sourceIcons}\n              phoneTypeRenderer={phoneTypeRenderer}\n              phoneSourceNameRenderer={phoneSourceNameRenderer}\n              dropdownRenderFunction={renderContactList}\n              dropdownClassName={dropdownClassName}\n            />\n            <div className={styles.detailsWithTime}>\n              <div\n                data-sign=\"msgDetail\"\n                className={styles.details}\n                title={detail}\n              >\n                {detail}\n              </div>\n              <div className={styles.separatrix}>|</div>\n              <div data-sign=\"msgCreateTime\" className={styles.creationTime}>\n                {this.dateTimeFormatter(creationTime)}\n              </div>\n            </div>\n          </div>\n          {extraButton}\n        </div>\n        <SlideMenu\n          extended={this.state.extended}\n          onToggle={this.toggleExtended}\n          extendIconClassName={styles.extendIcon}\n          className={styles.slideMenu}\n          minHeight={0}\n          maxHeight={slideMenuHeight}\n        >\n          <div\n            className={styles.playContainer}\n            onClick={this.preventEventPropagating}\n          >\n            {player}\n          </div>\n          <ActionMenuList\n            shouldHideEntityButton={isContactMatchesHidden}\n            className={styles.actionMenuList}\n            type={type}\n            currentLocale={currentLocale}\n            onLog={\n              isVoicemail || isFax || renderExtraButton\n                ? undefined\n                : onLogConversation && this.logConversation\n            }\n            onViewEntity={onViewContact && this.viewSelectedContact}\n            onCreateEntity={onCreateContact && this.createSelectedContact}\n            createEntityTypes={createEntityTypes}\n            hasEntity={\n              correspondents.length === 1 &&\n              !!correspondentMatches.length &&\n              (this.getSelectedContact()?.type ?? '') !== extensionTypes.ivrMenu\n            }\n            onClickToDial={\n              !isFax ? onClickToDial && this.clickToDial : undefined\n            }\n            onClickToSms={\n              isVoicemail ? onClickToSms && this.onClickToSms : undefined\n            }\n            disableClickToSms={disableClickToSms}\n            phoneNumber={phoneNumber}\n            disableLinks={disableLinks}\n            disableCallButton={disableCallButton}\n            disableClickToDial={disableClickToDial}\n            isLogging={isLogging || this.state.isLogging}\n            isLogged={conversationMatches.length > 0}\n            isCreating={this.state.isCreating}\n            addLogTitle={i18n.getString('addLog', currentLocale)}\n            editLogTitle={i18n.getString('editLog', currentLocale)}\n            callTitle={i18n.getString('call', currentLocale)}\n            textTitle={i18n.getString('text', currentLocale)}\n            createEntityTitle={i18n.getString('addEntity', currentLocale)}\n            viewEntityTitle={i18n.getString('viewDetails', currentLocale)}\n            stopPropagation={false}\n            onDelete={isVoicemail || isFax ? this.onDeleteMessage : undefined}\n            deleteTitle={i18n.getString('delete', currentLocale)}\n            marked={unreadCounts > 0}\n            onMark={\n              isVoicemail || (isFax && direction === messageDirection.inbound)\n                ? this.onMarkMessage\n                : undefined\n            }\n            onUnmark={\n              isVoicemail || (isFax && direction === messageDirection.inbound)\n                ? this.onUnmarkMessage\n                : undefined\n            }\n            onPreview={isFax ? this.onPreviewFax : undefined}\n            markTitle={i18n.getString('mark', currentLocale)}\n            unmarkTitle={i18n.getString('unmark', currentLocale)}\n            faxAttachment={faxAttachment}\n            previewTitle={i18n.getString('preview', currentLocale)}\n            downloadTitle={i18n.getString('download', currentLocale)}\n            onFaxDownload={onFaxDownload}\n            showChooseEntityModal={showChooseEntityModal}\n          />\n        </SlideMenu>\n      </div>\n    );\n  }\n}\n\nexport default MessageItem;\n"],"file":"index.js"}
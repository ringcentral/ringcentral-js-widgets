{"version":3,"file":"DurationCounter.js","names":["_formatDuration","require","_springUi","_clsx","_interopRequireDefault","_react","_interopRequireWildcard","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","_typeof","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","_arrayLikeToArray","toString","slice","constructor","name","Array","from","test","length","l","Symbol","iterator","f","o","next","done","push","value","isArray","DurationCounter","props","startTime","prev","usePrevious","forceUpdate","useForceUpdate","useEffect","createElement","InnerDurationCounter","exports","_ref","className","_ref$offset","offset","getFormattedDuration","useCallback","undefined","formatDuration","adjustedStartTime","duration","Math","round","Date","now","defaultValueRef","useResultRef","_useState","useState","current","_useState2","setDuration","useInterval","clsx"],"sources":["components/DurationCounter/DurationCounter.tsx"],"sourcesContent":["import { formatDuration } from '@ringcentral-integration/commons/lib/formatDuration';\nimport {\n  useForceUpdate,\n  useInterval,\n  usePrevious,\n  useResultRef,\n} from '@ringcentral/spring-ui';\nimport clsx from 'clsx';\nimport React, { useCallback, useEffect, useState } from 'react';\n\ntype DurationCounterProps = {\n  className?: string;\n  /**\n   * The start time in milliseconds since the Unix epoch.\n   */\n  startTime: number | undefined;\n  /**\n   * An optional offset in milliseconds to adjust the start time.\n   *\n   * @default 0\n   */\n  offset?: number;\n};\n\n/**\n * DurationCounter component displays a formatted duration that updates every second.\n */\nexport const DurationCounter: React.FC<DurationCounterProps> = (props) => {\n  const { startTime } = props;\n  const prev = usePrevious(() => startTime);\n  const forceUpdate = useForceUpdate();\n\n  // when startTime changes, force update to full re-render the component\n  useEffect(() => {\n    if (prev && prev !== startTime) {\n      forceUpdate();\n    }\n  }, [forceUpdate, prev, startTime]);\n\n  if (prev && prev !== startTime) {\n    return null;\n  }\n\n  return <InnerDurationCounter {...props} />;\n};\n\n/**\n * DurationCounter component displays a formatted duration that updates every second.\n */\nconst InnerDurationCounter: React.FC<DurationCounterProps> = ({\n  className,\n  startTime,\n  offset = 0,\n}) => {\n  const getFormattedDuration = useCallback(() => {\n    if (startTime === undefined) return formatDuration(startTime);\n\n    const adjustedStartTime = startTime + offset;\n\n    const duration = Math.round((Date.now() - adjustedStartTime) / 1000);\n\n    return formatDuration(duration);\n  }, [offset, startTime]);\n\n  // use result ref to avoid re-creating the function on every render\n  const defaultValueRef = useResultRef(getFormattedDuration);\n\n  const [duration, setDuration] = useState<string>(defaultValueRef.current);\n\n  useInterval(() => setDuration(getFormattedDuration()), 1000);\n\n  return (\n    <span\n      className={clsx(className, 'typography-descriptorMini')}\n      data-sign=\"duration\"\n    >\n      {duration}\n    </span>\n  );\n};\n"],"mappings":"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","ignoreList":[]}
{"version":3,"file":"DurationCounter.js","names":["_formatDuration","require","_springUi","_clsx","_interopRequireDefault","_react","_interopRequireWildcard","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","_typeof","has","get","set","_t","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","a","_arrayLikeToArray","toString","slice","constructor","name","Array","from","test","length","l","Symbol","iterator","u","next","done","push","value","isArray","DurationCounter","exports","props","startTime","prev","usePrevious","forceUpdate","useForceUpdate","useEffect","createElement","InnerDurationCounter","_ref","className","_ref$offset","offset","getFormattedDuration","useCallback","undefined","formatDuration","adjustedStartTime","duration","Math","round","Date","now","defaultValueRef","useResultRef","_useState","useState","current","_useState2","setDuration","useInterval","clsx"],"sources":["components/DurationCounter/DurationCounter.tsx"],"sourcesContent":["import { formatDuration } from '@ringcentral-integration/commons/lib/formatDuration';\nimport {\n  useForceUpdate,\n  useInterval,\n  usePrevious,\n  useResultRef,\n} from '@ringcentral/spring-ui';\nimport clsx from 'clsx';\nimport React, { useCallback, useEffect, useState } from 'react';\n\ntype DurationCounterProps = {\n  className?: string;\n  /**\n   * The start time in milliseconds since the Unix epoch.\n   */\n  startTime: number | undefined;\n  /**\n   * An optional offset in milliseconds to adjust the start time.\n   *\n   * @default 0\n   */\n  offset?: number;\n};\n\n/**\n * DurationCounter component displays a formatted duration that updates every second.\n */\nexport const DurationCounter: React.FC<DurationCounterProps> = (props) => {\n  const { startTime } = props;\n  const prev = usePrevious(() => startTime);\n  const forceUpdate = useForceUpdate();\n\n  // when startTime changes, force update to full re-render the component\n  useEffect(() => {\n    if (prev && prev !== startTime) {\n      forceUpdate();\n    }\n  }, [forceUpdate, prev, startTime]);\n\n  if (prev && prev !== startTime) {\n    return null;\n  }\n\n  return <InnerDurationCounter {...props} />;\n};\n\n/**\n * DurationCounter component displays a formatted duration that updates every second.\n */\nconst InnerDurationCounter: React.FC<DurationCounterProps> = ({\n  className,\n  startTime,\n  offset = 0,\n}) => {\n  const getFormattedDuration = useCallback(() => {\n    if (startTime === undefined) return formatDuration(startTime);\n\n    const adjustedStartTime = startTime + offset;\n\n    const duration = Math.round((Date.now() - adjustedStartTime) / 1000);\n\n    return formatDuration(duration);\n  }, [offset, startTime]);\n\n  // use result ref to avoid re-creating the function on every render\n  const defaultValueRef = useResultRef(getFormattedDuration);\n\n  const [duration, setDuration] = useState<string>(defaultValueRef.current);\n\n  useInterval(() => setDuration(getFormattedDuration()), 1000);\n\n  return (\n    <span\n      className={clsx(className, 'typography-descriptorMini')}\n      data-sign=\"duration\"\n    >\n      {duration}\n    </span>\n  );\n};\n"],"mappings":"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","ignoreList":[]}
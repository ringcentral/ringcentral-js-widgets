{"version":3,"file":"CountdownTimer.js","names":["_utils","require","_juno","_react","_interopRequireWildcard","_i18n","_interopRequireDefault","_styles","e","__esModule","_getRequireWildcardCache","WeakMap","r","t","_typeof","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","_arrayLikeToArray","toString","slice","constructor","name","Array","from","test","length","l","Symbol","iterator","f","o","next","done","push","value","isArray","CountdownTimer","_ref","creationTime","duration","variant","currentLocale","_ref$children","children","createElement","endTime","remain","Math","floor","Date","now","_useState","useState","_useState2","timeRemaining","setTimeRemaining","useEffect","intervalId","setInterval","remainingTime","clearInterval","minutes","ceil","seconds","countdownInfo","concat","format","i18n","getString","delayTime","className","styles","wrapper","RcAlert","icon","alert","RcTooltip","title","ignorePointer","plaintext","exports"],"sources":["components/CountdownTimer/CountdownTimer.tsx"],"sourcesContent":["import { format } from '@ringcentral-integration/utils';\nimport { RcAlert, RcTooltip } from '@ringcentral/juno';\nimport React, { useEffect, useState } from 'react';\n\nimport i18n from './i18n';\nimport styles from './styles.scss';\n\ntype CountdownTimerProps = {\n  creationTime: number;\n  duration: number;\n  currentLocale: string;\n  variant: 'plain' | 'info' | 'tooltip';\n  children?: any;\n};\n\nexport const CountdownTimer = ({\n  creationTime,\n  duration,\n  variant,\n  currentLocale,\n  children = <span />,\n}: CountdownTimerProps) => {\n  const endTime = creationTime + duration * 60 * 1000; // ms\n  const remain = Math.floor((endTime - Date.now()) / 1000); // s\n  const [timeRemaining, setTimeRemaining] = useState(remain);\n\n  useEffect(() => {\n    const intervalId = setInterval(() => {\n      const remainingTime = Math.floor((endTime - Date.now()) / 1000); // s\n      if (remainingTime <= -1) {\n        clearInterval(intervalId);\n        // do something when time is up\n      }\n      setTimeRemaining(remainingTime);\n    }, 1000);\n\n    return () => clearInterval(intervalId);\n  }, [creationTime, duration]);\n\n  const minutes = Math.ceil(timeRemaining / 60);\n  const seconds = Math.ceil(timeRemaining % 60);\n\n  let countdownInfo: string;\n  if (timeRemaining > 60) {\n    countdownInfo = `${format(\n      i18n.getString('infoMessageMins', currentLocale),\n      {\n        delayTime: minutes,\n      },\n    )}`;\n  } else if (timeRemaining === 60) {\n    /* 1 minute */\n    countdownInfo = `${format(i18n.getString('infoMessageMin', currentLocale), {\n      delayTime: minutes,\n    })}`;\n  } else if (seconds !== 1) {\n    countdownInfo = `${format(\n      i18n.getString('infoMessageSecs', currentLocale),\n      {\n        delayTime: seconds,\n      },\n    )}`;\n  } else {\n    /* 1 second */\n    countdownInfo = `${format(i18n.getString('infoMessageSec', currentLocale), {\n      delayTime: seconds,\n    })}`;\n  }\n\n  if (timeRemaining < 0 && variant === 'tooltip') {\n    return children;\n  } else if (timeRemaining < 0) {\n    return null;\n  }\n\n  switch (variant) {\n    case 'info':\n      return (\n        <div data-sign=\"delaySavingTimer\" className={styles.wrapper}>\n          <RcAlert icon className={styles.alert}>\n            {countdownInfo}\n          </RcAlert>\n        </div>\n      );\n    case 'tooltip':\n      return (\n        <RcTooltip title={countdownInfo} ignorePointer>\n          {children}\n        </RcTooltip>\n      );\n    case 'plain':\n    default:\n      return (\n        <div\n          data-sign=\"delaySavingTimer\"\n          className={styles.plaintext}\n          title={countdownInfo}\n        >\n          {countdownInfo}\n        </div>\n      );\n  }\n};\n"],"mappings":"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","ignoreList":[]}
{"version":3,"file":"CountdownTimer.js","names":["_utils","require","_juno","_react","_interopRequireWildcard","_i18n","_interopRequireDefault","_styles","e","__esModule","t","WeakMap","r","n","o","i","f","__proto__","_typeof","has","get","set","_t","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","a","_arrayLikeToArray","toString","slice","constructor","name","Array","from","test","length","l","Symbol","iterator","u","next","done","push","value","isArray","CountdownTimer","exports","_ref","creationTime","duration","variant","currentLocale","_ref$children","children","createElement","endTime","remain","Math","floor","Date","now","_useState","useState","_useState2","timeRemaining","setTimeRemaining","useEffect","intervalId","setInterval","remainingTime","clearInterval","minutes","ceil","seconds","countdownInfo","concat","format","i18n","getString","delayTime","className","styles","wrapper","RcAlert","icon","alert","RcTooltip","title","ignorePointer","plaintext"],"sources":["components/CountdownTimer/CountdownTimer.tsx"],"sourcesContent":["import { format } from '@ringcentral-integration/utils';\nimport { RcAlert, RcTooltip } from '@ringcentral/juno';\nimport React, { useEffect, useState } from 'react';\n\nimport i18n from './i18n';\nimport styles from './styles.scss';\n\ntype CountdownTimerProps = {\n  creationTime: number;\n  duration: number;\n  currentLocale: string;\n  variant: 'plain' | 'info' | 'tooltip';\n  children?: any;\n};\n\nexport const CountdownTimer = ({\n  creationTime,\n  duration,\n  variant,\n  currentLocale,\n  children = <span />,\n}: CountdownTimerProps) => {\n  const endTime = creationTime + duration * 60 * 1000; // ms\n  const remain = Math.floor((endTime - Date.now()) / 1000); // s\n  const [timeRemaining, setTimeRemaining] = useState(remain);\n\n  useEffect(() => {\n    const intervalId = setInterval(() => {\n      const remainingTime = Math.floor((endTime - Date.now()) / 1000); // s\n      if (remainingTime <= -1) {\n        clearInterval(intervalId);\n        // do something when time is up\n      }\n      setTimeRemaining(remainingTime);\n    }, 1000);\n\n    return () => clearInterval(intervalId);\n  }, [creationTime, duration]);\n\n  const minutes = Math.ceil(timeRemaining / 60);\n  const seconds = Math.ceil(timeRemaining % 60);\n\n  let countdownInfo: string;\n  if (timeRemaining > 60) {\n    countdownInfo = `${format(\n      i18n.getString('infoMessageMins', currentLocale),\n      {\n        delayTime: minutes,\n      },\n    )}`;\n  } else if (timeRemaining === 60) {\n    /* 1 minute */\n    countdownInfo = `${format(i18n.getString('infoMessageMin', currentLocale), {\n      delayTime: minutes,\n    })}`;\n  } else if (seconds !== 1) {\n    countdownInfo = `${format(\n      i18n.getString('infoMessageSecs', currentLocale),\n      {\n        delayTime: seconds,\n      },\n    )}`;\n  } else {\n    /* 1 second */\n    countdownInfo = `${format(i18n.getString('infoMessageSec', currentLocale), {\n      delayTime: seconds,\n    })}`;\n  }\n\n  if (timeRemaining < 0 && variant === 'tooltip') {\n    return children;\n  } else if (timeRemaining < 0) {\n    return null;\n  }\n\n  switch (variant) {\n    case 'info':\n      return (\n        <div data-sign=\"delaySavingTimer\" className={styles.wrapper}>\n          <RcAlert icon className={styles.alert}>\n            {countdownInfo}\n          </RcAlert>\n        </div>\n      );\n    case 'tooltip':\n      return (\n        <RcTooltip title={countdownInfo} ignorePointer>\n          {children}\n        </RcTooltip>\n      );\n    case 'plain':\n    default:\n      return (\n        <div\n          data-sign=\"delaySavingTimer\"\n          className={styles.plaintext}\n          title={countdownInfo}\n        >\n          {countdownInfo}\n        </div>\n      );\n  }\n};\n"],"mappings":"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","ignoreList":[]}
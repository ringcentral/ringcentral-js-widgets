{"version":3,"file":"ImageAttachmentRender.js","names":["_utils","require","_constant","_clsx","_interopRequireDefault","_react","_interopRequireWildcard","_DownloadButton","_styles","e","__esModule","_typeof","o","Symbol","iterator","constructor","prototype","_extends","Object","assign","bind","n","arguments","length","t","r","hasOwnProperty","call","apply","_objectWithoutProperties","i","_objectWithoutPropertiesLoose","getOwnPropertySymbols","indexOf","propertyIsEnumerable","_getRequireWildcardCache","WeakMap","has","get","__proto__","a","defineProperty","getOwnPropertyDescriptor","u","set","TiffViewer","React","lazy","Promise","resolve","then","ImageAttachmentRender","props","attachment","handleImageLoad","rest","uri","fileNameWithoutExt","fileName","removeExtension","id","fileExt","getFileExtension","CONTENT_TYPE_TO_EXTENSION","contentType","concat","isTiff","createElement","key","className","clsx","styles","previewMedia","Suspense","fallback","tiffUrl","onLoad","loading","tabIndex","src","alt","title","draggable","hoverAction","ext","DownloadButton","size","url","name","exports"],"sources":["components/ConversationMessageList/ImageAttachmentRender.tsx"],"sourcesContent":["import MessageAttachmentInfo from '@rc-ex/core/lib/definitions/MessageAttachmentInfo';\nimport {\n  getFileExtension,\n  removeExtension,\n} from '@ringcentral-integration/utils';\nimport { CONTENT_TYPE_TO_EXTENSION } from '@ringcentral-integration/utils/src/utils/fileHandler/constant';\nimport clsx from 'clsx';\nimport type { FunctionComponent } from 'react';\nimport React, { Suspense } from 'react';\n\nimport { DownloadButton } from '../DownloadButton';\n\nimport styles from './styles.scss';\n\nconst TiffViewer = React.lazy(() => import('./TiffViewer'));\n\nexport interface ImageAttachmentRenderProps {\n  attachment: MessageAttachmentInfo;\n  handleImageLoad?: () => void;\n}\n\nexport const ImageAttachmentRender: FunctionComponent<\n  ImageAttachmentRenderProps\n> = (props) => {\n  const { attachment, handleImageLoad, ...rest } = props;\n\n  const uri = attachment.uri;\n  const fileNameWithoutExt = attachment.fileName\n    ? removeExtension(attachment.fileName)\n    : attachment.id;\n  const fileExt = attachment.fileName\n    ? getFileExtension(attachment.fileName)\n    : CONTENT_TYPE_TO_EXTENSION[attachment.contentType!];\n  const fileName = `${fileNameWithoutExt}.${fileExt}`;\n  const isTiff = fileExt.indexOf('tif') > -1;\n\n  return (\n    <div\n      key={attachment.id}\n      {...rest}\n      className={clsx(\n        'rounded-lg overflow-hidden relative outline-none z-10',\n        styles.previewMedia,\n      )}\n    >\n      {isTiff ? (\n        <Suspense fallback={<div></div>}>\n          <TiffViewer tiffUrl={uri!} onLoad={handleImageLoad} />\n        </Suspense>\n      ) : (\n        <img\n          loading=\"lazy\"\n          // eslint-disable-next-line jsx-a11y/no-noninteractive-tabindex\n          tabIndex={0}\n          src={uri}\n          alt={fileName}\n          title={fileName}\n          draggable=\"false\"\n          className=\"w-full\"\n          onLoad={handleImageLoad}\n        />\n      )}\n      <div\n        className={clsx(\n          'bg-neutral-b4 h-8 p-2 flex items-center absolute left-0 bottom-0 translate-y-full transition-neutral-01-fast w-full',\n          styles.hoverAction,\n        )}\n        data-sign=\"image-toolbar\"\n      >\n        {fileName && (\n          <div\n            className=\"flex typography-mainText overflow-hidden flex-auto pr-2\"\n            data-sign=\"image-name\"\n          >\n            <div className=\"truncate\">{fileNameWithoutExt}</div>\n            <div className={clsx('flex-none', styles.ext)}>.{fileExt}</div>\n          </div>\n        )}\n        <div className=\"ml-auto\">\n          <DownloadButton\n            size=\"medium\"\n            url={`${uri}&contentDisposition=Attachment`}\n            name={fileName}\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n"],"mappings":"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","ignoreList":[]}
{"version":3,"file":"RingtoneUploadButton.js","names":["_AudioSettings","require","_RingtoneConfiguration","_juno","_junoIcon","_react","_interopRequireWildcard","_helper","_i18n","_styles","_interopRequireDefault","e","__esModule","_getRequireWildcardCache","WeakMap","r","t","_typeof","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","asyncGeneratorStep","o","c","value","done","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","RingtoneUploadButton","_ref","customRingtoneNameList","isButtonDisabled","onUploadRingtone","showAlert","onClickAddButton","isMountedRef","useMountState","inputElRef","useRef","createElement","Fragment","RcMenuItem","key","className","styles","addRingtoneItem","onClick","current","click","disabled","RcIcon","symbol","ZoomIn","size","RcText","titleWhenOverflow","flexFull","ref","hidden","type","accept","onChange","_ref3","regeneratorRuntime","mark","_callee","_ref2","currentTarget","_currentTarget$files","file","isValidFile","audioInfo","wrap","_callee$","_context","prev","next","files","length","includes","name","audioSettingsErrors","duplicateRingtone","abrupt","MAX_RINGTONE_SIZE","ringtoneSizeOverLimit","isAudioFile","sent","uploadRingtoneFailed","readAudioFile","t0","console","error","stop","_x","RcDivider","tabIndex","addRingtoneDivider","exports"],"sources":["components/RingtoneSelection/components/RingtoneUploadButton.tsx"],"sourcesContent":["import { audioSettingsErrors } from '@ringcentral-integration/commons/modules/AudioSettings';\nimport {\n  AudioInfo,\n  MAX_RINGTONE_SIZE,\n} from '@ringcentral-integration/commons/modules/RingtoneConfiguration';\nimport {\n  RcIcon,\n  RcText,\n  RcMenuItem,\n  useMountState,\n  RcDivider,\n} from '@ringcentral/juno';\nimport { ZoomIn } from '@ringcentral/juno-icon';\nimport type { FunctionComponent } from 'react';\nimport React, { useRef } from 'react';\n\nimport { isAudioFile, readAudioFile } from '../helper';\nimport { t } from '../i18n';\nimport styles from '../styles.scss';\n\ninterface RingtoneUploadButtonProps {\n  customRingtoneNameList: string[];\n  isButtonDisabled?: boolean;\n  onUploadRingtone: ({ fileName, dataUrl }: AudioInfo) => void;\n  showAlert: (message: string) => void;\n  onClickAddButton: () => void;\n}\n\nexport const RingtoneUploadButton: FunctionComponent<\n  RingtoneUploadButtonProps\n> = ({\n  customRingtoneNameList,\n  isButtonDisabled,\n  onUploadRingtone,\n  showAlert,\n  onClickAddButton,\n}) => {\n  const isMountedRef = useMountState();\n  const inputElRef = useRef<HTMLInputElement>(null);\n\n  return (\n    <>\n      <RcMenuItem\n        key=\"add\"\n        data-sign=\"addRingtone\"\n        className={styles.addRingtoneItem}\n        onClick={() => {\n          if (inputElRef.current) {\n            inputElRef.current.click();\n          }\n          onClickAddButton();\n        }}\n        disabled={isButtonDisabled}\n      >\n        <RcIcon symbol={ZoomIn} size=\"small\" />\n        <RcText titleWhenOverflow flexFull>\n          {t('add')}\n        </RcText>\n        <input\n          ref={inputElRef}\n          className={styles.hidden}\n          type=\"file\"\n          data-sign=\"uploadRingtoneInput\"\n          accept=\".mp3, .wav\"\n          onChange={async ({ currentTarget }) => {\n            try {\n              if (currentTarget?.files?.length && isMountedRef.current) {\n                const file = currentTarget.files[0];\n\n                // duplicate file\n                if (customRingtoneNameList.includes(file.name)) {\n                  showAlert(audioSettingsErrors.duplicateRingtone);\n                  return;\n                }\n\n                // over size limit\n                if (file.size > MAX_RINGTONE_SIZE) {\n                  showAlert(audioSettingsErrors.ringtoneSizeOverLimit);\n                  return;\n                }\n\n                const isValidFile = await isAudioFile(file);\n                if (!isValidFile) {\n                  showAlert(audioSettingsErrors.uploadRingtoneFailed);\n                  return;\n                }\n\n                const audioInfo = await readAudioFile(file);\n                onUploadRingtone(audioInfo);\n                // reset input\n                currentTarget.value = '';\n              }\n            } catch (e) {\n              console.error('upload ringtone failed', e);\n              showAlert(audioSettingsErrors.uploadRingtoneFailed);\n            }\n          }}\n        />\n      </RcMenuItem>\n      <RcDivider\n        aria-hidden={true}\n        tabIndex={-1}\n        className={styles.addRingtoneDivider}\n      />\n    </>\n  );\n};\n"],"mappings":"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","ignoreList":[]}
{"version":3,"sources":["integration-test/utils/WaitUtil.ts"],"names":["isTimeOut","startTime","timeoutInSeconds","Date","now","waitUntilEqual","source","checkItem","expect","retryTtl","Promise","resolve","timer","setInterval","checkValue","clearInterval","e","console","error"],"mappings":";;;;;;;;;;;;;;;AAAA,SAASA,SAAT,CAAmBC,SAAnB,EAAsCC,gBAAtC,EAAgE;AAC9D,SAAOC,IAAI,CAACC,GAAL,KAAaH,SAAb,GAAyBC,gBAAgB,GAAG,IAAnD;AACD;;AAEM,SAASG,cAAT,CACLC,MADK,EAELC,SAFK,EAGLC,MAHK,EAILN,gBAJK,EAML;AAAA,MADAO,QACA,uEADW,GACX;AACA,MAAMR,SAAS,GAAGE,IAAI,CAACC,GAAL,EAAlB;AACA,SAAO,IAAIM,OAAJ,CAAY,UAACC,OAAD,EAAa;AAC9B,QAAMC,KAAK,GAAGC,WAAW,CAAC,YAAM;AAC9B,UAAI;AACF,YAAMC,UAAU,GAAGR,MAAM,EAAzB;;AACA,YAAIQ,UAAU,KAAKN,MAAnB,EAA2B;AACzBO,UAAAA,aAAa,CAACH,KAAD,CAAb;AACAD,UAAAA,OAAO,CAAC,IAAD,CAAP;AACA;AACD;AACF,OAPD,CAOE,OAAOK,CAAP,EAAU;AACVC,QAAAA,OAAO,CAACC,KAAR,CAAcF,CAAd;AACD;;AACD,UAAIhB,SAAS,CAACC,SAAD,EAAYC,gBAAZ,CAAb,EAA4C;AAC1Ca,QAAAA,aAAa,CAACH,KAAD,CAAb;AACAD,QAAAA,OAAO,CAAC,KAAD,CAAP;AACAM,QAAAA,OAAO,CAACC,KAAR,4BAAkCX,SAAlC,qBAAsDC,MAAtD;AACD;AACF,KAhBwB,EAgBtBC,QAhBsB,CAAzB;AAiBD,GAlBM,CAAP;AAmBD","sourcesContent":["function isTimeOut(startTime: number, timeoutInSeconds: number) {\n  return Date.now() - startTime > timeoutInSeconds * 1000;\n}\n\nexport function waitUntilEqual<T>(\n  source: () => T,\n  checkItem: string,\n  expect: T,\n  timeoutInSeconds: number,\n  retryTtl = 500,\n) {\n  const startTime = Date.now();\n  return new Promise((resolve) => {\n    const timer = setInterval(() => {\n      try {\n        const checkValue = source();\n        if (checkValue === expect) {\n          clearInterval(timer);\n          resolve(true);\n          return;\n        }\n      } catch (e) {\n        console.error(e);\n      }\n      if (isTimeOut(startTime, timeoutInSeconds)) {\n        clearInterval(timer);\n        resolve(false);\n        console.error(`Timeout wait for ${checkItem}  to be ${expect}`);\n      }\n    }, retryTtl);\n  });\n}\n"],"file":"WaitUtil.js"}
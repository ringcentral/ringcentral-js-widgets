{"version":3,"file":"checkPatches.js","names":["checkPatches","oldStateTree","options","patches","_patches","patch","op","path","value","toString","call","Object","keys","length","Array","isArray","oldState","reduce","state","_path"],"sources":["lib/usm-redux/checkPatches.ts"],"sourcesContent":["import { Action } from './interface';\n\nexport const checkPatches = (\n  oldStateTree: Record<string, any>,\n  options: Action,\n) => {\n  const patches = options._patches ?? [];\n  for (const patch of patches) {\n    const { op, path, value } = patch;\n    if (\n      op === 'replace' &&\n      ((toString.call(value) === '[object Object]' &&\n        !!Object.keys(value).length) ||\n        (Array.isArray(value) && !!value.length))\n    ) {\n      const oldState = path.reduce(\n        (state, _path) => state?.[_path],\n        oldStateTree,\n      );\n      if (oldState && typeof oldState === 'object') {\n        const length = Array.isArray(oldState)\n          ? oldState.length\n          : Object.keys(oldState).length;\n        if (length > 0) {\n          return true;\n        }\n      }\n    }\n  }\n  return false;\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAEO,IAAMA,YAAY,GAAG,SAAfA,YAAe,CAC1BC,YAD0B,EAE1BC,OAF0B,EAGvB;EAAA;;EACH,IAAMC,OAAO,wBAAGD,OAAO,CAACE,QAAX,iEAAuB,EAApC;;EADG,2CAEiBD,OAFjB;EAAA;;EAAA;IAEH,oDAA6B;MAAA,IAAlBE,KAAkB;MAAA,IACnBC,EADmB,GACCD,KADD,CACnBC,EADmB;MAAA,IACfC,IADe,GACCF,KADD,CACfE,IADe;MAAA,IACTC,KADS,GACCH,KADD,CACTG,KADS;;MAE3B,IACEF,EAAE,KAAK,SAAP,KACEG,QAAQ,CAACC,IAAT,CAAcF,KAAd,MAAyB,iBAAzB,IACA,CAAC,CAACG,MAAM,CAACC,IAAP,CAAYJ,KAAZ,EAAmBK,MADtB,IAEEC,KAAK,CAACC,OAAN,CAAcP,KAAd,KAAwB,CAAC,CAACA,KAAK,CAACK,MAHnC,CADF,EAKE;QACA,IAAMG,QAAQ,GAAGT,IAAI,CAACU,MAAL,CACf,UAACC,KAAD,EAAQC,KAAR;UAAA,OAAkBD,KAAlB,aAAkBA,KAAlB,uBAAkBA,KAAK,CAAGC,KAAH,CAAvB;QAAA,CADe,EAEflB,YAFe,CAAjB;;QAIA,IAAIe,QAAQ,IAAI,QAAOA,QAAP,MAAoB,QAApC,EAA8C;UAC5C,IAAMH,MAAM,GAAGC,KAAK,CAACC,OAAN,CAAcC,QAAd,IACXA,QAAQ,CAACH,MADE,GAEXF,MAAM,CAACC,IAAP,CAAYI,QAAZ,EAAsBH,MAF1B;;UAGA,IAAIA,MAAM,GAAG,CAAb,EAAgB;YACd,OAAO,IAAP;UACD;QACF;MACF;IACF;EAvBE;IAAA;EAAA;IAAA;EAAA;;EAwBH,OAAO,KAAP;AACD,CA5BM"}
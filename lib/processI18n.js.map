{"version":3,"file":"processI18n.js","names":["_ramda","require","_i18n","_interopRequireWildcard","_getLanguageFromLocale","_toPseudoString","_interopRequireDefault","_BrandConfig","obj","__esModule","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","_typeof","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","Symbol","iterator","constructor","processI18n","input","locale","arguments","length","undefined","DEFAULT_LOCALE","defaultLocale","parentKey","Array","isArray","map","item","I18nFlag","_ref","_translations$locale","PSEUDO_LOCALE","_translations$default","toPseudoString","str","translations","padRatio","I18n","getLanguageFromLocale","reduce","acc","keys"],"sources":["lib/processI18n.ts"],"sourcesContent":["import { keys, map, reduce } from 'ramda';\n\nimport I18n, {\n  DEFAULT_LOCALE,\n  PSEUDO_LOCALE,\n} from '@ringcentral-integration/i18n';\nimport { getLanguageFromLocale } from '@ringcentral-integration/i18n/lib/getLanguageFromLocale';\nimport toPseudoString from '@ringcentral-integration/i18n/lib/toPseudoString';\nimport type { LocaleCode } from '@ringcentral-integration/locale-settings';\n\nimport type { I18nStrings } from '../modules/Brand/BrandConfig.interface';\nimport { I18nFlag } from '../modules/Brand/BrandConfig.interface';\n\n// TODO: find a better place to put this file\n\nexport type ConvertI18nToString<T> = T extends Array<infer D>\n  ? Array<ConvertI18nToString<D>>\n  : T extends object\n  ? {\n      [K in keyof T]: T[K] extends string | I18nStrings\n        ? string\n        : ConvertI18nToString<T[K]>;\n    }\n  : T;\n\n/**\n * processI18n takes brandConfigs with I18nStrings objects and based on the locale, return brandConfig without the I18nStrings.\n * @param config BrandConfig\n * @param locale\n * @param defaultLocale\n * @param parentKey parent key of object\n * @returns BrandConfig without I18nStrings structure\n */\nexport function processI18n<T>(\n  input: T,\n  locale: LocaleCode = DEFAULT_LOCALE,\n  defaultLocale: LocaleCode = DEFAULT_LOCALE,\n  parentKey?: string,\n): ConvertI18nToString<T> {\n  if (Array.isArray(input)) {\n    return map(\n      (item) => processI18n(item, locale, defaultLocale),\n      input,\n    ) as ConvertI18nToString<T>;\n  }\n  if (input && typeof input === 'object') {\n    if ((input as unknown as I18nStrings)[I18nFlag]) {\n      if (locale === PSEUDO_LOCALE) {\n        return toPseudoString({\n          str:\n            (input as unknown as I18nStrings).translations[defaultLocale] ??\n            parentKey,\n          padRatio: I18n.padRatio,\n        }) as unknown as ConvertI18nToString<T>;\n      }\n      return ((input as unknown as I18nStrings).translations[locale] ??\n        (input as unknown as I18nStrings).translations[\n          getLanguageFromLocale(locale)\n        ] ??\n        (input as unknown as I18nStrings).translations[\n          defaultLocale\n        ]) as unknown as ConvertI18nToString<T>;\n    }\n    return reduce(\n      (acc, key) => {\n        if (Object.hasOwnProperty.call(input, key)) {\n          acc[key] = processI18n(input[key], locale, defaultLocale, key);\n        }\n        return acc;\n      },\n      {} as Partial<T>,\n      keys(input as object),\n    ) as ConvertI18nToString<T>;\n  }\n\n  return input as ConvertI18nToString<T>;\n}\n"],"mappings":"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"}
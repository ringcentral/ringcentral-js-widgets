{"version":3,"file":"processI18n.js","names":["_i18n","_interopRequireWildcard","require","_getLanguageFromLocale","_toPseudoString","_interopRequireDefault","_ramda","_BrandConfig","e","__esModule","_getRequireWildcardCache","WeakMap","r","t","_typeof","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","o","Symbol","iterator","constructor","prototype","processI18n","input","locale","arguments","length","undefined","DEFAULT_LOCALE","defaultLocale","parentKey","Array","isArray","map","item","I18nFlag","_ref","_translations$locale","PSEUDO_LOCALE","_translations$default","toPseudoString","str","translations","padRatio","I18n","getLanguageFromLocale","reduce","acc","key","keys"],"sources":["lib/processI18n.ts"],"sourcesContent":["import I18n, {\n  DEFAULT_LOCALE,\n  PSEUDO_LOCALE,\n} from '@ringcentral-integration/i18n';\nimport { getLanguageFromLocale } from '@ringcentral-integration/i18n/lib/getLanguageFromLocale';\nimport toPseudoString from '@ringcentral-integration/i18n/lib/toPseudoString';\nimport type { LocaleCode } from '@ringcentral-integration/locale-settings';\nimport { keys, map, reduce } from 'ramda';\n\nimport type { I18nStrings } from '../modules/Brand/BrandConfig.interface';\nimport { I18nFlag } from '../modules/Brand/BrandConfig.interface';\n\n// TODO: find a better place to put this file\n\nexport type ConvertI18nToString<T> = T extends Array<infer D>\n  ? Array<ConvertI18nToString<D>>\n  : T extends object\n  ? {\n      [K in keyof T]: T[K] extends string | I18nStrings\n        ? string\n        : ConvertI18nToString<T[K]>;\n    }\n  : T;\n\n/**\n * processI18n takes brandConfigs with I18nStrings objects and based on the locale, return brandConfig without the I18nStrings.\n * @param config BrandConfig\n * @param locale\n * @param defaultLocale\n * @param parentKey parent key of object\n * @returns BrandConfig without I18nStrings structure\n */\nexport function processI18n<T>(\n  input: T,\n  locale: LocaleCode = DEFAULT_LOCALE,\n  defaultLocale: LocaleCode = DEFAULT_LOCALE,\n  parentKey?: string,\n): ConvertI18nToString<T> {\n  if (Array.isArray(input)) {\n    return map(\n      (item) => processI18n(item, locale, defaultLocale),\n      input,\n    ) as ConvertI18nToString<T>;\n  }\n  if (input && typeof input === 'object') {\n    if ((input as unknown as I18nStrings)[I18nFlag]) {\n      if (locale === PSEUDO_LOCALE) {\n        return toPseudoString({\n          str:\n            (input as unknown as I18nStrings).translations[defaultLocale] ??\n            parentKey,\n          padRatio: I18n.padRatio,\n        }) as unknown as ConvertI18nToString<T>;\n      }\n      return ((input as unknown as I18nStrings).translations[locale] ??\n        (input as unknown as I18nStrings).translations[\n          getLanguageFromLocale(locale)\n        ] ??\n        (input as unknown as I18nStrings).translations[\n          defaultLocale\n        ]) as unknown as ConvertI18nToString<T>;\n    }\n    return reduce(\n      (acc, key) => {\n        if (Object.hasOwnProperty.call(input, key)) {\n          acc[key] = processI18n(input[key], locale, defaultLocale, key);\n        }\n        return acc;\n      },\n      {} as Partial<T>,\n      keys(input as object),\n    ) as ConvertI18nToString<T>;\n  }\n\n  return input as ConvertI18nToString<T>;\n}\n"],"mappings":";;;;;;;;;;;;;;AAAA,IAAAA,KAAA,GAAAC,uBAAA,CAAAC,OAAA;AAIA,IAAAC,sBAAA,GAAAD,OAAA;AACA,IAAAE,eAAA,GAAAC,sBAAA,CAAAH,OAAA;AAEA,IAAAI,MAAA,GAAAJ,OAAA;AAGA,IAAAK,YAAA,GAAAL,OAAA;AAAkE,SAAAG,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,gBAAAA,CAAA;AAAA,SAAAE,yBAAAF,CAAA,6BAAAG,OAAA,mBAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAD,wBAAA,YAAAA,yBAAAF,CAAA,WAAAA,CAAA,GAAAK,CAAA,GAAAD,CAAA,KAAAJ,CAAA;AAAA,SAAAP,wBAAAO,CAAA,EAAAI,CAAA,SAAAA,CAAA,IAAAJ,CAAA,IAAAA,CAAA,CAAAC,UAAA,SAAAD,CAAA,eAAAA,CAAA,gBAAAM,OAAA,CAAAN,CAAA,0BAAAA,CAAA,sBAAAA,CAAA,QAAAK,CAAA,GAAAH,wBAAA,CAAAE,CAAA,OAAAC,CAAA,IAAAA,CAAA,CAAAE,GAAA,CAAAP,CAAA,UAAAK,CAAA,CAAAG,GAAA,CAAAR,CAAA,OAAAS,CAAA,KAAAC,SAAA,UAAAC,CAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,CAAA,IAAAf,CAAA,sBAAAe,CAAA,OAAAC,cAAA,CAAAC,IAAA,CAAAjB,CAAA,EAAAe,CAAA,SAAAG,CAAA,GAAAP,CAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAd,CAAA,EAAAe,CAAA,UAAAG,CAAA,KAAAA,CAAA,CAAAV,GAAA,IAAAU,CAAA,CAAAC,GAAA,IAAAP,MAAA,CAAAC,cAAA,CAAAJ,CAAA,EAAAM,CAAA,EAAAG,CAAA,IAAAT,CAAA,CAAAM,CAAA,IAAAf,CAAA,CAAAe,CAAA,cAAAN,CAAA,cAAAT,CAAA,EAAAK,CAAA,IAAAA,CAAA,CAAAc,GAAA,CAAAnB,CAAA,EAAAS,CAAA,GAAAA,CAAA;AAAA,SAAAH,QAAAc,CAAA,sCAAAd,OAAA,wBAAAe,MAAA,uBAAAA,MAAA,CAAAC,QAAA,aAAAF,CAAA,kBAAAA,CAAA,gBAAAA,CAAA,WAAAA,CAAA,yBAAAC,MAAA,IAAAD,CAAA,CAAAG,WAAA,KAAAF,MAAA,IAAAD,CAAA,KAAAC,MAAA,CAAAG,SAAA,qBAAAJ,CAAA,KAAAd,OAAA,CAAAc,CAAA;AAElE;;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASK,WAAWA,CACzBC,KAAQ,EAIgB;EAAA,IAHxBC,MAAkB,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAGG,oBAAc;EAAA,IACnCC,aAAyB,GAAAJ,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAGG,oBAAc;EAAA,IAC1CE,SAAkB,GAAAL,SAAA,CAAAC,MAAA,OAAAD,SAAA,MAAAE,SAAA;EAElB,IAAII,KAAK,CAACC,OAAO,CAACT,KAAK,CAAC,EAAE;IACxB,OAAO,IAAAU,UAAG,EACR,UAACC,IAAI;MAAA,OAAKZ,WAAW,CAACY,IAAI,EAAEV,MAAM,EAAEK,aAAa,CAAC;IAAA,GAClDN,KACF,CAAC;EACH;EACA,IAAIA,KAAK,IAAIpB,OAAA,CAAOoB,KAAK,MAAK,QAAQ,EAAE;IACtC,IAAKA,KAAK,CAA4BY,qBAAQ,CAAC,EAAE;MAAA,IAAAC,IAAA,EAAAC,oBAAA;MAC/C,IAAIb,MAAM,KAAKc,mBAAa,EAAE;QAAA,IAAAC,qBAAA;QAC5B,OAAO,IAAAC,0BAAc,EAAC;UACpBC,GAAG,GAAAF,qBAAA,GACAhB,KAAK,CAA4BmB,YAAY,CAACb,aAAa,CAAC,cAAAU,qBAAA,cAAAA,qBAAA,GAC7DT,SAAS;UACXa,QAAQ,EAAEC,gBAAI,CAACD;QACjB,CAAC,CAAC;MACJ;MACA,QAAAP,IAAA,IAAAC,oBAAA,GAASd,KAAK,CAA4BmB,YAAY,CAAClB,MAAM,CAAC,cAAAa,oBAAA,cAAAA,oBAAA,GAC3Dd,KAAK,CAA4BmB,YAAY,CAC5C,IAAAG,4CAAqB,EAACrB,MAAM,CAAC,CAC9B,cAAAY,IAAA,cAAAA,IAAA,GACAb,KAAK,CAA4BmB,YAAY,CAC5Cb,aAAa,CACd;IACL;IACA,OAAO,IAAAiB,aAAM,EACX,UAACC,GAAG,EAAEC,GAAG,EAAK;MACZ,IAAIvC,MAAM,CAACI,cAAc,CAACC,IAAI,CAACS,KAAK,EAAEyB,GAAG,CAAC,EAAE;QAC1CD,GAAG,CAACC,GAAG,CAAC,GAAG1B,WAAW,CAACC,KAAK,CAACyB,GAAG,CAAC,EAAExB,MAAM,EAAEK,aAAa,EAAEmB,GAAG,CAAC;MAChE;MACA,OAAOD,GAAG;IACZ,CAAC,EACD,CAAC,CAAC,EACF,IAAAE,WAAI,EAAC1B,KAAe,CACtB,CAAC;EACH;EAEA,OAAOA,KAAK;AACd","ignoreList":[]}
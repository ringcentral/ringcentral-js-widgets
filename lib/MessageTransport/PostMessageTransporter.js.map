{"version":3,"sources":["lib/MessageTransport/PostMessageTransporter.ts"],"names":["PostMessageTransporter","addReceiver","receiveMessage","useCapture","window","addEventListener","dispose","removeEventListener","createEmitter","sendTarget","message","targetOrigin","callback","postMessage","BasicTransporter"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;;;;;;;;;;;;;IAEaA,sB;;;;;;;;;;;;;;;;UACXC,W,GAAc,UAACC,cAAD,EAAsD;AAAA,qFAAP,EAAO;AAAA,iCAA9BC,UAA8B;AAAA,UAA9BA,UAA8B,gCAAjB,KAAiB;;AAClEC,MAAAA,MAAM,CAACC,gBAAP,CAAwB,SAAxB,EAAmCH,cAAnC,EAAmDC,UAAnD;AACD,K;;UAEDG,O,GAAU,UAACJ,cAAD,EAAyB;AACjCE,MAAAA,MAAM,CAACG,mBAAP,CAA2B,SAA3B,EAAsCL,cAAtC;AACD,K;;UAEDM,a,GAAgB,UAACC,UAAD,EAAwB;AACtC;AACA;AACA;AACA;AACA,aAAO,UAACC,OAAD,EAAmE;AAAA,wFAAd,EAAc;AAAA,uCAA/CC,YAA+C;AAAA,YAA/CA,YAA+C,mCAAhC,GAAgC;AAAA,YAA3BC,QAA2B,SAA3BA,QAA2B;;AACxEH,QAAAA,UAAU,CAACI,WAAX,CAAuBH,OAAvB,EAAgCC,YAAhC;AACA,YAAI,OAAOC,QAAP,KAAoB,UAAxB,EAAoCA,QAAQ;AAC7C,OAHD;AAID,K;;;;;;EAlByCE,6B","sourcesContent":["import BasicTransporter from './BasicTransporter';\n\nexport class PostMessageTransporter extends BasicTransporter {\n  addReceiver = (receiveMessage: any, { useCapture = false } = {}) => {\n    window.addEventListener('message', receiveMessage, useCapture);\n  };\n\n  dispose = (receiveMessage: any) => {\n    window.removeEventListener('message', receiveMessage);\n  };\n\n  createEmitter = (sendTarget: Window) => {\n    // Always specify an exact target origin, not *,\n    // when you use postMessage to send data to other windows.\n    // A malicious site can change the location of the window without your knowledge,\n    // and therefore it can intercept the data sent using postMessage.\n    return (message: string, { targetOrigin = '*', callback } = {} as any) => {\n      sendTarget.postMessage(message, targetOrigin);\n      if (typeof callback === 'function') callback();\n    };\n  };\n}\n"],"file":"PostMessageTransporter.js"}
{"version":3,"file":"loggerV2.js","names":["_mfeLogger","require","_reactantShare","_globalThis$localStor","_globalThis$localStor2","_toConsumableArray","r","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","a","_arrayLikeToArray","t","toString","call","slice","constructor","name","Array","from","test","Symbol","iterator","isArray","length","e","n","_regenerator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","d","bind","l","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","w","m","defineProperty","_regeneratorDefine","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_classCallCheck","_defineProperties","_toPropertyKey","key","_createClass","_toPrimitive","_typeof","toPrimitive","String","Number","isSharedWorker","globalThis","SharedWorkerGlobalScope","SharedWorkerTransport","exports","_options","undefined","type","transport","enabled","createTransport","prefix","_init","_callee","_context","init","_write","_callee2","_ref","_this$transport","payload","_context2","emit","respond","write","_x","MemoryStorage","_data","getItem","setItem","removeItem","toggleKey","DEFAULT_LOGGER_ENABLED","loggerEnabled","localStorage","toggleLogger","_globalThis$localStor3","checkLoggerEnabled","defaultEnabled","_globalThis$localStor4","consoleIgnoreRule","consoleTransport","ConsoleTransport","storage","ROARR_LOG","ignoreRule","sessionId","Math","random","substring","concat","_globalThis$indexedDB","_globalThis$indexedDB2","_globalThis$indexedDB3","_globalThis$indexedDB4","globalName","split","indexedDB","deleteDatabase","TestStorageTransport","messages","logLevelMap","options","saveDB","getLogs","content","downloadLogs","message","_console","namespace","context","level","logLevel","serviceName","data","JSON","parse","push","time","console","loggerV2","useLogger","transports","process","env","NODE_ENV","StorageTransport","integrations","ScriptErrorIntegration","ConsoleIntegration","module","nameKey","warn","getContext","tag"],"sources":["lib/logger/loggerV2.ts"],"sourcesContent":["import {\n  type ITransport,\n  type SerializedMessage,\n  ConsoleIntegration,\n  ConsoleTransport,\n  Logger,\n  ScriptErrorIntegration,\n  StorageTransport,\n  TransportInitOptions,\n  useLogger,\n} from '@ringcentral/mfe-logger';\nimport { type Transport, createTransport, nameKey } from 'reactant-share';\n\nconst isSharedWorker = !!globalThis.SharedWorkerGlobalScope;\ninterface SharedWorkerTransportOptions {\n  /**\n   * enable transport\n   */\n  enabled?: boolean;\n}\n\nexport class SharedWorkerTransport implements ITransport {\n  type = 'storage';\n\n  private transport?: Transport;\n\n  constructor(protected _options: SharedWorkerTransportOptions = {}) {\n    if (isSharedWorker && this._options.enabled) {\n      this.transport = createTransport('SharedWorkerInternal', {\n        prefix: 'logger',\n      });\n    }\n  }\n\n  async init() {\n    //\n  }\n\n  async write({ payload }: SerializedMessage) {\n    this.transport?.emit(\n      {\n        name: 'syncLog',\n        respond: false,\n      },\n      { payload },\n    );\n  }\n}\n\nexport class MemoryStorage {\n  constructor(protected _data: Record<string, any> = {}) {}\n\n  getItem(key: string) {\n    return this._data[key];\n  }\n\n  setItem(key: string, value: unknown) {\n    this._data[key] = value;\n  }\n\n  removeItem(key: string) {\n    delete this._data[key];\n  }\n}\n\nconst toggleKey = 'RC_MFE_LOGGER';\n\nexport const DEFAULT_LOGGER_ENABLED = true;\n\n// if the toggleKey is not set, the logger is enabled by default\nexport const loggerEnabled =\n  globalThis.localStorage?.getItem(toggleKey) === 'true' ||\n  (DEFAULT_LOGGER_ENABLED &&\n    globalThis.SharedWorkerGlobalScope === undefined &&\n    globalThis.localStorage?.getItem(toggleKey) === null);\n\nexport const toggleLogger = (enabled: boolean) => {\n  globalThis.localStorage?.setItem(toggleKey, String(enabled));\n};\n\nexport const checkLoggerEnabled = (defaultEnabled: boolean) => {\n  if (globalThis.localStorage?.getItem(toggleKey) === null) {\n    globalThis.localStorage.setItem(toggleKey, String(defaultEnabled));\n  }\n};\n\n// add ignore rule here\nexport const consoleIgnoreRule = [\n  'ResizeObserver loop completed with undelivered notifications',\n  // !!! Don't add rules lightly unless you explicitly want to ignore the log\n];\n\nconst consoleTransport = new ConsoleTransport({\n  enabled: true,\n  storage: new MemoryStorage({\n    ROARR_LOG: true,\n  }),\n  //@ts-ignore\n  ignoreRule: consoleIgnoreRule,\n});\n\nconst sessionId = Math.random().toString(36).substring(2, 10);\n\nlet name = `root-${sessionId}`;\n\nif (isSharedWorker) {\n  // @ts-ignore\n  const globalName = globalThis.name;\n  const prefix =\n    typeof globalName === 'string' ? globalName.split('#')[0] : 'worker';\n  name = `${prefix || 'worker'}-${sessionId}`;\n\n  // remove indexedDB old database\n  // This is a short-term temporary deletion only to keep the deletion logic clean, and this code is expected to be deleted in Q3 2025.\n  // There is no impact on the deleted db.\n  globalThis.indexedDB?.deleteDatabase?.('rc-mfe-logs');\n  globalThis.indexedDB?.deleteDatabase?.('rc-mfe-log');\n}\n\n/**\n * for test only storage to store logs in memory\n */\nclass TestStorageTransport implements ITransport {\n  type = 'storage';\n\n  _data = {\n    messages: [] as any[],\n  };\n\n  logLevelMap = {\n    20: 'debug',\n    30: 'info',\n    40: 'warn',\n    50: 'error',\n  } as const;\n\n  init = (options: TransportInitOptions) => {};\n  write(message: SerializedMessage): void {\n    const namespace = message.payload.context.namespace as string[];\n    const level = message.payload.context.logLevel as number;\n    const serviceName = namespace[namespace.length - 1];\n\n    const data = JSON.parse(message.payload.message);\n\n    this._data.messages.push({\n      time: message.payload.time,\n      data,\n    });\n\n    // @ts-ignore\n    // eslint-disable-next-line no-console\n    console[this.logLevelMap[level]](`[${serviceName}]`, ...data);\n  }\n  saveDB = () => {};\n  getLogs = () => {\n    return {\n      content: 'mock-content',\n      name: 'applicationLogs',\n    };\n  };\n  downloadLogs = () => {};\n}\n\n/**\n * new logger\n */\n// eslint-disable-next-line react-hooks/rules-of-hooks\nconst loggerV2 = useLogger({\n  name,\n  transports: isSharedWorker\n    ? [\n        consoleTransport,\n        new SharedWorkerTransport({\n          enabled: true,\n        }),\n      ]\n    : [\n        ...(process.env.NODE_ENV === 'test'\n          ? [new TestStorageTransport()]\n          : [\n              consoleTransport,\n              new StorageTransport({\n                enabled: true,\n              }),\n            ]),\n      ],\n  integrations:\n    process.env.NODE_ENV === 'test'\n      ? []\n      : [\n          new ScriptErrorIntegration({\n            enabled: true,\n          }),\n          ...(process.env.NODE_ENV === 'production'\n            ? [\n                new ConsoleIntegration({\n                  enabled: true,\n                }),\n              ]\n            : []),\n        ],\n  enabled: isSharedWorker ? isSharedWorker : loggerEnabled,\n}) as Logger & { create: (module: object) => Logger };\n\nloggerV2.create = (module: object) => {\n  const name = Object.getPrototypeOf(module)[nameKey];\n  if (!name) {\n    if (process.env.NODE_ENV === 'development') {\n      console.warn('Module name not found');\n    }\n    return loggerV2;\n  }\n\n  if (loggerV2['_logger'].getContext().namespace) {\n    return loggerV2.tag(name);\n  }\n  return loggerV2;\n};\n\nexport { loggerV2 };\n"],"mappings":"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","ignoreList":[]}
{"version":3,"file":"handleProxyAction.js","names":["_core","require","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","value","_toPropertyKey","configurable","writable","arg","_toPrimitive","_typeof","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","_objectWithoutProperties","excluded","_objectWithoutPropertiesLoose","sourceSymbolKeys","indexOf","prototype","propertyIsEnumerable","sourceKeys","dropStates","action","_state","params","_inversePatches","actionRest","_usm","usmAction","exports","pushStates","applyPatches","type","_getLastState","_patches","_handleState"],"sources":["lib/proxy/handleProxyAction.ts"],"sourcesContent":["import type { RcModuleV2 } from '@ringcentral-integration/core';\nimport { applyPatches, usmAction } from '@ringcentral-integration/core';\n\nexport const dropStates = (action: any) => {\n  // In `_state`/`params`/`_inversePatches`, there may be a large amount of data that needs to be serialized from server to client.\n  const { _state, params, _inversePatches, ...actionRest } = action;\n  if (action._usm === usmAction) {\n    // drop states for reduction of serialized data\n    return actionRest;\n  }\n  return action;\n};\n\nexport const pushStates = (target: RcModuleV2, action: any) => {\n  if (action._usm === usmAction) {\n    // restore changes states for reduction of serialized data from `patches`\n    const _state = applyPatches(\n      target[action.type]._getLastState(),\n      action._patches,\n    );\n    target[action.type]._handleState(_state);\n    return {\n      ...action,\n      _state,\n    };\n  }\n  return action;\n};\n"],"mappings":"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"}
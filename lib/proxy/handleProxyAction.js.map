{"version":3,"file":"handleProxyAction.js","names":["_core","require","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_toPropertyKey","value","configurable","writable","i","_toPrimitive","_typeof","Symbol","toPrimitive","call","TypeError","String","Number","_objectWithoutProperties","_objectWithoutPropertiesLoose","n","indexOf","propertyIsEnumerable","hasOwnProperty","dropStates","action","_state","params","_inversePatches","actionRest","_usm","usmAction","exports","pushStates","target","applyPatches","type","_getLastState","_patches","_handleState"],"sources":["lib/proxy/handleProxyAction.ts"],"sourcesContent":["import type { RcModuleV2 } from '@ringcentral-integration/core';\nimport { applyPatches, usmAction } from '@ringcentral-integration/core';\n\nexport const dropStates = (action: any) => {\n  // In `_state`/`params`/`_inversePatches`, there may be a large amount of data that needs to be serialized from server to client.\n  const { _state, params, _inversePatches, ...actionRest } = action;\n  if (action._usm === usmAction) {\n    // drop states for reduction of serialized data\n    return actionRest;\n  }\n  return action;\n};\n\nexport const pushStates = (target: RcModuleV2, action: any) => {\n  if (action._usm === usmAction) {\n    // restore changes states for reduction of serialized data from `patches`\n    const _state = applyPatches(\n      // @ts-expect-error TS(7053): Element implicitly has an 'any' type because expre... Remove this comment to see the full error message\n      target[action.type]._getLastState(),\n      action._patches,\n    );\n    // @ts-expect-error TS(7053): Element implicitly has an 'any' type because expre... Remove this comment to see the full error message\n    target[action.type]._handleState(_state);\n    return {\n      ...action,\n      _state,\n    };\n  }\n  return action;\n};\n"],"mappings":";;;;;;;;AACA,IAAAA,KAAA,GAAAC,OAAA;AAAwE,SAAAC,QAAAC,CAAA,EAAAC,CAAA,QAAAC,CAAA,GAAAC,MAAA,CAAAC,IAAA,CAAAJ,CAAA,OAAAG,MAAA,CAAAE,qBAAA,QAAAC,CAAA,GAAAH,MAAA,CAAAE,qBAAA,CAAAL,CAAA,GAAAC,CAAA,KAAAK,CAAA,GAAAA,CAAA,CAAAC,MAAA,WAAAN,CAAA,WAAAE,MAAA,CAAAK,wBAAA,CAAAR,CAAA,EAAAC,CAAA,EAAAQ,UAAA,OAAAP,CAAA,CAAAQ,IAAA,CAAAC,KAAA,CAAAT,CAAA,EAAAI,CAAA,YAAAJ,CAAA;AAAA,SAAAU,cAAAZ,CAAA,aAAAC,CAAA,MAAAA,CAAA,GAAAY,SAAA,CAAAC,MAAA,EAAAb,CAAA,UAAAC,CAAA,WAAAW,SAAA,CAAAZ,CAAA,IAAAY,SAAA,CAAAZ,CAAA,QAAAA,CAAA,OAAAF,OAAA,CAAAI,MAAA,CAAAD,CAAA,OAAAa,OAAA,WAAAd,CAAA,IAAAe,eAAA,CAAAhB,CAAA,EAAAC,CAAA,EAAAC,CAAA,CAAAD,CAAA,SAAAE,MAAA,CAAAc,yBAAA,GAAAd,MAAA,CAAAe,gBAAA,CAAAlB,CAAA,EAAAG,MAAA,CAAAc,yBAAA,CAAAf,CAAA,KAAAH,OAAA,CAAAI,MAAA,CAAAD,CAAA,GAAAa,OAAA,WAAAd,CAAA,IAAAE,MAAA,CAAAgB,cAAA,CAAAnB,CAAA,EAAAC,CAAA,EAAAE,MAAA,CAAAK,wBAAA,CAAAN,CAAA,EAAAD,CAAA,iBAAAD,CAAA;AAAA,SAAAgB,gBAAAhB,CAAA,EAAAC,CAAA,EAAAC,CAAA,YAAAD,CAAA,GAAAmB,cAAA,CAAAnB,CAAA,MAAAD,CAAA,GAAAG,MAAA,CAAAgB,cAAA,CAAAnB,CAAA,EAAAC,CAAA,IAAAoB,KAAA,EAAAnB,CAAA,EAAAO,UAAA,MAAAa,YAAA,MAAAC,QAAA,UAAAvB,CAAA,CAAAC,CAAA,IAAAC,CAAA,EAAAF,CAAA;AAAA,SAAAoB,eAAAlB,CAAA,QAAAsB,CAAA,GAAAC,YAAA,CAAAvB,CAAA,gCAAAwB,OAAA,CAAAF,CAAA,IAAAA,CAAA,GAAAA,CAAA;AAAA,SAAAC,aAAAvB,CAAA,EAAAD,CAAA,oBAAAyB,OAAA,CAAAxB,CAAA,MAAAA,CAAA,SAAAA,CAAA,MAAAF,CAAA,GAAAE,CAAA,CAAAyB,MAAA,CAAAC,WAAA,kBAAA5B,CAAA,QAAAwB,CAAA,GAAAxB,CAAA,CAAA6B,IAAA,CAAA3B,CAAA,EAAAD,CAAA,gCAAAyB,OAAA,CAAAF,CAAA,UAAAA,CAAA,YAAAM,SAAA,yEAAA7B,CAAA,GAAA8B,MAAA,GAAAC,MAAA,EAAA9B,CAAA;AAAA,SAAA+B,yBAAAjC,CAAA,EAAAE,CAAA,gBAAAF,CAAA,iBAAAM,CAAA,EAAAL,CAAA,EAAAuB,CAAA,GAAAU,6BAAA,CAAAlC,CAAA,EAAAE,CAAA,OAAAC,MAAA,CAAAE,qBAAA,QAAA8B,CAAA,GAAAhC,MAAA,CAAAE,qBAAA,CAAAL,CAAA,QAAAC,CAAA,MAAAA,CAAA,GAAAkC,CAAA,CAAArB,MAAA,EAAAb,CAAA,MAAAK,CAAA,GAAA6B,CAAA,CAAAlC,CAAA,UAAAC,CAAA,CAAAkC,OAAA,CAAA9B,CAAA,QAAA+B,oBAAA,CAAAR,IAAA,CAAA7B,CAAA,EAAAM,CAAA,MAAAkB,CAAA,CAAAlB,CAAA,IAAAN,CAAA,CAAAM,CAAA,eAAAkB,CAAA;AAAA,SAAAU,8BAAAjC,CAAA,EAAAD,CAAA,gBAAAC,CAAA,iBAAAC,CAAA,gBAAAiC,CAAA,IAAAlC,CAAA,WAAAqC,cAAA,CAAAT,IAAA,CAAA5B,CAAA,EAAAkC,CAAA,gBAAAnC,CAAA,CAAAoC,OAAA,CAAAD,CAAA,aAAAjC,CAAA,CAAAiC,CAAA,IAAAlC,CAAA,CAAAkC,CAAA,cAAAjC,CAAA;AAEjE,IAAMqC,UAAU,GAAG,SAAbA,UAAUA,CAAIC,MAAW,EAAK;EACzC;EAAA,IACQC,MAAM,GAA6CD,MAAM,CAAzDC,MAAM;IAAEC,MAAM,GAAqCF,MAAM,CAAjDE,MAAM;IAAEC,eAAe,GAAoBH,MAAM,CAAzCG,eAAe;IAAKC,UAAU,GAAAX,wBAAA,CAAKO,MAAM;EACjE,IAAIA,MAAM,CAACK,IAAI,KAAKC,eAAS,EAAE;IAC7B;IACA,OAAOF,UAAU;EACnB;EACA,OAAOJ,MAAM;AACf,CAAC;AAACO,OAAA,CAAAR,UAAA,GAAAA,UAAA;AAEK,IAAMS,UAAU,GAAG,SAAbA,UAAUA,CAAIC,MAAkB,EAAET,MAAW,EAAK;EAC7D,IAAIA,MAAM,CAACK,IAAI,KAAKC,eAAS,EAAE;IAC7B;IACA,IAAML,MAAM,GAAG,IAAAS,kBAAY;IACzB;IACAD,MAAM,CAACT,MAAM,CAACW,IAAI,CAAC,CAACC,aAAa,CAAC,CAAC,EACnCZ,MAAM,CAACa,QACT,CAAC;IACD;IACAJ,MAAM,CAACT,MAAM,CAACW,IAAI,CAAC,CAACG,YAAY,CAACb,MAAM,CAAC;IACxC,OAAA7B,aAAA,CAAAA,aAAA,KACK4B,MAAM;MACTC,MAAM,EAANA;IAAM;EAEV;EACA,OAAOD,MAAM;AACf,CAAC;AAACO,OAAA,CAAAC,UAAA,GAAAA,UAAA","ignoreList":[]}
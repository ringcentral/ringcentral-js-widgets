{"version":3,"sources":["lib/chunkMessage.js"],"names":["chunkMessage","text","maxLength","Error","chunks","currentIndex","total","length","newIndex","offset","char","charAt","isWhiteSpace","test","snippet","substring","push"],"mappings":";;;;;kBAMwBA,Y;AANxB;;;;;;AAMe,SAASA,YAAT,CAAsBC,IAAtB,EAA4BC,SAA5B,EAAuC;AACpD,MAAI,CAACD,IAAL,EAAW;AACT,WAAO,EAAP;AACD;;AAED,MAAI,OAAQC,SAAR,KAAuB,QAA3B,EAAqC;AACnC,UAAM,IAAIC,KAAJ,CAAU,iCAAV,CAAN;AACD;;AAED,MAAID,YAAY,CAAhB,EAAmB;AACjB,UAAM,IAAIC,KAAJ,CAAU,mCAAV,CAAN;AACD;;AAED,MAAMC,SAAS,EAAf;AACA,MAAIC,eAAe,CAAnB;AACA,MAAMC,QAAQL,KAAKM,MAAnB;;AAEA,SAAOF,eAAeC,KAAtB,EAA6B;AAC3B,QAAIE,WAAWH,eAAeH,SAA9B;AACA,QAAIO,SAAS,CAAb;AACA,WAAOA,SAASP,SAAhB,EAA2BO,UAAU,CAArC,EAAwC;AACtC,UAAMC,OAAOT,KAAKU,MAAL,CAAYH,WAAWC,MAAvB,CAAb;AACA,UAAI,CAACC,IAAL,EAAW;AACT;AACD;AACD,UAAME,eAAe,KAAKC,IAAL,CAAUH,IAAV,CAArB;AACA,UAAIE,YAAJ,EAAkB;AAChBH,kBAAU,CAAV;AACA;AACD;AACF;AACD,QAAIA,WAAWP,SAAf,EAA0B;AACxBM,kBAAYC,MAAZ;AACD;AACD,QAAMK,UAAUb,KAAKc,SAAL,CAAeV,YAAf,EAA6BG,QAA7B,CAAhB;AACAH,mBAAeG,QAAf;AACAJ,WAAOY,IAAP,CAAYF,OAAZ;AACD;;AAED,SAAOV,MAAP;AACD","file":"chunkMessage.js","sourcesContent":["/**\n * this module seems better\n * https://www.npmjs.com/package/chunk-text\n * use our own implementation for now.\n */\n\nexport default function chunkMessage(text, maxLength) {\n  if (!text) {\n    return [];\n  }\n\n  if (typeof (maxLength) !== 'number') {\n    throw new Error('Should be a integer \"maxLength\"');\n  }\n\n  if (maxLength < 1) {\n    throw new Error('Should greater than 0 \"maxLength\"');\n  }\n\n  const chunks = [];\n  let currentIndex = 0;\n  const total = text.length;\n\n  while (currentIndex < total) {\n    let newIndex = currentIndex + maxLength;\n    let offset = 0;\n    for (; offset < maxLength; offset += 1) {\n      const char = text.charAt(newIndex - offset);\n      if (!char) {\n        break;\n      }\n      const isWhiteSpace = /\\s/.test(char);\n      if (isWhiteSpace) {\n        offset -= 1;\n        break;\n      }\n    }\n    if (offset !== maxLength) {\n      newIndex -= offset;\n    }\n    const snippet = text.substring(currentIndex, newIndex);\n    currentIndex = newIndex;\n    chunks.push(snippet);\n  }\n\n  return chunks;\n}\n"]}
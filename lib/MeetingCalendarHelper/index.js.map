{"version":3,"sources":["lib/MeetingCalendarHelper/index.ts"],"names":["formatSmartphones","dialInNumber","pinNumber","showMeetingPasswordPSTN","meetingPasswordPSTN","length","map","obj","passwordField","locationField","country","name","location","phoneNumber","join","formatDialInNumber","getPasswordTpl","meetingPassword","currentLocale","passwordLiteral","i18n","getString","replaceTextLinksToAnchors","input","pattern","replace","$0","htmlNewLine","htmlIndentation","htmlTabIndentation","repeat","formatTextToHtml","plantText","options","links","uselessSentences","searchLinks","newLine","indentation","tabIndentation","htmlContent","split","line","forEach","sentence","link","isPlantLink","uri","text","getRcvPstnPasswordTpl","passwordPstnLiteral","getBaseRcmTpl","brand","meeting","serviceInfo","extensionInfo","invitationInfo","accountName","meetingId","id","joinUri","password","mobileDialingNumberTpl","phoneDialingNumberTpl","passwordTpl","teleconference","brandConfig","formattedMsg","invitation","brandName","getRcmEventTpl","mainInfo","tplResult","getRcmHtmlEventTpl","formatDialInSection","isMeetingSecret","shortId","dialingString","dialingInfo","smartphones","dialNumber","pstnPasswordTpl","getRcvDialInInfo","rcvTeleconference","args","hasDialInNumber","dialInSection","teleconferenceInfo","getBaseRcvTpl","enableRcvConnector","enableE2EE","e2ee","meetingContent","push","rcvProductName","e2EESupportLinkText","rcvE2EESupportUrl","rcvInviteMeetingContent","rcvSipContent","rcvBrandName","getRcvEventTpl","getRcvHtmlEventTpl","getMeetingId","meetingUri","rcvUriRegExp","rcmUriRegExp","regs","i","matches","exec","match0","indexOf","substring","stripMeetingLinks","result","reg","test","meetingLinkContains","hasRCM","hasRCV"],"mappings":"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","sourcesContent":["import formatMessage from 'format-message';\n\nimport { RcVDialInNumberObj } from '@ringcentral-integration/commons/interfaces/Rcv.model';\n\nimport { formatMeetingId } from './formatMeetingId';\nimport i18n from './i18n';\nimport {\n  CommonBrand,\n  DialInSectionParams,\n  FormatToHtmlOptions,\n  ParcelledLink,\n  RcmMainParams,\n  RcvMainParams,\n  TplResult,\n} from './index.interface';\n\nfunction formatSmartphones(\n  dialInNumber: string | RcVDialInNumberObj[],\n  pinNumber: string,\n  showMeetingPasswordPSTN: boolean,\n  meetingPasswordPSTN: string,\n) {\n  if (!dialInNumber || dialInNumber.length === 0) {\n    return '';\n  }\n\n  if (typeof dialInNumber === 'string') {\n    return `${dialInNumber},,${pinNumber}#${\n      showMeetingPasswordPSTN ? `,,${meetingPasswordPSTN}#` : ''\n    }`;\n  }\n  return dialInNumber\n    .map((obj) => {\n      const passwordField = showMeetingPasswordPSTN\n        ? `,,${meetingPasswordPSTN}#`\n        : '';\n\n      const locationField =\n        obj?.country?.name && obj.location\n          ? `${obj.country.name} (${obj.location})`\n          : obj?.country?.name || '';\n\n      return `${obj.phoneNumber},,${pinNumber}#${passwordField} ${locationField}`;\n    })\n    .join('\\n\\t');\n}\n\nfunction formatDialInNumber(dialInNumber: string | RcVDialInNumberObj[]) {\n  if (!dialInNumber || dialInNumber.length === 0) {\n    return '';\n  }\n\n  if (typeof dialInNumber === 'string') {\n    return dialInNumber;\n  }\n\n  return dialInNumber\n    .map((obj) => {\n      const locationField =\n        obj?.country?.name && obj.location\n          ? `${obj.country.name} (${obj.location})`\n          : obj?.country?.name || '';\n\n      return `${obj.phoneNumber} ${locationField}`;\n    })\n    .join('\\n\\t');\n}\n\nfunction getPasswordTpl(\n  meetingPassword: string,\n  currentLocale: string,\n): string {\n  const passwordLiteral = i18n.getString('password', currentLocale);\n  return meetingPassword ? `${passwordLiteral}: ${meetingPassword}` : '';\n}\n\n/**\n * replace all text link into anchor link\n * Should match: http://www.example.com\n * Should not match: <a href=\"http://www.example.com\">http://www.example.com </a>\n * Then replace it into <a href=\"http://www.example.com\">http://www.example.com </a>\n * @param input\n */\nfunction replaceTextLinksToAnchors(input: string): string {\n  /**\n   * [^<>\\]]+ means should match any characters except < or > or ]\n   * (?!\\s*<\\/a>) means url should not be followed by either \"</a>\" or \"     </a>\"\n   * (?!\"[^>]*>) means url should not followed by \">\n   * further explanation: origin string: <a href=\"http://www.example.com\">http://www.example.com </a> should not match\n   * (?=[\\s!,?\\]]|$) means url can be followed by punctuations or whitespace or nothing\n   */\n  // https://stackoverflow.com/questions/19060460/url-replace-with-anchor-not-replacing-existing-anchors\n\n  const pattern: RegExp =\n    /(?:(?:ht|f)tps?:\\/\\/|www)[^<>\\]]+(?!\\s*<\\/a>)(?!\"[^>]*>)(?=[\\s!,?\\]<]|$)/gim;\n\n  return input.replace(pattern, ($0: string): string => {\n    return `<a target=\"_blank\" href=\"${$0}\">${$0}</a>`;\n  });\n}\n\nconst htmlNewLine: string = '<br>';\nconst htmlIndentation: string = '&nbsp;';\nconst htmlTabIndentation: string = htmlIndentation.repeat(4);\n\nfunction formatTextToHtml(\n  plantText: string,\n  options: FormatToHtmlOptions = {},\n): string {\n  const {\n    links = [],\n    uselessSentences = [],\n    searchLinks = false,\n    newLine = htmlNewLine,\n    indentation = htmlIndentation,\n    tabIndentation = htmlTabIndentation,\n  } = options;\n\n  let htmlContent = plantText\n    .replace(/\\r\\n|\\n|\\r/g, '\\n') // formalize newline\n    .split('\\n') // split with formalized newline\n    .map((line) => {\n      return line\n        .replace(/\\t/g, tabIndentation) // replace all Tab with 4 indentations\n        .replace(/^\\s*/, ($0) => indentation.repeat($0.length)); // replace leading white spaces with indentations\n    })\n    .join(newLine);\n\n  uselessSentences.forEach((sentence) => {\n    if (sentence) {\n      htmlContent = htmlContent.replace(sentence, '');\n    }\n  });\n\n  links.forEach((link) => {\n    if (link) {\n      const isPlantLink = typeof link === 'string';\n      const uri = isPlantLink ? (link as string) : (link as ParcelledLink).uri;\n      const text = isPlantLink\n        ? (link as string)\n        : (link as ParcelledLink).text;\n\n      if (uri && text) {\n        htmlContent = htmlContent.replace(\n          uri,\n          `<a target=\"_blank\" href=\"${uri}\">${text}</a>`,\n        );\n      }\n    }\n  });\n\n  if (searchLinks) {\n    htmlContent = replaceTextLinksToAnchors(htmlContent);\n  }\n\n  return htmlContent;\n}\n\n/**\n * Dial-in password: ${passwordPstn}\n */\nfunction getRcvPstnPasswordTpl(\n  meetingPasswordPSTN: string,\n  currentLocale: string,\n): string {\n  const passwordPstnLiteral = i18n.getString('passwordPstn', currentLocale);\n  return `${passwordPstnLiteral} ${meetingPasswordPSTN}`;\n}\n\nfunction getBaseRcmTpl(\n  { meeting, serviceInfo, extensionInfo, invitationInfo }: RcmMainParams,\n  brand: CommonBrand,\n  currentLocale: string,\n): TplResult {\n  const accountName = extensionInfo.name;\n  const meetingId = meeting.id;\n  const joinUri = meeting.links.joinUri;\n  const password = meeting.password;\n\n  const mobileDialingNumberTpl = serviceInfo.mobileDialingNumberTpl;\n  const phoneDialingNumberTpl = serviceInfo.phoneDialingNumberTpl;\n  const passwordTpl = getPasswordTpl(password, currentLocale);\n  const teleconference = brand.brandConfig.teleconference;\n\n  let formattedMsg = invitationInfo?.invitation;\n  if (!formattedMsg) {\n    formattedMsg = formatMessage(\n      i18n.getString('inviteMeetingContent', currentLocale),\n      {\n        accountName,\n        brandName: brand.name,\n        joinUri,\n        passwordTpl,\n        mobileDialingNumberTpl,\n        phoneDialingNumberTpl,\n        meetingId: formatMeetingId(meetingId),\n        teleconference,\n      },\n    );\n  }\n\n  return {\n    formattedMsg,\n    links: {\n      joinUri,\n      teleconference,\n    },\n  };\n}\n\nfunction getRcmEventTpl(\n  mainInfo: RcmMainParams,\n  brand: CommonBrand,\n  currentLocale: string,\n): string {\n  const tplResult = getBaseRcmTpl(mainInfo, brand, currentLocale);\n  return tplResult.formattedMsg;\n}\n\nfunction getRcmHtmlEventTpl(\n  mainInfo: RcmMainParams,\n  brand: CommonBrand,\n  currentLocale: string,\n): string {\n  const tplResult = getBaseRcmTpl(mainInfo, brand, currentLocale);\n  return formatTextToHtml(tplResult.formattedMsg, {\n    links: [tplResult.links.joinUri, tplResult.links.teleconference],\n  });\n}\n\n/* Outcome example:\nOne tap to join audio only from a smartphone:\n  +16504191505,,977988816#,,3893596796# United States (San Mateo, CA)\n\nOr dial:\n    +1 (650) 4191505 United States (San Mateo, CA)\n    Access Code / Meeting ID: 977988816\n\nDial-in password: 3893596796\n */\nfunction formatDialInSection({\n  dialInNumber,\n  isMeetingSecret,\n  meetingPasswordPSTN,\n  shortId,\n  currentLocale,\n}: DialInSectionParams) {\n  /* TODO: after get the translation, remove rcvInviteMeetingContentDial\n   * rcvInviteMeetingContentCountryDial is the correct one\n   */\n  const dialingString = i18n.getString(\n    typeof dialInNumber === 'string'\n      ? 'rcvInviteMeetingContentDial'\n      : 'rcvInviteMeetingContentCountryDial',\n    currentLocale,\n  );\n  const showMeetingPasswordPSTN = !!(isMeetingSecret && meetingPasswordPSTN);\n  const dialingInfo = formatMessage(dialingString, {\n    smartphones: formatSmartphones(\n      dialInNumber,\n      shortId,\n      showMeetingPasswordPSTN,\n      meetingPasswordPSTN,\n    ),\n    dialNumber: formatDialInNumber(dialInNumber),\n    pinNumber: formatMeetingId(shortId),\n  });\n  const pstnPasswordTpl = !showMeetingPasswordPSTN\n    ? ''\n    : getRcvPstnPasswordTpl(meetingPasswordPSTN, currentLocale);\n  return `${dialingInfo}${pstnPasswordTpl}`;\n}\n\n// RCINT-22191 hotfix\n// The feature need us to extract just the dial-in and teleconference section\n// Although the logic is OK for common usage, the requirement is specific\n// There is no any evidence that the other projects will need this\n// Therefore, this is reserved for the calendar-update-tool project\nfunction getRcvDialInInfo({\n  rcvTeleconference,\n  ...args\n}: DialInSectionParams & { rcvTeleconference: string }) {\n  const hasDialInNumber = args?.dialInNumber?.length > 0;\n  const dialInSection = hasDialInNumber ? formatDialInSection(args) : '';\n  const teleconferenceInfo = formatMessage(\n    i18n.getString('rcvTeleconference', args.currentLocale),\n    {\n      teleconference: rcvTeleconference,\n    },\n  );\n  return `${dialInSection}${teleconferenceInfo}`;\n}\n\nfunction getBaseRcvTpl(\n  { meeting, extensionInfo, dialInNumber, invitationInfo }: RcvMainParams,\n  brand: CommonBrand,\n  currentLocale: string,\n  enableRcvConnector = false,\n  enableE2EE = false,\n): TplResult {\n  const joinUri = meeting.joinUri;\n  const teleconference = brand.rcvTeleconference;\n  if (invitationInfo) {\n    return {\n      formattedMsg: invitationInfo,\n      links: {\n        joinUri,\n        teleconference,\n      },\n    };\n  }\n\n  const accountName = extensionInfo.name;\n  const { meetingPassword, meetingPasswordPSTN, isMeetingSecret, e2ee } =\n    meeting;\n  const meetingContent: Array<string> = [];\n  const showMeetingPasswordPSTN = !!(isMeetingSecret && meetingPasswordPSTN);\n\n  if (enableE2EE && e2ee) {\n    meetingContent.push(\n      i18n.getString('rcvE2EEInviteMeetingContent', currentLocale),\n    );\n    return {\n      formattedMsg: formatMessage(meetingContent.join(''), {\n        accountName,\n        brandName: brand.name,\n        rcvProductName: brand.brandConfig.rcvProductName,\n        joinUri,\n        e2EESupportLinkText: formatMessage(\n          i18n.getString('e2EESupportLinkText', currentLocale),\n          {\n            brandName: brand.name,\n          },\n        ),\n        rcvE2EESupportUrl: brand.rcvE2EESupportUrl,\n      }),\n      links: {\n        joinUri,\n        teleconference,\n      },\n    };\n  }\n\n  meetingContent.push(brand.brandConfig.rcvInviteMeetingContent as string);\n\n  if (dialInNumber && dialInNumber.length > 0) {\n    /* TODO: after get the translation, remove rcvInviteMeetingContentDial\n     * rcvInviteMeetingContentCountryDial is the correct one\n     */\n    meetingContent.push(\n      i18n.getString(\n        typeof dialInNumber === 'string'\n          ? 'rcvInviteMeetingContentDial'\n          : 'rcvInviteMeetingContentCountryDial',\n        currentLocale,\n      ),\n    );\n    if (showMeetingPasswordPSTN) {\n      meetingContent.push(\n        getRcvPstnPasswordTpl(meetingPasswordPSTN, currentLocale),\n      );\n    }\n  }\n  meetingContent.push(`${i18n.getString('rcvTeleconference', currentLocale)}`);\n  const passwordTpl = isMeetingSecret\n    ? getPasswordTpl(meetingPassword, currentLocale)\n    : '';\n\n  if (enableRcvConnector) {\n    meetingContent.push(`${i18n.getString('rcvSipHeader', currentLocale)}`);\n    const rcvSipContent = isMeetingSecret\n      ? 'rcvSipContentWithPwd'\n      : 'rcvSipContentNoPwd';\n    meetingContent.push(`${i18n.getString(rcvSipContent, currentLocale)}`);\n  }\n\n  const shortId = meeting.shortId;\n\n  const formattedMsg = formatMessage(meetingContent.join(''), {\n    accountName,\n    brandName: brand.brandConfig.rcvBrandName ?? brand.name,\n    joinUri,\n    passwordTpl,\n    meetingPasswordPSTN,\n    meetingId: shortId,\n    pinNumber: formatMeetingId(shortId),\n    teleconference,\n    dialNumber: formatDialInNumber(dialInNumber),\n    smartphones: formatSmartphones(\n      dialInNumber,\n      shortId,\n      showMeetingPasswordPSTN,\n      meetingPasswordPSTN,\n    ),\n    rcvProductName: brand.brandConfig.rcvProductName,\n  });\n\n  return {\n    formattedMsg,\n    links: {\n      joinUri,\n      teleconference,\n    },\n  };\n}\n\nfunction getRcvEventTpl(\n  mainInfo: RcvMainParams,\n  brand: CommonBrand,\n  currentLocale: string,\n  enableRcvConnector = false,\n  enableE2EE = false,\n): string {\n  const tplResult = getBaseRcvTpl(\n    mainInfo,\n    brand,\n    currentLocale,\n    enableRcvConnector,\n    enableE2EE,\n  );\n  return tplResult.formattedMsg;\n}\n\nfunction getRcvHtmlEventTpl(\n  mainInfo: RcvMainParams,\n  brand: CommonBrand,\n  currentLocale: string,\n  enableRcvConnector = false,\n  enableE2EE = false,\n): string {\n  const tplResult = getBaseRcvTpl(\n    mainInfo,\n    brand,\n    currentLocale,\n    enableRcvConnector,\n    enableE2EE,\n  );\n\n  const links: [string, string, ParcelledLink] = [\n    tplResult.links.joinUri,\n    tplResult.links.teleconference,\n    {\n      uri: brand.rcvE2EESupportUrl,\n      text: formatMessage(\n        i18n.getString('e2EESupportLinkText', currentLocale),\n        {\n          brandName: brand.name,\n        },\n      ),\n    },\n  ];\n\n  return formatTextToHtml(tplResult.formattedMsg, {\n    uselessSentences: [\n      `${formatMessage(i18n.getString('e2EESupportLinkText', currentLocale), {\n        brandName: brand.name,\n      })}<br>`,\n    ],\n    links,\n  });\n}\n\nfunction getMeetingId(\n  meetingUri: string,\n  rcvUriRegExp: RegExp,\n  rcmUriRegExp: RegExp,\n): string {\n  if (meetingUri) {\n    const regs = [rcmUriRegExp, rcvUriRegExp];\n    for (let i = 0; i < regs.length; i += 1) {\n      const matches = regs[i].exec(meetingUri);\n      if (matches && matches.length > 0) {\n        const match0 = matches[0];\n        const link = (\n          match0.indexOf('?') > -1\n            ? matches[0].substring(0, matches[0].indexOf('?'))\n            : match0\n        ).split('/');\n\n        const id = link[link.length - 1];\n        return id;\n      }\n    }\n  }\n\n  return null;\n}\n\nfunction stripMeetingLinks(\n  text: string,\n  rcvUriRegExp: RegExp,\n  rcmUriRegExp: RegExp,\n): string {\n  let result = text;\n  [rcmUriRegExp, rcvUriRegExp].forEach((reg) => {\n    while (reg.test(result)) {\n      result = result.replace(reg, '');\n    }\n  });\n  return result;\n}\n\nfunction meetingLinkContains(\n  rcvUriRegExp: RegExp,\n  rcmUriRegExp: RegExp,\n  text?: string,\n): { hasRCM: boolean; hasRCV: boolean } {\n  return {\n    hasRCM: rcmUriRegExp.test(text ?? ''),\n    hasRCV: rcvUriRegExp.test(text ?? ''),\n  };\n}\n\nexport {\n  getBaseRcvTpl,\n  formatMeetingId,\n  formatTextToHtml,\n  getMeetingId,\n  getRcmEventTpl,\n  getRcmHtmlEventTpl,\n  getRcvDialInInfo,\n  getRcvEventTpl,\n  getRcvHtmlEventTpl,\n  htmlIndentation,\n  htmlNewLine,\n  htmlTabIndentation,\n  meetingLinkContains,\n  replaceTextLinksToAnchors,\n  stripMeetingLinks,\n};\n"],"file":"index.js"}
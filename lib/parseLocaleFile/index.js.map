{"version":3,"file":"index.js","names":["parseLocaleFile","rawContent","data","Map","extractAnnotations","content","annotations","ast","parse","sourceType","defaultExport","find","item","type","program","body","declaration","forEach","prop","key","substring","start","end","value","eval","generate","code","source","get","set","properties"],"sources":["lib/parseLocaleFile/index.js"],"sourcesContent":["import { find, forEach } from 'ramda';\nimport { parse } from '@babel/parser';\nimport generate from '@babel/generator';\nimport extractAnnotations from '../extractAnnotations';\n\n/* eslint { no-eval: 0 } */\nexport default function parseLocaleFile(rawContent) {\n  const data = new Map();\n  const { content, annotations } = extractAnnotations(rawContent);\n  const ast = parse(content, { sourceType: 'module' });\n\n  const defaultExport = find(\n    (item) => item.type === 'ExportDefaultDeclaration',\n    ast.program.body,\n  );\n  if (defaultExport && defaultExport.declaration.type === 'ObjectExpression') {\n    forEach((prop) => {\n      // get raw key from source content\n      let key = content.substring(prop.key.start, prop.key.end);\n      // wrap key in [] if needed\n      if (\n        prop.key.type !== 'StringLiteral' &&\n        prop.key.type !== 'Identifier' &&\n        prop.key.type !== 'NumericLiteral'\n      ) {\n        key = `[${key}]`;\n      }\n      // evaluate value to convert template literals or string concats into single string literal\n      const value = eval(generate(prop.value).code);\n      const source = annotations.get(key);\n\n      data.set(key, {\n        key,\n        value,\n        source,\n      });\n    }, defaultExport.declaration.properties);\n  }\n\n  return {\n    content,\n    annotations,\n    ast,\n    data,\n  };\n}\n"],"mappings":";;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;;;AAEA;AACe,SAASA,eAAT,CAAyBC,UAAzB,EAAqC;EAClD,IAAMC,IAAI,GAAG,IAAIC,GAAJ,EAAb;;EADkD,0BAEjB,IAAAC,+BAAA,EAAmBH,UAAnB,CAFiB;EAAA,IAE1CI,OAF0C,uBAE1CA,OAF0C;EAAA,IAEjCC,WAFiC,uBAEjCA,WAFiC;;EAGlD,IAAMC,GAAG,GAAG,IAAAC,aAAA,EAAMH,OAAN,EAAe;IAAEI,UAAU,EAAE;EAAd,CAAf,CAAZ;EAEA,IAAMC,aAAa,GAAG,IAAAC,WAAA,EACpB,UAACC,IAAD;IAAA,OAAUA,IAAI,CAACC,IAAL,KAAc,0BAAxB;EAAA,CADoB,EAEpBN,GAAG,CAACO,OAAJ,CAAYC,IAFQ,CAAtB;;EAIA,IAAIL,aAAa,IAAIA,aAAa,CAACM,WAAd,CAA0BH,IAA1B,KAAmC,kBAAxD,EAA4E;IAC1E,IAAAI,cAAA,EAAQ,UAACC,IAAD,EAAU;MAChB;MACA,IAAIC,GAAG,GAAGd,OAAO,CAACe,SAAR,CAAkBF,IAAI,CAACC,GAAL,CAASE,KAA3B,EAAkCH,IAAI,CAACC,GAAL,CAASG,GAA3C,CAAV,CAFgB,CAGhB;;MACA,IACEJ,IAAI,CAACC,GAAL,CAASN,IAAT,KAAkB,eAAlB,IACAK,IAAI,CAACC,GAAL,CAASN,IAAT,KAAkB,YADlB,IAEAK,IAAI,CAACC,GAAL,CAASN,IAAT,KAAkB,gBAHpB,EAIE;QACAM,GAAG,cAAOA,GAAP,MAAH;MACD,CAVe,CAWhB;;;MACA,IAAMI,KAAK,GAAGC,IAAI,CAAC,IAAAC,qBAAA,EAASP,IAAI,CAACK,KAAd,EAAqBG,IAAtB,CAAlB;MACA,IAAMC,MAAM,GAAGrB,WAAW,CAACsB,GAAZ,CAAgBT,GAAhB,CAAf;MAEAjB,IAAI,CAAC2B,GAAL,CAASV,GAAT,EAAc;QACZA,GAAG,EAAHA,GADY;QAEZI,KAAK,EAALA,KAFY;QAGZI,MAAM,EAANA;MAHY,CAAd;IAKD,CApBD,EAoBGjB,aAAa,CAACM,WAAd,CAA0Bc,UApB7B;EAqBD;;EAED,OAAO;IACLzB,OAAO,EAAPA,OADK;IAELC,WAAW,EAAXA,WAFK;IAGLC,GAAG,EAAHA,GAHK;IAILL,IAAI,EAAJA;EAJK,CAAP;AAMD"}
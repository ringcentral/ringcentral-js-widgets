{"version":3,"file":"RcModule.js","names":["_redux","require","_usmRedux","_class","_descriptor","_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","_unsupportedIterableToArray","length","i","F","s","n","done","value","e","_e","f","TypeError","normalCompletion","didErr","err","call","step","next","_e2","minLen","_arrayLikeToArray","Object","prototype","toString","slice","constructor","name","from","test","arr","len","arr2","_defineProperty","obj","key","_toPropertyKey","defineProperty","enumerable","configurable","writable","asyncGeneratorStep","gen","resolve","reject","_next","_throw","arg","info","error","Promise","then","_asyncToGenerator","fn","self","args","arguments","apply","undefined","_initializerDefineProperty","target","property","descriptor","context","initializer","_objectWithoutProperties","source","excluded","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","indexOf","propertyIsEnumerable","sourceKeys","keys","_classCallCheck","instance","Constructor","_defineProperties","props","_createClass","protoProps","staticProps","_toPrimitive","_typeof","String","input","hint","prim","toPrimitive","res","Number","_applyDecoratedDescriptor","decorators","desc","forEach","reverse","reduce","decorator","_initializerWarningHelper","Error","setAutoFreeze","setPatchesToggle","process","env","DISABLE_PATCHES","enablePatches","ModuleStatus","exports","onceKey","onInitOnceKey","notReadyModulesKey","checkStatusChangeKey","enableCacheKey","enableGlobalCacheKey","storageKey","storageStateKey","globalStorageStateKey","spawnReducersKey","spawnStorageReducersKey","ignoreReadyModulesKey","RcModuleV2","_ref2","_this","_ref","deps","_ref$enableCache","enableCache","_ref$enableGlobalCach","enableGlobalCache","options","_transport","Set","_deps","_modulePath","_initialized","_suppressInit","_reducers","_getStateV2","state","subscribe","onStateChange","storage","stateKey","globalStorage","_setStatus","status","_value","regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","onInitOnce","stop","_value2","_callee2","_callee2$","_context2","_shouldInit","Initializing","onInit","Ready","onInitSuccess","_shouldReset","Resetting","onReset","Pending","_ignoreModuleReadiness","dep","add","_getLastState","_this$_deps$storage","_this2","_this$_deps$globalSto","lastState","__state","storeKey","getState","identifierKey","__identifier","data","storageReducerKey","concat","_handleState","assign","areAllReady","pending","areNotReady","ready","_depsCheck","_this$_deps","checkedModules","pickedModules","values","module","_module$_deps","notReadyModules","filter","item","includes","push","_changeState","callback","_this3","descriptors","getOwnPropertyDescriptor","initialState","registerReducer","reducer","action","_usm","usmAction","type","hasOwnProperty","_state","get","stagedState","getStagedState","set","defineProperties","_setStore","_initModule","_this$stateKey","_this4","_this$storeKey","serviceReducersMapObject","stateDescriptor","_initModule2","_callee3","_this$subscriptionsKe","_iterator","_step","_subscribe","subModule","subRcModule","_callee3$","_context3","parentModule","subscriptionsKey","addModule","modulePath","actionTypes","_this5","modules","has","store","combineReducers"],"sources":["lib/RcModule/RcModule.ts"],"sourcesContent":["import type { Reducer, ReducersMapObject } from 'redux';\nimport { combineReducers } from 'redux';\nimport type { Action, Service, Store, Subscription } from '../usm-redux';\nimport {\n  action,\n  applyPatches,\n  computed,\n  createStore,\n  enableES5,\n  enablePatches,\n  getStagedState,\n  identifierKey,\n  setAutoFreeze,\n  setPatchesToggle,\n  state,\n  stateKey,\n  storeKey,\n  subscribe,\n  subscriptionsKey,\n  usm as usmAction,\n  watch,\n} from '../usm-redux';\n\nsetAutoFreeze(false);\n\nsetPatchesToggle(!process.env.DISABLE_PATCHES);\nif (!process.env.DISABLE_PATCHES) {\n  enablePatches();\n}\n\nexport const enum ModuleStatus {\n  Pending = 'PENDING',\n  Initializing = 'INITIALIZING',\n  Ready = 'READY',\n  Resetting = 'RESETTING',\n}\n\nexport const onceKey: unique symbol = Symbol('once');\nexport const onInitOnceKey: unique symbol = Symbol('onInitOnce');\nexport const notReadyModulesKey: unique symbol = Symbol('notReadyModules');\nexport const checkStatusChangeKey: unique symbol = Symbol('checkStatusChange');\nexport const enableCacheKey: unique symbol = Symbol('enableCache');\nexport const enableGlobalCacheKey: unique symbol = Symbol('enableGlobalCache');\nexport const storageKey: unique symbol = Symbol('storage');\nexport const storageStateKey: unique symbol = Symbol('storageState');\nexport const globalStorageStateKey: unique symbol =\n  Symbol('globalStorageState');\nexport const spawnReducersKey: unique symbol = Symbol('spawnReducers');\nexport const spawnStorageReducersKey: unique symbol = Symbol(\n  'spawnStorageReducers',\n);\nexport const ignoreReadyModulesKey: unique symbol =\n  Symbol('ignoreReadyModules');\n\nexport interface RcModuleOptions<T> {\n  deps?: T & {\n    storage?: any;\n    globalStorage?: any;\n  };\n  enableCache?: boolean;\n  enableGlobalCache?: boolean;\n  storageKey?: string;\n}\n\ninterface RcModuleV2 {\n  parentModule: RcModuleV2;\n  [storageStateKey]: string[];\n  [globalStorageStateKey]: string[];\n  [stateKey]: Record<string, any>;\n  [identifierKey]: string;\n  [subscriptionsKey]: Subscription[];\n  [storeKey]: Store;\n}\n\ninterface IStorage extends RcModuleV2 {\n  registerReducer(options: {\n    key: string;\n    reducer: Reducer<any, Action>;\n  }): void;\n  data: Record<string, any>;\n}\n\n/**\n * Module system based on Dependency Injection and Redux\n *\n * life cycle:\n * - `constructor`\n * - `onInitOnce`: when deps are ready, only run once in whole life cycle\n * - `onInit`: when module init, module status will be set to `ready` after that event.\n * - `onInitSuccess`: when onInit be passed successfully, this event will be triggered.\n * - `onReset`: when one of deps be reset, this event will be triggered.\n */\nabstract class RcModuleV2<\n  T extends Record<string, any> & {\n    storage?: IStorage;\n    globalStorage?: IStorage;\n  } = {},\n> {\n  private [onceKey] = false;\n\n  private [storageKey]?: string;\n\n  private [enableCacheKey]: boolean;\n\n  private [enableGlobalCacheKey]: boolean;\n\n  /**\n   * background/client transport for browser extension\n   */\n  protected _transport?: any; // TODO: add transport type\n  private [ignoreReadyModulesKey] = new Set<RcModuleV2>();\n\n  protected initializeProxy?(): Promise<void> | void;\n  /**\n   * `onInit` life cycle for current initialization before all deps modules are all ready.\n   */\n  protected onInit?(): Promise<void> | void;\n  /**\n   * `onInitOnce` once life cycle for current initialization before all deps modules are all ready.\n   */\n  protected onInitOnce?(): Promise<void> | void;\n  /**\n   * `onInitSuccess` life cycle for current initialization after this module is ready.\n   */\n  protected onInitSuccess?(): Promise<void> | void;\n  /**\n   * `onReset` life cycle for current reset before one of deps modules is not ready.\n   */\n  protected onReset?(): Promise<void> | void;\n  /**\n   * Each Redux dispatch action will trigger `onStateChange` once.\n   */\n  protected onStateChange?(): Promise<void> | void;\n\n  protected _deps: T;\n\n  constructor({\n    deps,\n    enableCache = false,\n    enableGlobalCache = false,\n    ...options\n  }: RcModuleOptions<T> = {}) {\n    this._deps = deps! ?? {};\n    this[storageKey] = options.storageKey;\n    this[enableCacheKey] = enableCache;\n    this[enableGlobalCacheKey] = enableGlobalCache;\n    subscribe(this, () => {\n      if (typeof this.onStateChange === 'function') {\n        this.onStateChange();\n      }\n      this[checkStatusChangeKey]();\n    });\n    if (\n      !this[storageStateKey] ||\n      !this[enableCacheKey] ||\n      !this._deps.storage\n    ) {\n      this[storageStateKey] = [];\n    }\n    this[storageStateKey].forEach((key) => delete this[stateKey][key]);\n    if (\n      !this[globalStorageStateKey] ||\n      !this[enableGlobalCacheKey] ||\n      !this._deps.globalStorage\n    ) {\n      this[globalStorageStateKey] = [];\n    }\n    this[globalStorageStateKey].forEach((key) => delete this[stateKey][key]);\n  }\n\n  @state\n  status = ModuleStatus.Pending;\n\n  @action\n  private _setStatus(status: ModuleStatus) {\n    this.status = status;\n  }\n\n  private async [onInitOnceKey]() {\n    if (!this[onceKey]) {\n      this[onceKey] = true;\n      if (typeof this.onInitOnce === 'function') {\n        await this.onInitOnce();\n      }\n    }\n  }\n\n  private async [checkStatusChangeKey]() {\n    if (this._shouldInit()) {\n      this._setStatus(ModuleStatus.Initializing);\n      await this[onInitOnceKey]();\n      if (typeof this.onInit === 'function') {\n        await this.onInit();\n      }\n      this._setStatus(ModuleStatus.Ready);\n      if (typeof this.onInitSuccess === 'function') {\n        await this.onInitSuccess();\n      }\n    } else if (this._shouldReset()) {\n      this._setStatus(ModuleStatus.Resetting);\n      if (typeof this.onReset === 'function') {\n        await this.onReset();\n      }\n      this._setStatus(ModuleStatus.Pending);\n    }\n  }\n\n  protected _ignoreModuleReadiness(dep: RcModuleV2) {\n    this[ignoreReadyModulesKey].add(dep);\n  }\n\n  private get [notReadyModulesKey](): RcModuleV2[] {\n    const modules = Object.values(this._deps || {}).filter(\n      // In order to be compatible with RcModuleV1\n      (module: RcModuleV2) => module && typeof module.ready !== 'undefined',\n    );\n    return modules.filter(\n      (module: RcModuleV2) =>\n        !module.ready && !this[ignoreReadyModulesKey].has(module),\n    );\n  }\n\n  private _getLastState() {\n    const lastState: Record<string, any> = {\n      // for combineReducers check state with reducers\n      __state: this._getStateV2(this[storeKey].getState(), this[identifierKey]),\n      __identifier: this[identifierKey],\n    };\n    if (this._deps.storage?.data) {\n      this[storageStateKey].forEach((key: string) => {\n        const storageReducerKey = `${this[storageKey]}-${key}`;\n        lastState[key] = this._deps.storage!.data[storageReducerKey];\n      });\n    }\n    if (this._deps.globalStorage?.data) {\n      this[globalStorageStateKey].forEach((key: string) => {\n        const storageReducerKey = `${this[storageKey]}-${key}`;\n        lastState[key] = this._deps.globalStorage!.data[storageReducerKey];\n      });\n    }\n    return lastState;\n  }\n\n  private _handleState(state: {\n    __state?: Record<string, any>;\n    __identifier?: string;\n    [key: string]: any;\n  }) {\n    Object.assign(state, state.__state);\n    delete state.__state;\n    delete state.__identifier;\n  }\n\n  _shouldInit() {\n    const areAllReady = this[notReadyModulesKey].length === 0;\n    return areAllReady && this.pending;\n  }\n\n  _shouldReset() {\n    const areNotReady = this[notReadyModulesKey].length > 0;\n    return areNotReady && this.ready;\n  }\n\n  _depsCheck(\n    checkedModules: RcModuleV2[] = [this],\n    pickedModules: RcModuleV2[] = [],\n  ) {\n    Object.values(this._deps ?? {}).forEach((module) => {\n      if (module instanceof RcModuleV2 && !module.ready) {\n        const notReadyModules = Object.values(module._deps ?? {}).filter(\n          (item) => item instanceof RcModuleV2 && !item.ready,\n        );\n        if (notReadyModules.length > 0 && !checkedModules.includes(module)) {\n          checkedModules.push(module);\n          module._depsCheck(checkedModules, pickedModules);\n        } else if (\n          !pickedModules.includes(module) &&\n          notReadyModules.length === 0\n        ) {\n          pickedModules.push(module);\n        }\n      }\n    });\n    // please check `_shouldInit()` or `onInit()`.\n    return pickedModules;\n  }\n\n  @action\n  _changeState(callback: () => void) {\n    callback();\n  }\n\n  get pending() {\n    return this.status === ModuleStatus.Pending;\n  }\n\n  get ready() {\n    return this.status === ModuleStatus.Ready;\n  }\n\n  get resetting() {\n    return this.status === ModuleStatus.Resetting;\n  }\n\n  get initializing() {\n    return this.status === ModuleStatus.Initializing;\n  }\n\n  get store() {\n    return this[storeKey];\n  }\n\n  private [spawnStorageReducersKey]() {\n    const descriptors: PropertyDescriptorMap = {};\n    /**\n     * make storage reducer and state\n     */\n    this[storageStateKey].forEach((key) => {\n      const descriptor = Object.getOwnPropertyDescriptor(this, key);\n      if (typeof descriptor === 'undefined') return;\n      const initialState = descriptor.value;\n      const storageReducerKey = `${this[storageKey]}-${key}`;\n      this._deps.storage!.registerReducer({\n        key: storageReducerKey,\n        reducer: (state = initialState, action: Action) =>\n          action._usm === usmAction &&\n          action.type === this[identifierKey] &&\n          Object.hasOwnProperty.call(action._state, key)\n            ? action._state[key]\n            : state,\n      });\n      Object.assign(descriptors, {\n        [key]: {\n          enumerable: true,\n          configurable: false,\n          get(this: Service) {\n            const stagedState: any = getStagedState();\n            return stagedState?.__identifier === this[identifierKey]\n              ? stagedState[key]\n              : this._deps.storage.data![storageReducerKey];\n          },\n          set(this: Service, value: unknown) {\n            const stagedState = getStagedState();\n            if (\n              stagedState &&\n              stagedState.__identifier !== this[identifierKey]\n            ) {\n              throw new Error(\n                `RcModule does not support cross-module execution of the methods decorated by action`,\n              );\n            }\n            if (stagedState) {\n              stagedState[key] = value;\n              return;\n            }\n            this._deps.storage.data![storageReducerKey] = value;\n          },\n        },\n      });\n    });\n\n    /**\n     * make global storage reducer and state\n     */\n    this[globalStorageStateKey].forEach((key) => {\n      const descriptor = Object.getOwnPropertyDescriptor(this, key);\n      if (typeof descriptor === 'undefined') return;\n      const initialState = descriptor.value;\n      const storageReducerKey = `${this[storageKey]}-${key}`;\n      this._deps.globalStorage!.registerReducer({\n        key: storageReducerKey,\n        reducer: (state = initialState, action: Action) =>\n          action._usm === usmAction &&\n          action.type === this[identifierKey] &&\n          Object.hasOwnProperty.call(action._state, key)\n            ? action._state[key]\n            : state,\n      });\n      Object.assign(descriptors, {\n        [key]: {\n          enumerable: true,\n          configurable: false,\n          get(this: Service) {\n            const stagedState = getStagedState();\n            return stagedState?.__identifier === this[identifierKey]\n              ? stagedState[key]\n              : this._deps.globalStorage.data![storageReducerKey];\n          },\n          set(this: Service, value: unknown) {\n            const stagedState = getStagedState();\n            if (\n              stagedState &&\n              stagedState.__identifier !== this[identifierKey]\n            ) {\n              throw new Error(\n                `RcModule does not support cross-module execution of the methods decorated by action`,\n              );\n            }\n            if (stagedState) {\n              stagedState[key] = value;\n              return;\n            }\n            this._deps.globalStorage.data![storageReducerKey] = value;\n          },\n        },\n      });\n    });\n\n    Object.defineProperties(this, descriptors);\n  }\n\n  // TODO: Refactor without RcModuleV1\n  // harmony with RcModule V1 for modules initialization\n\n  private _modulePath = 'root';\n\n  private _initialized = false;\n\n  private _suppressInit?: boolean;\n\n  protected _reducers?: ReducersMapObject;\n\n  protected _getStateV2 = (state: Record<string, any>, key: string) =>\n    state[key];\n\n  private _setStore() {\n    return this._initModule();\n  }\n\n  get _store() {\n    return this.store;\n  }\n\n  private [spawnReducersKey]() {\n    const descriptors: PropertyDescriptorMap = {\n      [stateKey]: {\n        enumerable: false,\n        configurable: false,\n        get(this: Service) {\n          const stagedState = getStagedState();\n          return stagedState?.__identifier === this[identifierKey]\n            ? stagedState.__state\n            : this._getStateV2(this[storeKey]?.getState(), this[identifierKey]);\n        },\n      },\n    };\n    this._reducers = Object.keys(this[stateKey] ?? {}).reduce(\n      (serviceReducersMapObject: ReducersMapObject, key) => {\n        const descriptor = Object.getOwnPropertyDescriptor(this, key);\n        if (typeof descriptor === 'undefined') return serviceReducersMapObject;\n        const initialState = descriptor.value;\n        Object.assign(descriptors, {\n          [key]: {\n            enumerable: true,\n            configurable: false,\n            get(this: Service) {\n              return this[stateKey][key];\n            },\n            set(this: Service, value: unknown) {\n              this[stateKey][key] = value;\n            },\n          },\n        });\n        return Object.assign(serviceReducersMapObject, {\n          [key]: (state = initialState, action: Action) =>\n            action._usm === usmAction &&\n            this[identifierKey] === action.type &&\n            Object.hasOwnProperty.call(action._state, key)\n              ? action._state[key]\n              : state,\n        });\n      },\n      {},\n    );\n    const stateDescriptor = Object.getOwnPropertyDescriptor(this, stateKey);\n    if (stateDescriptor && typeof stateDescriptor.get === 'function') return;\n    Object.defineProperties(this, descriptors);\n  }\n\n  get reducer(): Reducer<any, Action<any>> {\n    if (this._reducers) return combineReducers(this._reducers);\n    this[spawnStorageReducersKey]();\n    this[spawnReducersKey]();\n    if (!this._reducers) {\n      throw new Error(`Combine reducers error`);\n    }\n    return combineReducers(this._reducers!);\n  }\n\n  async _initModule() {\n    this._initialized = true;\n    if (\n      (this.parentModule && !(this.parentModule instanceof RcModuleV2)) ||\n      (!this.parentModule && !(this instanceof RcModuleV2))\n    ) {\n      for (const subscribe of this[subscriptionsKey] ?? []) {\n        subscribe();\n      }\n      this[subscriptionsKey] = [];\n    }\n    await this[checkStatusChangeKey]();\n    // eslint-disable-next-line guard-for-in\n    for (const subModule in this) {\n      const subRcModule = this[subModule] as any;\n      if (\n        subRcModule &&\n        typeof subRcModule._initModule === 'function' &&\n        !subRcModule._initialized &&\n        !subRcModule._suppressInit\n      ) {\n        subRcModule._initModule();\n      }\n    }\n  }\n\n  private get proxyReady() {\n    return this.ready;\n  }\n\n  private get modulePath() {\n    return this._modulePath;\n  }\n\n  private addModule(name: string, module: unknown) {\n    if (Object.prototype.hasOwnProperty.call(this, name)) {\n      throw new Error(`Property '${name}' already exists...`);\n    }\n    Object.defineProperty(this, name, {\n      get() {\n        return module;\n      },\n      enumerable: true,\n    });\n    if ((this as any)[name]._modulePath === 'root') {\n      (this as any)[name]._modulePath = `${this.modulePath}.${name}`;\n    }\n  }\n\n  private get state() {\n    return this[stateKey];\n  }\n\n  private actionTypes() {\n    return {};\n  }\n}\n\nexport {\n  RcModuleV2,\n  state,\n  action,\n  subscribe,\n  computed,\n  createStore,\n  watch,\n  stateKey,\n  storeKey,\n  identifierKey,\n  applyPatches,\n  usmAction,\n  enableES5,\n  setAutoFreeze,\n};\n"],"mappings":"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"}
{"version":3,"file":"RcModule.js","names":["_redux","require","_usmRedux","_class","_descriptor","_createForOfIteratorHelper","r","e","t","Symbol","iterator","Array","isArray","_unsupportedIterableToArray","length","_n","F","s","n","done","value","f","TypeError","o","a","u","call","next","_arrayLikeToArray","toString","slice","constructor","name","from","test","_defineProperty","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","asyncGeneratorStep","c","i","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_initializerDefineProperty","l","initializer","_objectWithoutProperties","_objectWithoutPropertiesLoose","getOwnPropertySymbols","indexOf","propertyIsEnumerable","hasOwnProperty","_classCallCheck","_defineProperties","key","_createClass","prototype","_toPrimitive","_typeof","toPrimitive","String","Number","_applyDecoratedDescriptor","keys","forEach","reverse","reduce","_initializerWarningHelper","Error","setAutoFreeze","setPatchesToggle","process","env","DISABLE_PATCHES","enablePatches","ModuleStatus","exports","onceKey","onInitOnceKey","notReadyModulesKey","checkStatusChangeKey","enableCacheKey","enableGlobalCacheKey","storageKey","storageStateKey","globalStorageStateKey","spawnReducersKey","spawnStorageReducersKey","ignoreReadyModulesKey","RcModuleV2","_ref2","_this","_ref","undefined","deps","_ref$enableCache","enableCache","_ref$enableGlobalCach","enableGlobalCache","options","_transport","Set","_deps","_modulePath","_initialized","_suppressInit","_reducers","_getStateV2","state","subscribe","onStateChange","storage","stateKey","globalStorage","_setStatus","status","_value","regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","onInitOnce","stop","_value2","_callee2","_callee2$","_context2","_shouldInit","Initializing","onInit","Ready","onInitSuccess","_shouldReset","Resetting","onReset","Pending","_ignoreModuleReadiness","dep","add","_getLastState","_this$_deps$storage","_this2","_this$_deps$globalSto","lastState","__state","storeKey","getState","identifierKey","__identifier","data","storageReducerKey","concat","_handleState","assign","areAllReady","pending","areNotReady","ready","_depsCheck","_this$_deps","checkedModules","pickedModules","values","module","_module$_deps","notReadyModules","filter","item","includes","push","_changeState","callback","_this3","descriptors","descriptor","getOwnPropertyDescriptor","initialState","registerReducer","reducer","action","_usm","usmAction","type","_state","get","stagedState","getStagedState","set","defineProperties","_setStore","_initModule","_this$stateKey","_this4","_this$storeKey","serviceReducersMapObject","stateDescriptor","_initModule2","_callee3","_this$subscriptionsKe","_iterator","_step","_subscribe","subModule","subRcModule","_callee3$","_context3","parentModule","subscriptionsKey","err","addModule","modulePath","actionTypes","_this5","modules","has","store","combineReducers"],"sources":["lib/RcModule/RcModule.ts"],"sourcesContent":["import type { Reducer, ReducersMapObject } from 'redux';\nimport { combineReducers } from 'redux';\n\nimport type { Action, Service, Store, Subscription } from '../usm-redux';\nimport {\n  action,\n  applyPatches,\n  computed,\n  createStore,\n  enableES5,\n  enablePatches,\n  getStagedState,\n  identifierKey,\n  setAutoFreeze,\n  setPatchesToggle,\n  state,\n  stateKey,\n  storeKey,\n  subscribe,\n  subscriptionsKey,\n  usm as usmAction,\n  watch,\n} from '../usm-redux';\n\nsetAutoFreeze(false);\n\nsetPatchesToggle(!process.env.DISABLE_PATCHES);\nif (!process.env.DISABLE_PATCHES) {\n  enablePatches();\n}\n\nexport const enum ModuleStatus {\n  Pending = 'PENDING',\n  Initializing = 'INITIALIZING',\n  Ready = 'READY',\n  Resetting = 'RESETTING',\n}\n\nexport const onceKey: unique symbol = Symbol('once');\nexport const onInitOnceKey: unique symbol = Symbol('onInitOnce');\nexport const notReadyModulesKey: unique symbol = Symbol('notReadyModules');\nexport const checkStatusChangeKey: unique symbol = Symbol('checkStatusChange');\nexport const enableCacheKey: unique symbol = Symbol('enableCache');\nexport const enableGlobalCacheKey: unique symbol = Symbol('enableGlobalCache');\nexport const storageKey: unique symbol = Symbol('storage');\nexport const storageStateKey: unique symbol = Symbol('storageState');\nexport const globalStorageStateKey: unique symbol =\n  Symbol('globalStorageState');\nexport const spawnReducersKey: unique symbol = Symbol('spawnReducers');\nexport const spawnStorageReducersKey: unique symbol = Symbol(\n  'spawnStorageReducers',\n);\nexport const ignoreReadyModulesKey: unique symbol =\n  Symbol('ignoreReadyModules');\n\nexport interface RcModuleOptions<T> {\n  deps?: T & {\n    storage?: any;\n    globalStorage?: any;\n  };\n  enableCache?: boolean;\n  enableGlobalCache?: boolean;\n  storageKey?: string;\n}\n\ninterface RcModuleV2 {\n  parentModule: RcModuleV2;\n  [storageStateKey]: string[];\n  [globalStorageStateKey]: string[];\n  [stateKey]: Record<string, any>;\n  [identifierKey]: string;\n  [subscriptionsKey]: Subscription[];\n  [storeKey]: Store;\n}\n\ninterface IStorage extends RcModuleV2 {\n  registerReducer(options: {\n    key: string;\n    reducer: Reducer<any, Action>;\n  }): void;\n  data: Record<string, any>;\n}\n\n/**\n * Module system based on Dependency Injection and Redux\n *\n * life cycle:\n * - `constructor`\n * - `onInitOnce`: when deps are ready, only run once in whole life cycle\n * - `onInit`: when module init, module status will be set to `ready` after that event.\n * - `onInitSuccess`: when onInit be passed successfully, this event will be triggered.\n * - `onReset`: when one of deps be reset, this event will be triggered.\n */\nabstract class RcModuleV2<\n  T extends Record<string, any> & {\n    storage?: IStorage;\n    globalStorage?: IStorage;\n  } = {},\n> {\n  private [onceKey] = false;\n\n  private [storageKey]?: string;\n\n  private [enableCacheKey]: boolean;\n\n  private [enableGlobalCacheKey]: boolean;\n\n  /**\n   * background/client transport for browser extension\n   */\n  protected _transport?: any; // TODO: add transport type\n  private [ignoreReadyModulesKey] = new Set<RcModuleV2>();\n\n  protected initializeProxy?(): Promise<void> | void;\n  /**\n   * `onInit` life cycle for current initialization before all deps modules are all ready.\n   */\n  protected onInit?(): Promise<void> | void;\n  /**\n   * `onInitOnce` once life cycle for current initialization before all deps modules are all ready.\n   */\n  protected onInitOnce?(): Promise<void> | void;\n  /**\n   * `onInitSuccess` life cycle for current initialization after this module is ready.\n   */\n  protected onInitSuccess?(): Promise<void> | void;\n  /**\n   * `onReset` life cycle for current reset before one of deps modules is not ready.\n   */\n  protected onReset?(): Promise<void> | void;\n  /**\n   * Each Redux dispatch action will trigger `onStateChange` once.\n   */\n  protected onStateChange?(): Promise<void> | void;\n\n  protected _deps: T;\n\n  constructor({\n    deps,\n    enableCache = false,\n    enableGlobalCache = false,\n    ...options\n  }: RcModuleOptions<T> = {}) {\n    this._deps = deps! ?? {};\n    this[storageKey] = options.storageKey;\n    this[enableCacheKey] = enableCache;\n    this[enableGlobalCacheKey] = enableGlobalCache;\n    subscribe(this, () => {\n      if (typeof this.onStateChange === 'function') {\n        this.onStateChange();\n      }\n      this[checkStatusChangeKey]();\n    });\n    if (\n      !this[storageStateKey] ||\n      !this[enableCacheKey] ||\n      !this._deps.storage\n    ) {\n      this[storageStateKey] = [];\n    }\n    this[storageStateKey].forEach((key) => delete this[stateKey][key]);\n    if (\n      !this[globalStorageStateKey] ||\n      !this[enableGlobalCacheKey] ||\n      !this._deps.globalStorage\n    ) {\n      this[globalStorageStateKey] = [];\n    }\n    this[globalStorageStateKey].forEach((key) => delete this[stateKey][key]);\n  }\n\n  @state\n  status = ModuleStatus.Pending;\n\n  @action\n  private _setStatus(status: ModuleStatus) {\n    this.status = status;\n  }\n\n  private async [onInitOnceKey]() {\n    if (!this[onceKey]) {\n      this[onceKey] = true;\n      if (typeof this.onInitOnce === 'function') {\n        await this.onInitOnce();\n      }\n    }\n  }\n\n  private async [checkStatusChangeKey]() {\n    if (this._shouldInit()) {\n      this._setStatus(ModuleStatus.Initializing);\n      await this[onInitOnceKey]();\n      if (typeof this.onInit === 'function') {\n        await this.onInit();\n      }\n      this._setStatus(ModuleStatus.Ready);\n      if (typeof this.onInitSuccess === 'function') {\n        await this.onInitSuccess();\n      }\n    } else if (this._shouldReset()) {\n      this._setStatus(ModuleStatus.Resetting);\n      if (typeof this.onReset === 'function') {\n        await this.onReset();\n      }\n      this._setStatus(ModuleStatus.Pending);\n    }\n  }\n\n  protected _ignoreModuleReadiness(dep: RcModuleV2) {\n    this[ignoreReadyModulesKey].add(dep);\n  }\n\n  private get [notReadyModulesKey](): RcModuleV2[] {\n    const modules = Object.values(this._deps || {}).filter(\n      // In order to be compatible with RcModuleV1\n      (module: RcModuleV2) => module && typeof module.ready !== 'undefined',\n    );\n    return modules.filter(\n      (module: RcModuleV2) =>\n        !module.ready && !this[ignoreReadyModulesKey].has(module),\n    );\n  }\n\n  private _getLastState() {\n    const lastState: Record<string, any> = {\n      // for combineReducers check state with reducers\n      __state: this._getStateV2(this[storeKey].getState(), this[identifierKey]),\n      __identifier: this[identifierKey],\n    };\n    if (this._deps.storage?.data) {\n      this[storageStateKey].forEach((key: string) => {\n        const storageReducerKey = `${this[storageKey]}-${key}`;\n        lastState[key] = this._deps.storage!.data[storageReducerKey];\n      });\n    }\n    if (this._deps.globalStorage?.data) {\n      this[globalStorageStateKey].forEach((key: string) => {\n        const storageReducerKey = `${this[storageKey]}-${key}`;\n        lastState[key] = this._deps.globalStorage!.data[storageReducerKey];\n      });\n    }\n    return lastState;\n  }\n\n  private _handleState(state: {\n    __state?: Record<string, any>;\n    __identifier?: string;\n    [key: string]: any;\n  }) {\n    Object.assign(state, state.__state);\n    delete state.__state;\n    delete state.__identifier;\n  }\n\n  _shouldInit() {\n    const areAllReady = this[notReadyModulesKey].length === 0;\n    return areAllReady && this.pending;\n  }\n\n  _shouldReset() {\n    const areNotReady = this[notReadyModulesKey].length > 0;\n    return areNotReady && this.ready;\n  }\n\n  _depsCheck(\n    checkedModules: RcModuleV2[] = [this],\n    pickedModules: RcModuleV2[] = [],\n  ) {\n    Object.values(this._deps ?? {}).forEach((module) => {\n      if (module instanceof RcModuleV2 && !module.ready) {\n        const notReadyModules = Object.values(module._deps ?? {}).filter(\n          (item) => item instanceof RcModuleV2 && !item.ready,\n        );\n        if (notReadyModules.length > 0 && !checkedModules.includes(module)) {\n          checkedModules.push(module);\n          module._depsCheck(checkedModules, pickedModules);\n        } else if (\n          !pickedModules.includes(module) &&\n          notReadyModules.length === 0\n        ) {\n          pickedModules.push(module);\n        }\n      }\n    });\n    // please check `_shouldInit()` or `onInit()`.\n    return pickedModules;\n  }\n\n  @action\n  _changeState(callback: () => void) {\n    callback();\n  }\n\n  get pending() {\n    return this.status === ModuleStatus.Pending;\n  }\n\n  get ready() {\n    return this.status === ModuleStatus.Ready;\n  }\n\n  get resetting() {\n    return this.status === ModuleStatus.Resetting;\n  }\n\n  get initializing() {\n    return this.status === ModuleStatus.Initializing;\n  }\n\n  get store() {\n    return this[storeKey];\n  }\n\n  private [spawnStorageReducersKey]() {\n    const descriptors: PropertyDescriptorMap = {};\n    /**\n     * make storage reducer and state\n     */\n    this[storageStateKey].forEach((key) => {\n      const descriptor = Object.getOwnPropertyDescriptor(this, key);\n      if (typeof descriptor === 'undefined') return;\n      const initialState = descriptor.value;\n      const storageReducerKey = `${this[storageKey]}-${key}`;\n      this._deps.storage!.registerReducer({\n        key: storageReducerKey,\n        reducer: (state = initialState, action: Action) =>\n          action._usm === usmAction &&\n          action.type === this[identifierKey] &&\n          Object.hasOwnProperty.call(action._state, key)\n            ? action._state[key]\n            : state,\n      });\n      Object.assign(descriptors, {\n        [key]: {\n          enumerable: true,\n          configurable: false,\n          get(this: Service) {\n            const stagedState: any = getStagedState();\n            return stagedState?.__identifier === this[identifierKey]\n              ? stagedState[key]\n              : this._deps.storage.data![storageReducerKey];\n          },\n          set(this: Service, value: unknown) {\n            const stagedState = getStagedState();\n            if (\n              stagedState &&\n              stagedState.__identifier !== this[identifierKey]\n            ) {\n              throw new Error(\n                `RcModule does not support cross-module execution of the methods decorated by action`,\n              );\n            }\n            if (stagedState) {\n              stagedState[key] = value;\n              return;\n            }\n            this._deps.storage.data![storageReducerKey] = value;\n          },\n        },\n      });\n    });\n\n    /**\n     * make global storage reducer and state\n     */\n    this[globalStorageStateKey].forEach((key) => {\n      const descriptor = Object.getOwnPropertyDescriptor(this, key);\n      if (typeof descriptor === 'undefined') return;\n      const initialState = descriptor.value;\n      const storageReducerKey = `${this[storageKey]}-${key}`;\n      this._deps.globalStorage!.registerReducer({\n        key: storageReducerKey,\n        reducer: (state = initialState, action: Action) =>\n          action._usm === usmAction &&\n          action.type === this[identifierKey] &&\n          Object.hasOwnProperty.call(action._state, key)\n            ? action._state[key]\n            : state,\n      });\n      Object.assign(descriptors, {\n        [key]: {\n          enumerable: true,\n          configurable: false,\n          get(this: Service) {\n            const stagedState = getStagedState();\n            return stagedState?.__identifier === this[identifierKey]\n              ? stagedState[key]\n              : this._deps.globalStorage.data![storageReducerKey];\n          },\n          set(this: Service, value: unknown) {\n            const stagedState = getStagedState();\n            if (\n              stagedState &&\n              stagedState.__identifier !== this[identifierKey]\n            ) {\n              throw new Error(\n                `RcModule does not support cross-module execution of the methods decorated by action`,\n              );\n            }\n            if (stagedState) {\n              stagedState[key] = value;\n              return;\n            }\n            this._deps.globalStorage.data![storageReducerKey] = value;\n          },\n        },\n      });\n    });\n\n    Object.defineProperties(this, descriptors);\n  }\n\n  // TODO: Refactor without RcModuleV1\n  // harmony with RcModule V1 for modules initialization\n\n  private _modulePath = 'root';\n\n  private _initialized = false;\n\n  private _suppressInit?: boolean;\n\n  protected _reducers?: ReducersMapObject;\n\n  protected _getStateV2 = (state: Record<string, any>, key: string) =>\n    state[key];\n\n  private _setStore() {\n    return this._initModule();\n  }\n\n  get _store() {\n    return this.store;\n  }\n\n  private [spawnReducersKey]() {\n    const descriptors: PropertyDescriptorMap = {\n      [stateKey]: {\n        enumerable: false,\n        configurable: false,\n        get(this: Service) {\n          const stagedState = getStagedState();\n          return stagedState?.__identifier === this[identifierKey]\n            ? stagedState.__state\n            : this._getStateV2(this[storeKey]?.getState(), this[identifierKey]);\n        },\n      },\n    };\n    this._reducers = Object.keys(this[stateKey] ?? {}).reduce(\n      (serviceReducersMapObject: ReducersMapObject, key) => {\n        const descriptor = Object.getOwnPropertyDescriptor(this, key);\n        if (typeof descriptor === 'undefined') return serviceReducersMapObject;\n        const initialState = descriptor.value;\n        Object.assign(descriptors, {\n          [key]: {\n            enumerable: true,\n            configurable: false,\n            get(this: Service) {\n              return this[stateKey][key];\n            },\n            set(this: Service, value: unknown) {\n              this[stateKey][key] = value;\n            },\n          },\n        });\n        return Object.assign(serviceReducersMapObject, {\n          [key]: (state = initialState, action: Action) =>\n            action._usm === usmAction &&\n            this[identifierKey] === action.type &&\n            Object.hasOwnProperty.call(action._state, key)\n              ? action._state[key]\n              : state,\n        });\n      },\n      {},\n    );\n    const stateDescriptor = Object.getOwnPropertyDescriptor(this, stateKey);\n    if (stateDescriptor && typeof stateDescriptor.get === 'function') return;\n    Object.defineProperties(this, descriptors);\n  }\n\n  get reducer(): Reducer<any, Action<any>> {\n    if (this._reducers) return combineReducers(this._reducers);\n    this[spawnStorageReducersKey]();\n    this[spawnReducersKey]();\n    if (!this._reducers) {\n      throw new Error(`Combine reducers error`);\n    }\n    return combineReducers(this._reducers!);\n  }\n\n  async _initModule() {\n    this._initialized = true;\n    if (\n      (this.parentModule && !(this.parentModule instanceof RcModuleV2)) ||\n      (!this.parentModule && !(this instanceof RcModuleV2))\n    ) {\n      for (const subscribe of this[subscriptionsKey] ?? []) {\n        subscribe();\n      }\n      this[subscriptionsKey] = [];\n    }\n    await this[checkStatusChangeKey]();\n    // eslint-disable-next-line guard-for-in\n    for (const subModule in this) {\n      const subRcModule = this[subModule] as any;\n      if (\n        subRcModule &&\n        typeof subRcModule._initModule === 'function' &&\n        !subRcModule._initialized &&\n        !subRcModule._suppressInit\n      ) {\n        subRcModule._initModule();\n      }\n    }\n  }\n\n  private get proxyReady() {\n    return this.ready;\n  }\n\n  private get modulePath() {\n    return this._modulePath;\n  }\n\n  private addModule(name: string, module: unknown) {\n    if (Object.prototype.hasOwnProperty.call(this, name)) {\n      throw new Error(`Property '${name}' already exists...`);\n    }\n    Object.defineProperty(this, name, {\n      get() {\n        return module;\n      },\n      enumerable: true,\n    });\n    if ((this as any)[name]._modulePath === 'root') {\n      (this as any)[name]._modulePath = `${this.modulePath}.${name}`;\n    }\n  }\n\n  private get state() {\n    return this[stateKey];\n  }\n\n  private actionTypes() {\n    return {};\n  }\n}\n\nexport {\n  RcModuleV2,\n  state,\n  action,\n  subscribe,\n  computed,\n  createStore,\n  watch,\n  stateKey,\n  storeKey,\n  identifierKey,\n  applyPatches,\n  usmAction,\n  enableES5,\n  setAutoFreeze,\n};\n"],"mappings":"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","ignoreList":[]}
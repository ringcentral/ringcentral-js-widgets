{"version":3,"sources":["lib/getWebpackConfig/index.js"],"names":["getBaseConfig","cacheDirectory","hashPrefix","supportedLocales","themeFolder","fontFileSizeLimit","multiThread","prefixSvgId","enableMultiThread","Object","useMultiThread","loader","options","resolve","extensions","module","rules","enforce","test","exclude","use","resource","jsx","svgo","plugins","removeViewBox","cleanupIDs","prefix","path","basename","modules","localIdentName","autoprefixer","includePaths","process","cwd","outputStyle","getWebpackConfig","env","base","mode","webpack","DefinePlugin","NODE_ENV","JSON","stringify","devtool"],"mappings":"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","sourcesContent":["import { is, isNil } from 'ramda';\nimport { MD5 } from 'crypto-js';\nimport { warmup } from 'thread-loader';\nimport autoprefixer from 'autoprefixer';\nimport path from 'path';\nimport webpack from 'webpack';\n\nfunction getBaseConfig({\n  cacheDirectory = false,\n  hashPrefix = '',\n  supportedLocales = [],\n  themeFolder,\n  fontFileSizeLimit = 15000,\n  multiThread = false,\n  prefixSvgId = false,\n}: {\n  cacheDirectory: boolean,\n  supportedLocales: string[],\n  themeFolder: string,\n  hashPrefix?: string,\n  fontFileSizeLimit?: number,\n  multiThread: boolean | { [key: string]: any },\n  prefixSvgId?: boolean,\n}) {\n  const enableMultiThread = !isNil(multiThread) && multiThread !== false;\n  if (enableMultiThread) {\n    warmup(is(Object, multiThread) ? multiThread : {}, [\n      'source-map-loader',\n      'babel-loader',\n      'sass-loader',\n    ]);\n  }\n  const useMultiThread = enableMultiThread\n    ? [\n        is(Object, multiThread)\n          ? {\n              loader: 'thread-loader',\n              options: multiThread,\n            }\n          : 'thread-loader',\n      ]\n    : [];\n\n  return {\n    resolve: {\n      extensions: ['.ts', '.tsx', '.js', '.jsx'],\n    },\n    module: {\n      rules: [\n        {\n          enforce: 'pre',\n          test: /\\.(js|jsx|ts|tsx)$/,\n          exclude: /node_modules/,\n          ...(multiThread\n            ? {\n                use: ['source-map-loader', ...useMultiThread],\n              }\n            : {\n                loader: 'source-map-loader',\n              }),\n        },\n        {\n          test: /\\.(js|jsx|ts|tsx)$/,\n          use: [\n            {\n              loader: 'babel-loader',\n              options: {\n                cacheDirectory,\n              },\n            },\n            {\n              loader: '@ringcentral-integration/locale-loader',\n              options: {\n                supportedLocales,\n              },\n            },\n            ...useMultiThread,\n          ],\n          exclude: /node_modules/,\n        },\n        {\n          test: /\\.css$/i,\n          use: ['style-loader', 'css-loader', ...useMultiThread],\n        },\n        {\n          test: /\\.woff|\\.woff2|.eot|\\.ttf/,\n          use: `url-loader?limit=${fontFileSizeLimit}&name=fonts/[name]_[hash].[ext]`,\n        },\n        {\n          test: /\\.svg/,\n          exclude: /fonts/,\n          use: ({ resource }) => [\n            'babel-loader',\n            {\n              loader: 'react-svg-loader',\n              options: {\n                jsx: true,\n                svgo: {\n                  plugins: [\n                    {\n                      removeViewBox: false,\n                    },\n                    ...(prefixSvgId\n                      ? [\n                          {\n                            cleanupIDs: {\n                              prefix: `${MD5(\n                                path.basename(resource, '.svg'),\n                              )}-`,\n                            },\n                          },\n                        ]\n                      : []),\n                  ],\n                },\n              },\n            },\n          ],\n        },\n        {\n          test: /\\.png|\\.jpg|\\.gif|fonts(\\/|\\\\).*\\.svg/,\n          use: 'url-loader?limit=20000&name=images/[name]_[hash].[ext]',\n        },\n        {\n          test: /\\.sass|\\.scss/,\n          use: [\n            {\n              loader: 'style-loader',\n            },\n            {\n              loader: 'css-loader',\n              options: {\n                modules: true,\n                localIdentName: `${hashPrefix}_[path]_[name]_[local]_[hash:base64:5]`,\n              },\n            },\n            {\n              loader: 'postcss-loader',\n              options: {\n                plugins: () => [autoprefixer],\n              },\n            },\n            {\n              loader: 'sass-loader',\n              options: {\n                includePaths: [\n                  themeFolder,\n                  path.resolve(process.cwd(), 'node_modules'),\n                  path.resolve(process.cwd(), '../../node_modules'),\n                ],\n                outputStyle: 'expanded',\n              },\n            },\n            ...useMultiThread,\n          ],\n        },\n        {\n          test: /\\.ogg$|\\.wav$/,\n          use: 'file-loader?name=audio/[name]_[hash].[ext]',\n        },\n      ],\n    },\n    plugins: [],\n  };\n}\n\nexport default function getWebpackConfig({ env = 'development', ...options }) {\n  const base = getBaseConfig({\n    ...options,\n  });\n  if (env === 'production') {\n    return {\n      ...base,\n      mode: 'production',\n      plugins: [\n        ...base.plugins,\n        new webpack.DefinePlugin({\n          'process.env': {\n            NODE_ENV: JSON.stringify('production'),\n          },\n        }),\n      ],\n    };\n  }\n  return {\n    ...base,\n    mode: 'development',\n    devtool: 'inline-source-map',\n    plugins: [\n      ...base.plugins,\n      new webpack.DefinePlugin({\n        'process.env': {\n          NODE_ENV: JSON.stringify('development'),\n        },\n      }),\n    ],\n  };\n}\n"],"file":"index.js"}
{"version":3,"file":"debounce.js","names":["DEFAULT_THRESHOLD","exports","debounce","_ref","fn","_ref$threshold","threshold","_ref$leading","leading","_ref$trailing","trailing","maxThreshold","timeoutId","lastArgs","lastThis","lastResult","thresholdStart","invoke","apply","undefined","getWaitTime","timestamp","Number","isNaN","Math","min","handleTimeout","Date","now","setTimeout","cancel","clearTimeout","flush","debounced","_len","arguments","length","args","Array","_key"],"sources":["lib/debounce-throttle/debounce.ts"],"sourcesContent":["// @ts-nocheck\nexport const DEFAULT_THRESHOLD = 500;\n\n/**\n * @property {function} fn - Original function to be debounced\n * @property {number} threshold\n */\nexport interface DebounceOptions<F> {\n  /** @property {function} - Original function to be debounced */\n  fn: F;\n  /** @default 500 @property {number} - The debounce delay time. Or the throttle time if in leading mode. */\n  threshold?: number;\n  /** @default false @property {boolean} - If true, fn will be invoke first before starting the debounce timer. */\n  leading?: boolean;\n  /** @default true @property {boolean} - Only applies to leading=true. If true, calling the debounced function during debounce timer will lead to a trailing invocation. */\n  trailing?: boolean;\n  /** @default undefined @property {number} - Defines the maximum time in ms that the invocation can be delayed. This can be used as a throttling mechanism. */\n  maxThreshold?: number;\n}\n\nexport interface DebouncedFunction<F extends (...args: any) => any> {\n  (this: any, ...args: Parameters<F>): ReturnType<F>;\n  flush: () => ReturnType<F>;\n  cancel: () => ReturnType<F>;\n}\n\n/**\n * @return {function} debounced - The debounced function. Set leading to true and maxThreshold to the same as threshold to have basic throttle function.\n * @return {function} debounced.cancel - Calling the cancel function will return the last known result and cancel the queued invocation if there is one.\n * @return {function} debounce.flush - Calling the flush function will return the last known result if no invocation is queued, or cancel the queue and invoke fn immediately and return the result.\n */\nexport function debounce<F extends (...args: any) => any>({\n  fn,\n  threshold = DEFAULT_THRESHOLD,\n  leading = false,\n  trailing = true,\n  maxThreshold,\n}: DebounceOptions<F>): DebouncedFunction<F> {\n  let timeoutId: NodeJS.Timeout;\n  let lastArgs: Parameters<F>;\n  let lastThis: any;\n  let lastResult: ReturnType<F>;\n  let thresholdStart = 0;\n\n  function invoke() {\n    if (lastArgs) {\n      lastResult = fn.apply(lastThis, lastArgs);\n    }\n    lastThis = undefined;\n    lastArgs = undefined;\n  }\n\n  function getWaitTime(timestamp: number) {\n    return !Number.isNaN(maxThreshold) && maxThreshold > 0\n      ? Math.min(threshold, maxThreshold - (timestamp - thresholdStart))\n      : threshold;\n  }\n\n  function handleTimeout() {\n    timeoutId = null;\n    const timestamp = Date.now();\n    if (lastArgs) {\n      thresholdStart = timestamp;\n      invoke();\n      timeoutId = setTimeout(handleTimeout, getWaitTime(timestamp));\n    } else {\n      thresholdStart = 0;\n    }\n  }\n\n  function cancel() {\n    if (timeoutId) {\n      clearTimeout(timeoutId);\n      timeoutId = null;\n    }\n    // reset the args and thresholdStart since no invocation occurs\n    lastThis = undefined;\n    lastArgs = undefined;\n    thresholdStart = 0;\n    return lastResult;\n  }\n\n  function flush() {\n    if (timeoutId) {\n      clearTimeout(timeoutId);\n      handleTimeout();\n    }\n    return lastResult;\n  }\n\n  function debounced(this: any, ...args: Parameters<F>): ReturnType<F> {\n    const timestamp = Date.now();\n    if (!timeoutId || trailing || !leading) {\n      lastThis = this;\n      lastArgs = args;\n    }\n\n    if (!timeoutId && leading) {\n      invoke();\n    }\n    if (timeoutId) {\n      clearTimeout(timeoutId);\n    }\n    if (thresholdStart === 0 || thresholdStart > timestamp) {\n      // in case that the system time is adjusted backwards to a time server\n      // resett he thresholdStart so that invocation will not be delayed indefinitely\n      thresholdStart = timestamp;\n    }\n    timeoutId = setTimeout(handleTimeout, getWaitTime(timestamp));\n\n    return lastResult;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n\n  return debounced;\n}\n"],"mappings":"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"}
{"version":3,"file":"promisedDebounce.js","names":["_debounce","require","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","value","_toPropertyKey","configurable","writable","arg","_toPrimitive","_typeof","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","_objectWithoutProperties","excluded","_objectWithoutPropertiesLoose","sourceSymbolKeys","indexOf","prototype","propertyIsEnumerable","sourceKeys","promisedDebounce","_ref","fn","options","promise","reject","resolve","wrappedFn","result","lastResolve","lastReject","_len","args","Array","_key","setTimeout","error","debounced","debounce","debouncePromiseFn","Promise","promiseResolve","promiseReject","_len2","_key2","cancel","Error","flush"],"sources":["lib/debounce-throttle/promisedDebounce.ts"],"sourcesContent":["// @ts-nocheck\nimport type { DebouncedFunction, DebounceOptions } from './debounce';\nimport { debounce } from './debounce';\n\nexport interface PromisedDebounceFunction<\n  F extends (this: any, ...args: any) => any,\n> {\n  (this: any, ...args: Parameters<F>): Promise<ReturnType<F>>;\n  cancel: DebouncedFunction<F>['cancel'];\n  flush: DebouncedFunction<F>['flush'];\n}\n\nexport function promisedDebounce<F extends (...args: any) => any>({\n  fn,\n  ...options\n}: DebounceOptions<F>): PromisedDebounceFunction<F> {\n  let promise: Promise<ReturnType<F>> = null;\n  let reject: (reason?: any) => void = null;\n  let resolve: (value?: any) => void = null;\n\n  function wrappedFn(this: any, ...args: Parameters<F>) {\n    let result: ReturnType<F>;\n    const lastResolve = resolve;\n    const lastReject = reject;\n\n    promise = null;\n    reject = null;\n    resolve = null;\n\n    try {\n      result = fn.apply(this, args);\n      setTimeout(() => {\n        lastResolve(result);\n      }, 0);\n      return result;\n    } catch (error: any /** TODO: confirm with instanceof */) {\n      setTimeout(() => {\n        lastReject(error);\n      }, 0);\n      throw error;\n    }\n  }\n\n  const debounced = debounce({\n    fn: wrappedFn,\n    ...options,\n  });\n\n  function debouncePromiseFn(\n    this: any,\n    ...args: Parameters<F>\n  ): Promise<ReturnType<F>> {\n    if (!promise) {\n      promise = new Promise((promiseResolve, promiseReject) => {\n        resolve = promiseResolve;\n        reject = promiseReject;\n      });\n    }\n    debounced.apply(this, args);\n    return promise;\n  }\n\n  function cancel() {\n    const result = debounced.cancel();\n    if (promise) {\n      const lastReject = reject;\n      promise = null;\n      resolve = null;\n      reject = null;\n      setTimeout(() => lastReject(new Error('cancelled')), 0);\n    }\n    return result;\n  }\n\n  debouncePromiseFn.cancel = cancel;\n  debouncePromiseFn.flush = debounced.flush;\n\n  return debouncePromiseFn;\n}\n"],"mappings":";;;;;;;;;;;;AAEA,IAAAA,SAAA,GAAAC,OAAA;AAAsC,SAAAC,QAAAC,MAAA,EAAAC,cAAA,QAAAC,IAAA,GAAAC,MAAA,CAAAD,IAAA,CAAAF,MAAA,OAAAG,MAAA,CAAAC,qBAAA,QAAAC,OAAA,GAAAF,MAAA,CAAAC,qBAAA,CAAAJ,MAAA,GAAAC,cAAA,KAAAI,OAAA,GAAAA,OAAA,CAAAC,MAAA,WAAAC,GAAA,WAAAJ,MAAA,CAAAK,wBAAA,CAAAR,MAAA,EAAAO,GAAA,EAAAE,UAAA,OAAAP,IAAA,CAAAQ,IAAA,CAAAC,KAAA,CAAAT,IAAA,EAAAG,OAAA,YAAAH,IAAA;AAAA,SAAAU,cAAAC,MAAA,aAAAC,CAAA,MAAAA,CAAA,GAAAC,SAAA,CAAAC,MAAA,EAAAF,CAAA,UAAAG,MAAA,WAAAF,SAAA,CAAAD,CAAA,IAAAC,SAAA,CAAAD,CAAA,QAAAA,CAAA,OAAAf,OAAA,CAAAI,MAAA,CAAAc,MAAA,OAAAC,OAAA,WAAAC,GAAA,IAAAC,eAAA,CAAAP,MAAA,EAAAM,GAAA,EAAAF,MAAA,CAAAE,GAAA,SAAAhB,MAAA,CAAAkB,yBAAA,GAAAlB,MAAA,CAAAmB,gBAAA,CAAAT,MAAA,EAAAV,MAAA,CAAAkB,yBAAA,CAAAJ,MAAA,KAAAlB,OAAA,CAAAI,MAAA,CAAAc,MAAA,GAAAC,OAAA,WAAAC,GAAA,IAAAhB,MAAA,CAAAoB,cAAA,CAAAV,MAAA,EAAAM,GAAA,EAAAhB,MAAA,CAAAK,wBAAA,CAAAS,MAAA,EAAAE,GAAA,iBAAAN,MAAA;AAAA,SAAAO,gBAAAI,GAAA,EAAAL,GAAA,EAAAM,KAAA,IAAAN,GAAA,GAAAO,cAAA,CAAAP,GAAA,OAAAA,GAAA,IAAAK,GAAA,IAAArB,MAAA,CAAAoB,cAAA,CAAAC,GAAA,EAAAL,GAAA,IAAAM,KAAA,EAAAA,KAAA,EAAAhB,UAAA,QAAAkB,YAAA,QAAAC,QAAA,oBAAAJ,GAAA,CAAAL,GAAA,IAAAM,KAAA,WAAAD,GAAA;AAAA,SAAAE,eAAAG,GAAA,QAAAV,GAAA,GAAAW,YAAA,CAAAD,GAAA,oBAAAE,OAAA,CAAAZ,GAAA,iBAAAA,GAAA,GAAAa,MAAA,CAAAb,GAAA;AAAA,SAAAW,aAAAG,KAAA,EAAAC,IAAA,QAAAH,OAAA,CAAAE,KAAA,kBAAAA,KAAA,kBAAAA,KAAA,MAAAE,IAAA,GAAAF,KAAA,CAAAG,MAAA,CAAAC,WAAA,OAAAF,IAAA,KAAAG,SAAA,QAAAC,GAAA,GAAAJ,IAAA,CAAAK,IAAA,CAAAP,KAAA,EAAAC,IAAA,oBAAAH,OAAA,CAAAQ,GAAA,uBAAAA,GAAA,YAAAE,SAAA,4DAAAP,IAAA,gBAAAF,MAAA,GAAAU,MAAA,EAAAT,KAAA;AAAA,SAAAU,yBAAA1B,MAAA,EAAA2B,QAAA,QAAA3B,MAAA,yBAAAJ,MAAA,GAAAgC,6BAAA,CAAA5B,MAAA,EAAA2B,QAAA,OAAAzB,GAAA,EAAAL,CAAA,MAAAX,MAAA,CAAAC,qBAAA,QAAA0C,gBAAA,GAAA3C,MAAA,CAAAC,qBAAA,CAAAa,MAAA,QAAAH,CAAA,MAAAA,CAAA,GAAAgC,gBAAA,CAAA9B,MAAA,EAAAF,CAAA,MAAAK,GAAA,GAAA2B,gBAAA,CAAAhC,CAAA,OAAA8B,QAAA,CAAAG,OAAA,CAAA5B,GAAA,uBAAAhB,MAAA,CAAA6C,SAAA,CAAAC,oBAAA,CAAAT,IAAA,CAAAvB,MAAA,EAAAE,GAAA,aAAAN,MAAA,CAAAM,GAAA,IAAAF,MAAA,CAAAE,GAAA,cAAAN,MAAA;AAAA,SAAAgC,8BAAA5B,MAAA,EAAA2B,QAAA,QAAA3B,MAAA,yBAAAJ,MAAA,WAAAqC,UAAA,GAAA/C,MAAA,CAAAD,IAAA,CAAAe,MAAA,OAAAE,GAAA,EAAAL,CAAA,OAAAA,CAAA,MAAAA,CAAA,GAAAoC,UAAA,CAAAlC,MAAA,EAAAF,CAAA,MAAAK,GAAA,GAAA+B,UAAA,CAAApC,CAAA,OAAA8B,QAAA,CAAAG,OAAA,CAAA5B,GAAA,kBAAAN,MAAA,CAAAM,GAAA,IAAAF,MAAA,CAAAE,GAAA,YAAAN,MAAA,IAFtC;AAYO,SAASsC,gBAAgBA,CAAAC,IAAA,EAGoB;EAAA,IAFlDC,EAAE,GAAAD,IAAA,CAAFC,EAAE;IACCC,OAAO,GAAAX,wBAAA,CAAAS,IAAA;EAEV,IAAIG,OAA+B,GAAG,IAAI;EAC1C,IAAIC,MAA8B,GAAG,IAAI;EACzC,IAAIC,OAA8B,GAAG,IAAI;EAEzC,SAASC,SAASA,CAAA,EAAoC;IACpD,IAAIC,MAAqB;IACzB,IAAMC,WAAW,GAAGH,OAAO;IAC3B,IAAMI,UAAU,GAAGL,MAAM;IAEzBD,OAAO,GAAG,IAAI;IACdC,MAAM,GAAG,IAAI;IACbC,OAAO,GAAG,IAAI;IAEd,IAAI;MAAA,SAAAK,IAAA,GAAA/C,SAAA,CAAAC,MAAA,EAT2B+C,IAAI,OAAAC,KAAA,CAAAF,IAAA,GAAAG,IAAA,MAAAA,IAAA,GAAAH,IAAA,EAAAG,IAAA;QAAJF,IAAI,CAAAE,IAAA,IAAAlD,SAAA,CAAAkD,IAAA;MAAA;MAUjCN,MAAM,GAAGN,EAAE,CAAC1C,KAAK,CAAC,IAAI,EAAEoD,IAAI,CAAC;MAC7BG,UAAU,CAAC,YAAM;QACfN,WAAW,CAACD,MAAM,CAAC;MACrB,CAAC,EAAE,CAAC,CAAC;MACL,OAAOA,MAAM;IACf,CAAC,CAAC,OAAOQ,KAAU,EAAuC;MACxDD,UAAU,CAAC,YAAM;QACfL,UAAU,CAACM,KAAK,CAAC;MACnB,CAAC,EAAE,CAAC,CAAC;MACL,MAAMA,KAAK;IACb;EACF;EAEA,IAAMC,SAAS,GAAG,IAAAC,kBAAQ,EAAAzD,aAAA;IACxByC,EAAE,EAAEK;EAAS,GACVJ,OAAO,CACX,CAAC;EAEF,SAASgB,iBAAiBA,CAAA,EAGA;IACxB,IAAI,CAACf,OAAO,EAAE;MACZA,OAAO,GAAG,IAAIgB,OAAO,CAAC,UAACC,cAAc,EAAEC,aAAa,EAAK;QACvDhB,OAAO,GAAGe,cAAc;QACxBhB,MAAM,GAAGiB,aAAa;MACxB,CAAC,CAAC;IACJ;IAAC,SAAAC,KAAA,GAAA3D,SAAA,CAAAC,MAAA,EAPE+C,IAAI,OAAAC,KAAA,CAAAU,KAAA,GAAAC,KAAA,MAAAA,KAAA,GAAAD,KAAA,EAAAC,KAAA;MAAJZ,IAAI,CAAAY,KAAA,IAAA5D,SAAA,CAAA4D,KAAA;IAAA;IAQPP,SAAS,CAACzD,KAAK,CAAC,IAAI,EAAEoD,IAAI,CAAC;IAC3B,OAAOR,OAAO;EAChB;EAEA,SAASqB,MAAMA,CAAA,EAAG;IAChB,IAAMjB,MAAM,GAAGS,SAAS,CAACQ,MAAM,CAAC,CAAC;IACjC,IAAIrB,OAAO,EAAE;MACX,IAAMM,UAAU,GAAGL,MAAM;MACzBD,OAAO,GAAG,IAAI;MACdE,OAAO,GAAG,IAAI;MACdD,MAAM,GAAG,IAAI;MACbU,UAAU,CAAC;QAAA,OAAML,UAAU,CAAC,IAAIgB,KAAK,CAAC,WAAW,CAAC,CAAC;MAAA,GAAE,CAAC,CAAC;IACzD;IACA,OAAOlB,MAAM;EACf;EAEAW,iBAAiB,CAACM,MAAM,GAAGA,MAAM;EACjCN,iBAAiB,CAACQ,KAAK,GAAGV,SAAS,CAACU,KAAK;EAEzC,OAAOR,iBAAiB;AAC1B"}
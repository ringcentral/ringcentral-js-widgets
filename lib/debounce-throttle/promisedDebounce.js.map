{"version":3,"file":"promisedDebounce.js","names":["_debounce","require","_excluded","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_toPropertyKey","value","configurable","writable","i","_toPrimitive","_typeof","Symbol","toPrimitive","call","TypeError","String","Number","_objectWithoutProperties","_objectWithoutPropertiesLoose","n","indexOf","propertyIsEnumerable","hasOwnProperty","promisedDebounce","_ref","fn","options","promise","reject","resolve","wrappedFn","result","lastResolve","lastReject","_len","args","Array","_key","setTimeout","error","debounced","debounce","debouncePromiseFn","Promise","promiseResolve","promiseReject","_len2","_key2","cancel","Error","flush"],"sources":["lib/debounce-throttle/promisedDebounce.ts"],"sourcesContent":["// @ts-nocheck\nimport type { DebouncedFunction, DebounceOptions } from './debounce';\nimport { debounce } from './debounce';\n\nexport interface PromisedDebounceFunction<\n  F extends (this: any, ...args: any) => any,\n> {\n  (this: any, ...args: Parameters<F>): Promise<ReturnType<F>>;\n  cancel: DebouncedFunction<F>['cancel'];\n  flush: DebouncedFunction<F>['flush'];\n}\n\nexport function promisedDebounce<F extends (...args: any) => any>({\n  fn,\n  ...options\n}: DebounceOptions<F>): PromisedDebounceFunction<F> {\n  let promise: Promise<ReturnType<F>> = null;\n  let reject: (reason?: any) => void = null;\n  let resolve: (value?: any) => void = null;\n\n  function wrappedFn(this: any, ...args: Parameters<F>) {\n    let result: ReturnType<F>;\n    const lastResolve = resolve;\n    const lastReject = reject;\n\n    promise = null;\n    reject = null;\n    resolve = null;\n\n    try {\n      result = fn.apply(this, args);\n      setTimeout(() => {\n        lastResolve(result);\n      }, 0);\n      return result;\n    } catch (error: any /** TODO: confirm with instanceof */) {\n      setTimeout(() => {\n        lastReject(error);\n      }, 0);\n      throw error;\n    }\n  }\n\n  const debounced = debounce({\n    fn: wrappedFn,\n    ...options,\n  });\n\n  function debouncePromiseFn(\n    this: any,\n    ...args: Parameters<F>\n  ): Promise<ReturnType<F>> {\n    if (!promise) {\n      promise = new Promise((promiseResolve, promiseReject) => {\n        resolve = promiseResolve;\n        reject = promiseReject;\n      });\n    }\n    debounced.apply(this, args);\n    return promise;\n  }\n\n  function cancel() {\n    const result = debounced.cancel();\n    if (promise) {\n      const lastReject = reject;\n      promise = null;\n      resolve = null;\n      reject = null;\n      setTimeout(() => lastReject(new Error('cancelled')), 0);\n    }\n    return result;\n  }\n\n  debouncePromiseFn.cancel = cancel;\n  debouncePromiseFn.flush = debounced.flush;\n\n  return debouncePromiseFn;\n}\n"],"mappings":"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","ignoreList":[]}
{"version":3,"file":"Tabbie.js","names":["_ObjectMap","require","_events","_uuid","_typeof","o","Symbol","iterator","constructor","prototype","_toConsumableArray","r","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","Array","isArray","_arrayLikeToArray","_toArray","_arrayWithHoles","_nonIterableRest","a","t","toString","call","slice","name","from","test","length","e","n","_regenerator","toStringTag","i","c","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","d","bind","l","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","w","m","defineProperty","_regeneratorDefine","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_classCallCheck","_defineProperties","_toPropertyKey","key","_createClass","_toPrimitive","toPrimitive","String","Number","HEART_BEAT_INTERVAL","HEART_BEAT_EXPIRE","GC_INTERVAL","getPrefix","exports","prefix","concat","getEventKey","TabbieEvents","ObjectMap","fromKeys","Tabbie","_ref","_this","_ref$prefix","_ref$heartBeatInterva","heartBeatInterval","_ref$heartBeatExpire","heartBeatExpire","_ref$gcInterval","gcInterval","_ref$autoMainTab","autoMainTab","isMainTab","id","v4","enabled","_emitter","EventEmitter","_autoMainTab","_isMainTab","_mainTabKey","_heartBeatKey","_heartBeatRegExp","_eventKey","_eventRegExp","_heartBeatExpire","_heartBeatInterval","_gcInterval","_heartBeatIntervalId","_gcIntervalId","_heartBeat","localStorage","setItem","Date","now","_gc","_callee","expiredCut","isMainTabAlive","mainTabId","tabs","len","isExpired","_context","getMainTabId","getItem","_getActualId","removeItem","_setFirstTabAsMainTab","_setAsVisibleTab","document","hidden","setAsMainTab","window","visibilityState","preFixHeartBeatKey","RegExp","_bindInterval","_bindStorageListener","_bindVisibilityListener","_bindUnloadListener","get","_getHeartBeatKeys","_this2","map","tab","firstTabId","_this3","filter","Math","floor","setInterval","addEventListener","_this4","_ref4","_callee2","_ref3","newValue","payload","_payload","event","args","_this4$_emitter","_t","_t2","_t3","_t4","_context2","events","mainTabIdChanged","emit","JSON","parse","_x","_this5","clearInterval","send","_len","_key","stringify","_getMainTabId","_callee3","_this6","_context3","once","_checkIsMain","_callee4","_t5","_t6","_t7","_context4","checkIsMain","checkTabAliveById","_this7","some","on","_this$_emitter","replace","results","Set","add","undefined","isFirstTab"],"sources":["lib/Tabbie.ts"],"sourcesContent":["// @ts-nocheck\nimport { ObjectMap } from '@ringcentral-integration/core/lib/ObjectMap';\nimport { EventEmitter } from 'events';\nimport { v4 } from 'uuid';\n\nconst HEART_BEAT_INTERVAL = 1000;\n// heartbeat older than HEART_BEAT_EXPIRE will be gc'ed\n// chrome and firefox throttles intervals when inactive expire time of 2000\n// sometimes would kill live heartbeats and cause the mainTabId to change\nconst HEART_BEAT_EXPIRE = 3000;\nconst GC_INTERVAL = 5000;\nexport const getPrefix = (prefix: string): string =>\n  prefix && prefix !== '' ? `${prefix}-` : '';\nexport const getEventKey = (prefix: string): string => `${prefix}tabbie-event-`;\n\nconst TabbieEvents = ObjectMap.fromKeys(['mainTabIdChanged', 'event']);\n/**\n * @class\n * @description The base active tab and cross tab event handling class.\n */\nexport class Tabbie {\n  id = v4();\n  enabled: boolean;\n  prefix: string;\n\n  private _emitter = new EventEmitter();\n\n  private _autoMainTab?: boolean;\n  private _isMainTab?: boolean;\n  private _mainTabKey: string;\n\n  private _heartBeatKey: string;\n  private _heartBeatRegExp: RegExp;\n\n  private _eventKey: string;\n  private _eventRegExp: RegExp;\n\n  private _heartBeatExpire: number;\n  private _heartBeatInterval: number;\n  private _gcInterval: number;\n  private _heartBeatIntervalId: NodeJS.Timeout;\n  private _gcIntervalId: NodeJS.Timeout;\n\n  get events() {\n    return TabbieEvents;\n  }\n\n  get mainTabId() {\n    return localStorage.getItem(this._mainTabKey);\n  }\n\n  get isMainTab() {\n    return this.mainTabId === this.id;\n  }\n\n  get tabs() {\n    return this._getHeartBeatKeys();\n  }\n\n  get actualTabIds() {\n    return this.tabs.map((tab) => this._getActualId(tab));\n  }\n\n  get firstTabId() {\n    const tabs = this.tabs;\n    if (tabs.length) {\n      return this._getActualId(tabs[0]);\n    }\n    return null;\n  }\n\n  get isFirstTab() {\n    return this.id === this.firstTabId;\n  }\n\n  get hasMultipleTabs() {\n    return (\n      this.enabled &&\n      this.tabs.filter(\n        (key) =>\n          Date.now() - Math.floor(+localStorage.getItem(key)) <\n          this._heartBeatInterval * 2 - 100,\n      ).length > 1\n    );\n  }\n\n  constructor({\n    prefix = '',\n    heartBeatInterval = HEART_BEAT_INTERVAL,\n    heartBeatExpire = HEART_BEAT_EXPIRE,\n    gcInterval = GC_INTERVAL,\n    autoMainTab = true,\n    isMainTab,\n  }: {\n    prefix?: string;\n    heartBeatInterval?: number;\n    heartBeatExpire?: number;\n    gcInterval?: number;\n    autoMainTab?: boolean;\n    isMainTab?: boolean;\n  }) {\n    this.prefix = getPrefix(prefix);\n    this._heartBeatInterval = heartBeatInterval;\n    this._heartBeatExpire = heartBeatExpire;\n    this._gcInterval = gcInterval;\n    this._autoMainTab = autoMainTab;\n    this._isMainTab = isMainTab;\n\n    this.enabled =\n      typeof window !== 'undefined' &&\n      typeof document.visibilityState !== 'undefined' &&\n      typeof localStorage !== 'undefined';\n\n    const preFixHeartBeatKey = `${this.prefix}tabbie-heartBeat-`;\n    this._heartBeatKey = `${preFixHeartBeatKey}${this.id}`;\n    this._mainTabKey = `${this.prefix}tabbie-mainTab-id`;\n    this._eventKey = getEventKey(this.prefix);\n\n    this._heartBeatRegExp = new RegExp(`^${preFixHeartBeatKey}`);\n    this._eventRegExp = new RegExp(`^${this._eventKey}`);\n\n    if (this.enabled) {\n      this._bindInterval();\n      this._bindStorageListener();\n      if (autoMainTab) {\n        this._bindVisibilityListener();\n        if (!document.hidden) {\n          this.setAsMainTab();\n        } else if (!this.mainTabId) {\n          this._setFirstTabAsMainTab();\n        }\n      } else if (isMainTab === true) {\n        this.setAsMainTab();\n      }\n      this._bindUnloadListener();\n    }\n  }\n\n  private _bindInterval() {\n    this._heartBeat();\n    this._heartBeatIntervalId = setInterval(\n      this._heartBeat,\n      this._heartBeatInterval,\n    );\n\n    this._gcIntervalId = setInterval(this._gc, this._gcInterval);\n  }\n\n  private _bindVisibilityListener() {\n    document.addEventListener('visibilitychange', this._setAsVisibleTab);\n    window.addEventListener('focus', this._setAsVisibleTab);\n  }\n\n  private _bindStorageListener() {\n    window.addEventListener('storage', async ({ key, newValue }) => {\n      if (key === this._mainTabKey) {\n        // use the newest main tab id from localhost instead of from the event\n        // to avoid race conditions\n        this._emitter.emit(\n          this.events.mainTabIdChanged,\n          await this.getMainTabId(),\n        );\n      } else if (\n        this._heartBeatRegExp.test(key) &&\n        (!newValue || newValue === '')\n      ) {\n        if (this._getActualId(key) === (await this.getMainTabId())) {\n          this._setFirstTabAsMainTab();\n        }\n      } else if (this._eventRegExp.test(key) && newValue && newValue !== '') {\n        const payload = JSON.parse(newValue);\n        const [id, event, ...args] = payload;\n        if (id !== this.id) {\n          // ie fires storage event on original\n          this._emitter.emit(this.events.event, event, ...args);\n        }\n      }\n    });\n  }\n\n  private _bindUnloadListener() {\n    window.addEventListener('pagehide', () => {\n      clearInterval(this._gcIntervalId);\n      clearInterval(this._heartBeatIntervalId);\n      localStorage.removeItem(this._heartBeatKey);\n      if (this.isMainTab) {\n        localStorage.removeItem(this._mainTabKey);\n      }\n    });\n  }\n\n  send(event: string, ...args: any[]) {\n    if (!window.document || !this.enabled) {\n      return;\n    }\n\n    const key = `${this._eventKey}${v4()}`;\n\n    const payload = [this.id, event, ...args];\n    localStorage.setItem(key, JSON.stringify(payload));\n    localStorage.removeItem(key);\n  }\n\n  /**\n   * @function\n   * @return {Promise} - Resolves to current main tab id\n   */\n  async getMainTabId(): Promise<string> {\n    const mainTabId = this.mainTabId;\n    if (mainTabId) return mainTabId;\n    return new Promise<string>((resolve) => {\n      this._emitter.once(this.events.mainTabIdChanged, resolve);\n    });\n  }\n\n  /**\n   * check current tab is main tab.\n   */\n  async checkIsMain() {\n    // assume main if not enabled\n    // this is to ensure that modules depending on this would function\n    // in node like environments\n    if (!this._autoMainTab) {\n      return !!this._isMainTab;\n    }\n    return !this.enabled || (await this.getMainTabId()) === this.id;\n  }\n\n  /**\n   * check tab alive state by tabId\n   * @param id tabId you want to check\n   */\n  checkTabAliveById(id: string) {\n    return this.tabs.some((key) => this._getActualId(key) === id);\n  }\n\n  on(...args: Parameters<EventEmitter['on']>) {\n    return this._emitter.on(...args);\n  }\n\n  private _getActualId(key: string) {\n    return key.replace(this._heartBeatRegExp, '');\n  }\n\n  private _heartBeat = () => {\n    localStorage.setItem(this._heartBeatKey, `${Date.now()}`);\n  };\n\n  // When there is some problem when not remove item from storage, that will remove by gc\n  private _gc = async () => {\n    const expiredCut = Date.now() - this._heartBeatExpire;\n    let isMainTabAlive = false;\n    const mainTabId = await this.getMainTabId();\n    const tabs = this.tabs;\n\n    for (let i = 0, len = tabs.length; i < len; i++) {\n      const key = tabs[i];\n      const isExpired = +localStorage.getItem(key) < expiredCut;\n      const isMainTab = this._getActualId(key) === mainTabId;\n\n      if (isExpired) {\n        localStorage.removeItem(key);\n      }\n\n      if (isMainTab) {\n        isMainTabAlive = !isExpired;\n      }\n    }\n\n    // if mainTab is not alive reset mainTab to firstTab\n    if (!isMainTabAlive) {\n      this._setFirstTabAsMainTab();\n    }\n  };\n\n  private _getHeartBeatKeys() {\n    const results = new Set<string>();\n\n    for (let i = 0; i < localStorage.length; i += 1) {\n      const key = localStorage.key(i);\n      if (key && key !== '' && this._heartBeatRegExp.test(key)) {\n        results.add(key);\n      }\n    }\n    return [...results];\n  }\n\n  public setAsMainTab(id = this.id) {\n    localStorage.setItem(this._mainTabKey, id);\n    this._emitter.emit(this.events.mainTabIdChanged, id);\n  }\n\n  private _setAsVisibleTab = () => {\n    // avoid setting mainTabId repeatedly which may result in forced rendering\n    if (!document.hidden && !this.isMainTab) {\n      this.setAsMainTab();\n    }\n  };\n\n  private _setFirstTabAsMainTab() {\n    if (this.isFirstTab) {\n      localStorage.removeItem(this._mainTabKey);\n      this.setAsMainTab();\n    }\n  }\n}\n"],"mappings":"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","ignoreList":[]}
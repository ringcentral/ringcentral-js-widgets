{"version":3,"sources":["helpers/meetingHelper.ts"],"names":["getMobileDialingNumberTpl","dialInNumbers","meetingId","map","phoneNumber","location","join","getPhoneDialingNumberTpl","country","filterFormattedNumber","countryCode","isoCode","type","formatTypes","international","UTC_TIMEZONE_ID","isRecurringMeeting","meetingType","MeetingType","RECURRING","SCHEDULED_RECURRING","getMeetingSettings","extensionName","startTime","durationInMinutes","topic","currentLocale","i18n","getString","SCHEDULED","password","schedule","timeZone","id","host","allowJoinBeforeHost","startHostVideo","startParticipantsVideo","audioOptions","getDefaultTopic","getDefaultMeetingSettings","hostId","usePersonalMeetingId","_requireMeetingPassword","_showDate","_showTime","_saved","getInitializedStartTime","now","Date","setHours","getHours","preferencesMembers","prunePreferencesObject","meeting","preferences","comparePreferences","preferencesChanged","key","generateRandomPassword","length","charset","charLen","retVal","i","charAt","Math","floor","random","updateFullYear","preTime","currTime","y","getFullYear","m","getMonth","d","getDate","setFullYear","updateFullTime","newTime","setMinutes","getMinutes","setSeconds","getSeconds"],"mappings":"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","sourcesContent":["import formatMessage from 'format-message';\nimport { pick } from 'ramda';\n\nimport format, {\n  formatTypes,\n} from '@ringcentral-integration/phone-number/lib/format';\n\nimport i18n from '../modules/MeetingV2/i18n';\nimport { RcMMeetingModel } from '../modules/MeetingV2/Meeting.interface';\nimport { MeetingType, MeetingTypeV } from './meetingHelper.interface';\n\nfunction getMobileDialingNumberTpl(dialInNumbers, meetingId) {\n  return dialInNumbers\n    .map(({ phoneNumber, location = '' }) =>\n      location\n        ? `${phoneNumber},,${meetingId}# (${location})`\n        : `${phoneNumber},,${meetingId}#`,\n    )\n    .join('\\n    ');\n}\n\nfunction getPhoneDialingNumberTpl(dialInNumbers) {\n  return dialInNumbers\n    .map(({ phoneNumber, location = '', country }) => {\n      const filterFormattedNumber = format({\n        phoneNumber,\n        countryCode: country.isoCode,\n        type: formatTypes.international,\n      });\n      return location\n        ? `${filterFormattedNumber} (${location})`\n        : `${filterFormattedNumber}`;\n    })\n    .join('\\n    ');\n}\n\nconst UTC_TIMEZONE_ID = '1';\n\nfunction isRecurringMeeting(meetingType: MeetingTypeV) {\n  return (\n    meetingType === MeetingType.RECURRING ||\n    meetingType === MeetingType.SCHEDULED_RECURRING\n  );\n}\n\nfunction getMeetingSettings({\n  extensionName,\n  startTime,\n  durationInMinutes = 60,\n  topic = '',\n  currentLocale = 'en-US',\n}) {\n  return {\n    topic:\n      topic ||\n      formatMessage(i18n.getString('meetingTitle', currentLocale), {\n        extensionName,\n      }),\n    meetingType: MeetingType.SCHEDULED,\n    password: '',\n    schedule: {\n      startTime,\n      durationInMinutes,\n      timeZone: {\n        id: UTC_TIMEZONE_ID,\n      },\n    },\n    host: {\n      id: null,\n    },\n    allowJoinBeforeHost: false,\n    startHostVideo: false,\n    startParticipantsVideo: false,\n    audioOptions: ['Phone', 'ComputerAudio'],\n  };\n}\n\nfunction getDefaultTopic(\n  extensionName: string,\n  currentLocale: string = 'en-US',\n) {\n  return formatMessage(i18n.getString('meetingTitle', currentLocale), {\n    extensionName,\n  });\n}\n\n// Basic default meeting type information\nfunction getDefaultMeetingSettings(\n  extensionName: string,\n  currentLocale: string = 'en-US',\n  startTime: number,\n  hostId?: string,\n): RcMMeetingModel {\n  return {\n    topic: getDefaultTopic(extensionName, currentLocale),\n    meetingType: MeetingType.SCHEDULED,\n    password: '',\n    schedule: {\n      startTime,\n      durationInMinutes: 60,\n      timeZone: {\n        id: UTC_TIMEZONE_ID,\n      },\n    },\n    host: {\n      id: hostId ?? null,\n    },\n    allowJoinBeforeHost: false,\n    startHostVideo: false,\n    startParticipantsVideo: false,\n    audioOptions: ['Phone', 'ComputerAudio'],\n    usePersonalMeetingId: false,\n    _requireMeetingPassword: false,\n    _showDate: false,\n    _showTime: false,\n    _saved: false,\n  };\n}\n\nfunction getInitializedStartTime(): number {\n  const now = new Date();\n  const startTime = now.setHours(now.getHours() + 1, 0, 0, 0);\n  return startTime;\n}\n\nconst preferencesMembers = [\n  'allowJoinBeforeHost',\n  'startHostVideo',\n  'startParticipantsVideo',\n  '_requireMeetingPassword',\n];\n\nfunction prunePreferencesObject(meeting) {\n  const preferences = pick(preferencesMembers, meeting);\n  return preferences;\n}\n\nfunction comparePreferences(preferences, meeting): boolean {\n  let preferencesChanged = false;\n  if (preferences && meeting) {\n    for (const key in preferences) {\n      if (preferences[key] !== meeting[key]) {\n        preferencesChanged = true;\n        break;\n      }\n    }\n  }\n  return preferencesChanged;\n}\n\nfunction generateRandomPassword(length: number = 6): string {\n  const charset = '0123456789';\n  const charLen = charset.length;\n  let retVal = '';\n  for (let i = 0; i < length; i++) {\n    retVal += charset.charAt(Math.floor(Math.random() * charLen));\n  }\n  return retVal;\n}\n\n// only update the date part (container year, month, day)\nfunction updateFullYear(preTime: Date, currTime: Date): number {\n  const y = currTime.getFullYear();\n  const m = currTime.getMonth();\n  const d = currTime.getDate();\n  return preTime.setFullYear(y, m, d);\n}\n\n// only update the time part (container hour, minute, second)\nfunction updateFullTime(preTime: Date, currTime: Date | number): Date {\n  const newTime = new Date(currTime);\n  preTime.setHours(newTime.getHours());\n  preTime.setMinutes(newTime.getMinutes());\n  preTime.setSeconds(newTime.getSeconds());\n  return preTime;\n}\n\n// TODO: will remove this when google app script could support export seperately\n// export together because google app script not fully support export\nexport {\n  comparePreferences,\n  generateRandomPassword,\n  getDefaultMeetingSettings,\n  getDefaultTopic,\n  getInitializedStartTime,\n  getMeetingSettings,\n  getMobileDialingNumberTpl,\n  getPhoneDialingNumberTpl,\n  isRecurringMeeting,\n  MeetingType,\n  prunePreferencesObject,\n  updateFullTime,\n  updateFullYear,\n  UTC_TIMEZONE_ID,\n};\n"],"file":"meetingHelper.js"}
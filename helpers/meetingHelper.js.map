{"version":3,"file":"meetingHelper.js","names":["_format","_interopRequireWildcard","require","_utils","_ramda","_i18n","_interopRequireDefault","_meetingHelper","e","__esModule","t","WeakMap","r","n","o","i","f","__proto__","_typeof","has","get","set","_t","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","getMobileDialingNumberTpl","dialInNumbers","meetingId","map","_ref","phoneNumber","_ref$location","location","concat","join","getPhoneDialingNumberTpl","_ref2","_ref2$location","country","filterFormattedNumber","formatPhoneNumber","countryCode","isoCode","type","formatTypes","international","UTC_TIMEZONE_ID","exports","isRecurringMeeting","meetingType","MeetingType","RECURRING","SCHEDULED_RECURRING","getDefaultTopic","extensionName","currentLocale","arguments","length","undefined","format","i18n","getString","getDefaultMeetingSettings","startTime","hostId","topic","SCHEDULED","password","schedule","durationInMinutes","timeZone","id","host","allowJoinBeforeHost","startHostVideo","startParticipantsVideo","audioOptions","usePersonalMeetingId","_requireMeetingPassword","_showDate","_showTime","_saved","getInitializedStartTime","now","Date","setHours","getHours","preferencesMembers","prunePreferencesObject","meeting","preferences","pick","comparePreferences","preferencesChanged","key","generateRandomPassword","charset","charLen","retVal","charAt","Math","floor","random","updateFullYear","preTime","currTime","y","getFullYear","m","getMonth","d","getDate","setFullYear","updateFullTime","newTime","setMinutes","getMinutes","setSeconds","getSeconds"],"sources":["helpers/meetingHelper.ts"],"sourcesContent":["import type DialInNumberResource from '@rc-ex/core/lib/definitions/DialInNumberResource';\nimport type { CountryCode } from '@ringcentral-integration/phone-number';\nimport formatPhoneNumber, {\n  formatTypes,\n} from '@ringcentral-integration/phone-number/lib/format';\nimport { format } from '@ringcentral-integration/utils';\nimport { pick } from 'ramda';\n\nimport type { RcMMeetingModel } from '../modules/Meeting/Meeting.interface';\nimport i18n from '../modules/Meeting/i18n';\n\nimport type { MeetingTypeV } from './meetingHelper.interface';\nimport { MeetingType } from './meetingHelper.interface';\n\nfunction getMobileDialingNumberTpl(\n  dialInNumbers: DialInNumberResource[],\n  meetingId: string,\n) {\n  return dialInNumbers\n    .map(({ phoneNumber, location = '' }) =>\n      location\n        ? `${phoneNumber},,${meetingId}# (${location})`\n        : `${phoneNumber},,${meetingId}#`,\n    )\n    .join('\\n    ');\n}\n\nfunction getPhoneDialingNumberTpl(dialInNumbers: DialInNumberResource[]) {\n  return dialInNumbers\n    .map(({ phoneNumber, location = '', country }) => {\n      const filterFormattedNumber = formatPhoneNumber({\n        phoneNumber: phoneNumber as string,\n        countryCode: country?.isoCode as CountryCode,\n        type: formatTypes.international,\n      });\n      return location\n        ? `${filterFormattedNumber} (${location})`\n        : `${filterFormattedNumber}`;\n    })\n    .join('\\n    ');\n}\n\nconst UTC_TIMEZONE_ID = '1';\n\nfunction isRecurringMeeting(meetingType: MeetingTypeV) {\n  return (\n    meetingType === MeetingType.RECURRING ||\n    meetingType === MeetingType.SCHEDULED_RECURRING\n  );\n}\n\nfunction getDefaultTopic(extensionName: string, currentLocale = 'en-US') {\n  return format(i18n.getString('meetingTitle', currentLocale), {\n    extensionName,\n  });\n}\n\n// Basic default meeting type information\nfunction getDefaultMeetingSettings(\n  extensionName: string,\n  currentLocale = 'en-US',\n  startTime: number,\n  hostId?: string,\n): Partial<RcMMeetingModel> {\n  return {\n    topic: getDefaultTopic(extensionName, currentLocale),\n    meetingType: MeetingType.SCHEDULED,\n    password: '',\n    schedule: {\n      startTime,\n      durationInMinutes: 60,\n      timeZone: {\n        id: UTC_TIMEZONE_ID,\n      },\n    },\n    host: {\n      id: hostId ?? null,\n    },\n    allowJoinBeforeHost: false,\n    startHostVideo: false,\n    startParticipantsVideo: false,\n    audioOptions: ['Phone', 'ComputerAudio'],\n    usePersonalMeetingId: false,\n    _requireMeetingPassword: false,\n    _showDate: false,\n    _showTime: false,\n    _saved: false,\n  };\n}\n\nfunction getInitializedStartTime(): number {\n  const now = new Date();\n  const startTime = now.setHours(now.getHours() + 1, 0, 0, 0);\n  return startTime;\n}\n\nconst preferencesMembers = [\n  'allowJoinBeforeHost',\n  'startHostVideo',\n  'startParticipantsVideo',\n  '_requireMeetingPassword',\n];\n\nfunction prunePreferencesObject(meeting: RcMMeetingModel) {\n  const preferences = pick(preferencesMembers, meeting);\n  return preferences;\n}\n\nfunction comparePreferences(\n  preferences: RcMMeetingModel,\n  meeting: RcMMeetingModel,\n) {\n  let preferencesChanged = false;\n  if (preferences && meeting) {\n    for (const key in preferences) {\n      if ((preferences as any)[key] !== (meeting as any)[key]) {\n        preferencesChanged = true;\n        break;\n      }\n    }\n  }\n  return preferencesChanged;\n}\n\nfunction generateRandomPassword(length = 6): string {\n  const charset = '0123456789';\n  const charLen = charset.length;\n  let retVal = '';\n  for (let i = 0; i < length; i++) {\n    retVal += charset.charAt(Math.floor(Math.random() * charLen));\n  }\n  return retVal;\n}\n\n// only update the date part (container year, month, day)\nfunction updateFullYear(preTime: Date, currTime: Date): number {\n  const y = currTime.getFullYear();\n  const m = currTime.getMonth();\n  const d = currTime.getDate();\n  return preTime.setFullYear(y, m, d);\n}\n\n// only update the time part (container hour, minute, second)\nfunction updateFullTime(preTime: Date, currTime: Date | number): Date {\n  const newTime = new Date(currTime);\n  preTime.setHours(newTime.getHours());\n  preTime.setMinutes(newTime.getMinutes());\n  preTime.setSeconds(newTime.getSeconds());\n  return preTime;\n}\n\n// TODO: will remove this when google app script could support export separately\n// export together because google app script not fully support export\nexport {\n  comparePreferences,\n  generateRandomPassword,\n  getDefaultMeetingSettings,\n  getDefaultTopic,\n  getInitializedStartTime,\n  getMobileDialingNumberTpl,\n  getPhoneDialingNumberTpl,\n  isRecurringMeeting,\n  MeetingType,\n  prunePreferencesObject,\n  updateFullTime,\n  updateFullYear,\n  UTC_TIMEZONE_ID,\n};\n"],"mappings":"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","ignoreList":[]}
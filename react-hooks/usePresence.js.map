{"version":3,"file":"usePresence.js","names":["_juno","require","_react","_reactUse","asyncGeneratorStep","n","t","e","r","o","a","c","i","u","value","done","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","_arrayLikeToArray","toString","call","slice","constructor","name","Array","from","test","length","l","Symbol","iterator","f","next","Object","push","isArray","usePresence","contact","_ref","_contact$presence","fetch","_ref$timeout","timeout","_useState","useState","presence","_useState2","setPresence","mounted","usePromise","_useSleep","useSleep","sleep","useEffect","fetchPresence","_fetchPresence","regeneratorRuntime","mark","_callee","result","wrap","_callee$","_context","prev","sent","stop","exports"],"sources":["react-hooks/usePresence.ts"],"sourcesContent":["import type {\n  ContactPresence,\n  IContact,\n} from '@ringcentral-integration/commons/interfaces/Contact.model';\nimport { useSleep } from '@ringcentral/juno';\nimport { useEffect, useState } from 'react';\nimport { usePromise } from 'react-use';\n\nexport type GetPresenceFn = (\n  contact: IContact,\n  useCache: boolean,\n) => Promise<ContactPresence | null>;\n\n/**\n * get presence state from contact, and that will auto get data from that fetch callback\n * @param contact\n * @param fetch fetch presence\n * @param timeout -1 means not to use timeout\n * @returns\n */\nexport const usePresence = (\n  contact: IContact & { presence?: ContactPresence },\n  {\n    fetch,\n    timeout = -1,\n  }: {\n    fetch: GetPresenceFn | undefined;\n    timeout?: number;\n  },\n) => {\n  const [presence, setPresence] = useState(contact?.presence ?? null);\n  const mounted = usePromise();\n  const { sleep } = useSleep();\n  useEffect(() => {\n    async function fetchPresence() {\n      if (fetch && contact) {\n        const result = await mounted(fetch!(contact, true));\n        setPresence(result);\n      } else {\n        setPresence(null);\n      }\n    }\n    if (timeout >= 0) {\n      sleep(timeout).then(() => {\n        fetchPresence();\n      });\n    } else {\n      fetchPresence();\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [contact, fetch]);\n  return presence;\n};\n"],"mappings":"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","ignoreList":[]}
{"version":3,"file":"WebSocketSubscription.js","names":["_core","require","_background","_interopRequireDefault","_debounceThrottle","_di","_proxify","_webSocketReadyStates","_normalizeEventFilter","_dec","_class","_class2","_descriptor","_descriptor2","_descriptor3","_descriptor4","e","__esModule","asyncGeneratorStep","n","t","r","o","a","c","i","u","value","done","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_initializerDefineProperty","l","Object","defineProperty","enumerable","configurable","writable","initializer","call","_classCallCheck","TypeError","_defineProperties","length","_toPropertyKey","key","_createClass","prototype","_toPrimitive","_typeof","Symbol","toPrimitive","String","Number","_inherits","create","constructor","_setPrototypeOf","setPrototypeOf","bind","__proto__","_createSuper","_isNativeReflectConstruct","_getPrototypeOf","s","Reflect","construct","_possibleConstructorReturn","_assertThisInitialized","ReferenceError","Boolean","valueOf","getPrototypeOf","_initializerWarningHelper","Error","_applyDecoratedDescriptor","keys","forEach","slice","reverse","reduce","DEFAULT_REFRESH_DELAY","process","env","NODE_ENV","SyncMessageTabEventName","exports","WebSocketSubscription","Module","name","deps","dep","optional","_RcModuleV","_super","_this","enableCache","storageKey","_wsSubscription","_debouncedUpdateSubscription","promisedDebounce","fn","_updateSubscription","threshold","_onInitOnce","regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","_bindEvents","stop","onInitOnce","_onInitSuccess","_callee2","_callee2$","_context2","_debouncedUpdateSubscriptionCatchCancel","onInitSuccess","_onReset","_callee3","_callee3$","_context3","cancel","_removeSubscription","onReset","_debouncedUpdateSubscriptionCatchCancel2","_callee4","_callee4$","_context4","t0","message","_bindEvents2","_callee6","_this2","_callee6$","_context6","watch","_deps","ringCentralExtensions","webSocketReadyState","_ref","_callee5","wsState","_callee5$","_context5","ready","abrupt","webSocketReadyStates","closing","_revokeSubscription","_x","onlyOneTabConnected","tabManager","event","_tabEventHandler","_notifyMessage","args","_syncMessageToOtherTabs2","_callee7","_this$_deps$tabManage","_callee7$","_context7","send","_syncMessageToOtherTabs","_x2","_setTokens","subscriptionInfo","subscriptionChannel","_saveTokens","_this$_wsSubscription","webSocketExtension","ws","url","_clearTokens","_obtainSubscription2","_callee8","_this3","_subscription$subscri","isNewChannel","subscription","isNewSubscription","_callee8$","_context8","isTheSameWebSocket","console","log","concat","subscribe","filters","sent","id","_obtainSubscription","_refreshSubscription2","_callee9","_callee9$","_context9","eventFilters","refresh","_refreshSubscription","_revokeSubscription2","_callee10","_callee10$","_context10","revoke","client","service","platform","uri","warn","undefined","_removeSubscription2","_callee11","_callee11$","_context11","remove","ex","_updateSubscription2","_callee12","_this$_wsSubscription2","_this$_wsSubscription3","_callee12$","_context12","isWebSocketReady","map","x","normalizeEventFilter","sort","join","_subscribe","_callee13","eventsFilters","oldLength","_args13","_callee13$","_context13","_addFilters","_unsubscribe","_callee14","_args14","_callee14$","_context14","_removeFilters","unsubscribe","filter","index","array","indexOf","includes","get","disconnectOnInactive","RcModuleV2","background","getOwnPropertyDescriptor","storage","state","action","proxify"],"sources":["modules/WebSocketSubscription/WebSocketSubscription.ts"],"sourcesContent":["import type SubscriptionInfo from '@rc-ex/core/lib/definitions/SubscriptionInfo';\nimport type Subscription from '@rc-ex/ws/lib/subscription';\nimport {\n  action,\n  RcModuleV2,\n  state,\n  storage,\n  watch,\n} from '@ringcentral-integration/core';\n\nimport type { SubscriptionFilter } from '../../enums/subscriptionFilters';\nimport background from '../../lib/background';\nimport { promisedDebounce } from '../../lib/debounce-throttle';\nimport { Module } from '../../lib/di';\nimport { proxify } from '../../lib/proxy/proxify';\nimport { webSocketReadyStates } from '../RingCentralExtensions/webSocketReadyStates';\nimport type { TabEvent } from '../TabManager';\n\nimport type { Deps } from './WebSocketSubscription.interface';\nimport {\n  isTheSameWebSocket,\n  normalizeEventFilter,\n} from './normalizeEventFilter';\n\nconst DEFAULT_REFRESH_DELAY = process.env.NODE_ENV === 'test' ? 0 : 1000;\nexport const SyncMessageTabEventName = 'WebSocketSubscription-syncMessage';\n\n@Module({\n  name: 'WebSocketSubscription',\n  deps: [\n    'Client',\n    'Storage',\n    'RingCentralExtensions',\n    { dep: 'TabManager', optional: true },\n    { dep: 'WebSocketSubscriptionOptions', optional: true },\n  ],\n})\nexport class WebSocketSubscription extends RcModuleV2<Deps> {\n  private _wsSubscription?: Subscription;\n\n  constructor(deps: Deps) {\n    super({\n      deps,\n      enableCache: true,\n      storageKey: 'WebSocketSubscription',\n    });\n  }\n\n  override async onInitOnce() {\n    await this._bindEvents();\n  }\n\n  override async onInitSuccess() {\n    await this._debouncedUpdateSubscriptionCatchCancel();\n  }\n\n  override async onReset() {\n    this._debouncedUpdateSubscription.cancel();\n    await this._removeSubscription();\n  }\n\n  private async _debouncedUpdateSubscriptionCatchCancel() {\n    try {\n      await this._debouncedUpdateSubscription();\n    } catch (error: any /** TODO: confirm with instanceof */) {\n      if (error.message !== 'cancelled') {\n        throw error;\n      }\n    }\n  }\n\n  get onlyOneTabConnected(): boolean {\n    return this._deps.ringCentralExtensions.disconnectOnInactive;\n  }\n\n  @background\n  private async _bindEvents() {\n    watch(\n      this,\n      () => this._deps.ringCentralExtensions.webSocketReadyState,\n      async (wsState) => {\n        if (!this.ready || !wsState) {\n          return;\n        }\n        if (wsState === webSocketReadyStates.ready) {\n          await this._updateSubscription();\n        } else if (wsState === webSocketReadyStates.closing) {\n          // when websocket is going to close, revoke subscription beforehand\n          await this._revokeSubscription();\n        } else {\n          this._debouncedUpdateSubscription.cancel();\n          await this._removeSubscription();\n        }\n      },\n    );\n    if (this.onlyOneTabConnected) {\n      watch(\n        this,\n        () => this._deps.tabManager!.event,\n        (event) => {\n          this._tabEventHandler(event);\n        },\n      );\n    }\n  }\n\n  private _tabEventHandler(event: TabEvent) {\n    if (!this.ready || !event) {\n      return;\n    }\n    if (event.name === SyncMessageTabEventName) {\n      this._notifyMessage(event.args![0]);\n    }\n  }\n\n  private async _syncMessageToOtherTabs(message: unknown) {\n    // sync notification message to other tabs, so that other tabs got the latest message state\n    await this._deps.tabManager?.send(SyncMessageTabEventName, message);\n  }\n\n  @storage\n  @state\n  subscriptionInfo?: SubscriptionInfo | null = null;\n\n  @storage\n  @state\n  subscriptionChannel?: string | null = null;\n\n  @action\n  private _setTokens(\n    subscriptionInfo?: SubscriptionInfo | null,\n    subscriptionChannel?: string | null,\n  ) {\n    this.subscriptionInfo = subscriptionInfo ?? null;\n    this.subscriptionChannel = subscriptionChannel ?? null;\n  }\n\n  private _saveTokens() {\n    this._setTokens(\n      this._wsSubscription?.subscriptionInfo,\n      this._deps.ringCentralExtensions.webSocketExtension.ws.url,\n    );\n  }\n\n  private _clearTokens() {\n    this._setTokens(null, null);\n  }\n\n  private async _obtainSubscription() {\n    const isNewChannel =\n      !this.subscriptionChannel ||\n      !isTheSameWebSocket(\n        this.subscriptionChannel,\n        this._deps.ringCentralExtensions.webSocketExtension.ws.url,\n      );\n    if (process.env.NODE_ENV !== 'test') {\n      console.log(\n        `[WebSocketSubscription] > _obtainSubscription > isNewChannel: ${isNewChannel}`,\n      );\n    }\n\n    // For reduce the total number of subscriptions (ttl 24 hours, limited number 20),\n    // Revoke existing subscription before creating new.\n    if (isNewChannel) {\n      await this._revokeSubscription();\n      if (process.env.NODE_ENV !== 'test') {\n        console.log(\n          '[WebSocketSubscription] > _obtainSubscription > existing subscription revoked',\n        );\n      }\n    }\n\n    // Create or recover subscription\n    const subscription =\n      await this._deps.ringCentralExtensions.webSocketExtension.subscribe(\n        this.filters,\n        (message) => {\n          this._notifyMessage(message);\n          if (this.onlyOneTabConnected) {\n            this._syncMessageToOtherTabs(message);\n          }\n        },\n        isNewChannel ? null : this.subscriptionInfo,\n      );\n\n    const isNewSubscription =\n      !this.subscriptionInfo ||\n      this.subscriptionInfo.id !== subscription.subscriptionInfo?.id;\n    if (isNewSubscription) {\n      if (process.env.NODE_ENV !== 'test') {\n        console.log(\n          '[WebSocketSubscription] > _obtainSubscription > subscription created',\n        );\n      }\n    } else {\n      if (process.env.NODE_ENV !== 'test') {\n        console.log(\n          '[WebSocketSubscription] > _obtainSubscription > subscription recovered',\n        );\n      }\n    }\n\n    this._wsSubscription = subscription;\n    this._saveTokens();\n  }\n\n  private async _refreshSubscription() {\n    if (this._wsSubscription) {\n      this._wsSubscription.eventFilters = this.filters;\n      await this._wsSubscription.refresh();\n      this._saveTokens();\n    }\n  }\n\n  private async _revokeSubscription() {\n    try {\n      // Prior using ws channel for revoking, it is faster\n      if (this._wsSubscription) {\n        await this._wsSubscription.revoke();\n      }\n      // Else try to revoke over RESTful API\n      // When page reload we do have cached subscriptionInfo but not _wsSubscription object\n      else if (this.subscriptionInfo) {\n        await this._deps.client.service\n          .platform()\n          .delete(this.subscriptionInfo.uri);\n      }\n    } catch (ex) {\n      // ignore error of revoke request\n      if (process.env.NODE_ENV !== 'test') {\n        console.warn(`[WebSocketSubscription] > _revokeSubscription > ${ex}`);\n      }\n    }\n    this._wsSubscription = undefined;\n    this._clearTokens(); // once subscription is revoked, all tokens are expired\n  }\n\n  // Remove client side subscription object only\n  private async _removeSubscription() {\n    if (this._wsSubscription) {\n      try {\n        this._wsSubscription.remove();\n      } catch (ex) {\n        // ignore error of remove request\n        if (process.env.NODE_ENV !== 'test') {\n          console.warn(`[WebSocketSubscription] > _removeSubscription > ${ex}`);\n        }\n      }\n      this._wsSubscription = undefined;\n    }\n  }\n\n  @proxify\n  private async _updateSubscription() {\n    // only when websocket is ready for create/refresh/revoke subscription\n    if (!this._deps.ringCentralExtensions.isWebSocketReady) {\n      return;\n    }\n    if (this.filters.length === 0) {\n      await this._revokeSubscription();\n      return;\n    }\n    if (!this._wsSubscription) {\n      await this._obtainSubscription();\n    } else if (\n      this.filters\n        .map((x) => normalizeEventFilter(x))\n        .sort()\n        .join(',') !==\n      (this._wsSubscription.subscriptionInfo?.eventFilters ?? [])\n        .map((x: string) => normalizeEventFilter(x))\n        .sort()\n        .join(',')\n    ) {\n      await this._refreshSubscription();\n    }\n  }\n\n  private _debouncedUpdateSubscription = promisedDebounce({\n    fn: this._updateSubscription,\n    threshold: DEFAULT_REFRESH_DELAY,\n  });\n\n  @proxify\n  async subscribe(eventsFilters: SubscriptionFilter[] = []) {\n    if (!this.ready) {\n      return;\n    }\n    const oldLength = this.filters.length;\n    this._addFilters(eventsFilters);\n    if (oldLength !== this.filters.length) {\n      await this._debouncedUpdateSubscriptionCatchCancel();\n    }\n  }\n\n  @proxify\n  async unsubscribe(eventsFilters: SubscriptionFilter[] = []) {\n    if (!this.ready) {\n      return;\n    }\n    const oldLength = this.filters.length;\n    this._removeFilters(eventsFilters);\n    if (oldLength !== this.filters.length) {\n      await this._debouncedUpdateSubscriptionCatchCancel();\n    }\n  }\n\n  @action\n  private _addFilters(eventsFilters: SubscriptionFilter[]) {\n    this.filters = this.filters\n      .concat(eventsFilters)\n      .filter((x, index, array) => array.indexOf(x) === index); // remove duplicates\n  }\n\n  @action\n  private _removeFilters(eventsFilters: SubscriptionFilter[]) {\n    this.filters = this.filters.filter((x) => !eventsFilters.includes(x));\n  }\n\n  @action\n  private _notifyMessage(message: unknown) {\n    this.message = message ?? null;\n  }\n\n  @state\n  filters: SubscriptionFilter[] = [];\n\n  @state\n  message?: unknown = null;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAEA,IAAAA,KAAA,GAAAC,OAAA;AASA,IAAAC,WAAA,GAAAC,sBAAA,CAAAF,OAAA;AACA,IAAAG,iBAAA,GAAAH,OAAA;AACA,IAAAI,GAAA,GAAAJ,OAAA;AACA,IAAAK,QAAA,GAAAL,OAAA;AACA,IAAAM,qBAAA,GAAAN,OAAA;AAIA,IAAAO,qBAAA,GAAAP,OAAA;AAGgC,IAAAQ,IAAA,EAAAC,MAAA,EAAAC,OAAA,EAAAC,WAAA,EAAAC,YAAA,EAAAC,YAAA,EAAAC,YAAA;AAAA,SAAAZ,uBAAAa,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,gBAAAA,CAAA;AAAA,SAAAE,mBAAAC,CAAA,EAAAC,CAAA,EAAAJ,CAAA,EAAAK,CAAA,EAAAC,CAAA,EAAAC,CAAA,EAAAC,CAAA,cAAAC,CAAA,GAAAN,CAAA,CAAAI,CAAA,EAAAC,CAAA,GAAAE,CAAA,GAAAD,CAAA,CAAAE,KAAA,WAAAR,CAAA,gBAAAH,CAAA,CAAAG,CAAA,KAAAM,CAAA,CAAAG,IAAA,GAAAR,CAAA,CAAAM,CAAA,IAAAG,OAAA,CAAAC,OAAA,CAAAJ,CAAA,EAAAK,IAAA,CAAAV,CAAA,EAAAC,CAAA;AAAA,SAAAU,kBAAAb,CAAA,6BAAAC,CAAA,SAAAJ,CAAA,GAAAiB,SAAA,aAAAJ,OAAA,WAAAR,CAAA,EAAAC,CAAA,QAAAC,CAAA,GAAAJ,CAAA,CAAAe,KAAA,CAAAd,CAAA,EAAAJ,CAAA,YAAAmB,MAAAhB,CAAA,IAAAD,kBAAA,CAAAK,CAAA,EAAAF,CAAA,EAAAC,CAAA,EAAAa,KAAA,EAAAC,MAAA,UAAAjB,CAAA,cAAAiB,OAAAjB,CAAA,IAAAD,kBAAA,CAAAK,CAAA,EAAAF,CAAA,EAAAC,CAAA,EAAAa,KAAA,EAAAC,MAAA,WAAAjB,CAAA,KAAAgB,KAAA;AAAA,SAAAE,2BAAArB,CAAA,EAAAS,CAAA,EAAAJ,CAAA,EAAAiB,CAAA,IAAAjB,CAAA,IAAAkB,MAAA,CAAAC,cAAA,CAAAxB,CAAA,EAAAS,CAAA,IAAAgB,UAAA,EAAApB,CAAA,CAAAoB,UAAA,EAAAC,YAAA,EAAArB,CAAA,CAAAqB,YAAA,EAAAC,QAAA,EAAAtB,CAAA,CAAAsB,QAAA,EAAAhB,KAAA,EAAAN,CAAA,CAAAuB,WAAA,GAAAvB,CAAA,CAAAuB,WAAA,CAAAC,IAAA,CAAAP,CAAA;AAAA,SAAAQ,gBAAAvB,CAAA,EAAAJ,CAAA,UAAAI,CAAA,YAAAJ,CAAA,aAAA4B,SAAA;AAAA,SAAAC,kBAAAhC,CAAA,EAAAK,CAAA,aAAAD,CAAA,MAAAA,CAAA,GAAAC,CAAA,CAAA4B,MAAA,EAAA7B,CAAA,UAAAE,CAAA,GAAAD,CAAA,CAAAD,CAAA,GAAAE,CAAA,CAAAmB,UAAA,GAAAnB,CAAA,CAAAmB,UAAA,QAAAnB,CAAA,CAAAoB,YAAA,kBAAApB,CAAA,KAAAA,CAAA,CAAAqB,QAAA,QAAAJ,MAAA,CAAAC,cAAA,CAAAxB,CAAA,EAAAkC,cAAA,CAAA5B,CAAA,CAAA6B,GAAA,GAAA7B,CAAA;AAAA,SAAA8B,aAAApC,CAAA,EAAAK,CAAA,EAAAD,CAAA,WAAAC,CAAA,IAAA2B,iBAAA,CAAAhC,CAAA,CAAAqC,SAAA,EAAAhC,CAAA,GAAAD,CAAA,IAAA4B,iBAAA,CAAAhC,CAAA,EAAAI,CAAA,GAAAmB,MAAA,CAAAC,cAAA,CAAAxB,CAAA,iBAAA2B,QAAA,SAAA3B,CAAA;AAAA,SAAAkC,eAAA9B,CAAA,QAAAK,CAAA,GAAA6B,YAAA,CAAAlC,CAAA,gCAAAmC,OAAA,CAAA9B,CAAA,IAAAA,CAAA,GAAAA,CAAA;AAAA,SAAA6B,aAAAlC,CAAA,EAAAC,CAAA,oBAAAkC,OAAA,CAAAnC,CAAA,MAAAA,CAAA,SAAAA,CAAA,MAAAJ,CAAA,GAAAI,CAAA,CAAAoC,MAAA,CAAAC,WAAA,kBAAAzC,CAAA,QAAAS,CAAA,GAAAT,CAAA,CAAA6B,IAAA,CAAAzB,CAAA,EAAAC,CAAA,gCAAAkC,OAAA,CAAA9B,CAAA,UAAAA,CAAA,YAAAsB,SAAA,yEAAA1B,CAAA,GAAAqC,MAAA,GAAAC,MAAA,EAAAvC,CAAA;AAAA,SAAAwC,UAAAxC,CAAA,EAAAJ,CAAA,6BAAAA,CAAA,aAAAA,CAAA,YAAA+B,SAAA,wDAAA3B,CAAA,CAAAiC,SAAA,GAAAd,MAAA,CAAAsB,MAAA,CAAA7C,CAAA,IAAAA,CAAA,CAAAqC,SAAA,IAAAS,WAAA,IAAAnC,KAAA,EAAAP,CAAA,EAAAuB,QAAA,MAAAD,YAAA,WAAAH,MAAA,CAAAC,cAAA,CAAApB,CAAA,iBAAAuB,QAAA,SAAA3B,CAAA,IAAA+C,eAAA,CAAA3C,CAAA,EAAAJ,CAAA;AAAA,SAAA+C,gBAAA3C,CAAA,EAAAJ,CAAA,WAAA+C,eAAA,GAAAxB,MAAA,CAAAyB,cAAA,GAAAzB,MAAA,CAAAyB,cAAA,CAAAC,IAAA,eAAA7C,CAAA,EAAAJ,CAAA,WAAAI,CAAA,CAAA8C,SAAA,GAAAlD,CAAA,EAAAI,CAAA,KAAA2C,eAAA,CAAA3C,CAAA,EAAAJ,CAAA;AAAA,SAAAmD,aAAA/C,CAAA,QAAAC,CAAA,GAAA+C,yBAAA,6BAAApD,CAAA,EAAAM,CAAA,GAAA+C,eAAA,CAAAjD,CAAA,OAAAC,CAAA,QAAAiD,CAAA,GAAAD,eAAA,OAAAP,WAAA,EAAA9C,CAAA,GAAAuD,OAAA,CAAAC,SAAA,CAAAlD,CAAA,EAAAW,SAAA,EAAAqC,CAAA,UAAAtD,CAAA,GAAAM,CAAA,CAAAY,KAAA,OAAAD,SAAA,UAAAwC,0BAAA,OAAAzD,CAAA;AAAA,SAAAyD,2BAAArD,CAAA,EAAAJ,CAAA,QAAAA,CAAA,iBAAAuC,OAAA,CAAAvC,CAAA,0BAAAA,CAAA,UAAAA,CAAA,iBAAAA,CAAA,YAAA+B,SAAA,qEAAA2B,sBAAA,CAAAtD,CAAA;AAAA,SAAAsD,uBAAA1D,CAAA,mBAAAA,CAAA,YAAA2D,cAAA,sEAAA3D,CAAA;AAAA,SAAAoD,0BAAA,cAAAhD,CAAA,IAAAwD,OAAA,CAAAvB,SAAA,CAAAwB,OAAA,CAAAhC,IAAA,CAAA0B,OAAA,CAAAC,SAAA,CAAAI,OAAA,iCAAAxD,CAAA,aAAAgD,yBAAA,YAAAA,0BAAA,aAAAhD,CAAA;AAAA,SAAAiD,gBAAAjD,CAAA,WAAAiD,eAAA,GAAA9B,MAAA,CAAAyB,cAAA,GAAAzB,MAAA,CAAAuC,cAAA,CAAAb,IAAA,eAAA7C,CAAA,WAAAA,CAAA,CAAA8C,SAAA,IAAA3B,MAAA,CAAAuC,cAAA,CAAA1D,CAAA,MAAAiD,eAAA,CAAAjD,CAAA;AAAA,SAAA2D,0BAAA1D,CAAA,EAAAL,CAAA,UAAAgE,KAAA;AAAA,SAAAC,0BAAAxD,CAAA,EAAAT,CAAA,EAAAK,CAAA,EAAAF,CAAA,EAAAmB,CAAA,QAAAf,CAAA,cAAAgB,MAAA,CAAA2C,IAAA,CAAA/D,CAAA,EAAAgE,OAAA,WAAA1D,CAAA,IAAAF,CAAA,CAAAE,CAAA,IAAAN,CAAA,CAAAM,CAAA,OAAAF,CAAA,CAAAkB,UAAA,KAAAlB,CAAA,CAAAkB,UAAA,EAAAlB,CAAA,CAAAmB,YAAA,KAAAnB,CAAA,CAAAmB,YAAA,cAAAnB,CAAA,IAAAA,CAAA,CAAAqB,WAAA,MAAArB,CAAA,CAAAoB,QAAA,QAAApB,CAAA,GAAAF,CAAA,CAAA+D,KAAA,GAAAC,OAAA,GAAAC,MAAA,WAAAjE,CAAA,EAAAF,CAAA,WAAAA,CAAA,CAAAM,CAAA,EAAAT,CAAA,EAAAK,CAAA,KAAAA,CAAA,KAAAE,CAAA,GAAAe,CAAA,eAAAf,CAAA,CAAAqB,WAAA,KAAArB,CAAA,CAAAI,KAAA,GAAAJ,CAAA,CAAAqB,WAAA,GAAArB,CAAA,CAAAqB,WAAA,CAAAC,IAAA,CAAAP,CAAA,YAAAf,CAAA,CAAAqB,WAAA,uBAAArB,CAAA,CAAAqB,WAAA,IAAAL,MAAA,CAAAC,cAAA,CAAAf,CAAA,EAAAT,CAAA,EAAAO,CAAA,WAAAA,CAAA;AAEhC,IAAMgE,qBAAqB,GAAGC,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,MAAM,GAAG,CAAC,GAAG,IAAI;AACjE,IAAMC,uBAAuB,GAAG,mCAAmC;AAACC,OAAA,CAAAD,uBAAA,GAAAA,uBAAA;AAAA,IAY9DE,qBAAqB,IAAApF,IAAA,GAVjC,IAAAqF,UAAM,EAAC;EACNC,IAAI,EAAE,uBAAuB;EAC7BC,IAAI,EAAE,CACJ,QAAQ,EACR,SAAS,EACT,uBAAuB,EACvB;IAAEC,GAAG,EAAE,YAAY;IAAEC,QAAQ,EAAE;EAAK,CAAC,EACrC;IAAED,GAAG,EAAE,8BAA8B;IAAEC,QAAQ,EAAE;EAAK,CAAC;AAE3D,CAAC,CAAC,EAAAzF,IAAA,CAAAC,MAAA,IAAAC,OAAA,0BAAAwF,UAAA;EAAAvC,SAAA,CAAAiC,qBAAA,EAAAM,UAAA;EAAA,IAAAC,MAAA,GAAAjC,YAAA,CAAA0B,qBAAA;EAIA,SAAAA,sBAAYG,IAAU,EAAE;IAAA,IAAAK,KAAA;IAAAvD,eAAA,OAAA+C,qBAAA;IACtBQ,KAAA,GAAAD,MAAA,CAAAvD,IAAA,OAAM;MACJmD,IAAI,EAAJA,IAAI;MACJM,WAAW,EAAE,IAAI;MACjBC,UAAU,EAAE;IACd,CAAC;IAAEF,KAAA,CAPGG,eAAe;IAAAnE,0BAAA,CAAAgE,KAAA,sBAAAzF,WAAA,EAAA8D,sBAAA,CAAA2B,KAAA;IAAAhE,0BAAA,CAAAgE,KAAA,yBAAAxF,YAAA,EAAA6D,sBAAA,CAAA2B,KAAA;IAAAA,KAAA,CAgPfI,4BAA4B,GAAG,IAAAC,kCAAgB,EAAC;MACtDC,EAAE,EAAEN,KAAA,CAAKO,mBAAmB;MAC5BC,SAAS,EAAEtB;IACb,CAAC,CAAC;IAAAlD,0BAAA,CAAAgE,KAAA,aAAAvF,YAAA,EAAA4D,sBAAA,CAAA2B,KAAA;IAAAhE,0BAAA,CAAAgE,KAAA,aAAAtF,YAAA,EAAA2D,sBAAA,CAAA2B,KAAA;IAAA,OAAAA,KAAA;EA3OF;EAACjD,YAAA,CAAAyC,qBAAA;IAAA1C,GAAA;IAAAxB,KAAA;MAAA,IAAAmF,WAAA,GAAA9E,iBAAA,eAAA+E,kBAAA,CAAAC,IAAA,UAAAC,QAAA;QAAA,OAAAF,kBAAA,CAAAG,IAAA,UAAAC,SAAAC,QAAA;UAAA;YAAA,QAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;cAAA;gBAAAF,QAAA,CAAAE,IAAA;gBAAA,OAGO,IAAI,CAACC,WAAW,CAAC,CAAC;cAAA;cAAA;gBAAA,OAAAH,QAAA,CAAAI,IAAA;YAAA;UAAA;QAAA,GAAAP,OAAA;MAAA;MAAA,SAAAQ,WAAA;QAAA,OAAAX,WAAA,CAAA5E,KAAA,OAAAD,SAAA;MAAA;MAAA,OAAAwF,UAAA;IAAA;EAAA;IAAAtE,GAAA;IAAAxB,KAAA;MAAA,IAAA+F,cAAA,GAAA1F,iBAAA,eAAA+E,kBAAA,CAAAC,IAAA,UAAAW,SAAA;QAAA,OAAAZ,kBAAA,CAAAG,IAAA,UAAAU,UAAAC,SAAA;UAAA;YAAA,QAAAA,SAAA,CAAAR,IAAA,GAAAQ,SAAA,CAAAP,IAAA;cAAA;gBAAAO,SAAA,CAAAP,IAAA;gBAAA,OAIlB,IAAI,CAACQ,uCAAuC,CAAC,CAAC;cAAA;cAAA;gBAAA,OAAAD,SAAA,CAAAL,IAAA;YAAA;UAAA;QAAA,GAAAG,QAAA;MAAA;MAAA,SAAAI,cAAA;QAAA,OAAAL,cAAA,CAAAxF,KAAA,OAAAD,SAAA;MAAA;MAAA,OAAA8F,aAAA;IAAA;EAAA;IAAA5E,GAAA;IAAAxB,KAAA;MAAA,IAAAqG,QAAA,GAAAhG,iBAAA,eAAA+E,kBAAA,CAAAC,IAAA,UAAAiB,SAAA;QAAA,OAAAlB,kBAAA,CAAAG,IAAA,UAAAgB,UAAAC,SAAA;UAAA;YAAA,QAAAA,SAAA,CAAAd,IAAA,GAAAc,SAAA,CAAAb,IAAA;cAAA;gBAIpD,IAAI,CAACb,4BAA4B,CAAC2B,MAAM,CAAC,CAAC;gBAACD,SAAA,CAAAb,IAAA;gBAAA,OACrC,IAAI,CAACe,mBAAmB,CAAC,CAAC;cAAA;cAAA;gBAAA,OAAAF,SAAA,CAAAX,IAAA;YAAA;UAAA;QAAA,GAAAS,QAAA;MAAA;MAAA,SAAAK,QAAA;QAAA,OAAAN,QAAA,CAAA9F,KAAA,OAAAD,SAAA;MAAA;MAAA,OAAAqG,OAAA;IAAA;EAAA;IAAAnF,GAAA;IAAAxB,KAAA;MAAA,IAAA4G,wCAAA,GAAAvG,iBAAA,eAAA+E,kBAAA,CAAAC,IAAA,UAAAwB,SAAA;QAAA,OAAAzB,kBAAA,CAAAG,IAAA,UAAAuB,UAAAC,SAAA;UAAA;YAAA,QAAAA,SAAA,CAAArB,IAAA,GAAAqB,SAAA,CAAApB,IAAA;cAAA;gBAAAoB,SAAA,CAAArB,IAAA;gBAAAqB,SAAA,CAAApB,IAAA;gBAAA,OAKxB,IAAI,CAACb,4BAA4B,CAAC,CAAC;cAAA;gBAAAiC,SAAA,CAAApB,IAAA;gBAAA;cAAA;gBAAAoB,SAAA,CAAArB,IAAA;gBAAAqB,SAAA,CAAAC,EAAA,GAAAD,SAAA;gBAAA,MAErCA,SAAA,CAAAC,EAAA,CAAMC,OAAO,KAAK,WAAW;kBAAAF,SAAA,CAAApB,IAAA;kBAAA;gBAAA;gBAAA,MAAAoB,SAAA,CAAAC,EAAA;cAAA;cAAA;gBAAA,OAAAD,SAAA,CAAAlB,IAAA;YAAA;UAAA;QAAA,GAAAgB,QAAA;MAAA;MAAA,SAAAV,wCAAA;QAAA,OAAAS,wCAAA,CAAArG,KAAA,OAAAD,SAAA;MAAA;MAAA,OAAA6F,uCAAA;IAAA;EAAA;IAAA3E,GAAA;IAAAxB,KAAA;MAAA,IAAAkH,YAAA,GAAA7G,iBAAA,eAAA+E,kBAAA,CAAAC,IAAA,UAAA8B,SAAA;QAAA,IAAAC,MAAA;QAAA,OAAAhC,kBAAA,CAAAG,IAAA,UAAA8B,UAAAC,SAAA;UAAA;YAAA,QAAAA,SAAA,CAAA5B,IAAA,GAAA4B,SAAA,CAAA3B,IAAA;cAAA;gBAYnC,IAAA4B,WAAK,EACH,IAAI,EACJ;kBAAA,OAAMH,MAAI,CAACI,KAAK,CAACC,qBAAqB,CAACC,mBAAmB;gBAAA;kBAAA,IAAAC,IAAA,GAAAtH,iBAAA,eAAA+E,kBAAA,CAAAC,IAAA,CAC1D,SAAAuC,SAAOC,OAAO;oBAAA,OAAAzC,kBAAA,CAAAG,IAAA,UAAAuC,UAAAC,SAAA;sBAAA;wBAAA,QAAAA,SAAA,CAAArC,IAAA,GAAAqC,SAAA,CAAApC,IAAA;0BAAA;4BAAA,MACR,CAACyB,MAAI,CAACY,KAAK,IAAI,CAACH,OAAO;8BAAAE,SAAA,CAAApC,IAAA;8BAAA;4BAAA;4BAAA,OAAAoC,SAAA,CAAAE,MAAA;0BAAA;4BAAA,MAGvBJ,OAAO,KAAKK,0CAAoB,CAACF,KAAK;8BAAAD,SAAA,CAAApC,IAAA;8BAAA;4BAAA;4BAAAoC,SAAA,CAAApC,IAAA;4BAAA,OAClCyB,MAAI,CAACnC,mBAAmB,CAAC,CAAC;0BAAA;4BAAA8C,SAAA,CAAApC,IAAA;4BAAA;0BAAA;4BAAA,MACvBkC,OAAO,KAAKK,0CAAoB,CAACC,OAAO;8BAAAJ,SAAA,CAAApC,IAAA;8BAAA;4BAAA;4BAAAoC,SAAA,CAAApC,IAAA;4BAAA,OAE3CyB,MAAI,CAACgB,mBAAmB,CAAC,CAAC;0BAAA;4BAAAL,SAAA,CAAApC,IAAA;4BAAA;0BAAA;4BAEhCyB,MAAI,CAACtC,4BAA4B,CAAC2B,MAAM,CAAC,CAAC;4BAACsB,SAAA,CAAApC,IAAA;4BAAA,OACrCyB,MAAI,CAACV,mBAAmB,CAAC,CAAC;0BAAA;0BAAA;4BAAA,OAAAqB,SAAA,CAAAlC,IAAA;wBAAA;sBAAA;oBAAA,GAAA+B,QAAA;kBAAA,CAEnC;kBAAA,iBAAAS,EAAA;oBAAA,OAAAV,IAAA,CAAApH,KAAA,OAAAD,SAAA;kBAAA;gBAAA,GACH,CAAC;gBACD,IAAI,IAAI,CAACgI,mBAAmB,EAAE;kBAC5B,IAAAf,WAAK,EACH,IAAI,EACJ;oBAAA,OAAMH,MAAI,CAACI,KAAK,CAACe,UAAU,CAAEC,KAAK;kBAAA,GAClC,UAACA,KAAK,EAAK;oBACTpB,MAAI,CAACqB,gBAAgB,CAACD,KAAK,CAAC;kBAC9B,CACF,CAAC;gBACH;cAAC;cAAA;gBAAA,OAAAlB,SAAA,CAAAzB,IAAA;YAAA;UAAA;QAAA,GAAAsB,QAAA;MAAA;MAAA,SAAAvB,YAAA;QAAA,OAAAsB,YAAA,CAAA3G,KAAA,OAAAD,SAAA;MAAA;MAAA,OAAAsF,WAAA;IAAA;EAAA;IAAApE,GAAA;IAAAxB,KAAA,WAAAyI,iBAGsBD,KAAe,EAAE;MACxC,IAAI,CAAC,IAAI,CAACR,KAAK,IAAI,CAACQ,KAAK,EAAE;QACzB;MACF;MACA,IAAIA,KAAK,CAACpE,IAAI,KAAKJ,uBAAuB,EAAE;QAC1C,IAAI,CAAC0E,cAAc,CAACF,KAAK,CAACG,IAAI,CAAE,CAAC,CAAC,CAAC;MACrC;IACF;EAAC;IAAAnH,GAAA;IAAAxB,KAAA;MAAA,IAAA4I,wBAAA,GAAAvI,iBAAA,eAAA+E,kBAAA,CAAAC,IAAA,UAAAwD,SAEqC5B,OAAgB;QAAA,IAAA6B,qBAAA;QAAA,OAAA1D,kBAAA,CAAAG,IAAA,UAAAwD,UAAAC,SAAA;UAAA;YAAA,QAAAA,SAAA,CAAAtD,IAAA,GAAAsD,SAAA,CAAArD,IAAA;cAAA;gBAAAqD,SAAA,CAAArD,IAAA;gBAAA,QAAAmD,qBAAA,GAE9C,IAAI,CAACtB,KAAK,CAACe,UAAU,cAAAO,qBAAA,uBAArBA,qBAAA,CAAuBG,IAAI,CAACjF,uBAAuB,EAAEiD,OAAO,CAAC;cAAA;cAAA;gBAAA,OAAA+B,SAAA,CAAAnD,IAAA;YAAA;UAAA;QAAA,GAAAgD,QAAA;MAAA;MAAA,SAAAK,wBAAAC,GAAA;QAAA,OAAAP,wBAAA,CAAArI,KAAA,OAAAD,SAAA;MAAA;MAAA,OAAA4I,uBAAA;IAAA;EAAA;IAAA1H,GAAA;IAAAxB,KAAA,WAAAoJ,WAanEC,gBAA0C,EAC1CC,mBAAmC,EACnC;MACA,IAAI,CAACD,gBAAgB,GAAGA,gBAAgB,aAAhBA,gBAAgB,cAAhBA,gBAAgB,GAAI,IAAI;MAChD,IAAI,CAACC,mBAAmB,GAAGA,mBAAmB,aAAnBA,mBAAmB,cAAnBA,mBAAmB,GAAI,IAAI;IACxD;EAAC;IAAA9H,GAAA;IAAAxB,KAAA,WAAAuJ,YAAA,EAEqB;MAAA,IAAAC,qBAAA;MACpB,IAAI,CAACJ,UAAU,EAAAI,qBAAA,GACb,IAAI,CAAC3E,eAAe,cAAA2E,qBAAA,uBAApBA,qBAAA,CAAsBH,gBAAgB,EACtC,IAAI,CAAC7B,KAAK,CAACC,qBAAqB,CAACgC,kBAAkB,CAACC,EAAE,CAACC,GACzD,CAAC;IACH;EAAC;IAAAnI,GAAA;IAAAxB,KAAA,WAAA4J,aAAA,EAEsB;MACrB,IAAI,CAACR,UAAU,CAAC,IAAI,EAAE,IAAI,CAAC;IAC7B;EAAC;IAAA5H,GAAA;IAAAxB,KAAA;MAAA,IAAA6J,oBAAA,GAAAxJ,iBAAA,eAAA+E,kBAAA,CAAAC,IAAA,UAAAyE,SAAA;QAAA,IAAAC,MAAA;UAAAC,qBAAA;QAAA,IAAAC,YAAA,EAAAC,YAAA,EAAAC,iBAAA;QAAA,OAAA/E,kBAAA,CAAAG,IAAA,UAAA6E,UAAAC,SAAA;UAAA;YAAA,QAAAA,SAAA,CAAA3E,IAAA,GAAA2E,SAAA,CAAA1E,IAAA;cAAA;gBAGOsE,YAAY,GAChB,CAAC,IAAI,CAACX,mBAAmB,IACzB,CAAC,IAAAgB,wCAAkB,EACjB,IAAI,CAAChB,mBAAmB,EACxB,IAAI,CAAC9B,KAAK,CAACC,qBAAqB,CAACgC,kBAAkB,CAACC,EAAE,CAACC,GACzD,CAAC;gBACH,IAAI9F,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,MAAM,EAAE;kBACnCwG,OAAO,CAACC,GAAG,kEAAAC,MAAA,CACwDR,YAAY,CAC/E,CAAC;gBACH;;gBAEA;gBACA;gBAAA,KACIA,YAAY;kBAAAI,SAAA,CAAA1E,IAAA;kBAAA;gBAAA;gBAAA0E,SAAA,CAAA1E,IAAA;gBAAA,OACR,IAAI,CAACyC,mBAAmB,CAAC,CAAC;cAAA;gBAChC,IAAIvE,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,MAAM,EAAE;kBACnCwG,OAAO,CAACC,GAAG,CACT,+EACF,CAAC;gBACH;cAAC;gBAAAH,SAAA,CAAA1E,IAAA;gBAAA,OAKK,IAAI,CAAC6B,KAAK,CAACC,qBAAqB,CAACgC,kBAAkB,CAACiB,SAAS,CACjE,IAAI,CAACC,OAAO,EACZ,UAAC1D,OAAO,EAAK;kBACX8C,MAAI,CAACrB,cAAc,CAACzB,OAAO,CAAC;kBAC5B,IAAI8C,MAAI,CAACzB,mBAAmB,EAAE;oBAC5ByB,MAAI,CAACb,uBAAuB,CAACjC,OAAO,CAAC;kBACvC;gBACF,CAAC,EACDgD,YAAY,GAAG,IAAI,GAAG,IAAI,CAACZ,gBAC7B,CAAC;cAAA;gBAVGa,YAAY,GAAAG,SAAA,CAAAO,IAAA;gBAYZT,iBAAiB,GACrB,CAAC,IAAI,CAACd,gBAAgB,IACtB,IAAI,CAACA,gBAAgB,CAACwB,EAAE,OAAAb,qBAAA,GAAKE,YAAY,CAACb,gBAAgB,cAAAW,qBAAA,uBAA7BA,qBAAA,CAA+Ba,EAAE;gBAChE,IAAIV,iBAAiB,EAAE;kBACrB,IAAItG,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,MAAM,EAAE;oBACnCwG,OAAO,CAACC,GAAG,CACT,sEACF,CAAC;kBACH;gBACF,CAAC,MAAM;kBACL,IAAI3G,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,MAAM,EAAE;oBACnCwG,OAAO,CAACC,GAAG,CACT,wEACF,CAAC;kBACH;gBACF;gBAEA,IAAI,CAAC3F,eAAe,GAAGqF,YAAY;gBACnC,IAAI,CAACX,WAAW,CAAC,CAAC;cAAC;cAAA;gBAAA,OAAAc,SAAA,CAAAxE,IAAA;YAAA;UAAA;QAAA,GAAAiE,QAAA;MAAA;MAAA,SAAAgB,oBAAA;QAAA,OAAAjB,oBAAA,CAAAtJ,KAAA,OAAAD,SAAA;MAAA;MAAA,OAAAwK,mBAAA;IAAA;EAAA;IAAAtJ,GAAA;IAAAxB,KAAA;MAAA,IAAA+K,qBAAA,GAAA1K,iBAAA,eAAA+E,kBAAA,CAAAC,IAAA,UAAA2F,SAAA;QAAA,OAAA5F,kBAAA,CAAAG,IAAA,UAAA0F,UAAAC,SAAA;UAAA;YAAA,QAAAA,SAAA,CAAAxF,IAAA,GAAAwF,SAAA,CAAAvF,IAAA;cAAA;gBAAA,KAIf,IAAI,CAACd,eAAe;kBAAAqG,SAAA,CAAAvF,IAAA;kBAAA;gBAAA;gBACtB,IAAI,CAACd,eAAe,CAACsG,YAAY,GAAG,IAAI,CAACR,OAAO;gBAACO,SAAA,CAAAvF,IAAA;gBAAA,OAC3C,IAAI,CAACd,eAAe,CAACuG,OAAO,CAAC,CAAC;cAAA;gBACpC,IAAI,CAAC7B,WAAW,CAAC,CAAC;cAAC;cAAA;gBAAA,OAAA2B,SAAA,CAAArF,IAAA;YAAA;UAAA;QAAA,GAAAmF,QAAA;MAAA;MAAA,SAAAK,qBAAA;QAAA,OAAAN,qBAAA,CAAAxK,KAAA,OAAAD,SAAA;MAAA;MAAA,OAAA+K,oBAAA;IAAA;EAAA;IAAA7J,GAAA;IAAAxB,KAAA;MAAA,IAAAsL,oBAAA,GAAAjL,iBAAA,eAAA+E,kBAAA,CAAAC,IAAA,UAAAkG,UAAA;QAAA,OAAAnG,kBAAA,CAAAG,IAAA,UAAAiG,WAAAC,UAAA;UAAA;YAAA,QAAAA,UAAA,CAAA/F,IAAA,GAAA+F,UAAA,CAAA9F,IAAA;cAAA;gBAAA8F,UAAA,CAAA/F,IAAA;gBAAA,KAOf,IAAI,CAACb,eAAe;kBAAA4G,UAAA,CAAA9F,IAAA;kBAAA;gBAAA;gBAAA8F,UAAA,CAAA9F,IAAA;gBAAA,OAChB,IAAI,CAACd,eAAe,CAAC6G,MAAM,CAAC,CAAC;cAAA;gBAAAD,UAAA,CAAA9F,IAAA;gBAAA;cAAA;gBAAA,KAI5B,IAAI,CAAC0D,gBAAgB;kBAAAoC,UAAA,CAAA9F,IAAA;kBAAA;gBAAA;gBAAA8F,UAAA,CAAA9F,IAAA;gBAAA,OACtB,IAAI,CAAC6B,KAAK,CAACmE,MAAM,CAACC,OAAO,CAC5BC,QAAQ,CAAC,CAAC,UACJ,CAAC,IAAI,CAACxC,gBAAgB,CAACyC,GAAG,CAAC;cAAA;gBAAAL,UAAA,CAAA9F,IAAA;gBAAA;cAAA;gBAAA8F,UAAA,CAAA/F,IAAA;gBAAA+F,UAAA,CAAAzE,EAAA,GAAAyE,UAAA;gBAGtC;gBACA,IAAI5H,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,MAAM,EAAE;kBACnCwG,OAAO,CAACwB,IAAI,oDAAAtB,MAAA,CAAAgB,UAAA,CAAAzE,EAAA,CAAwD,CAAC;gBACvE;cAAC;gBAEH,IAAI,CAACnC,eAAe,GAAGmH,SAAS;gBAChC,IAAI,CAACpC,YAAY,CAAC,CAAC,CAAC,CAAC;cAAA;cAAA;gBAAA,OAAA6B,UAAA,CAAA5F,IAAA;YAAA;UAAA;QAAA,GAAA0F,SAAA;MAAA;MAAA,SAAAnD,oBAAA;QAAA,OAAAkD,oBAAA,CAAA/K,KAAA,OAAAD,SAAA;MAAA;MAAA,OAAA8H,mBAAA;IAAA,IAGvB;EAAA;IAAA5G,GAAA;IAAAxB,KAAA;MAAA,IAAAiM,oBAAA,GAAA5L,iBAAA,eAAA+E,kBAAA,CAAAC,IAAA,UAAA6G,UAAA;QAAA,OAAA9G,kBAAA,CAAAG,IAAA,UAAA4G,WAAAC,UAAA;UAAA;YAAA,QAAAA,UAAA,CAAA1G,IAAA,GAAA0G,UAAA,CAAAzG,IAAA;cAAA;gBAEE,IAAI,IAAI,CAACd,eAAe,EAAE;kBACxB,IAAI;oBACF,IAAI,CAACA,eAAe,CAACwH,MAAM,CAAC,CAAC;kBAC/B,CAAC,CAAC,OAAOC,EAAE,EAAE;oBACX;oBACA,IAAIzI,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,MAAM,EAAE;sBACnCwG,OAAO,CAACwB,IAAI,oDAAAtB,MAAA,CAAoD6B,EAAE,CAAE,CAAC;oBACvE;kBACF;kBACA,IAAI,CAACzH,eAAe,GAAGmH,SAAS;gBAClC;cAAC;cAAA;gBAAA,OAAAI,UAAA,CAAAvG,IAAA;YAAA;UAAA;QAAA,GAAAqG,SAAA;MAAA;MAAA,SAAAxF,oBAAA;QAAA,OAAAuF,oBAAA,CAAA1L,KAAA,OAAAD,SAAA;MAAA;MAAA,OAAAoG,mBAAA;IAAA;EAAA;IAAAlF,GAAA;IAAAxB,KAAA;MAAA,IAAAuM,oBAAA,GAAAlM,iBAAA,eAAA+E,kBAAA,CAAAC,IAAA,UAAAmH,UAAA;QAAA,IAAAC,sBAAA,EAAAC,sBAAA;QAAA,OAAAtH,kBAAA,CAAAG,IAAA,UAAAoH,WAAAC,UAAA;UAAA;YAAA,QAAAA,UAAA,CAAAlH,IAAA,GAAAkH,UAAA,CAAAjH,IAAA;cAAA;gBAAA,IAMI,IAAI,CAAC6B,KAAK,CAACC,qBAAqB,CAACoF,gBAAgB;kBAAAD,UAAA,CAAAjH,IAAA;kBAAA;gBAAA;gBAAA,OAAAiH,UAAA,CAAA3E,MAAA;cAAA;gBAAA,MAGlD,IAAI,CAAC0C,OAAO,CAACrJ,MAAM,KAAK,CAAC;kBAAAsL,UAAA,CAAAjH,IAAA;kBAAA;gBAAA;gBAAAiH,UAAA,CAAAjH,IAAA;gBAAA,OACrB,IAAI,CAACyC,mBAAmB,CAAC,CAAC;cAAA;gBAAA,OAAAwE,UAAA,CAAA3E,MAAA;cAAA;gBAAA,IAG7B,IAAI,CAACpD,eAAe;kBAAA+H,UAAA,CAAAjH,IAAA;kBAAA;gBAAA;gBAAAiH,UAAA,CAAAjH,IAAA;gBAAA,OACjB,IAAI,CAACmF,mBAAmB,CAAC,CAAC;cAAA;gBAAA8B,UAAA,CAAAjH,IAAA;gBAAA;cAAA;gBAAA,MAEhC,IAAI,CAACgF,OAAO,CACTmC,GAAG,CAAC,UAACC,CAAC;kBAAA,OAAK,IAAAC,0CAAoB,EAACD,CAAC,CAAC;gBAAA,EAAC,CACnCE,IAAI,CAAC,CAAC,CACNC,IAAI,CAAC,GAAG,CAAC,KACZ,EAAAT,sBAAA,IAAAC,sBAAA,GAAC,IAAI,CAAC7H,eAAe,CAACwE,gBAAgB,cAAAqD,sBAAA,uBAArCA,sBAAA,CAAuCvB,YAAY,cAAAsB,sBAAA,cAAAA,sBAAA,GAAI,EAAE,EACvDK,GAAG,CAAC,UAACC,CAAS;kBAAA,OAAK,IAAAC,0CAAoB,EAACD,CAAC,CAAC;gBAAA,EAAC,CAC3CE,IAAI,CAAC,CAAC,CACNC,IAAI,CAAC,GAAG,CAAC;kBAAAN,UAAA,CAAAjH,IAAA;kBAAA;gBAAA;gBAAAiH,UAAA,CAAAjH,IAAA;gBAAA,OAEN,IAAI,CAAC0F,oBAAoB,CAAC,CAAC;cAAA;cAAA;gBAAA,OAAAuB,UAAA,CAAA/G,IAAA;YAAA;UAAA;QAAA,GAAA2G,SAAA;MAAA;MAAA,SAAAvH,oBAAA;QAAA,OAAAsH,oBAAA,CAAAhM,KAAA,OAAAD,SAAA;MAAA;MAAA,OAAA2E,mBAAA;IAAA;EAAA;IAAAzD,GAAA;IAAAxB,KAAA;MAAA,IAAAmN,UAAA,GAAA9M,iBAAA,eAAA+E,kBAAA,CAAAC,IAAA,UAAA+H,UAAA;QAAA,IAAAC,aAAA;UAAAC,SAAA;UAAAC,OAAA,GAAAjN,SAAA;QAAA,OAAA8E,kBAAA,CAAAG,IAAA,UAAAiI,WAAAC,UAAA;UAAA;YAAA,QAAAA,UAAA,CAAA/H,IAAA,GAAA+H,UAAA,CAAA9H,IAAA;cAAA;gBAUrB0H,aAAmC,GAAAE,OAAA,CAAAjM,MAAA,QAAAiM,OAAA,QAAAvB,SAAA,GAAAuB,OAAA,MAAG,EAAE;gBAAA,IACjD,IAAI,CAACvF,KAAK;kBAAAyF,UAAA,CAAA9H,IAAA;kBAAA;gBAAA;gBAAA,OAAA8H,UAAA,CAAAxF,MAAA;cAAA;gBAGTqF,SAAS,GAAG,IAAI,CAAC3C,OAAO,CAACrJ,MAAM;gBACrC,IAAI,CAACoM,WAAW,CAACL,aAAa,CAAC;gBAAC,MAC5BC,SAAS,KAAK,IAAI,CAAC3C,OAAO,CAACrJ,MAAM;kBAAAmM,UAAA,CAAA9H,IAAA;kBAAA;gBAAA;gBAAA8H,UAAA,CAAA9H,IAAA;gBAAA,OAC7B,IAAI,CAACQ,uCAAuC,CAAC,CAAC;cAAA;cAAA;gBAAA,OAAAsH,UAAA,CAAA5H,IAAA;YAAA;UAAA;QAAA,GAAAuH,SAAA;MAAA;MAAA,SAAA1C,UAAA;QAAA,OAAAyC,UAAA,CAAA5M,KAAA,OAAAD,SAAA;MAAA;MAAA,OAAAoK,SAAA;IAAA;EAAA;IAAAlJ,GAAA;IAAAxB,KAAA;MAAA,IAAA2N,YAAA,GAAAtN,iBAAA,eAAA+E,kBAAA,CAAAC,IAAA,UAAAuI,UAAA;QAAA,IAAAP,aAAA;UAAAC,SAAA;UAAAO,OAAA,GAAAvN,SAAA;QAAA,OAAA8E,kBAAA,CAAAG,IAAA,UAAAuI,WAAAC,UAAA;UAAA;YAAA,QAAAA,UAAA,CAAArI,IAAA,GAAAqI,UAAA,CAAApI,IAAA;cAAA;gBAKtC0H,aAAmC,GAAAQ,OAAA,CAAAvM,MAAA,QAAAuM,OAAA,QAAA7B,SAAA,GAAA6B,OAAA,MAAG,EAAE;gBAAA,IACnD,IAAI,CAAC7F,KAAK;kBAAA+F,UAAA,CAAApI,IAAA;kBAAA;gBAAA;gBAAA,OAAAoI,UAAA,CAAA9F,MAAA;cAAA;gBAGTqF,SAAS,GAAG,IAAI,CAAC3C,OAAO,CAACrJ,MAAM;gBACrC,IAAI,CAAC0M,cAAc,CAACX,aAAa,CAAC;gBAAC,MAC/BC,SAAS,KAAK,IAAI,CAAC3C,OAAO,CAACrJ,MAAM;kBAAAyM,UAAA,CAAApI,IAAA;kBAAA;gBAAA;gBAAAoI,UAAA,CAAApI,IAAA;gBAAA,OAC7B,IAAI,CAACQ,uCAAuC,CAAC,CAAC;cAAA;cAAA;gBAAA,OAAA4H,UAAA,CAAAlI,IAAA;YAAA;UAAA;QAAA,GAAA+H,SAAA;MAAA;MAAA,SAAAK,YAAA;QAAA,OAAAN,YAAA,CAAApN,KAAA,OAAAD,SAAA;MAAA;MAAA,OAAA2N,WAAA;IAAA;EAAA;IAAAzM,GAAA;IAAAxB,KAAA,WAAA0N,YAKpCL,aAAmC,EAAE;MACvD,IAAI,CAAC1C,OAAO,GAAG,IAAI,CAACA,OAAO,CACxBF,MAAM,CAAC4C,aAAa,CAAC,CACrBa,MAAM,CAAC,UAACnB,CAAC,EAAEoB,KAAK,EAAEC,KAAK;QAAA,OAAKA,KAAK,CAACC,OAAO,CAACtB,CAAC,CAAC,KAAKoB,KAAK;MAAA,EAAC,CAAC,CAAC;IAC9D;EAAC;IAAA3M,GAAA;IAAAxB,KAAA,WAAAgO,eAGsBX,aAAmC,EAAE;MAC1D,IAAI,CAAC1C,OAAO,GAAG,IAAI,CAACA,OAAO,CAACuD,MAAM,CAAC,UAACnB,CAAC;QAAA,OAAK,CAACM,aAAa,CAACiB,QAAQ,CAACvB,CAAC,CAAC;MAAA,EAAC;IACvE;EAAC;IAAAvL,GAAA;IAAAxB,KAAA,WAAA0I,eAGsBzB,OAAgB,EAAE;MACvC,IAAI,CAACA,OAAO,GAAGA,OAAO,aAAPA,OAAO,cAAPA,OAAO,GAAI,IAAI;IAChC;EAAC;IAAAzF,GAAA;IAAA+M,GAAA,WAAAA,IAAA,EA3PkC;MACjC,OAAO,IAAI,CAAC/G,KAAK,CAACC,qBAAqB,CAAC+G,oBAAoB;IAC9D;EAAC;EAAA,OAAAtK,qBAAA;AAAA,EApCwCuK,gBAAU,IAAAnL,yBAAA,CAAAtE,OAAA,CAAA0C,SAAA,kBAsClDgN,sBAAU,GAAA9N,MAAA,CAAA+N,wBAAA,CAAA3P,OAAA,CAAA0C,SAAA,kBAAA1C,OAAA,CAAA0C,SAAA,GAAAzC,WAAA,GAAAqE,yBAAA,CAAAtE,OAAA,CAAA0C,SAAA,uBA6CVkN,aAAO,EACPC,WAAK;EAAA9N,YAAA;EAAAD,UAAA;EAAAE,QAAA;EAAAC,WAAA,WAAAA,YAAA;IAAA,OACuC,IAAI;EAAA;AAAA,IAAA/B,YAAA,GAAAoE,yBAAA,CAAAtE,OAAA,CAAA0C,SAAA,0BAEhDkN,aAAO,EACPC,WAAK;EAAA9N,YAAA;EAAAD,UAAA;EAAAE,QAAA;EAAAC,WAAA,WAAAA,YAAA;IAAA,OACgC,IAAI;EAAA;AAAA,IAAAqC,yBAAA,CAAAtE,OAAA,CAAA0C,SAAA,iBAEzCoN,YAAM,GAAAlO,MAAA,CAAA+N,wBAAA,CAAA3P,OAAA,CAAA0C,SAAA,iBAAA1C,OAAA,CAAA0C,SAAA,GAAA4B,yBAAA,CAAAtE,OAAA,CAAA0C,SAAA,0BA4HNqN,gBAAO,GAAAnO,MAAA,CAAA+N,wBAAA,CAAA3P,OAAA,CAAA0C,SAAA,0BAAA1C,OAAA,CAAA0C,SAAA,GAAA4B,yBAAA,CAAAtE,OAAA,CAAA0C,SAAA,gBA+BPqN,gBAAO,GAAAnO,MAAA,CAAA+N,wBAAA,CAAA3P,OAAA,CAAA0C,SAAA,gBAAA1C,OAAA,CAAA0C,SAAA,GAAA4B,yBAAA,CAAAtE,OAAA,CAAA0C,SAAA,kBAYPqN,gBAAO,GAAAnO,MAAA,CAAA+N,wBAAA,CAAA3P,OAAA,CAAA0C,SAAA,kBAAA1C,OAAA,CAAA0C,SAAA,GAAA4B,yBAAA,CAAAtE,OAAA,CAAA0C,SAAA,kBAYPoN,YAAM,GAAAlO,MAAA,CAAA+N,wBAAA,CAAA3P,OAAA,CAAA0C,SAAA,kBAAA1C,OAAA,CAAA0C,SAAA,GAAA4B,yBAAA,CAAAtE,OAAA,CAAA0C,SAAA,qBAONoN,YAAM,GAAAlO,MAAA,CAAA+N,wBAAA,CAAA3P,OAAA,CAAA0C,SAAA,qBAAA1C,OAAA,CAAA0C,SAAA,GAAA4B,yBAAA,CAAAtE,OAAA,CAAA0C,SAAA,qBAKNoN,YAAM,GAAAlO,MAAA,CAAA+N,wBAAA,CAAA3P,OAAA,CAAA0C,SAAA,qBAAA1C,OAAA,CAAA0C,SAAA,GAAAvC,YAAA,GAAAmE,yBAAA,CAAAtE,OAAA,CAAA0C,SAAA,cAKNmN,WAAK;EAAA9N,YAAA;EAAAD,UAAA;EAAAE,QAAA;EAAAC,WAAA,WAAAA,YAAA;IAAA,OAC0B,EAAE;EAAA;AAAA,IAAA7B,YAAA,GAAAkE,yBAAA,CAAAtE,OAAA,CAAA0C,SAAA,cAEjCmN,WAAK;EAAA9N,YAAA;EAAAD,UAAA;EAAAE,QAAA;EAAAC,WAAA,WAAAA,YAAA;IAAA,OACc,IAAI;EAAA;AAAA,KAAAjC,OAAA,MAAAD,MAAA;AAAAkF,OAAA,CAAAC,qBAAA,GAAAA,qBAAA","ignoreList":[]}
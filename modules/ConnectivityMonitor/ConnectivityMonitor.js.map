{"version":3,"file":"ConnectivityMonitor.js","names":["_core","require","_di","_proxify","_AvailabilityMonitor","_RateLimiter","_dec","_class","_class2","_descriptor","_descriptor2","_initializerDefineProperty","e","i","r","l","Object","defineProperty","enumerable","configurable","writable","value","initializer","call","_regenerator","t","Symbol","n","iterator","o","toStringTag","c","prototype","Generator","u","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","TypeError","done","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","w","m","_regeneratorDefine","_invoke","_classCallCheck","_defineProperties","_toPropertyKey","key","_createClass","_toPrimitive","_typeof","toPrimitive","String","Number","_callSuper","_getPrototypeOf","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","constructor","apply","_assertThisInitialized","ReferenceError","Boolean","valueOf","_inherits","_setPrototypeOf","_applyDecoratedDescriptor","keys","forEach","slice","reverse","reduce","_initializerWarningHelper","Error","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","_next","_throw","DEFAULT_TIME_TO_RETRY","exports","DEFAULT_HEART_BEAT_INTERVAL","errorMessageTypes","rateLimiterErrorMessage","rateLimitReached","errorMessages","serviceLimited","defaultCheckConnectionFn","_defaultCheckConnectionFn","_callee3","response","_context3","fetch","method","mode","type","status","ConnectivityMonitor","Module","name","deps","dep","optional","_RcModuleV","_this$_deps$connectiv","_this$_deps$connectiv2","_this$_deps$connectiv3","_this$_deps$connectiv4","_this","_timeToRetry","_deps","connectivityMonitorOptions","timeToRetry","_heartBeatInterval","heartBeatInterval","_checkConnectionFunc","_callee","_this$_deps$connectiv5","_this$_deps$connectiv6","checkConnectionFunc","_t","_context","_requestSuccessHandler","_requestErrorHandler","_retryTimeoutId","_lastEnvironmentCounter","_unbindHandlers","connectivity","setConnectSuccess","_retry","error","message","includes","setConnectFail","_networkOnlineHandler","_checkConnection","_networkErrorHandler","networkLoss","setNetworkLoss","_shouldInit","pending","environment","ready","_shouldRebindHandlers","_this$_deps$environme","changeCounter","onInit","_bindHandlers","onInitSuccess","onStateChange","_this$_unbindHandlers","_window","_window2","_this2","client","service","on","events","requestSuccess","requestError","window","addEventListener","_window3","_window4","removeListener","removeEventListener","_checkConnection2","_callee2","_t2","_context2","_clearTimeout","clearTimeout","_this3","undefined","setTimeout","RcModuleV2","state","action","getOwnPropertyDescriptor","proxify"],"sources":["modules/ConnectivityMonitor/ConnectivityMonitor.ts"],"sourcesContent":["import { action, RcModuleV2, state } from '@ringcentral-integration/core';\nimport type { ApiError } from '@ringcentral/sdk';\n\nimport { Module } from '../../lib/di';\nimport { proxify } from '../../lib/proxy/proxify';\nimport { errorMessages } from '../AvailabilityMonitor';\nimport { errorMessages as rateLimiterErrorMessage } from '../RateLimiter';\n\nimport type { Deps } from './ConnectivityMonitor.interface';\n\nexport const DEFAULT_TIME_TO_RETRY = 5 * 1000;\nexport const DEFAULT_HEART_BEAT_INTERVAL = 60 * 1000;\n\nconst errorMessageTypes = [\n  rateLimiterErrorMessage.rateLimitReached,\n  errorMessages.serviceLimited,\n];\n\nasync function defaultCheckConnectionFn() {\n  const response = await fetch(\n    'https://apps.ringcentral.com/integration/ping',\n    {\n      method: 'HEAD',\n      mode: 'no-cors',\n    },\n  );\n  if (response.type !== 'opaque' && response.status !== 200) {\n    throw new Error('Network check failed');\n  }\n}\n\n@Module({\n  name: 'ConnectivityMonitor',\n  deps: [\n    'Client',\n    { dep: 'Environment', optional: true },\n    { dep: 'ConnectivityMonitorOptions', optional: true },\n  ],\n})\nexport class ConnectivityMonitor extends RcModuleV2<Deps> {\n  protected _timeToRetry =\n    this._deps.connectivityMonitorOptions?.timeToRetry ?? DEFAULT_TIME_TO_RETRY;\n\n  protected _heartBeatInterval =\n    this._deps.connectivityMonitorOptions?.heartBeatInterval ??\n    DEFAULT_HEART_BEAT_INTERVAL;\n\n  _checkConnectionFunc = async () => {\n    try {\n      const checkConnectionFunc =\n        this._deps.connectivityMonitorOptions?.checkConnectionFunc ??\n        defaultCheckConnectionFn;\n      await checkConnectionFunc();\n      this._requestSuccessHandler();\n    } catch (error: any /** TODO: confirm with instanceof */) {\n      this._requestErrorHandler(error);\n    }\n  };\n\n  protected _retryTimeoutId: NodeJS.Timeout | null = null;\n\n  protected _lastEnvironmentCounter = 0;\n\n  _unbindHandlers?: (() => void) | null = null;\n\n  _requestSuccessHandler = () => {\n    if (!this.connectivity) {\n      this.setConnectSuccess();\n    }\n    this._retry();\n  };\n\n  _requestErrorHandler = (error: ApiError) => {\n    if (error.message && errorMessageTypes.includes(error.message)) return;\n\n    if (!error.response && this.connectivity) {\n      this.setConnectFail();\n    }\n\n    this._retry();\n  };\n\n  _networkOnlineHandler = () => {\n    this._checkConnection();\n  };\n\n  protected _networkErrorHandler = () => {\n    if (!this.networkLoss) {\n      this.setNetworkLoss();\n    }\n    this._retry();\n  };\n\n  constructor(deps: Deps) {\n    super({\n      deps,\n    });\n  }\n\n  @state\n  connectivity = true;\n\n  @state\n  networkLoss = false;\n\n  @action\n  setNetworkLoss() {\n    this.connectivity = false;\n    this.networkLoss = true;\n  }\n\n  @action\n  setConnectSuccess() {\n    this.connectivity = true;\n    this.networkLoss = false;\n  }\n\n  @action\n  setConnectFail() {\n    this.connectivity = false;\n  }\n\n  override _shouldInit() {\n    return !!(\n      this.pending &&\n      (!this._deps.environment || this._deps.environment.ready)\n    );\n  }\n\n  _shouldRebindHandlers() {\n    return !!(\n      this.ready &&\n      this._deps.environment?.ready &&\n      this._deps.environment.changeCounter !== this._lastEnvironmentCounter\n    );\n  }\n\n  override onInit() {\n    this._bindHandlers();\n  }\n\n  override onInitSuccess() {\n    this._retry();\n  }\n\n  override onStateChange() {\n    if (!this._shouldInit() && this._shouldRebindHandlers()) {\n      if (this._deps.environment) {\n        this._lastEnvironmentCounter = this._deps.environment.changeCounter;\n      }\n\n      this._bindHandlers();\n    }\n  }\n\n  _bindHandlers() {\n    this._unbindHandlers?.();\n    const client = this._deps.client.service.client();\n    client.on(client.events.requestSuccess, this._requestSuccessHandler);\n    client.on(client.events.requestError, this._requestErrorHandler);\n    window?.addEventListener('offline', this._networkErrorHandler);\n    window?.addEventListener('online', this._networkOnlineHandler);\n    this._unbindHandlers = () => {\n      client.removeListener(\n        client.events.requestSuccess,\n        this._requestSuccessHandler,\n      );\n      client.removeListener(\n        client.events.requestError,\n        this._requestErrorHandler,\n      );\n      window?.removeEventListener('offline', this._networkErrorHandler);\n      window?.removeEventListener('online', this._networkOnlineHandler);\n      this._unbindHandlers = null;\n    };\n  }\n\n  @proxify\n  async _checkConnection() {\n    try {\n      await this._checkConnectionFunc();\n    } catch (error: any /** TODO: confirm with instanceof */) {\n      // catch error\n    }\n  }\n\n  _clearTimeout() {\n    if (this._retryTimeoutId) {\n      clearTimeout(this._retryTimeoutId);\n      this._retryTimeoutId = null;\n    }\n  }\n\n  _retry(t = this.connectivity ? this._heartBeatInterval : this._timeToRetry) {\n    this._clearTimeout();\n\n    this._retryTimeoutId = setTimeout(() => {\n      this._retryTimeoutId = null;\n      this._checkConnection();\n    }, t);\n  }\n}\n"],"mappings":"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","ignoreList":[]}
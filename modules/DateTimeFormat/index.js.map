{"version":3,"sources":["modules/DateTimeFormat/index.js"],"names":["DateTimeFormat","deps","dep","optional","locale","options","actionTypes","_locale","_reducer","_proxyReducer","_formatters","pending","ready","_shouldInit","store","dispatch","type","init","_defaultFormatter","initSuccess","_shouldReset","reset","resetSuccess","subscribe","_onStateChange","proxyPending","proxyReady","proxyInit","proxyInitSuccess","name","formatter","Error","utcTimestamp","currentLocale","formatDateTime","proxyState","status","state"],"mappings":"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","file":"index.js","sourcesContent":["import RcModule from '../../lib/RcModule';\nimport { Module } from '../../lib/di';\nimport ensureExist from '../../lib/ensureExist';\nimport getIntlDateTimeFormatter from '../../lib/getIntlDateTimeFormatter';\nimport actionTypes from './actionTypes';\nimport getDateTimeFormatReducer from './getDateTimeFormatReducer';\nimport getProxyReducer from './getProxyReducer';\n\n/**\n * @class DateTimeFormat\n * @description Simple date and time formatting manager.\n */\n@Module({\n  deps: ['Locale', { dep: 'DateTimeFormatOptions', optional: true }]\n})\nexport default class DateTimeFormat extends RcModule {\n  /**\n   * @constructor\n   * @param {Object} params - params object\n   * @param {Locale} params.locale - locale module instance\n   */\n  constructor({\n    locale,\n    ...options\n  }) {\n    super({\n      ...options,\n      actionTypes,\n    });\n    this._locale = ensureExist(locale, 'locale');\n\n    this._reducer = getDateTimeFormatReducer(this.actionTypes);\n    this._proxyReducer = getProxyReducer(this.actionTypes);\n\n    this._formatters = {};\n  }\n  _shouldInit() {\n    return this.pending && this._locale.ready;\n  }\n  _shouldReset() {\n    return this.ready && !this._locale.ready;\n  }\n  _onStateChange() {\n    if (this._shouldInit()) {\n      this.store.dispatch({\n        type: this.actionTypes.init,\n      });\n      if (!this._defaultFormatter) {\n        this._defaultFormatter = getIntlDateTimeFormatter();\n      }\n      this.store.dispatch({\n        type: this.actionTypes.initSuccess,\n      });\n    } else if (this._shouldReset()) {\n      this.store.dispatch({\n        type: this.actionTypes.reset,\n      });\n      this._formatters = {};\n      this.store.dispatch({\n        type: this.actionTypes.resetSuccess,\n      });\n    }\n  }\n  initialize() {\n    this.store.subscribe(() => this._onStateChange());\n  }\n  initializeProxy() {\n    this.store.subscribe(() => {\n      if (\n        this.proxyPending &&\n        this._locale.proxyReady\n      ) {\n        this.store.dispatch({\n          type: this.actionTypes.proxyInit,\n        });\n        if (!this._defaultFormatter) {\n          this._defaultFormatter = getIntlDateTimeFormatter();\n        }\n        this.store.dispatch({\n          type: this.actionTypes.proxyInitSuccess,\n        });\n      }\n    });\n  }\n  addFormatter({\n    name,\n    formatter,\n  }) {\n    if (!name) {\n      throw new Error('`name` property cannot be empty.');\n    }\n    if (this._formatters[name]) {\n      throw new Error(`A formatter with the same name: ${name} already exists.`);\n    }\n    if (typeof formatter !== 'function') {\n      throw new Error('formatter must be a function.');\n    }\n    this._formatters[name] = formatter;\n  }\n\n  formatDateTime({\n    name,\n    utcTimestamp,\n    locale = this._locale.currentLocale,\n    type,\n  }) {\n    if (name && typeof this._formatters[name] === 'function') {\n      return this._formatters[name]({\n        utcTimestamp,\n        locale,\n        type,\n      });\n    }\n    return this._defaultFormatter({\n      utcTimestamp,\n      locale,\n      type,\n    });\n  }\n  formatDate({\n    name,\n    utcTimestamp,\n    locale,\n  }) {\n    return this.formatDateTime({\n      name,\n      utcTimestamp,\n      locale,\n      type: 'date',\n    });\n  }\n  formatTime({\n    name,\n    utcTimestamp,\n    locale,\n  }) {\n    return this.formatDateTime({\n      name,\n      utcTimestamp,\n      locale,\n      type: 'time',\n    });\n  }\n\n  get status() {\n    return (this.proxyState && this.proxyState.status) || this.state.status;\n  }\n\n  get proxyStatus() {\n    return this.proxyState.status;\n  }\n}\n"]}
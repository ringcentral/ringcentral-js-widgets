{"version":3,"file":"ExtensionFeatures.js","names":["_core","require","_ramda","_permissionsMessages","_subscriptionFilters","_subscriptionHints","_di","_Auth","_DataFetcherV","_dec","_dec2","_class","_class2","_slicedToArray","r","e","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","a","_arrayLikeToArray","t","toString","call","slice","constructor","name","Array","from","test","length","n","l","Symbol","iterator","i","u","f","o","next","Object","done","push","value","isArray","asyncGeneratorStep","c","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","ownKeys","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","enumerable","_objectSpread","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_toPropertyKey","configurable","writable","_classCallCheck","_defineProperties","key","_createClass","prototype","_toPrimitive","_typeof","toPrimitive","String","Number","_inherits","create","_setPrototypeOf","setPrototypeOf","bind","__proto__","_createSuper","_isNativeReflectConstruct","_getPrototypeOf","s","Reflect","construct","_possibleConstructorReturn","_assertThisInitialized","ReferenceError","Boolean","valueOf","getPrototypeOf","_applyDecoratedDescriptor","initializer","reverse","reduce","ExtensionFeatures","Module","deps","dep","optional","computed","_ref","data","_DataFetcherV2Consume","_super","_deps$extensionFeatur","_deps$extensionFeatur2","_this$_deps$subscript","_this","_stopWatchingSubscription","_handleSubscription","message","_this$_deps$tabManage","_this$_deps$tabManage2","_message$body","ready","_source","disableCache","_deps","tabManager","active","body","hints","includes","subscriptionHints","limits","features","permissions","fetchData","DataSource","polling","extensionFeaturesOptions","cleanOnReset","fetchFunction","_fetchFunction","regeneratorRuntime","mark","_callee","response","_response","wrap","_callee$","_context","prev","client","service","platform","get","sent","abrupt","json","t0","status","auth","logout","alert","danger","permissionsMessages","insufficientPrivilege","ttl","stop","readyCheckFunction","dataFetcherV2","register","subscription","filters","subscriptionFilters","extensionInfo","onInitOnce","_this2","watch","_this2$features","_this2$features$ReadE","ReadExtensionInfo","available","loginStatus","loggedIn","_ref3","_callee2","_ref2","_ref4","hasData","readExtensionInfo","_callee2$","_context2","_x","multiple","onInit","_this3","onReset","_this$_stopWatchingSu","_this$data$records","_this$data","item","id","records","DataFetcherV2Consumer","exports"],"sources":["modules/ExtensionFeatures/ExtensionFeatures.ts"],"sourcesContent":["import type ExtensionInfoEvent from '@rc-ex/core/lib/definitions/ExtensionInfoEvent';\nimport type FeatureInfo from '@rc-ex/core/lib/definitions/FeatureInfo';\nimport type FeatureList from '@rc-ex/core/lib/definitions/FeatureList';\nimport { computed, watch } from '@ringcentral-integration/core';\nimport { reduce } from 'ramda';\nimport type { Unsubscribe } from 'redux';\n\nimport { permissionsMessages } from '../../enums/permissionsMessages';\nimport { subscriptionFilters } from '../../enums/subscriptionFilters';\nimport { subscriptionHints } from '../../enums/subscriptionHints';\nimport { Module } from '../../lib/di';\nimport { loginStatus } from '../Auth';\nimport { DataFetcherV2Consumer, DataSource } from '../DataFetcherV2';\n\nimport type { Deps } from './ExtensionFeatures.interface';\n\n@Module({\n  name: 'ExtensionFeatures',\n  deps: [\n    'Auth',\n    'Alert',\n    'Client',\n    'DataFetcherV2',\n    { dep: 'Subscription', optional: true },\n    { dep: 'TabManager', optional: true },\n    { dep: 'ExtensionFeaturesOptions', optional: true },\n  ],\n})\nexport class ExtensionFeatures extends DataFetcherV2Consumer<\n  Deps,\n  FeatureList\n> {\n  // @ts-expect-error TS(2322): Type 'null' is not assignable to type 'Unsubscribe... Remove this comment to see the full error message\n  protected _stopWatchingSubscription: Unsubscribe = null;\n  constructor(deps: Deps) {\n    super({\n      deps,\n    });\n\n    this._source = new DataSource({\n      polling: deps.extensionFeaturesOptions?.polling ?? true,\n      ...deps.extensionFeaturesOptions,\n      key: 'extensionFeatures',\n      cleanOnReset: true,\n      fetchFunction: async () => {\n        try {\n          const response = await this._deps.client.service\n            .platform()\n            .get('/restapi/v1.0/account/~/extension/~/features');\n          return response.json();\n        } catch (error: any /** TODO: confirm with instanceof */) {\n          if ((error as { response?: Response }).response?.status === 403) {\n            await this._deps.auth.logout();\n            this._deps.alert.danger({\n              message: permissionsMessages.insufficientPrivilege,\n              ttl: 0,\n            });\n            return {};\n          }\n          throw error;\n        }\n      },\n      readyCheckFunction: () => true,\n    });\n    this._deps.dataFetcherV2.register(this._source);\n\n    this._deps.subscription?.register(this, {\n      filters: [subscriptionFilters.extensionInfo],\n    });\n  }\n\n  protected _handleSubscription = (message?: ExtensionInfoEvent) => {\n    if (\n      this.ready &&\n      (this._source.disableCache || (this._deps.tabManager?.active ?? true)) &&\n      message?.body?.hints &&\n      (message.body.hints.includes(subscriptionHints.limits) ||\n        message.body.hints.includes(subscriptionHints.features) ||\n        message.body.hints.includes(subscriptionHints.permissions))\n    ) {\n      this.fetchData();\n    }\n  };\n\n  override onInitOnce() {\n    watch(\n      this,\n      () => [\n        this.ready,\n        !!this.data,\n        !!this.features?.ReadExtensionInfo?.available,\n        this._deps.auth.loginStatus === loginStatus.loggedIn,\n      ],\n      async ([ready, hasData, readExtensionInfo, loggedIn]) => {\n        if (ready && loggedIn && !readExtensionInfo) {\n          await this._deps.auth.logout();\n          if (hasData) {\n            // only show alert if featuresList was successfully fetched,\n            // but the user has no ReadExtensionInfo feature\n            this._deps.alert.danger({\n              message: permissionsMessages.insufficientPrivilege,\n              ttl: 0,\n            });\n          }\n        }\n      },\n      {\n        multiple: true,\n      },\n    );\n  }\n\n  override onInit() {\n    if (this._deps.subscription) {\n      this._stopWatchingSubscription = watch(\n        this,\n        () =>\n          this._deps.subscription!.message as ExtensionInfoEvent | undefined,\n        this._handleSubscription,\n      );\n    }\n  }\n\n  override onReset() {\n    this._stopWatchingSubscription?.();\n    // @ts-expect-error TS(2322): Type 'null' is not assignable to type 'Unsubscribe... Remove this comment to see the full error message\n    this._stopWatchingSubscription = null;\n  }\n\n  @computed(({ data }: ExtensionFeatures) => [data])\n  get features() {\n    return reduce(\n      (features, item) => {\n        if (item && item.id) features[item.id] = item;\n        return features;\n      },\n      {} as Record<string, FeatureInfo>,\n      this.data?.records ?? [],\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}
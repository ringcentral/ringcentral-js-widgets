{"version":3,"sources":["modules/LocaleSettingsV2/LocaleSettings.ts"],"names":["LocaleSettings","name","deps","dep","optional","enableGlobalCache","storageKey","_supportedLocales","supportedLocales","_deps","localeSettingsOptions","DEFAULT_LOCALE","slice","sort","locale","savedLocale","saveLocale","currentLocale","setLocale","_saveLocale","RcModuleV2","globalStorage","state","action","proxify"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AAMA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAWaA,c,WARZ,gBAAO;AACNC,EAAAA,IAAI,EAAE,gBADA;AAENC,EAAAA,IAAI,EAAE,CACJ,eADI,EAEJ,QAFI,EAGJ;AAAEC,IAAAA,GAAG,EAAE,uBAAP;AAAgCC,IAAAA,QAAQ,EAAE;AAA1C,GAHI;AAFA,CAAP,C;;;;;AAYC,0BAAYF,IAAZ,EAAwB;AAAA;;AAAA;;AAAA;;AACtB,8BAAM;AACJA,MAAAA,IAAI,EAAJA,IADI;AAEJG,MAAAA,iBAAiB,EAAE,IAFf;AAGJC,MAAAA,UAAU,EAAE;AAHR,KAAN;AADsB,UAHdC,iBAGc;AAAA,UAFjBC,gBAEiB;;AAAA;;AAMtB,UAAKD,iBAAL,sDAAyB,MAAKE,KAAL,CAAWC,qBAApC,2DAAyB,uBACrBF,gBADJ,yEACwB,CAACG,oBAAD,CADxB;AAEA,UAAKH,gBAAL,GAAwB,MAAKD,iBAAL,CAAuBK,KAAvB,GAA+BC,IAA/B,EAAxB;AARsB;AASvB;;;;gCAOqBC,M,EAAgB;AACpC,WAAKC,WAAL,GAAmBD,MAAnB;AACD;;;;;;;;;oBAGM,KAAKC,W;;;;;AACR,qBAAKC,UAAL,CAAgB,KAAKP,KAAL,CAAWK,MAAX,CAAkBG,aAAlC;;;;;sBACS,KAAKF,WAAL,KAAqB,KAAKN,KAAL,CAAWK,MAAX,CAAkBG,a;;;;;;uBAC1C,KAAKR,KAAL,CAAWK,MAAX,CAAkBI,SAAlB,CAA4B,KAAKH,WAAjC,C;;;;;;;;;;;;;;;;;;;mGAKOD,M;;;;;;uBACT,KAAKL,KAAL,CAAWK,MAAX,CAAkBI,SAAlB,CAA4BJ,MAA5B,C;;;AACN,qBAAKK,WAAL,CAAiBL,MAAjB;;;;;;;;;;;;;;;;;;;EAnCgCM,gB,uFAejCC,mB,EACAC,W;;;;;WACqB,I;;iEAErBC,Y,sJAaAC,mB","sourcesContent":["import { DEFAULT_LOCALE } from '@ringcentral-integration/i18n';\nimport {\n  action,\n  RcModuleV2,\n  state,\n  globalStorage,\n} from '@ringcentral-integration/core';\nimport proxify from '../../lib/proxy/proxify';\nimport { Module } from '../../lib/di';\nimport { Deps } from './LocaleSettings.interface';\n\n@Module({\n  name: 'LocaleSettings',\n  deps: [\n    'GlobalStorage',\n    'Locale',\n    { dep: 'LocaleSettingsOptions', optional: true },\n  ],\n})\nexport class LocaleSettings extends RcModuleV2<Deps> {\n  protected _supportedLocales: string[];\n  public supportedLocales: string[];\n\n  constructor(deps: Deps) {\n    super({\n      deps,\n      enableGlobalCache: true,\n      storageKey: 'LocaleSettings',\n    });\n    this._supportedLocales = this._deps.localeSettingsOptions\n      ?.supportedLocales ?? [DEFAULT_LOCALE];\n    this.supportedLocales = this._supportedLocales.slice().sort();\n  }\n\n  @globalStorage\n  @state\n  savedLocale: string = null;\n\n  @action\n  protected _saveLocale(locale: string) {\n    this.savedLocale = locale;\n  }\n\n  async onInit() {\n    if (!this.savedLocale) {\n      this.saveLocale(this._deps.locale.currentLocale);\n    } else if (this.savedLocale !== this._deps.locale.currentLocale) {\n      await this._deps.locale.setLocale(this.savedLocale);\n    }\n  }\n\n  @proxify\n  async saveLocale(locale: string) {\n    await this._deps.locale.setLocale(locale);\n    this._saveLocale(locale);\n  }\n}\n"],"file":"LocaleSettings.js"}
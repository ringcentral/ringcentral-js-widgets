{"version":3,"sources":["modules/SettingsUI/SettingsUI.ts"],"names":["DEFAULT_REGION_SETTINGS_URL","DEFAULT_CALLING_SETTINGS_URL","DEFAULT_AUDIO_SETTINGS_URL","DEFAULT_FEEDBACK_SETTINGS_URL","SettingsUI","name","deps","dep","optional","showRegion","showCalling","showAudio","showFeedback","showUserGuide","showPresenceSettings","showQuickAccess","params","_deps","accountInfo","auth","brand","extensionInfo","extensionFeatures","locale","localeSettings","regionSettings","callingSettings","version","appFeatures","presence","userGuide","loginNumber","loggedIn","loginStatus","ready","mainCompanyNumber","extensionNumber","phoneNumber","join","countryCode","areaCode","showSpinner","isCallingEnabled","brandConfig","allowRegionSetting","showRegionSetting","currentLocale","brandId","id","ringoutEnabled","isRingOutEnabled","outboundSMS","hasOutboundSMSPermission","hasInternalSMSPermission","isCallQueueMember","dndStatus","userStatus","openPresenceSettings","features","EditPresenceStatus","available","supportedLocales","savedLocale","hasPermission","regionSettingsUrl","callingSettingsUrl","audioSettingsUrl","feedbackSettingsUrl","routerInteraction","quickAccess","onLogoutButtonClick","logout","onRegionSettingsLinkClick","push","onCallingSettingsLinkClick","onAudioSettingsLinkClick","onFeedbackSettingsLinkClick","onUserGuideClick","start","onQuickAccessLinkClick","enter","setAvailable","args","setBusy","setDoNotDisturb","setInvisible","toggleAcceptCallQueueCalls","saveLocale","RcUIModuleV2"],"mappings":"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","sourcesContent":["import {\n  RcUIModuleV2,\n  UIFunctions,\n  UIProps,\n} from '@ringcentral-integration/core';\nimport { Module } from '@ringcentral-integration/commons/lib/di';\nimport formatNumber from '@ringcentral-integration/commons/lib/formatNumber';\nimport loginStatus from '@ringcentral-integration/commons/modules/Auth/loginStatus';\nimport {\n  Deps,\n  SettingsContainerProps,\n  SettingsPanelProps,\n} from './SettingUI.interface';\n\nconst DEFAULT_REGION_SETTINGS_URL = '/settings/region';\nconst DEFAULT_CALLING_SETTINGS_URL = '/settings/calling';\nconst DEFAULT_AUDIO_SETTINGS_URL = '/settings/audio';\nconst DEFAULT_FEEDBACK_SETTINGS_URL = '/settings/feedback';\n\n@Module({\n  name: 'SettingsUI',\n  deps: [\n    'Auth',\n    'Brand',\n    'Locale',\n    'AccountInfo',\n    'ExtensionInfo',\n    'RegionSettings',\n    'ExtensionFeatures',\n    'AppFeatures',\n    'RouterInteraction',\n    {\n      dep: 'Version',\n      optional: true,\n    },\n    {\n      dep: 'Presence',\n      optional: true,\n    },\n    {\n      dep: 'CallingSettings',\n      optional: true,\n    },\n    {\n      dep: 'LocaleSettings',\n      optional: true,\n    },\n    {\n      dep: 'QuickAccess',\n      optional: true,\n    },\n    {\n      dep: 'UserGuide',\n      optional: true,\n    },\n    {\n      dep: 'SettingsUIOptions',\n      optional: true,\n    },\n  ],\n})\nexport class SettingsUI<T extends Deps = Deps> extends RcUIModuleV2<T> {\n  constructor(deps: T) {\n    super({ deps });\n  }\n\n  getUIProps({\n    showRegion = true,\n    showCalling = true,\n    showAudio = true,\n    showFeedback = true,\n    showUserGuide = true,\n    showPresenceSettings = true,\n    showQuickAccess = false,\n    params,\n  }: SettingsContainerProps): UIProps<SettingsPanelProps> {\n    const {\n      accountInfo,\n      auth,\n      brand,\n      extensionInfo,\n      extensionFeatures,\n      locale,\n      localeSettings,\n      regionSettings,\n      callingSettings,\n      version,\n      appFeatures,\n      presence,\n      userGuide,\n    } = this._deps;\n    let loginNumber = brand.name;\n    const loggedIn = auth.loginStatus === loginStatus.loggedIn;\n    if (\n      loggedIn &&\n      accountInfo.ready &&\n      extensionInfo.ready &&\n      accountInfo.mainCompanyNumber\n    ) {\n      // If no extensionNumber, extensionNumber field needs to be omitted\n      const extensionNumber =\n        extensionInfo.extensionNumber && extensionInfo.extensionNumber !== '0'\n          ? extensionInfo.extensionNumber\n          : null;\n      const phoneNumber = [accountInfo.mainCompanyNumber, extensionNumber].join(\n        '*',\n      );\n      loginNumber = formatNumber({\n        phoneNumber,\n        countryCode: regionSettings.countryCode,\n        areaCode: regionSettings.areaCode,\n      });\n    }\n    return {\n      version,\n      loginNumber,\n      showFeedback,\n      showQuickAccess,\n      showSpinner: !(\n        accountInfo.ready &&\n        auth.ready &&\n        loggedIn &&\n        extensionInfo.ready &&\n        locale.ready &&\n        regionSettings.ready &&\n        (!callingSettings || callingSettings.ready) &&\n        appFeatures.ready &&\n        (!presence || presence.ready) &&\n        (!localeSettings || localeSettings.ready)\n      ),\n      showCalling:\n        showCalling && callingSettings && appFeatures.isCallingEnabled,\n      showAudio: showAudio && appFeatures.isCallingEnabled,\n      showRegion:\n        loggedIn &&\n        brand.brandConfig.allowRegionSetting &&\n        regionSettings.showRegionSetting &&\n        appFeatures.isCallingEnabled &&\n        showRegion,\n      currentLocale: locale.currentLocale,\n      brandId: brand.id,\n      ringoutEnabled: appFeatures.isRingOutEnabled,\n      outboundSMS:\n        !!appFeatures.hasOutboundSMSPermission ||\n        !!appFeatures.hasInternalSMSPermission,\n      isCallQueueMember: extensionInfo.isCallQueueMember,\n      dndStatus: presence?.dndStatus,\n      userStatus: presence?.userStatus,\n      openPresenceSettings: !!(\n        presence &&\n        params &&\n        params.showPresenceSettings\n      ),\n      showPresenceSettings:\n        showPresenceSettings &&\n        !!extensionFeatures.features?.EditPresenceStatus?.available,\n      supportedLocales: localeSettings?.supportedLocales,\n      savedLocale: localeSettings?.savedLocale,\n      showUserGuide: showUserGuide && !!userGuide?.hasPermission,\n    };\n  }\n\n  getUIFunctions({\n    regionSettingsUrl = DEFAULT_REGION_SETTINGS_URL,\n    callingSettingsUrl = DEFAULT_CALLING_SETTINGS_URL,\n    audioSettingsUrl = DEFAULT_AUDIO_SETTINGS_URL,\n    feedbackSettingsUrl = DEFAULT_FEEDBACK_SETTINGS_URL,\n  }: SettingsContainerProps): UIFunctions<SettingsPanelProps> {\n    const {\n      auth,\n      presence,\n      routerInteraction,\n      localeSettings,\n      userGuide,\n      quickAccess,\n    } = this._deps;\n    return {\n      async onLogoutButtonClick() {\n        await auth.logout();\n      },\n      onRegionSettingsLinkClick() {\n        routerInteraction.push(regionSettingsUrl);\n      },\n      onCallingSettingsLinkClick() {\n        routerInteraction.push(callingSettingsUrl);\n      },\n      onAudioSettingsLinkClick() {\n        routerInteraction.push(audioSettingsUrl);\n      },\n      onFeedbackSettingsLinkClick() {\n        routerInteraction.push(feedbackSettingsUrl);\n      },\n      onUserGuideClick() {\n        userGuide.start();\n      },\n      onQuickAccessLinkClick() {\n        quickAccess.enter();\n      },\n      setAvailable: (...args) => presence?.setAvailable(...args),\n      setBusy: (...args) => presence?.setBusy(...args),\n      setDoNotDisturb: (...args) => presence?.setDoNotDisturb(...args),\n      setInvisible: (...args) => presence?.setInvisible(...args),\n      toggleAcceptCallQueueCalls: (...args) =>\n        presence?.toggleAcceptCallQueueCalls(...args),\n      saveLocale:\n        localeSettings && ((locale) => localeSettings.saveLocale(locale)),\n    };\n  }\n}\n"],"file":"SettingsUI.js"}
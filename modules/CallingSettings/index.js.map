{"version":3,"sources":["modules/CallingSettings/index.ts"],"names":["LOCATION_NUMBER_ORDER","BLOCKED_ID_VALUE","CallingSettings","deps","dep","optional","alert","brand","extensionInfo","extensionPhoneNumber","forwardingNumber","storage","appFeatures","tabManager","onFirstLogin","webphone","callerId","extensionFeatures","emergencyCallAvailable","defaultRingoutPrompt","showCallWithJupiter","extensionDevice","options","actionTypes","_alert","_brand","_extensionInfo","_extensionPhoneNumber","_forwardingNumber","_storage","_appFeatures","_tabManager","_webphone","_callerId","_storageKey","_emergencyCallAvailable","_extensionDevice","_onFirstLogin","_extensionFeatures","initRingoutPrompt","registerReducer","key","reducer","_reducer","_showCallWithJupiter","store","subscribe","_onStateChange","_shouldInit","dispatch","type","init","_init","initSuccess","_shouldReset","_reset","_shouldValidate","_ringoutEnabled","isRingOutEnabled","_webphoneEnabled","isWebPhoneEnabled","_myPhoneNumbers","myPhoneNumbers","_otherPhoneNumbers","otherPhoneNumbers","_blockedIdDisabled","isBlockedIdDisabled","_validateSettings","ready","pending","isCallingEnabled","_availableNumbers","availableNumbers","timestamp","defaultCallWith","callWithOptions","setData","callWith","Date","now","_warningEmergencyCallingNotAvailable","deprecatedCallingOptions","myphone","otherphone","customphone","callingOptions","ringout","isCustomLocation","_initFromNumber","resetSuccess","fromNumber","defaultCallerId","fromNumbers","ringOut","phoneNumber","defaultPhoneNumber","phoneInfo","defaultEntry","find","item","updateFromNumber","number","softphone","_hasWebphonePermissionRemoved","_setSoftPhoneToCallWith","danger","message","callingSettingsMessages","webphonePermissionRemoved","ttl","_hasPermissionChanged","permissionChanged","_hasPhoneNumberChanged","myLocation","phoneNumberChanged","browser","indexOf","devices","flipNumbers","mainCompanyNumber","extensionNumber","mainPhoneNumber","name","length","registedWithDevice","forEach","device","phoneLines","phoneLine","isFlipNumber","flipNumber","label","info","emergencyCallingNotAvailable","withPrompt","ringoutPrompt","saveSuccessWithSoftphone","jupiter","saveSuccessWithJupiter","saveSuccess","getItem","state","status","moduleStatuses","data","callingMode","callingModes","driver","features","BlockingCallerId","available","RcModule","proxify","selector","numbers","ringoutEnabled","webphoneEnabled","hasOtherPhone","hasExtensionPhoneNumber","push","directNumbers","map","callerIdNumbers","filterMapping","filter","sort","a","b","phoneNumbers","concat","result","locationLabel","_getLocationLabel","value","firstItem","lastItem","usageType"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAIA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,IAAMA,qBAAqB,GAAG,CAAC,OAAD,EAAU,MAAV,CAA9B;AACA,IAAMC,gBAAgB,GAAG,WAAzB;AACA;AACA;AACA;AACA;;IAkBqBC,e,WAjBpB,gBAAO;AACNC,EAAAA,IAAI,EAAE,CACJ,OADI,EAEJ,OAFI,EAGJ,eAHI,EAIJ,sBAJI,EAKJ,kBALI,EAMJ,SANI,EAOJ,aAPI,EAQJ,iBARI,EASJ,mBATI,EAUJ;AAAEC,IAAAA,GAAG,EAAE,UAAP;AAAmBC,IAAAA,QAAQ,EAAE;AAA7B,GAVI,EAWJ;AAAED,IAAAA,GAAG,EAAE,YAAP;AAAqBC,IAAAA,QAAQ,EAAE;AAA/B,GAXI,EAYJ;AAAED,IAAAA,GAAG,EAAE,UAAP;AAAmBC,IAAAA,QAAQ,EAAE;AAA7B,GAZI,EAaJ;AAAED,IAAAA,GAAG,EAAE,wBAAP;AAAiCC,IAAAA,QAAQ,EAAE;AAA3C,GAbI;AADA,CAAP,C;;;;;AAkBC,iCAkBG;AAAA;;AAAA,QAjBDC,KAiBC,QAjBDA,KAiBC;AAAA,QAhBDC,KAgBC,QAhBDA,KAgBC;AAAA,QAfDC,aAeC,QAfDA,aAeC;AAAA,QAdDC,oBAcC,QAdDA,oBAcC;AAAA,QAbDC,gBAaC,QAbDA,gBAaC;AAAA,QAZDC,OAYC,QAZDA,OAYC;AAAA,QAXDC,WAWC,QAXDA,WAWC;AAAA,QAVDC,UAUC,QAVDA,UAUC;AAAA,QATDC,YASC,QATDA,YASC;AAAA,QARDC,QAQC,QARDA,QAQC;AAAA,QAPDC,QAOC,QAPDA,QAOC;AAAA,QANDC,iBAMC,QANDA,iBAMC;AAAA,qCALDC,sBAKC;AAAA,QALDA,sBAKC,sCALwB,KAKxB;AAAA,QAJDC,oBAIC,QAJDA,oBAIC;AAAA,qCAHDC,mBAGC;AAAA,QAHDA,mBAGC,sCAHqB,IAGrB;AAAA,QAFDC,eAEC,QAFDA,eAEC;AAAA,QADEC,OACF;;AAAA;;AACD,8DACKA,OADL;AAEEC,MAAAA,WAAW,EAAXA;AAFF;;AADC;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAKD,UAAKC,MAAL,GAAclB,KAAd;AACA,UAAKmB,MAAL,GAAclB,KAAd;AACA,UAAKmB,cAAL,GAAsBlB,aAAtB;AACA,UAAKmB,qBAAL,GAA6BlB,oBAA7B;AACA,UAAKmB,iBAAL,GAAyBlB,gBAAzB;AACA,UAAKmB,QAAL,GAAgBlB,OAAhB;AACA,UAAKmB,YAAL,GAAoBlB,WAApB;AACA,UAAKmB,WAAL,GAAmBlB,UAAnB;AACA,UAAKmB,SAAL,GAAiBjB,QAAjB;AACA,UAAKkB,SAAL,GAAiBjB,QAAjB;AACA,UAAKkB,WAAL,GAAmB,qBAAnB;AACA,UAAKC,uBAAL,GAA+BjB,sBAA/B;AACA,UAAKkB,gBAAL,GAAwBf,eAAxB;AACA,UAAKgB,aAAL,GAAqBvB,YAArB;AACA,UAAKwB,kBAAL,GAA0BrB,iBAA1B;AACA,UAAKsB,iBAAL,GAAyBpB,oBAAzB;;AAEA,UAAKU,QAAL,CAAcW,eAAd,CAA8B;AAC5BC,MAAAA,GAAG,EAAE,MAAKP,WADkB;AAE5BQ,MAAAA,OAAO,EAAE,iEAAiC,MAAKnB,WAAtC;AAFmB,KAA9B;;AAKA,UAAKoB,QAAL,GAAgB,0DAA0B,MAAKpB,WAA/B,CAAhB;AACA,UAAKqB,oBAAL,GAA4BxB,mBAA5B;AA5BC;AA6BF;;;;iCAEY;AAAA;;AACX,WAAKyB,KAAL,CAAWC,SAAX,CAAqB;AAAA,eAAM,MAAI,CAACC,cAAL,EAAN;AAAA,OAArB;AACD;;;;;;;;;qBAGK,KAAKC,WAAL,E;;;;;AACF,qBAAKH,KAAL,CAAWI,QAAX,CAAoB;AAClBC,kBAAAA,IAAI,EAAE,KAAK3B,WAAL,CAAiB4B;AADL,iBAApB;;uBAGM,KAAKC,KAAL,E;;;AACN,qBAAKP,KAAL,CAAWI,QAAX,CAAoB;AAClBC,kBAAAA,IAAI,EAAE,KAAK3B,WAAL,CAAiB8B;AADL,iBAApB;;;;;qBAGS,KAAKC,YAAL,E;;;;;AACT,qBAAKC,MAAL;;;;;;qBACS,KAAKC,eAAL,E;;;;;AACT,qBAAKC,eAAL,GAAuB,KAAK3B,YAAL,CAAkB4B,gBAAzC;AACA,qBAAKC,gBAAL,GAAwB,KAAK7B,YAAL,CAAkB8B,iBAA1C;AACA,qBAAKC,eAAL,GAAuB,KAAKC,cAA5B;AACA,qBAAKC,kBAAL,GAA0B,KAAKC,iBAA/B;AACA,qBAAKC,kBAAL,GAA0B,KAAKC,mBAA/B;;uBACM,KAAKC,iBAAL,E;;;;;;;;;;;;;;;;;;kCAII;AACZ,aACE,KAAKtC,QAAL,CAAcuC,KAAd,IACA,KAAK1C,cAAL,CAAoB0C,KADpB,IAEA,KAAKzC,qBAAL,CAA2ByC,KAF3B,IAGA,KAAKxC,iBAAL,CAAuBwC,KAHvB,KAIC,CAAC,KAAKnC,SAAN,IAAmB,KAAKA,SAAL,CAAemC,KAJnC,KAKA,KAAKtC,YAAL,CAAkBsC,KALlB,IAMA,KAAKhC,gBAAL,CAAsBgC,KANtB,IAOA,KAAKC,OARP;AAUD;;;mCAEc;AACb,aAAO,CAAC,EACN,KAAKD,KAAL,KACC,CAAC,KAAKvC,QAAL,CAAcuC,KAAf,IACC,CAAC,KAAK1C,cAAL,CAAoB0C,KADtB,IAEC,CAAC,KAAKzC,qBAAL,CAA2ByC,KAF7B,IAGC,CAAC,KAAKxC,iBAAL,CAAuBwC,KAHzB,IAIC,CAAC,KAAKtC,YAAL,CAAkBsC,KAJpB,IAKE,KAAKnC,SAAL,IAAkB,CAAC,KAAKA,SAAL,CAAemC,KALpC,IAMC,CAAC,KAAKhC,gBAAL,CAAsBgC,KAPzB,CADM,CAAR;AAUD;;;sCAEiB;AAChB,aACE,KAAKA,KAAL,KACC,KAAKX,eAAL,KAAyB,KAAK3B,YAAL,CAAkB4B,gBAA3C,IACC,KAAKC,gBAAL,KAA0B,KAAK7B,YAAL,CAAkB8B,iBAD7C,IAEC,KAAKC,eAAL,KAAyB,KAAKC,cAF/B,IAGC,KAAKC,kBAAL,KAA4B,KAAKC,iBAHlC,IAIC,KAAKC,kBAAL,KAA4B,KAAKC,mBALnC,CADF;AAQD;;;;;;;;;;oBAGM,KAAKpC,YAAL,CAAkBwC,gB;;;;;;;;AACvB,qBAAKT,eAAL,GAAuB,KAAKC,cAA5B;AACA,qBAAKC,kBAAL,GAA0B,KAAKC,iBAA/B;AACA,qBAAKO,iBAAL,GAAyB,KAAKC,gBAA9B;AACA,qBAAKf,eAAL,GAAuB,KAAK3B,YAAL,CAAkB4B,gBAAzC;AACA,qBAAKC,gBAAL,GAAwB,KAAK7B,YAAL,CAAkB8B,iBAA1C;AACA,qBAAKK,kBAAL,GAA0B,KAAKC,mBAA/B;;AACA,oBAAI,CAAC,KAAKO,SAAV,EAAqB;AACnB;AACMC,kBAAAA,eAFa,GAEK,KAAKC,eAAL,IAAwB,KAAKA,eAAL,CAAqB,CAArB,CAF7B;AAGnB,uBAAK9B,KAAL,CAAWI,QAAX,CAAoB;AAClBC,oBAAAA,IAAI,EAAE,KAAK3B,WAAL,CAAiBqD,OADL;AAElBC,oBAAAA,QAAQ,EAAEH,eAFQ;AAGlBD,oBAAAA,SAAS,EAAEK,IAAI,CAACC,GAAL;AAHO,mBAApB;;AAKA,sBAAI,CAAC,KAAK5C,uBAAV,EAAmC;AACjC,yBAAK6C,oCAAL;AACD;;AACD,sBAAI,OAAO,KAAK3C,aAAZ,KAA8B,UAAlC,EAA8C;AAC5C,yBAAKA,aAAL;AACD;AACF;;AACD,oBACE,KAAKwC,QAAL,KAAkBI,qCAAyBC,OAA3C,IACA,KAAKL,QAAL,KAAkBI,qCAAyBE,UAD3C,IAEA,KAAKN,QAAL,KAAkBI,qCAAyBG,WAH7C,EAIE;AACA,uBAAKvC,KAAL,CAAWI,QAAX,CAAoB;AAClBC,oBAAAA,IAAI,EAAE,KAAK3B,WAAL,CAAiBqD,OADL;AAElBC,oBAAAA,QAAQ,EAAEQ,2BAAeC,OAFP;AAGlBC,oBAAAA,gBAAgB,EACd,KAAKV,QAAL,KAAkBI,qCAAyBG;AAJ3B,mBAApB;AAMD;;;uBACK,KAAKjB,iBAAL,E;;;;uBACA,KAAKqB,eAAL,E;;;;;;;;;;;;;;;;;;6BAGC;AACP,WAAK3C,KAAL,CAAWI,QAAX,CAAoB;AAClBC,QAAAA,IAAI,EAAE,KAAK3B,WAAL,CAAiBkE;AADL,OAApB;AAGD;;;;;;;;;;;AAIOC,gBAAAA,U,GAAa,KAAKA,U;;sBAEtB,CAACA,UAAD,IACCA,UAAU,KAAKzF,gBAAf,IAAmC,KAAKiE,mB;;;;;AAErCyB,gBAAAA,e,GAAkB,KAAKC,WAAL,CAAiB,CAAjB,C;;AACtB,uCAAI,KAAK3D,SAAT,oDAAI,gBAAgB4D,OAApB,EAA6B;AAC3B,sBACE,KAAK5D,SAAL,CAAe4D,OAAf,CAAuB3C,IAAvB,KAAgC,SAAhC,IACA,CAAC,KAAKgB,mBAFR,EAGE;AACAyB,oBAAAA,eAAe,GAAG;AAAEG,sBAAAA,WAAW,EAAE7F;AAAf,qBAAlB;AACD,mBALD,MAKO,IAAI,KAAKgC,SAAL,CAAe4D,OAAf,CAAuB3C,IAAvB,KAAgC,aAApC,EAAmD;AAClD6C,oBAAAA,kBADkD,uBAEtD,KAAK9D,SAFiD,8EAEtD,iBAAgB4D,OAAhB,CAAwBG,SAF8B,0DAEtD,sBAAmCF,WAFmB;AAGlDG,oBAAAA,YAHkD,GAGnC,KAAKL,WAAL,CAAiBM,IAAjB,CACnB,UAACC,IAAD;AAAA,6BAAUA,IAAI,CAACL,WAAL,KAAqBC,kBAA/B;AAAA,qBADmB,CAHmC;;AAMxD,wBAAIE,YAAJ,EAAkB;AAChBN,sBAAAA,eAAe,GAAGM,YAAlB;AACD;AACF;AACF;;;uBACK,KAAKG,gBAAL,CAAsBT,eAAtB,C;;;;;;;;;;;;;;;;;;;wGAKaU,M;;;;;AACrB,qBAAKxD,KAAL,CAAWI,QAAX,CAAoB;AAClBC,kBAAAA,IAAI,EAAE,KAAK3B,WAAL,CAAiB6E,gBADL;AAElBC,kBAAAA,MAAM,EAAEA,MAAM,IAAIA,MAAM,CAACP;AAFP,iBAApB;;;;;;;;;;;;;;;;;;;;;;;;AAQA,qBAAKjD,KAAL,CAAWI,QAAX,CAAoB;AAClBC,kBAAAA,IAAI,EAAE,KAAK3B,WAAL,CAAiBqD,OADL;AAElBC,kBAAAA,QAAQ,EAAEQ,2BAAeiB,SAFP;AAGlB7B,kBAAAA,SAAS,EAAEK,IAAI,CAACC,GAAL;AAHO,iBAApB;;;;;;;;;;;;;;;;;;;;;;;;qBASI,KAAKwB,6BAAL,E;;;;;;uBACI,KAAKC,uBAAL,E;;;AACN,qBAAKhF,MAAL,CAAYiF,MAAZ,CAAmB;AACjBC,kBAAAA,OAAO,EAAEC,iDAAwBC,yBADhB;AAEjBC,kBAAAA,GAAG,EAAE;AAFY,iBAAnB;;;;;;qBAIS,KAAKC,qBAAL,E;;;;;;uBACH,KAAKN,uBAAL,E;;;AACN,qBAAKhF,MAAL,CAAYiF,MAAZ,CAAmB;AACjBC,kBAAAA,OAAO,EAAEC,iDAAwBI,iBADhB;AAEjBF,kBAAAA,GAAG,EAAE;AAFY,iBAAnB;;;;;;AAIK,oBAAI,KAAKG,sBAAL,EAAJ,EAAmC;AACxC,uBAAKnE,KAAL,CAAWI,QAAX,CAAoB;AAClBC,oBAAAA,IAAI,EAAE,KAAK3B,WAAL,CAAiBqD,OADL;AAElBC,oBAAAA,QAAQ,EAAEQ,2BAAeC,OAFP;AAGlB2B,oBAAAA,UAAU,EAAE,KAAKpD,eAAL,CAAqB,CAArB,CAHM;AAIlBY,oBAAAA,SAAS,EAAEK,IAAI,CAACC,GAAL;AAJO,mBAApB;;AAMA,uBAAKvD,MAAL,CAAYiF,MAAZ,CAAmB;AACjBC,oBAAAA,OAAO,EAAEC,iDAAwBO,kBADhB;AAEjBL,oBAAAA,GAAG,EAAE;AAFY,mBAAnB;AAID;;;AAED,oBAAI,KAAK3C,mBAAL,IAA4B,KAAKwB,UAAL,KAAoBzF,gBAApD,EAAsE;AACpE,uBAAKuF,eAAL;AACD;;;;;;;;;;;;;;;;;;oDAG6B;AAC9B,aACE,EAAE,KAAK7B,gBAAL,IAAyB,KAAK3B,SAAhC,KACA,KAAK6C,QAAL,KAAkBQ,2BAAe8B,OAFnC;AAID;;;4CAEuB;AACtB,aAAO,CAAC,KAAK1D,eAAN,IAAyB,KAAKoB,QAAL,KAAkBQ,2BAAeC,OAAjE;AACD;;;6CAEwB;AACvB,aACE,KAAKT,QAAL,KAAkBQ,2BAAeC,OAAjC,IACA,CAAC,KAAKC,gBADN,IAEA,KAAKhB,iBAAL,CAAuB6C,OAAvB,CAA+B,KAAKH,UAApC,MAAoD,CAAC,CAHvD;AAKD;;;sCAEiBnB,W,EAAa;AAAA,UACrBuB,OADqB,GACT,KAAKjF,gBADI,CACrBiF,OADqB;AAAA,UAErBC,WAFqB,GAEL,KAAK1F,iBAFA,CAErB0F,WAFqB;AAAA,UAGrBC,iBAHqB,GAGC,KAAK5F,qBAHN,CAGrB4F,iBAHqB;AAAA,UAIrBC,eAJqB,GAID,KAAK9F,cAJJ,CAIrB8F,eAJqB;AAK7B,UAAMC,eAAe,aAAMF,iBAAiB,CAACzB,WAAxB,cAAuC0B,eAAvC,CAArB;AACA,UAAIE,IAAI,GAAG,IAAX;;AACA,UAAIL,OAAO,CAACM,MAAZ,EAAoB;AAClB,YAAIC,kBAAkB,GAAG,KAAzB;AACAP,QAAAA,OAAO,CAACQ,OAAR,CAAgB,UAACC,MAAD,EAAY;AAAA,cAClBC,UADkB,GACHD,MADG,CAClBC,UADkB;;AAE1B,cAAIA,UAAU,CAACJ,MAAf,EAAuB;AACrBC,YAAAA,kBAAkB,GAAGG,UAAU,CAAC7B,IAAX,CAAgB,UAAC8B,SAAD,EAAe;AAClD,qBAAOA,SAAS,CAAChC,SAAV,CAAoBF,WAApB,KAAoCA,WAA3C;AACD,aAFoB,CAArB;;AAGA,gBAAI8B,kBAAJ,EAAwB;AACtBF,cAAAA,IAAI,GAAGI,MAAM,CAACJ,IAAd;AACD;AACF;AACF,SAVD;AAWA,YAAIA,IAAJ,EAAU,OAAOA,IAAP;AACX;;AACD,UAAIJ,WAAW,CAACK,MAAhB,EAAwB;AACtB,YAAMM,YAAY,GAAGX,WAAW,CAACpB,IAAZ,CACnB,UAACgC,UAAD;AAAA,iBAAgBA,UAAU,CAACpC,WAAX,KAA2BA,WAA3C;AAAA,SADmB,CAArB;;AAGA,YAAImC,YAAJ,EAAkB;AAChB,iBAAOA,YAAY,CAACE,KAAb,IAAsB,OAA7B;AACD;AACF;;AAED,UAAIrC,WAAW,KAAK2B,eAApB,EAAqC;AACnC,eAAO,MAAP;AACD;;AACD,aAAO,OAAP;AACD;;;;;;;;;AAIC,oBAAI,KAAK5C,QAAL,KAAkBQ,2BAAe8B,OAArC,EAA8C;AAC5C,uBAAK3F,MAAL,CAAY4G,IAAZ,CAAiB;AACf1B,oBAAAA,OAAO,EAAEC,iDAAwB0B,4BADlB;AAEfxB,oBAAAA,GAAG,EAAE;AAFU,mBAAjB;AAID;;;;;;;;;;;;;;;;;;;sGA6KDyB,U;;;;;;AADEzD,gBAAAA,Q,SAAAA,Q,EAAUoC,U,SAAAA,U,EAAYsB,a,SAAAA,a,EAAehD,gB,SAAAA,gB;AAGvC;AACA,qBAAK1C,KAAL,CAAWI,QAAX,CAAoB;AAClBC,kBAAAA,IAAI,EAAE,KAAK3B,WAAL,CAAiBqD,OADL;AAElBC,kBAAAA,QAAQ,EAARA,QAFkB;AAGlBoC,kBAAAA,UAAU,EAAVA,UAHkB;AAIlBsB,kBAAAA,aAAa,EAAbA,aAJkB;AAKlBhD,kBAAAA,gBAAgB,EAAhBA,gBALkB;AAMlBd,kBAAAA,SAAS,EAAEK,IAAI,CAACC,GAAL;AANO,iBAApB;;AAQA,oBAAIuD,UAAJ,EAAgB;AACd,sBAAI,KAAKzD,QAAL,KAAkBQ,2BAAeiB,SAArC,EAAgD;AAC9C,yBAAK9E,MAAL,CAAY4G,IAAZ,CAAiB;AACf1B,sBAAAA,OAAO,EAAEC,iDAAwB6B;AADlB,qBAAjB;AAGD,mBAJD,MAIO,IAAI,KAAK3D,QAAL,KAAkBQ,2BAAeoD,OAArC,EAA8C;AACnD,yBAAKjH,MAAL,CAAY4G,IAAZ,CAAiB;AACf1B,sBAAAA,OAAO,EAAEC,iDAAwB+B;AADlB,qBAAjB;AAGD,mBAJM,MAIA;AACL,yBAAKlH,MAAL,CAAY4G,IAAZ,CAAiB;AACf1B,sBAAAA,OAAO,EAAEC,iDAAwBgC;AADlB,qBAAjB;;AAGA,wBAAI,CAAC,KAAKxG,uBAAV,EAAmC;AACjC,2BAAK6C,oCAAL;AACD;AACF;AACF;;;;;;;;;;;;;;;;AAGH;;;;wBAzMW;AACT,aAAO,KAAKnD,QAAL,CAAc+G,OAAd,CAAsB,KAAK1G,WAA3B,CAAP;AACD;;;wBAEY;AACX,aAAO,KAAK2G,KAAL,CAAWC,MAAlB;AACD;;;wBAEW;AACV,aAAO,KAAKD,KAAL,CAAWC,MAAX,KAAsBC,2BAAe3E,KAA5C;AACD;;;wBAEa;AACZ,aAAO,KAAKyE,KAAL,CAAWC,MAAX,KAAsBC,2BAAe1E,OAA5C;AACD;;;wBAEc;AACb,aAAO,KAAK2E,IAAL,CAAUnE,QAAjB;AACD;;;wBAEiB;AAChB,aAAO,iCAAgB,KAAKA,QAArB,CAAP;AACD;;;wBAEmB;AAClB,aAAO,KAAKmE,IAAL,CAAUT,aAAjB;AACD;;;wBAE0B;AACzB,aAAO,KAAKhG,iBAAZ;AACD;;;wBAEgB;AACf,aAAO,KAAKyG,IAAL,CAAU/B,UAAjB;AACD;;;wBAEsB;AACrB,aAAO,KAAK+B,IAAL,CAAUzD,gBAAjB;AACD;;;wBAEe;AACd,aAAO,KAAKyD,IAAL,CAAUvE,SAAjB;AACD;;;wBAEoB;AACnB,aAAO,KAAKwE,WAAL,KAAqBC,yBAAanI,QAAzC;AACD;;;wBAsGgB;AACf,aAAO,KAAKiI,IAAL,CAAUtD,UAAjB;AACD;;;wBAoD6B;AAC5B,aACE,KAAK1D,SAAL,KACC,KAAKH,QAAL,CAAcsH,MAAd,KAAyB,WAAzB,IACC,KAAKtH,QAAL,CAAcsH,MAAd,KAAyB,QAF3B,CADF;AAKD;AAED;;;;wBAC0B;AAAA;;AACxB,aACE,+BAAK7G,kBAAL,CAAwB8G,QAAxB,0GAAkCC,gBAAlC,kFAAoDC,SAApD,MAAkE,KADpE;AAGD;;;;EApgB0CC,qB,qEA6J1CC,mB,gKA6BAA,mB,wKAQAA,mB,yKASAA,mB,sLAwFAA,mB,kMA0DAC,kB;;;;;;;WACiB,CAChB;AAAA,aAAM,MAAI,CAAC3H,YAAL,CAAkB4B,gBAAxB;AAAA,KADgB,EAEhB;AAAA,aAAM,MAAI,CAAC5B,YAAL,CAAkB8B,iBAAxB;AAAA,KAFgB,EAGhB;AAAA,aAAM,MAAI,CAACI,iBAAL,CAAuB2D,MAAvB,GAAgC,CAAtC;AAAA,KAHgB,EAIhB;AAAA,aAAM,MAAI,CAAChG,qBAAL,CAA2B+H,OAA3B,CAAmC/B,MAAnC,GAA4C,CAAlD;AAAA,KAJgB,EAKhB,UACEgC,cADF,EAEEC,eAFF,EAGEC,aAHF,EAIEC,uBAJF,EAKK;AACH,UAAI,CAACA,uBAAL,EAA8B;AAC5B,eAAO,CAACzE,2BAAeiB,SAAhB,CAAP;AACD;;AACD,UAAM3B,eAAe,GAAG,EAAxB;;AACA,UAAI,MAAI,CAAC3C,SAAL,IAAkB4H,eAAtB,EAAuC;AACrCjF,QAAAA,eAAe,CAACoF,IAAhB,CAAqB1E,2BAAe8B,OAApC;AACD;;AACD,UAAI,MAAI,CAAC1F,MAAL,IAAe,MAAI,CAACmB,oBAAxB,EAA8C;AAC5C+B,QAAAA,eAAe,CAACoF,IAAhB,CAAqB1E,2BAAeoD,OAApC;AACD;;AAED9D,MAAAA,eAAe,CAACoF,IAAhB,CAAqB1E,2BAAeiB,SAApC;;AACA,UAAIqD,cAAJ,EAAoB;AAClBhF,QAAAA,eAAe,CAACoF,IAAhB,CAAqB1E,2BAAeC,OAApC;AACD;;AACD,aAAOX,eAAP;AACD,KA3Be,C;;mFA8BjB8E,kB;;;;;;;WACgB,CACf;AAAA,aAAM,MAAI,CAAC9H,qBAAL,CAA2BqI,aAAjC;AAAA,KADe,EAEf;AAAA,aAAM,MAAI,CAACrI,qBAAL,CAA2B4F,iBAAjC;AAAA,KAFe,EAGf;AAAA,aAAM,MAAI,CAAC7F,cAAL,CAAoB8F,eAA1B;AAAA,KAHe,EAIf,UAACwC,aAAD,EAAgBzC,iBAAhB,EAAmCC,eAAnC,EAAuD;AACrD,UAAM1D,cAAc,GAAGkG,aAAa,CAACC,GAAd,CAAkB,UAAC9D,IAAD;AAAA,eAAUA,IAAI,CAACL,WAAf;AAAA,OAAlB,CAAvB;;AACA,UAAIyB,iBAAiB,IAAIC,eAAzB,EAA0C;AACxC1D,QAAAA,cAAc,CAACiG,IAAf,WACKxC,iBAAiB,CAACzB,WADvB,cACsC0B,eADtC;AAGD;;AACD,aAAO1D,cAAP;AACD,KAZc,C;;sFAehB2F,kB;;;;;;;WACmB,CAClB;AAAA,aAAM,MAAI,CAAC7H,iBAAL,CAAuB0F,WAA7B;AAAA,KADkB,EAElB;AAAA,aAAM,MAAI,CAAC3F,qBAAL,CAA2BuI,eAAjC;AAAA,KAFkB,EAGlB;AAAA,aAAM,MAAI,CAACvI,qBAAL,CAA2BqI,aAAjC;AAAA,KAHkB,EAIlB,UAAC1C,WAAD,EAAc4C,eAAd,EAA+BF,aAA/B,EAAiD;AAC/C,UAAMG,aAAa,GAAG,EAAtB;AACAD,MAAAA,eAAe,CAACrC,OAAhB,CAAwB,UAAC1B,IAAD,EAAU;AAChCgE,QAAAA,aAAa,CAAChE,IAAI,CAACL,WAAN,CAAb,GAAkC,IAAlC;AACD,OAFD;AAGAkE,MAAAA,aAAa,CAACnC,OAAd,CAAsB,UAAC1B,IAAD,EAAU;AAC9BgE,QAAAA,aAAa,CAAChE,IAAI,CAACL,WAAN,CAAb,GAAkC,IAAlC;AACD,OAFD;AAGA,aAAOwB,WAAW,CACf8C,MADI,CACG,UAACjE,IAAD;AAAA,eAAU,CAACgE,aAAa,CAAChE,IAAI,CAACL,WAAN,CAAxB;AAAA,OADH,EAEJuE,IAFI,CAEC,UAACC,CAAD,EAAIC,CAAJ;AAAA,eAAWD,CAAC,CAACnC,KAAF,KAAY,QAAZ,IAAwBmC,CAAC,CAACnC,KAAF,KAAYoC,CAAC,CAACpC,KAAtC,GAA8C,CAAC,CAA/C,GAAmD,CAA9D;AAAA,OAFD,EAGJ8B,GAHI,CAGA,UAAC9D,IAAD;AAAA,eAAUA,IAAI,CAACL,WAAf;AAAA,OAHA,CAAP;AAID,KAhBiB,C;;qFAmBnB2D,kB;;;;;;;WACkB,CACjB;AAAA,aAAM,MAAI,CAAC3F,cAAX;AAAA,KADiB,EAEjB;AAAA,aAAM,MAAI,CAACE,iBAAX;AAAA,KAFiB,EAGjB,UAACF,cAAD,EAAiBE,iBAAjB,EAAuC;AACrC,UAAMwG,YAAY,GAAG1G,cAAc,CAAC2G,MAAf,CAAsBzG,iBAAtB,CAArB;AACA,aAAOwG,YAAP;AACD,KANgB,C;;8FASlBf,kB;;;;;;;WAC2B,CAC1B;AAAA,aAAM,MAAI,CAACjF,gBAAX;AAAA,KAD0B,EAE1B,UAACA,gBAAD,EAAsB;AACpB,UAAMkG,MAAM,GAAG,EAAf;;AACA,UAAIlG,gBAAgB,CAACmD,MAArB,EAA6B;AAC3BnD,QAAAA,gBAAgB,CAACqD,OAAjB,CAAyB,UAAC/B,WAAD,EAAiB;AACxC,cAAM6E,aAAa,GAAG,MAAI,CAACC,iBAAL,CAAuB9E,WAAvB,CAAtB;;AACA4E,UAAAA,MAAM,CAACX,IAAP,CAAY;AACV5B,YAAAA,KAAK,EAAEwC,aADG;AAEVE,YAAAA,KAAK,EAAE/E;AAFG,WAAZ;AAID,SAND;AAOD;;AACD4E,MAAAA,MAAM,CAACL,IAAP,CACE,UAACC,CAAD,EAAIC,CAAJ;AAAA,eACEvK,qBAAqB,CAACoH,OAAtB,CAA8BkD,CAAC,CAACnC,KAAhC,IACAnI,qBAAqB,CAACoH,OAAtB,CAA8BmD,CAAC,CAACpC,KAAhC,CAFF;AAAA,OADF;AAKA,aAAOuC,MAAP;AACD,KAnByB,C;;gFA0B3BjB,kB;;;;;;;WACa,CACZ;AAAA,aAAM,MAAI,CAAC9H,qBAAL,CAA2BuI,eAAjC;AAAA,KADY,EAEZ,UAACM,YAAD;AAAA,aACEA,YAAY,CAACH,IAAb,CAAkB,UAACS,SAAD,EAAYC,QAAZ,EAAyB;AACzC,YAAID,SAAS,CAACE,SAAV,KAAwB,cAA5B,EAA4C,OAAO,CAAC,CAAR;AAC5C,YAAID,QAAQ,CAACC,SAAT,KAAuB,cAA3B,EAA2C,OAAO,CAAP;AAC3C,YAAIF,SAAS,CAACE,SAAV,KAAwB,mBAA5B,EAAiD,OAAO,CAAC,CAAR;AACjD,YAAID,QAAQ,CAACC,SAAT,KAAuB,mBAA3B,EAAgD,OAAO,CAAP;AAChD,YAAIF,SAAS,CAACE,SAAV,GAAsBD,QAAQ,CAACC,SAAnC,EAA8C,OAAO,CAAC,CAAR;AAC9C,YAAIF,SAAS,CAACE,SAAV,GAAsBD,QAAQ,CAACC,SAAnC,EAA8C,OAAO,CAAP;AAC9C,eAAO,CAAP;AACD,OARD,CADF;AAAA,KAFY,C;;6DAcbxB,mB","sourcesContent":["import moduleStatuses from '../../enums/moduleStatuses';\nimport { Module } from '../../lib/di';\nimport proxify from '../../lib/proxy/proxify';\nimport RcModule from '../../lib/RcModule';\nimport { selector } from '../../lib/selector';\nimport { actionTypes } from './actionTypes';\nimport callingModes from './callingModes';\nimport callingOptions from './callingOptions';\nimport { callingSettingsMessages } from './callingSettingsMessages';\nimport deprecatedCallingOptions from './deprecatedCallingOptions';\nimport {\n  getCallingSettingsReducer,\n  getCallingSettingsStorageReducer,\n} from './getCallingSettingsReducer';\nimport mapOptionToMode from './mapOptionToMode';\n\nconst LOCATION_NUMBER_ORDER = ['Other', 'Main'];\nconst BLOCKED_ID_VALUE = 'anonymous';\n/**\n * @class\n * @description Call setting managing module\n */\n@Module({\n  deps: [\n    'Alert',\n    'Brand',\n    'ExtensionInfo',\n    'ExtensionPhoneNumber',\n    'ForwardingNumber',\n    'Storage',\n    'AppFeatures',\n    'ExtensionDevice',\n    'ExtensionFeatures',\n    { dep: 'CallerId', optional: true },\n    { dep: 'TabManager', optional: true },\n    { dep: 'Webphone', optional: true },\n    { dep: 'CallingSettingsOptions', optional: true },\n  ],\n})\nexport default class CallingSettings extends RcModule {\n  constructor({\n    alert,\n    brand,\n    extensionInfo,\n    extensionPhoneNumber,\n    forwardingNumber,\n    storage,\n    appFeatures,\n    tabManager,\n    onFirstLogin,\n    webphone,\n    callerId,\n    extensionFeatures,\n    emergencyCallAvailable = false,\n    defaultRingoutPrompt,\n    showCallWithJupiter = true,\n    extensionDevice,\n    ...options\n  }) {\n    super({\n      ...options,\n      actionTypes,\n    });\n    this._alert = alert;\n    this._brand = brand;\n    this._extensionInfo = extensionInfo;\n    this._extensionPhoneNumber = extensionPhoneNumber;\n    this._forwardingNumber = forwardingNumber;\n    this._storage = storage;\n    this._appFeatures = appFeatures;\n    this._tabManager = tabManager;\n    this._webphone = webphone;\n    this._callerId = callerId;\n    this._storageKey = 'callingSettingsData';\n    this._emergencyCallAvailable = emergencyCallAvailable;\n    this._extensionDevice = extensionDevice;\n    this._onFirstLogin = onFirstLogin;\n    this._extensionFeatures = extensionFeatures;\n    this.initRingoutPrompt = defaultRingoutPrompt;\n\n    this._storage.registerReducer({\n      key: this._storageKey,\n      reducer: getCallingSettingsStorageReducer(this.actionTypes),\n    });\n\n    this._reducer = getCallingSettingsReducer(this.actionTypes);\n    this._showCallWithJupiter = showCallWithJupiter;\n  }\n\n  initialize() {\n    this.store.subscribe(() => this._onStateChange());\n  }\n\n  async _onStateChange() {\n    if (this._shouldInit()) {\n      this.store.dispatch({\n        type: this.actionTypes.init,\n      });\n      await this._init();\n      this.store.dispatch({\n        type: this.actionTypes.initSuccess,\n      });\n    } else if (this._shouldReset()) {\n      this._reset();\n    } else if (this._shouldValidate()) {\n      this._ringoutEnabled = this._appFeatures.isRingOutEnabled;\n      this._webphoneEnabled = this._appFeatures.isWebPhoneEnabled;\n      this._myPhoneNumbers = this.myPhoneNumbers;\n      this._otherPhoneNumbers = this.otherPhoneNumbers;\n      this._blockedIdDisabled = this.isBlockedIdDisabled;\n      await this._validateSettings();\n    }\n  }\n\n  _shouldInit() {\n    return (\n      this._storage.ready &&\n      this._extensionInfo.ready &&\n      this._extensionPhoneNumber.ready &&\n      this._forwardingNumber.ready &&\n      (!this._callerId || this._callerId.ready) &&\n      this._appFeatures.ready &&\n      this._extensionDevice.ready &&\n      this.pending\n    );\n  }\n\n  _shouldReset() {\n    return !!(\n      this.ready &&\n      (!this._storage.ready ||\n        !this._extensionInfo.ready ||\n        !this._extensionPhoneNumber.ready ||\n        !this._forwardingNumber.ready ||\n        !this._appFeatures.ready ||\n        (this._callerId && !this._callerId.ready) ||\n        !this._extensionDevice.ready)\n    );\n  }\n\n  _shouldValidate() {\n    return (\n      this.ready &&\n      (this._ringoutEnabled !== this._appFeatures.isRingOutEnabled ||\n        this._webphoneEnabled !== this._appFeatures.isWebPhoneEnabled ||\n        this._myPhoneNumbers !== this.myPhoneNumbers ||\n        this._otherPhoneNumbers !== this.otherPhoneNumbers ||\n        this._blockedIdDisabled !== this.isBlockedIdDisabled)\n    );\n  }\n\n  async _init() {\n    if (!this._appFeatures.isCallingEnabled) return;\n    this._myPhoneNumbers = this.myPhoneNumbers;\n    this._otherPhoneNumbers = this.otherPhoneNumbers;\n    this._availableNumbers = this.availableNumbers;\n    this._ringoutEnabled = this._appFeatures.isRingOutEnabled;\n    this._webphoneEnabled = this._appFeatures.isWebPhoneEnabled;\n    this._blockedIdDisabled = this.isBlockedIdDisabled;\n    if (!this.timestamp) {\n      // first time login\n      const defaultCallWith = this.callWithOptions && this.callWithOptions[0];\n      this.store.dispatch({\n        type: this.actionTypes.setData,\n        callWith: defaultCallWith,\n        timestamp: Date.now(),\n      });\n      if (!this._emergencyCallAvailable) {\n        this._warningEmergencyCallingNotAvailable();\n      }\n      if (typeof this._onFirstLogin === 'function') {\n        this._onFirstLogin();\n      }\n    }\n    if (\n      this.callWith === deprecatedCallingOptions.myphone ||\n      this.callWith === deprecatedCallingOptions.otherphone ||\n      this.callWith === deprecatedCallingOptions.customphone\n    ) {\n      this.store.dispatch({\n        type: this.actionTypes.setData,\n        callWith: callingOptions.ringout,\n        isCustomLocation:\n          this.callWith === deprecatedCallingOptions.customphone,\n      });\n    }\n    await this._validateSettings();\n    await this._initFromNumber();\n  }\n\n  _reset() {\n    this.store.dispatch({\n      type: this.actionTypes.resetSuccess,\n    });\n  }\n\n  @proxify\n  async _initFromNumber() {\n    const fromNumber = this.fromNumber;\n    if (\n      !fromNumber ||\n      (fromNumber === BLOCKED_ID_VALUE && this.isBlockedIdDisabled)\n    ) {\n      let defaultCallerId = this.fromNumbers[0];\n      if (this._callerId?.ringOut) {\n        if (\n          this._callerId.ringOut.type === 'Blocked' &&\n          !this.isBlockedIdDisabled\n        ) {\n          defaultCallerId = { phoneNumber: BLOCKED_ID_VALUE };\n        } else if (this._callerId.ringOut.type === 'PhoneNumber') {\n          const defaultPhoneNumber =\n            this._callerId?.ringOut.phoneInfo?.phoneNumber;\n          const defaultEntry = this.fromNumbers.find(\n            (item) => item.phoneNumber === defaultPhoneNumber,\n          );\n          if (defaultEntry) {\n            defaultCallerId = defaultEntry;\n          }\n        }\n      }\n      await this.updateFromNumber(defaultCallerId);\n    }\n  }\n\n  @proxify\n  async updateFromNumber(number) {\n    this.store.dispatch({\n      type: this.actionTypes.updateFromNumber,\n      number: number && number.phoneNumber,\n    });\n  }\n\n  @proxify\n  async _setSoftPhoneToCallWith() {\n    this.store.dispatch({\n      type: this.actionTypes.setData,\n      callWith: callingOptions.softphone,\n      timestamp: Date.now(),\n    });\n  }\n\n  @proxify\n  async _validateSettings() {\n    if (this._hasWebphonePermissionRemoved()) {\n      await this._setSoftPhoneToCallWith();\n      this._alert.danger({\n        message: callingSettingsMessages.webphonePermissionRemoved,\n        ttl: 0,\n      });\n    } else if (this._hasPermissionChanged()) {\n      await this._setSoftPhoneToCallWith();\n      this._alert.danger({\n        message: callingSettingsMessages.permissionChanged,\n        ttl: 0,\n      });\n    } else if (this._hasPhoneNumberChanged()) {\n      this.store.dispatch({\n        type: this.actionTypes.setData,\n        callWith: callingOptions.ringout,\n        myLocation: this._myPhoneNumbers[0],\n        timestamp: Date.now(),\n      });\n      this._alert.danger({\n        message: callingSettingsMessages.phoneNumberChanged,\n        ttl: 0,\n      });\n    }\n\n    if (this.isBlockedIdDisabled && this.fromNumber === BLOCKED_ID_VALUE) {\n      this._initFromNumber();\n    }\n  }\n\n  _hasWebphonePermissionRemoved() {\n    return (\n      !(this._webphoneEnabled && this._webphone) &&\n      this.callWith === callingOptions.browser\n    );\n  }\n\n  _hasPermissionChanged() {\n    return !this._ringoutEnabled && this.callWith === callingOptions.ringout;\n  }\n\n  _hasPhoneNumberChanged() {\n    return (\n      this.callWith === callingOptions.ringout &&\n      !this.isCustomLocation &&\n      this._availableNumbers.indexOf(this.myLocation) === -1\n    );\n  }\n\n  _getLocationLabel(phoneNumber) {\n    const { devices } = this._extensionDevice;\n    const { flipNumbers } = this._forwardingNumber;\n    const { mainCompanyNumber } = this._extensionPhoneNumber;\n    const { extensionNumber } = this._extensionInfo;\n    const mainPhoneNumber = `${mainCompanyNumber.phoneNumber}*${extensionNumber}`;\n    let name = null;\n    if (devices.length) {\n      let registedWithDevice = false;\n      devices.forEach((device) => {\n        const { phoneLines } = device;\n        if (phoneLines.length) {\n          registedWithDevice = phoneLines.find((phoneLine) => {\n            return phoneLine.phoneInfo.phoneNumber === phoneNumber;\n          });\n          if (registedWithDevice) {\n            name = device.name;\n          }\n        }\n      });\n      if (name) return name;\n    }\n    if (flipNumbers.length) {\n      const isFlipNumber = flipNumbers.find(\n        (flipNumber) => flipNumber.phoneNumber === phoneNumber,\n      );\n      if (isFlipNumber) {\n        return isFlipNumber.label || 'Other';\n      }\n    }\n\n    if (phoneNumber === mainPhoneNumber) {\n      return 'Main';\n    }\n    return 'Other';\n  }\n\n  @proxify\n  async _warningEmergencyCallingNotAvailable() {\n    if (this.callWith === callingOptions.browser) {\n      this._alert.info({\n        message: callingSettingsMessages.emergencyCallingNotAvailable,\n        ttl: 0,\n      });\n    }\n  }\n\n  get data() {\n    return this._storage.getItem(this._storageKey);\n  }\n\n  get status() {\n    return this.state.status;\n  }\n\n  get ready() {\n    return this.state.status === moduleStatuses.ready;\n  }\n\n  get pending() {\n    return this.state.status === moduleStatuses.pending;\n  }\n\n  get callWith() {\n    return this.data.callWith;\n  }\n\n  get callingMode() {\n    return mapOptionToMode(this.callWith);\n  }\n\n  get ringoutPrompt() {\n    return this.data.ringoutPrompt;\n  }\n\n  get defaultRingoutPrompt() {\n    return this.initRingoutPrompt;\n  }\n\n  get myLocation() {\n    return this.data.myLocation;\n  }\n\n  get isCustomLocation() {\n    return this.data.isCustomLocation;\n  }\n\n  get timestamp() {\n    return this.data.timestamp;\n  }\n\n  get isWebphoneMode() {\n    return this.callingMode === callingModes.webphone;\n  }\n\n  @selector\n  callWithOptions = [\n    () => this._appFeatures.isRingOutEnabled,\n    () => this._appFeatures.isWebPhoneEnabled,\n    () => this.otherPhoneNumbers.length > 0,\n    () => this._extensionPhoneNumber.numbers.length > 0,\n    (\n      ringoutEnabled,\n      webphoneEnabled,\n      hasOtherPhone,\n      hasExtensionPhoneNumber,\n    ) => {\n      if (!hasExtensionPhoneNumber) {\n        return [callingOptions.softphone];\n      }\n      const callWithOptions = [];\n      if (this._webphone && webphoneEnabled) {\n        callWithOptions.push(callingOptions.browser);\n      }\n      if (this._brand && this._showCallWithJupiter) {\n        callWithOptions.push(callingOptions.jupiter);\n      }\n\n      callWithOptions.push(callingOptions.softphone);\n      if (ringoutEnabled) {\n        callWithOptions.push(callingOptions.ringout);\n      }\n      return callWithOptions;\n    },\n  ];\n\n  @selector\n  myPhoneNumbers = [\n    () => this._extensionPhoneNumber.directNumbers,\n    () => this._extensionPhoneNumber.mainCompanyNumber,\n    () => this._extensionInfo.extensionNumber,\n    (directNumbers, mainCompanyNumber, extensionNumber) => {\n      const myPhoneNumbers = directNumbers.map((item) => item.phoneNumber);\n      if (mainCompanyNumber && extensionNumber) {\n        myPhoneNumbers.push(\n          `${mainCompanyNumber.phoneNumber}*${extensionNumber}`,\n        );\n      }\n      return myPhoneNumbers;\n    },\n  ];\n\n  @selector\n  otherPhoneNumbers = [\n    () => this._forwardingNumber.flipNumbers,\n    () => this._extensionPhoneNumber.callerIdNumbers,\n    () => this._extensionPhoneNumber.directNumbers,\n    (flipNumbers, callerIdNumbers, directNumbers) => {\n      const filterMapping = {};\n      callerIdNumbers.forEach((item) => {\n        filterMapping[item.phoneNumber] = true;\n      });\n      directNumbers.forEach((item) => {\n        filterMapping[item.phoneNumber] = true;\n      });\n      return flipNumbers\n        .filter((item) => !filterMapping[item.phoneNumber])\n        .sort((a, b) => (a.label === 'Mobile' && a.label !== b.label ? -1 : 1))\n        .map((item) => item.phoneNumber);\n    },\n  ];\n\n  @selector\n  availableNumbers = [\n    () => this.myPhoneNumbers,\n    () => this.otherPhoneNumbers,\n    (myPhoneNumbers, otherPhoneNumbers) => {\n      const phoneNumbers = myPhoneNumbers.concat(otherPhoneNumbers);\n      return phoneNumbers;\n    },\n  ];\n\n  @selector\n  availableNumbersWithLabel = [\n    () => this.availableNumbers,\n    (availableNumbers) => {\n      const result = [];\n      if (availableNumbers.length) {\n        availableNumbers.forEach((phoneNumber) => {\n          const locationLabel = this._getLocationLabel(phoneNumber);\n          result.push({\n            label: locationLabel,\n            value: phoneNumber,\n          });\n        });\n      }\n      result.sort(\n        (a, b) =>\n          LOCATION_NUMBER_ORDER.indexOf(a.label) -\n          LOCATION_NUMBER_ORDER.indexOf(b.label),\n      );\n      return result;\n    },\n  ];\n\n  get fromNumber() {\n    return this.data.fromNumber;\n  }\n\n  @selector\n  fromNumbers = [\n    () => this._extensionPhoneNumber.callerIdNumbers,\n    (phoneNumbers) =>\n      phoneNumbers.sort((firstItem, lastItem) => {\n        if (firstItem.usageType === 'DirectNumber') return -1;\n        if (lastItem.usageType === 'DirectNumber') return 1;\n        if (firstItem.usageType === 'MainCompanyNumber') return -1;\n        if (lastItem.usageType === 'MainCompanyNumber') return 1;\n        if (firstItem.usageType < lastItem.usageType) return -1;\n        if (firstItem.usageType > lastItem.usageType) return 1;\n        return 0;\n      }),\n  ];\n\n  @proxify\n  async setData(\n    { callWith, myLocation, ringoutPrompt, isCustomLocation },\n    withPrompt,\n  ) {\n    // TODO validate myLocation\n    this.store.dispatch({\n      type: this.actionTypes.setData,\n      callWith,\n      myLocation,\n      ringoutPrompt,\n      isCustomLocation,\n      timestamp: Date.now(),\n    });\n    if (withPrompt) {\n      if (this.callWith === callingOptions.softphone) {\n        this._alert.info({\n          message: callingSettingsMessages.saveSuccessWithSoftphone,\n        });\n      } else if (this.callWith === callingOptions.jupiter) {\n        this._alert.info({\n          message: callingSettingsMessages.saveSuccessWithJupiter,\n        });\n      } else {\n        this._alert.info({\n          message: callingSettingsMessages.saveSuccess,\n        });\n        if (!this._emergencyCallAvailable) {\n          this._warningEmergencyCallingNotAvailable();\n        }\n      }\n    }\n  }\n\n  /* ringtone */\n  get isChangeRingToneAllowed() {\n    return (\n      this._webphone &&\n      (this._storage.driver === 'INDEXEDDB' ||\n        this._storage.driver === 'WEBSQL')\n    );\n  }\n\n  /* India go */\n  get isBlockedIdDisabled() {\n    return (\n      this._extensionFeatures.features?.BlockingCallerId?.available === false\n    );\n  }\n}\n"],"file":"index.js"}
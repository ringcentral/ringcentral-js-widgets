{"version":3,"sources":["modules/SimpleCallControlUI/SimpleCallControlUI.ts"],"names":["SimpleCallControlUI","name","deps","dep","optional","sessionId","params","renderContactName","_deps","activeCallControl","regionSettings","locale","brand","activeSession","nameMatches","direction","callDirections","outbound","toMatches","fromMatches","phoneNumber","to","from","fallBackName","i18n","getString","currentLocale","telephonySessionId","fallBackNameFromThirdParty","fallBackNumber","areaCode","countryCode","brandName","controlBusy","busy","onBackButtonClick","routerInteraction","goBack","setActiveSessionId","onTransfer","push","onMute","mute","onUnmute","unmute","onHold","hold","onUnhold","unhold","onHangup","hangUp","RcUIModuleV2"],"mappings":"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","sourcesContent":["import callDirections from '@ringcentral-integration/commons/enums/callDirections';\nimport { Entity } from '@ringcentral-integration/commons/interfaces/Entity.interface';\nimport { Module } from '@ringcentral-integration/commons/lib/di';\nimport {\n  RcUIModuleV2,\n  UIFunctions,\n  UIProps,\n} from '@ringcentral-integration/core';\n\nimport { SimpleCallControlPanelProps } from '../../components/SimpleCallControlPanel';\nimport i18n from '../../components/SimpleCallControlPanel/i18n';\nimport { pickFallBackInfo } from '../../components/SimpleCallControlPanel/utils';\nimport {\n  Deps,\n  SimpleCallControlContainerProps,\n} from './SimpleCallControlUI.interface';\n\n@Module({\n  name: 'SimpleCallControlUI',\n  deps: [\n    'Locale',\n    'RouterInteraction',\n    'Brand',\n    'RegionSettings',\n    'ActiveCallControl',\n    { dep: 'SimpleCallControlUIOptions', optional: true },\n  ],\n})\nexport class SimpleCallControlUI extends RcUIModuleV2<Deps> {\n  constructor(deps: Deps) {\n    super({\n      deps,\n    });\n  }\n\n  getUIProps({\n    params: { sessionId },\n    renderContactName,\n  }: SimpleCallControlContainerProps): UIProps<SimpleCallControlPanelProps> {\n    const { activeCallControl, regionSettings, locale, brand } = this._deps;\n    const { activeSession } = activeCallControl;\n    let nameMatches: Entity[] = [];\n    if (activeSession && !renderContactName) {\n      // TODO: check activeSession type\n      nameMatches =\n        activeSession.direction === callDirections.outbound\n          ? activeSession.toMatches\n          : activeSession.fromMatches;\n    }\n    let phoneNumber: string;\n    if (activeSession) {\n      phoneNumber =\n        activeSession.direction === callDirections.outbound\n          ? activeSession.to\n          : activeSession.from;\n    }\n    let fallBackName = i18n.getString('Unknown', locale.currentLocale);\n    if (renderContactName) {\n      const { fallBackName: fallBackNameFromThirdParty, fallBackNumber } =\n        pickFallBackInfo(\n          activeSession,\n          renderContactName({\n            sessionId: activeSession && activeSession.sessionId,\n            telephonySessionId: sessionId,\n          }),\n          locale.currentLocale,\n        );\n      phoneNumber = fallBackNumber;\n      fallBackName = fallBackNameFromThirdParty;\n    }\n    return {\n      currentLocale: locale.currentLocale,\n      activeSession,\n      sessionId,\n      areaCode: regionSettings.areaCode,\n      countryCode: regionSettings.countryCode,\n      nameMatches,\n      phoneNumber,\n      fallBackName,\n      brandName: brand.name,\n      controlBusy: activeCallControl.busy,\n    };\n  }\n\n  getUIFunctions({\n    params: { sessionId },\n  }: SimpleCallControlContainerProps): UIFunctions<SimpleCallControlPanelProps> {\n    return {\n      onBackButtonClick: () => {\n        this._deps.routerInteraction.goBack();\n      },\n      setActiveSessionId: (sessionId) => {\n        this._deps.activeCallControl.setActiveSessionId(sessionId);\n      },\n      onTransfer: (sessionId) => {\n        this._deps.routerInteraction.push(`/transfer/${sessionId}/active`);\n      },\n      onMute: () => this._deps.activeCallControl.mute(sessionId),\n      onUnmute: () => this._deps.activeCallControl.unmute(sessionId),\n      onHold: () => this._deps.activeCallControl.hold(sessionId),\n      onUnhold: () => this._deps.activeCallControl.unhold(sessionId),\n      onHangup: () => this._deps.activeCallControl.hangUp(sessionId),\n    };\n  }\n}\n"],"file":"SimpleCallControlUI.js"}
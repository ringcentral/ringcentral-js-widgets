{"version":3,"file":"ProxyFrameOAuth.js","names":["_background","_interopRequireDefault","require","_di","_proxify","_core","uuid","_interopRequireWildcard","_OAuthBase2","_dec","_class","_class2","_descriptor","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","_typeof","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","asyncGeneratorStep","o","c","value","done","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_initializerDefineProperty","l","enumerable","configurable","writable","initializer","ownKeys","keys","getOwnPropertySymbols","filter","push","_objectSpread","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","_toPropertyKey","_objectWithoutProperties","_objectWithoutPropertiesLoose","s","includes","propertyIsEnumerable","_classCallCheck","TypeError","_defineProperties","key","_createClass","prototype","_toPrimitive","Symbol","toPrimitive","String","Number","_get","Reflect","bind","p","_superPropBase","_getPrototypeOf","_inherits","create","constructor","_setPrototypeOf","setPrototypeOf","_createSuper","_isNativeReflectConstruct","construct","_possibleConstructorReturn","_assertThisInitialized","ReferenceError","Boolean","valueOf","getPrototypeOf","_applyDecoratedDescriptor","slice","reverse","reduce","_initializerWarningHelper","Error","DEFAULT_PROXY_RETRY","ProxyFrameOAuth","Module","name","deps","dep","optional","_OAuthBase","_super","_ref","_this","_ref$oAuthOptions","oAuthOptions","_ref$oAuthOptions$log","loginPath","_ref$oAuthOptions$red","redirectUri","_ref$oAuthOptions$pro","proxyUri","_ref$oAuthOptions$def","defaultProxyRetry","restOAuthOptions","_retryTimeoutId","_implicitRefreshTimeoutId","_uuid","v4","_proxyFrame","_implicitRefreshFrame","_loggedIn","_callbackHandler","_ref3","regeneratorRuntime","mark","_callee","_ref2","origin","data","callbackUri","proxyLoaded","wrap","_callee$","_context","prev","next","abrupt","_handleCallbackUri","clearTimeout","setOAuthReady","stop","_x","_createProxyFrame","_this$_deps$oAuthOpti","document","createElement","src","style","display","isEdge","window","navigator","userAgent","indexOf","isIE","test","setAttribute","join","body","appendChild","addEventListener","setTimeout","_retrySetupProxyFrame","_deps","_implicitRefreshCallBack","_ref4","refreshCallbackUri","auth","loggedIn","_clearImplicitRefreshIframe","onInitOnce","_this2","watch","_this2$_deps$oAuthOpt","ready","routerInteraction","currentPath","oAuthReady","_this2$_deps$oAuthOpt2","atLoginPage","setupOAuth","destroyOAuth","isImplicit","_createImplicitRefreshTimeout","multiple","_handleCallbackUri2","_callee2","refresh","_args2","_callee2$","_context2","undefined","_x2","setProxyRetryCount","val","proxyRetryCount","_destroyProxyFrame","removeChild","removeEventListener","_setupOAuth","_callee3","_callee3$","_context3","_destroyOAuth","_callee4","_callee4$","_context4","_openOAuthPage","_callee5","_callee5$","_context5","client","service","platform","discovery","loginUrlWithDiscovery","contentWindow","postMessage","oAuthUri","openOAuthPage","_createImplicitRefreshIframe","implicitRefreshOAuthUri","_this3","authData","token","refreshTokenExpiresIn","expiresIn","expireTime","refreshTokenTimeoutTime","parseInt","concat","Date","now","_this3$_deps$tabManag","tabManager","active","_this$_deps$oAuthOpti2","prefix","_this$_deps$oAuthOpti3","encodeURIComponent","URL","location","href","hash","btoa","OAuthBase","state","action","background","proxify","exports"],"sources":["modules/ProxyFrameOAuth/ProxyFrameOAuth.ts"],"sourcesContent":["import background from '@ringcentral-integration/commons/lib/background';\nimport { Module } from '@ringcentral-integration/commons/lib/di';\nimport { proxify } from '@ringcentral-integration/commons/lib/proxy/proxify';\nimport { action, state, watch } from '@ringcentral-integration/core';\nimport * as uuid from 'uuid';\n\nimport { OAuthBase } from '../../lib/OAuthBase';\n\nimport type { Deps } from './ProxyFrameOAuth.interface';\n\nconst DEFAULT_PROXY_RETRY = 5000;\n\ntype CallbackParams = {\n  origin: string;\n  data: any;\n};\n\n@Module({\n  name: 'OAuth',\n  deps: [\n    'Client',\n    'RouterInteraction',\n    { dep: 'OAuthOptions', optional: true },\n  ],\n})\nexport class ProxyFrameOAuth<T extends Deps = Deps> extends OAuthBase<T> {\n  // @ts-expect-error TS(2322): Type 'null' is not assignable to type 'Timeout'.\n  private _retryTimeoutId: ReturnType<typeof setTimeout> = null;\n  // @ts-expect-error TS(2322): Type 'null' is not assignable to type 'Timeout'.\n  private _implicitRefreshTimeoutId: ReturnType<typeof setTimeout> = null;\n\n  private _uuid = uuid.v4();\n  // @ts-expect-error TS(2564): Property '_proxyFrame' has no initializer and is n... Remove this comment to see the full error message\n  private _proxyFrame: HTMLIFrameElement;\n  // @ts-expect-error TS(2564): Property '_implicitRefreshFrame' has no initialize... Remove this comment to see the full error message\n  private _implicitRefreshFrame: HTMLIFrameElement;\n  protected _loggedIn = false;\n\n  constructor({\n    oAuthOptions: {\n      loginPath = '/',\n      redirectUri = './redirect.html',\n      proxyUri = './proxy.html',\n      defaultProxyRetry = DEFAULT_PROXY_RETRY,\n      ...restOAuthOptions\n    } = {},\n    ...deps\n  }: T) {\n    super({\n      ...deps,\n      oAuthOptions: {\n        loginPath,\n        redirectUri,\n        proxyUri,\n        defaultProxyRetry,\n        ...restOAuthOptions,\n      },\n    } as T);\n  }\n\n  override onInitOnce() {\n    super.onInitOnce && super.onInitOnce();\n\n    watch(\n      this,\n      () => [\n        this.ready,\n        this._deps.auth.loggedIn,\n        this._deps.routerInteraction.currentPath,\n        this._deps.oAuthOptions?.loginPath,\n        this.oAuthReady,\n        this._proxyFrame,\n      ],\n      () => {\n        const atLoginPage =\n          this._deps.routerInteraction.currentPath ===\n          this._deps.oAuthOptions?.loginPath;\n\n        if (\n          this.ready &&\n          !this._deps.auth.loggedIn &&\n          atLoginPage &&\n          !this.oAuthReady &&\n          !this._proxyFrame\n        ) {\n          this.setupOAuth();\n        } else if (\n          this._proxyFrame &&\n          (this._deps.auth.loggedIn || !atLoginPage)\n        ) {\n          this.destroyOAuth();\n        }\n\n        if (this._deps.auth.loggedIn === this._loggedIn) return;\n\n        this._loggedIn = this._deps.auth.loggedIn;\n\n        if (this._deps.auth.isImplicit) {\n          if (this._loggedIn) {\n            this._createImplicitRefreshTimeout();\n          } else if (!this._loggedIn) {\n            this._clearImplicitRefreshIframe();\n\n            if (this._implicitRefreshTimeoutId) {\n              clearTimeout(this._implicitRefreshTimeoutId);\n            }\n          }\n        }\n      },\n      { multiple: true },\n    );\n  }\n\n  // @ts-expect-error TS(4114): This member must have an 'override' modifier becau... Remove this comment to see the full error message\n  async _handleCallbackUri(callbackUri: string, refresh = false) {\n    await super._handleCallbackUri(callbackUri, refresh);\n\n    if (this._deps.auth.isImplicit && this._deps.auth.loggedIn) {\n      this._createImplicitRefreshTimeout();\n    }\n  }\n\n  // @ts-expect-error TS(4114): This member must have an 'override' modifier becau... Remove this comment to see the full error message\n  get name() {\n    return 'proxyFrameOAuth';\n  }\n\n  get prefix() {\n    return this._deps.oAuthOptions?.prefix;\n  }\n\n  get proxyUri() {\n    // @ts-expect-error TS(2345): Argument of type 'string | undefined' is not assig... Remove this comment to see the full error message\n    const prefix = encodeURIComponent(this.prefix);\n\n    const proxyUri = new URL(\n      this._deps.oAuthOptions?.proxyUri!,\n      window.location.href,\n    ).href;\n\n    const hash = encodeURIComponent(btoa(this._uuid));\n\n    return `${proxyUri}?hash=${hash}&prefix=${prefix}`;\n  }\n\n  @state\n  proxyRetryCount = 0;\n\n  @action\n  setProxyRetryCount(val: number) {\n    this.proxyRetryCount = val;\n  }\n\n  @action\n  override setOAuthReady(val: boolean) {\n    super.setOAuthReady(val);\n    this.setProxyRetryCount(0);\n  }\n\n  private _callbackHandler = async ({ origin, data }: CallbackParams) => {\n    // TODO: origin check\n    if (!data) return;\n\n    const { callbackUri, proxyLoaded } = data;\n    if (callbackUri) {\n      this._handleCallbackUri(callbackUri);\n    } else if (proxyLoaded) {\n      clearTimeout(this._retryTimeoutId);\n      // @ts-expect-error TS(2322): Type 'null' is not assignable to type 'Timeout'.\n      this._retryTimeoutId = null;\n\n      this.setOAuthReady(true);\n    }\n  };\n\n  private _createProxyFrame = () => {\n    this._proxyFrame = document.createElement('iframe');\n    this._proxyFrame.src = this.proxyUri;\n    this._proxyFrame.style.display = 'none';\n    const isEdge =\n      window &&\n      window.navigator &&\n      window.navigator.userAgent.indexOf('Edge') > -1;\n    const isIE =\n      window &&\n      window.navigator &&\n      /MSIE|Trident/i.test(window.navigator.userAgent);\n    if (!isEdge && !isIE) {\n      this._proxyFrame.setAttribute(\n        'sandbox',\n        [\n          'allow-scripts',\n          'allow-popups',\n          'allow-same-origin',\n          'allow-forms',\n        ].join(' '),\n      );\n    }\n    document.body.appendChild(this._proxyFrame);\n\n    window.addEventListener('message', this._callbackHandler);\n\n    this._retryTimeoutId = setTimeout(() => {\n      this._retrySetupProxyFrame();\n    }, this._deps.oAuthOptions?.defaultProxyRetry);\n  };\n\n  private _retrySetupProxyFrame() {\n    // @ts-expect-error TS(2322): Type 'null' is not assignable to type 'Timeout'.\n    this._retryTimeoutId = null;\n    if (this.oAuthReady) return;\n\n    this.setProxyRetryCount(this.proxyRetryCount + 1);\n    this._destroyProxyFrame();\n    this._createProxyFrame();\n  }\n\n  private _destroyProxyFrame() {\n    document.body.removeChild(this._proxyFrame);\n    // @ts-expect-error TS(2322): Type 'null' is not assignable to type 'HTMLIFrameE... Remove this comment to see the full error message\n    this._proxyFrame = null;\n    window.removeEventListener('message', this._callbackHandler);\n  }\n\n  @background\n  async setupOAuth() {\n    if (this._proxyFrame) return;\n\n    this._createProxyFrame();\n    this.setProxyRetryCount(0);\n  }\n\n  @background\n  // @ts-expect-error TS(4114): This member must have an 'override' modifier becau... Remove this comment to see the full error message\n  async destroyOAuth() {\n    if (!this._proxyFrame) return;\n\n    if (this._retryTimeoutId) {\n      clearTimeout(this._retryTimeoutId);\n      // @ts-expect-error TS(2322): Type 'null' is not assignable to type 'Timeout'.\n      this._retryTimeoutId = null;\n    }\n\n    this._destroyProxyFrame();\n    this.setOAuthReady(false);\n  }\n\n  @proxify\n  // @ts-expect-error TS(4114): This member must have an 'override' modifier becau... Remove this comment to see the full error message\n  async openOAuthPage() {\n    if (!this.oAuthReady) return;\n\n    if (this._deps.client.service.platform().discovery()) {\n      await this._deps.client.service.platform().loginUrlWithDiscovery();\n    }\n\n    // @ts-expect-error TS(2531): Object is possibly 'null'.\n    this._proxyFrame.contentWindow.postMessage(\n      {\n        oAuthUri: this.oAuthUri,\n      },\n      '*',\n    );\n  }\n\n  private _implicitRefreshCallBack = ({ data }: CallbackParams) => {\n    const { refreshCallbackUri } = data;\n    if (refreshCallbackUri && this._deps.auth.loggedIn) {\n      this._handleCallbackUri(refreshCallbackUri, true);\n      this._clearImplicitRefreshIframe();\n    }\n  };\n\n  private _createImplicitRefreshIframe() {\n    this._clearImplicitRefreshIframe();\n    this._implicitRefreshFrame = document.createElement('iframe');\n    this._implicitRefreshFrame.src = this.implicitRefreshOAuthUri;\n    this._implicitRefreshFrame.style.display = 'none';\n    document.body.appendChild(this._implicitRefreshFrame);\n    // eslint-disable-next-line\n\n    window.addEventListener('message', this._implicitRefreshCallBack);\n  }\n\n  private _clearImplicitRefreshIframe() {\n    if (!this._implicitRefreshFrame) return;\n\n    document.body.removeChild(this._implicitRefreshFrame);\n    // @ts-expect-error TS(2322): Type 'null' is not assignable to type 'HTMLIFrameE... Remove this comment to see the full error message\n    this._implicitRefreshFrame = null;\n    window.removeEventListener('message', this._implicitRefreshCallBack);\n    // @ts-expect-error TS(2322): Type 'null' is not assignable to type '({ origin, ... Remove this comment to see the full error message\n    this._callbackHandler = null;\n  }\n\n  // create a time out to refresh implicit flow token\n  private _createImplicitRefreshTimeout() {\n    if (this._implicitRefreshTimeoutId) {\n      clearTimeout(this._implicitRefreshTimeoutId);\n    }\n    const authData = this._deps.auth.token;\n    const refreshTokenExpiresIn = authData.expiresIn;\n    const { expireTime } = authData;\n\n    if (!refreshTokenExpiresIn || !expireTime) return;\n\n    // * set refresh time to (token expose time) / 3\n    let refreshTokenTimeoutTime =\n      (parseInt(`${refreshTokenExpiresIn}`, 10) * 1000) / 3;\n\n    if (refreshTokenTimeoutTime + Date.now() > expireTime) {\n      refreshTokenTimeoutTime = expireTime - Date.now() - 5000;\n      if (refreshTokenTimeoutTime < 0) return;\n    }\n\n    this._implicitRefreshTimeoutId = setTimeout(() => {\n      if (!this._deps.auth.loggedIn) return;\n\n      if (!this._deps.tabManager?.active) {\n        this._createImplicitRefreshTimeout();\n        return;\n      }\n\n      this._createImplicitRefreshIframe();\n      // @ts-expect-error TS(2322): Type 'null' is not assignable to type 'Timeout'.\n      this._implicitRefreshTimeoutId = null;\n    }, refreshTokenTimeoutTime);\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAA,IAAAA,WAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,GAAA,GAAAD,OAAA;AACA,IAAAE,QAAA,GAAAF,OAAA;AACA,IAAAG,KAAA,GAAAH,OAAA;AACA,IAAAI,IAAA,GAAAC,uBAAA,CAAAL,OAAA;AAEA,IAAAM,WAAA,GAAAN,OAAA;AAAgD,IAAAO,IAAA,EAAAC,MAAA,EAAAC,OAAA,EAAAC,WAAA;AAAA,SAAAC,yBAAAC,CAAA,6BAAAC,OAAA,mBAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAF,wBAAA,YAAAA,yBAAAC,CAAA,WAAAA,CAAA,GAAAG,CAAA,GAAAD,CAAA,KAAAF,CAAA;AAAA,SAAAP,wBAAAO,CAAA,EAAAE,CAAA,SAAAA,CAAA,IAAAF,CAAA,IAAAA,CAAA,CAAAI,UAAA,SAAAJ,CAAA,eAAAA,CAAA,gBAAAK,OAAA,CAAAL,CAAA,0BAAAA,CAAA,sBAAAA,CAAA,QAAAG,CAAA,GAAAJ,wBAAA,CAAAG,CAAA,OAAAC,CAAA,IAAAA,CAAA,CAAAG,GAAA,CAAAN,CAAA,UAAAG,CAAA,CAAAI,GAAA,CAAAP,CAAA,OAAAQ,CAAA,KAAAC,SAAA,UAAAC,CAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,CAAA,IAAAd,CAAA,sBAAAc,CAAA,OAAAC,cAAA,CAAAC,IAAA,CAAAhB,CAAA,EAAAc,CAAA,SAAAG,CAAA,GAAAP,CAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAb,CAAA,EAAAc,CAAA,UAAAG,CAAA,KAAAA,CAAA,CAAAV,GAAA,IAAAU,CAAA,CAAAC,GAAA,IAAAP,MAAA,CAAAC,cAAA,CAAAJ,CAAA,EAAAM,CAAA,EAAAG,CAAA,IAAAT,CAAA,CAAAM,CAAA,IAAAd,CAAA,CAAAc,CAAA,cAAAN,CAAA,cAAAR,CAAA,EAAAG,CAAA,IAAAA,CAAA,CAAAe,GAAA,CAAAlB,CAAA,EAAAQ,CAAA,GAAAA,CAAA;AAAA,SAAArB,uBAAAa,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAI,UAAA,GAAAJ,CAAA,gBAAAA,CAAA;AAAA,SAAAmB,mBAAAX,CAAA,EAAAL,CAAA,EAAAH,CAAA,EAAAE,CAAA,EAAAkB,CAAA,EAAAV,CAAA,EAAAW,CAAA,cAAAJ,CAAA,GAAAT,CAAA,CAAAE,CAAA,EAAAW,CAAA,GAAAP,CAAA,GAAAG,CAAA,CAAAK,KAAA,WAAAd,CAAA,gBAAAR,CAAA,CAAAQ,CAAA,KAAAS,CAAA,CAAAM,IAAA,GAAApB,CAAA,CAAAW,CAAA,IAAAU,OAAA,CAAAC,OAAA,CAAAX,CAAA,EAAAY,IAAA,CAAAxB,CAAA,EAAAkB,CAAA;AAAA,SAAAO,kBAAAnB,CAAA,6BAAAL,CAAA,SAAAH,CAAA,GAAA4B,SAAA,aAAAJ,OAAA,WAAAtB,CAAA,EAAAkB,CAAA,QAAAV,CAAA,GAAAF,CAAA,CAAAqB,KAAA,CAAA1B,CAAA,EAAAH,CAAA,YAAA8B,MAAAtB,CAAA,IAAAW,kBAAA,CAAAT,CAAA,EAAAR,CAAA,EAAAkB,CAAA,EAAAU,KAAA,EAAAC,MAAA,UAAAvB,CAAA,cAAAuB,OAAAvB,CAAA,IAAAW,kBAAA,CAAAT,CAAA,EAAAR,CAAA,EAAAkB,CAAA,EAAAU,KAAA,EAAAC,MAAA,WAAAvB,CAAA,KAAAsB,KAAA;AAAA,SAAAE,2BAAAhC,CAAA,EAAAiB,CAAA,EAAAf,CAAA,EAAA+B,CAAA,IAAA/B,CAAA,IAAAS,MAAA,CAAAC,cAAA,CAAAZ,CAAA,EAAAiB,CAAA,IAAAiB,UAAA,EAAAhC,CAAA,CAAAgC,UAAA,EAAAC,YAAA,EAAAjC,CAAA,CAAAiC,YAAA,EAAAC,QAAA,EAAAlC,CAAA,CAAAkC,QAAA,EAAAd,KAAA,EAAApB,CAAA,CAAAmC,WAAA,GAAAnC,CAAA,CAAAmC,WAAA,CAAArB,IAAA,CAAAiB,CAAA;AAAA,SAAAK,QAAAtC,CAAA,EAAAE,CAAA,QAAAC,CAAA,GAAAQ,MAAA,CAAA4B,IAAA,CAAAvC,CAAA,OAAAW,MAAA,CAAA6B,qBAAA,QAAApB,CAAA,GAAAT,MAAA,CAAA6B,qBAAA,CAAAxC,CAAA,GAAAE,CAAA,KAAAkB,CAAA,GAAAA,CAAA,CAAAqB,MAAA,WAAAvC,CAAA,WAAAS,MAAA,CAAAE,wBAAA,CAAAb,CAAA,EAAAE,CAAA,EAAAgC,UAAA,OAAA/B,CAAA,CAAAuC,IAAA,CAAAb,KAAA,CAAA1B,CAAA,EAAAiB,CAAA,YAAAjB,CAAA;AAAA,SAAAwC,cAAA3C,CAAA,aAAAE,CAAA,MAAAA,CAAA,GAAA0B,SAAA,CAAAgB,MAAA,EAAA1C,CAAA,UAAAC,CAAA,WAAAyB,SAAA,CAAA1B,CAAA,IAAA0B,SAAA,CAAA1B,CAAA,QAAAA,CAAA,OAAAoC,OAAA,CAAA3B,MAAA,CAAAR,CAAA,OAAA0C,OAAA,WAAA3C,CAAA,IAAA4C,eAAA,CAAA9C,CAAA,EAAAE,CAAA,EAAAC,CAAA,CAAAD,CAAA,SAAAS,MAAA,CAAAoC,yBAAA,GAAApC,MAAA,CAAAqC,gBAAA,CAAAhD,CAAA,EAAAW,MAAA,CAAAoC,yBAAA,CAAA5C,CAAA,KAAAmC,OAAA,CAAA3B,MAAA,CAAAR,CAAA,GAAA0C,OAAA,WAAA3C,CAAA,IAAAS,MAAA,CAAAC,cAAA,CAAAZ,CAAA,EAAAE,CAAA,EAAAS,MAAA,CAAAE,wBAAA,CAAAV,CAAA,EAAAD,CAAA,iBAAAF,CAAA;AAAA,SAAA8C,gBAAA9C,CAAA,EAAAE,CAAA,EAAAC,CAAA,YAAAD,CAAA,GAAA+C,cAAA,CAAA/C,CAAA,MAAAF,CAAA,GAAAW,MAAA,CAAAC,cAAA,CAAAZ,CAAA,EAAAE,CAAA,IAAAoB,KAAA,EAAAnB,CAAA,EAAA+B,UAAA,MAAAC,YAAA,MAAAC,QAAA,UAAApC,CAAA,CAAAE,CAAA,IAAAC,CAAA,EAAAH,CAAA;AAAA,SAAAkD,yBAAAlD,CAAA,EAAAG,CAAA,gBAAAH,CAAA,iBAAAoB,CAAA,EAAAlB,CAAA,EAAAe,CAAA,GAAAkC,6BAAA,CAAAnD,CAAA,EAAAG,CAAA,OAAAQ,MAAA,CAAA6B,qBAAA,QAAAY,CAAA,GAAAzC,MAAA,CAAA6B,qBAAA,CAAAxC,CAAA,QAAAE,CAAA,MAAAA,CAAA,GAAAkD,CAAA,CAAAR,MAAA,EAAA1C,CAAA,MAAAkB,CAAA,GAAAgC,CAAA,CAAAlD,CAAA,GAAAC,CAAA,CAAAkD,QAAA,CAAAjC,CAAA,QAAAkC,oBAAA,CAAAtC,IAAA,CAAAhB,CAAA,EAAAoB,CAAA,MAAAH,CAAA,CAAAG,CAAA,IAAApB,CAAA,CAAAoB,CAAA,eAAAH,CAAA;AAAA,SAAAkC,8BAAAjD,CAAA,EAAAF,CAAA,gBAAAE,CAAA,iBAAAC,CAAA,gBAAAK,CAAA,IAAAN,CAAA,WAAAa,cAAA,CAAAC,IAAA,CAAAd,CAAA,EAAAM,CAAA,SAAAR,CAAA,CAAAqD,QAAA,CAAA7C,CAAA,aAAAL,CAAA,CAAAK,CAAA,IAAAN,CAAA,CAAAM,CAAA,cAAAL,CAAA;AAAA,SAAAoD,gBAAA7C,CAAA,EAAAF,CAAA,UAAAE,CAAA,YAAAF,CAAA,aAAAgD,SAAA;AAAA,SAAAC,kBAAAzD,CAAA,EAAAE,CAAA,aAAAC,CAAA,MAAAA,CAAA,GAAAD,CAAA,CAAA0C,MAAA,EAAAzC,CAAA,UAAAiB,CAAA,GAAAlB,CAAA,CAAAC,CAAA,GAAAiB,CAAA,CAAAc,UAAA,GAAAd,CAAA,CAAAc,UAAA,QAAAd,CAAA,CAAAe,YAAA,kBAAAf,CAAA,KAAAA,CAAA,CAAAgB,QAAA,QAAAzB,MAAA,CAAAC,cAAA,CAAAZ,CAAA,EAAAiD,cAAA,CAAA7B,CAAA,CAAAsC,GAAA,GAAAtC,CAAA;AAAA,SAAAuC,aAAA3D,CAAA,EAAAE,CAAA,EAAAC,CAAA,WAAAD,CAAA,IAAAuD,iBAAA,CAAAzD,CAAA,CAAA4D,SAAA,EAAA1D,CAAA,GAAAC,CAAA,IAAAsD,iBAAA,CAAAzD,CAAA,EAAAG,CAAA,GAAAQ,MAAA,CAAAC,cAAA,CAAAZ,CAAA,iBAAAoC,QAAA,SAAApC,CAAA;AAAA,SAAAiD,eAAA9C,CAAA,QAAAc,CAAA,GAAA4C,YAAA,CAAA1D,CAAA,gCAAAE,OAAA,CAAAY,CAAA,IAAAA,CAAA,GAAAA,CAAA;AAAA,SAAA4C,aAAA1D,CAAA,EAAAD,CAAA,oBAAAG,OAAA,CAAAF,CAAA,MAAAA,CAAA,SAAAA,CAAA,MAAAH,CAAA,GAAAG,CAAA,CAAA2D,MAAA,CAAAC,WAAA,kBAAA/D,CAAA,QAAAiB,CAAA,GAAAjB,CAAA,CAAAgB,IAAA,CAAAb,CAAA,EAAAD,CAAA,gCAAAG,OAAA,CAAAY,CAAA,UAAAA,CAAA,YAAAuC,SAAA,yEAAAtD,CAAA,GAAA8D,MAAA,GAAAC,MAAA,EAAA9D,CAAA;AAAA,SAAA+D,KAAA,WAAAA,IAAA,yBAAAC,OAAA,IAAAA,OAAA,CAAA5D,GAAA,GAAA4D,OAAA,CAAA5D,GAAA,CAAA6D,IAAA,eAAApE,CAAA,EAAAG,CAAA,EAAAD,CAAA,QAAAmE,CAAA,GAAAC,cAAA,CAAAtE,CAAA,EAAAG,CAAA,OAAAkE,CAAA,QAAA7D,CAAA,GAAAG,MAAA,CAAAE,wBAAA,CAAAwD,CAAA,EAAAlE,CAAA,UAAAK,CAAA,CAAAD,GAAA,GAAAC,CAAA,CAAAD,GAAA,CAAAS,IAAA,CAAAY,SAAA,CAAAgB,MAAA,OAAA5C,CAAA,GAAAE,CAAA,IAAAM,CAAA,CAAAc,KAAA,OAAA4C,IAAA,CAAArC,KAAA,OAAAD,SAAA;AAAA,SAAA0C,eAAAnE,CAAA,EAAAiB,CAAA,eAAAL,cAAA,CAAAC,IAAA,CAAAb,CAAA,EAAAiB,CAAA,eAAAjB,CAAA,GAAAoE,eAAA,CAAApE,CAAA,kBAAAA,CAAA;AAAA,SAAAqE,UAAArE,CAAA,EAAAH,CAAA,6BAAAA,CAAA,aAAAA,CAAA,YAAAwD,SAAA,wDAAArD,CAAA,CAAAyD,SAAA,GAAAjD,MAAA,CAAA8D,MAAA,CAAAzE,CAAA,IAAAA,CAAA,CAAA4D,SAAA,IAAAc,WAAA,IAAApD,KAAA,EAAAnB,CAAA,EAAAiC,QAAA,MAAAD,YAAA,WAAAxB,MAAA,CAAAC,cAAA,CAAAT,CAAA,iBAAAiC,QAAA,SAAApC,CAAA,IAAA2E,eAAA,CAAAxE,CAAA,EAAAH,CAAA;AAAA,SAAA2E,gBAAAxE,CAAA,EAAAH,CAAA,WAAA2E,eAAA,GAAAhE,MAAA,CAAAiE,cAAA,GAAAjE,MAAA,CAAAiE,cAAA,CAAAR,IAAA,eAAAjE,CAAA,EAAAH,CAAA,WAAAG,CAAA,CAAAM,SAAA,GAAAT,CAAA,EAAAG,CAAA,KAAAwE,eAAA,CAAAxE,CAAA,EAAAH,CAAA;AAAA,SAAA6E,aAAA1E,CAAA,QAAAD,CAAA,GAAA4E,yBAAA,6BAAA9E,CAAA,EAAAoB,CAAA,GAAAmD,eAAA,CAAApE,CAAA,OAAAD,CAAA,QAAAkD,CAAA,GAAAmB,eAAA,OAAAG,WAAA,EAAA1E,CAAA,GAAAmE,OAAA,CAAAY,SAAA,CAAA3D,CAAA,EAAAQ,SAAA,EAAAwB,CAAA,UAAApD,CAAA,GAAAoB,CAAA,CAAAS,KAAA,OAAAD,SAAA,UAAAoD,0BAAA,OAAAhF,CAAA;AAAA,SAAAgF,2BAAA7E,CAAA,EAAAH,CAAA,QAAAA,CAAA,iBAAAK,OAAA,CAAAL,CAAA,0BAAAA,CAAA,UAAAA,CAAA,iBAAAA,CAAA,YAAAwD,SAAA,qEAAAyB,sBAAA,CAAA9E,CAAA;AAAA,SAAA8E,uBAAAjF,CAAA,mBAAAA,CAAA,YAAAkF,cAAA,sEAAAlF,CAAA;AAAA,SAAA8E,0BAAA,cAAA3E,CAAA,IAAAgF,OAAA,CAAAvB,SAAA,CAAAwB,OAAA,CAAApE,IAAA,CAAAmD,OAAA,CAAAY,SAAA,CAAAI,OAAA,iCAAAhF,CAAA,aAAA2E,yBAAA,YAAAA,0BAAA,aAAA3E,CAAA;AAAA,SAAAoE,gBAAApE,CAAA,WAAAoE,eAAA,GAAA5D,MAAA,CAAAiE,cAAA,GAAAjE,MAAA,CAAA0E,cAAA,CAAAjB,IAAA,eAAAjE,CAAA,WAAAA,CAAA,CAAAM,SAAA,IAAAE,MAAA,CAAA0E,cAAA,CAAAlF,CAAA,MAAAoE,eAAA,CAAApE,CAAA;AAAA,SAAAmF,0BAAArE,CAAA,EAAAjB,CAAA,EAAAE,CAAA,EAAAM,CAAA,EAAAyB,CAAA,QAAAvB,CAAA,cAAAC,MAAA,CAAA4B,IAAA,CAAA/B,CAAA,EAAAqC,OAAA,WAAA5B,CAAA,IAAAP,CAAA,CAAAO,CAAA,IAAAT,CAAA,CAAAS,CAAA,OAAAP,CAAA,CAAAwB,UAAA,KAAAxB,CAAA,CAAAwB,UAAA,EAAAxB,CAAA,CAAAyB,YAAA,KAAAzB,CAAA,CAAAyB,YAAA,cAAAzB,CAAA,IAAAA,CAAA,CAAA2B,WAAA,MAAA3B,CAAA,CAAA0B,QAAA,QAAA1B,CAAA,GAAAR,CAAA,CAAAqF,KAAA,GAAAC,OAAA,GAAAC,MAAA,WAAAvF,CAAA,EAAAM,CAAA,WAAAA,CAAA,CAAAS,CAAA,EAAAjB,CAAA,EAAAE,CAAA,KAAAA,CAAA,KAAAQ,CAAA,GAAAuB,CAAA,eAAAvB,CAAA,CAAA2B,WAAA,KAAA3B,CAAA,CAAAY,KAAA,GAAAZ,CAAA,CAAA2B,WAAA,GAAA3B,CAAA,CAAA2B,WAAA,CAAArB,IAAA,CAAAiB,CAAA,YAAAvB,CAAA,CAAA2B,WAAA,uBAAA3B,CAAA,CAAA2B,WAAA,IAAA1B,MAAA,CAAAC,cAAA,CAAAK,CAAA,EAAAjB,CAAA,EAAAU,CAAA,WAAAA,CAAA;AAAA,SAAAgF,0BAAAxF,CAAA,EAAAF,CAAA,UAAA2F,KAAA;AAIhD,IAAMC,mBAAmB,GAAG,IAAI;AAAC,IAepBC,eAAe,IAAAlG,IAAA,GAR3B,IAAAmG,UAAM,EAAC;EACNC,IAAI,EAAE,OAAO;EACbC,IAAI,EAAE,CACJ,QAAQ,EACR,mBAAmB,EACnB;IAAEC,GAAG,EAAE,cAAc;IAAEC,QAAQ,EAAE;EAAK,CAAC;AAE3C,CAAC,CAAC,EAAAvG,IAAA,CAAAC,MAAA,IAAAC,OAAA,0BAAAsG,UAAA;EAAA3B,SAAA,CAAAqB,eAAA,EAAAM,UAAA;EAAA,IAAAC,MAAA,GAAAvB,YAAA,CAAAgB,eAAA;EAcA,SAAAA,gBAAAQ,IAAA,EASM;IAAA,IAAAC,KAAA;IAAA,IAAAC,iBAAA,GAAAF,IAAA,CARJG,YAAY;IAAAD,iBAAA,GAAAA,iBAAA,cAMR,CAAC,CAAC,GAAAA,iBAAA;IAAA,IAAAE,qBAAA,GAAAF,iBAAA,CALJG,SAAS;MAATA,SAAS,GAAAD,qBAAA,cAAG,GAAG,GAAAA,qBAAA;MAAAE,qBAAA,GAAAJ,iBAAA,CACfK,WAAW;MAAXA,WAAW,GAAAD,qBAAA,cAAG,iBAAiB,GAAAA,qBAAA;MAAAE,qBAAA,GAAAN,iBAAA,CAC/BO,QAAQ;MAARA,QAAQ,GAAAD,qBAAA,cAAG,cAAc,GAAAA,qBAAA;MAAAE,qBAAA,GAAAR,iBAAA,CACzBS,iBAAiB;MAAjBA,iBAAiB,GAAAD,qBAAA,cAAGnB,mBAAmB,GAAAmB,qBAAA;MACpCE,gBAAgB,GAAA/D,wBAAA,CAAAqD,iBAAA;MAElBP,IAAI,GAAA9C,wBAAA,CAAAmD,IAAA;IAAA9C,eAAA,OAAAsC,eAAA;IAEPS,KAAA,GAAAF,MAAA,CAAApF,IAAA,OAAA2B,aAAA,CAAAA,aAAA,KACKqD,IAAI;MACPQ,YAAY,EAAA7D,aAAA;QACV+D,SAAS,EAATA,SAAS;QACTE,WAAW,EAAXA,WAAW;QACXE,QAAQ,EAARA,QAAQ;QACRE,iBAAiB,EAAjBA;MAAiB,GACdC,gBAAgB;IACpB;IA9BL;IAAAX,KAAA,CACQY,eAAe,GAAkC,IAAI;IAC7D;IAAAZ,KAAA,CACQa,yBAAyB,GAAkC,IAAI;IAAAb,KAAA,CAE/Dc,KAAK,GAAG5H,IAAI,CAAC6H,EAAE,CAAC,CAAC;IACzB;IAAAf,KAAA,CACQgB,WAAW;IACnB;IAAAhB,KAAA,CACQiB,qBAAqB;IAAAjB,KAAA,CACnBkB,SAAS,GAAG,KAAK;IAAAxF,0BAAA,CAAAsE,KAAA,qBAAAxG,WAAA,EAAAmF,sBAAA,CAAAqB,KAAA;IAAAA,KAAA,CA2HnBmB,gBAAgB;MAAA,IAAAC,KAAA,GAAA/F,iBAAA,eAAAgG,kBAAA,CAAAC,IAAA,CAAG,SAAAC,QAAAC,KAAA;QAAA,IAAAC,MAAA,EAAAC,IAAA,EAAAC,WAAA,EAAAC,WAAA;QAAA,OAAAP,kBAAA,CAAAQ,IAAA,UAAAC,SAAAC,QAAA;UAAA;YAAA,QAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;cAAA;gBAASR,MAAM,GAAAD,KAAA,CAANC,MAAM,EAAEC,IAAI,GAAAF,KAAA,CAAJE,IAAI;gBAAA,IAEzCA,IAAI;kBAAAK,QAAA,CAAAE,IAAA;kBAAA;gBAAA;gBAAA,OAAAF,QAAA,CAAAG,MAAA;cAAA;gBAEDP,WAAW,GAAkBD,IAAI,CAAjCC,WAAW,EAAEC,WAAW,GAAKF,IAAI,CAApBE,WAAW;gBAChC,IAAID,WAAW,EAAE;kBACf3B,KAAA,CAAKmC,kBAAkB,CAACR,WAAW,CAAC;gBACtC,CAAC,MAAM,IAAIC,WAAW,EAAE;kBACtBQ,YAAY,CAACpC,KAAA,CAAKY,eAAe,CAAC;kBAClC;kBACAZ,KAAA,CAAKY,eAAe,GAAG,IAAI;kBAE3BZ,KAAA,CAAKqC,aAAa,CAAC,IAAI,CAAC;gBAC1B;cAAC;cAAA;gBAAA,OAAAN,QAAA,CAAAO,IAAA;YAAA;UAAA;QAAA,GAAAf,OAAA;MAAA,CACF;MAAA,iBAAAgB,EAAA;QAAA,OAAAnB,KAAA,CAAA7F,KAAA,OAAAD,SAAA;MAAA;IAAA;IAAA0E,KAAA,CAEOwC,iBAAiB,GAAG,YAAM;MAAA,IAAAC,qBAAA;MAChCzC,KAAA,CAAKgB,WAAW,GAAG0B,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;MACnD3C,KAAA,CAAKgB,WAAW,CAAC4B,GAAG,GAAG5C,KAAA,CAAKQ,QAAQ;MACpCR,KAAA,CAAKgB,WAAW,CAAC6B,KAAK,CAACC,OAAO,GAAG,MAAM;MACvC,IAAMC,MAAM,GACVC,MAAM,IACNA,MAAM,CAACC,SAAS,IAChBD,MAAM,CAACC,SAAS,CAACC,SAAS,CAACC,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;MACjD,IAAMC,IAAI,GACRJ,MAAM,IACNA,MAAM,CAACC,SAAS,IAChB,eAAe,CAACI,IAAI,CAACL,MAAM,CAACC,SAAS,CAACC,SAAS,CAAC;MAClD,IAAI,CAACH,MAAM,IAAI,CAACK,IAAI,EAAE;QACpBpD,KAAA,CAAKgB,WAAW,CAACsC,YAAY,CAC3B,SAAS,EACT,CACE,eAAe,EACf,cAAc,EACd,mBAAmB,EACnB,aAAa,CACd,CAACC,IAAI,CAAC,GAAG,CACZ,CAAC;MACH;MACAb,QAAQ,CAACc,IAAI,CAACC,WAAW,CAACzD,KAAA,CAAKgB,WAAW,CAAC;MAE3CgC,MAAM,CAACU,gBAAgB,CAAC,SAAS,EAAE1D,KAAA,CAAKmB,gBAAgB,CAAC;MAEzDnB,KAAA,CAAKY,eAAe,GAAG+C,UAAU,CAAC,YAAM;QACtC3D,KAAA,CAAK4D,qBAAqB,CAAC,CAAC;MAC9B,CAAC,GAAAnB,qBAAA,GAAEzC,KAAA,CAAK6D,KAAK,CAAC3D,YAAY,cAAAuC,qBAAA,uBAAvBA,qBAAA,CAAyB/B,iBAAiB,CAAC;IAChD,CAAC;IAAAV,KAAA,CA4DO8D,wBAAwB,GAAG,UAAAC,KAAA,EAA8B;MAAA,IAA3BrC,IAAI,GAAAqC,KAAA,CAAJrC,IAAI;MAAA,IAChCsC,kBAAkB,GAAKtC,IAAI,CAA3BsC,kBAAkB;MAC1B,IAAIA,kBAAkB,IAAIhE,KAAA,CAAK6D,KAAK,CAACI,IAAI,CAACC,QAAQ,EAAE;QAClDlE,KAAA,CAAKmC,kBAAkB,CAAC6B,kBAAkB,EAAE,IAAI,CAAC;QACjDhE,KAAA,CAAKmE,2BAA2B,CAAC,CAAC;MACpC;IACF,CAAC;IAAA,OAAAnE,KAAA;EArND;EAAC3C,YAAA,CAAAkC,eAAA;IAAAnC,GAAA;IAAApC,KAAA,WAAAoJ,WAAA,EAEqB;MAAA,IAAAC,MAAA;MACpBzG,IAAA,CAAAK,eAAA,CAAAsB,eAAA,CAAAjC,SAAA,0BAAAM,IAAA,CAAAK,eAAA,CAAAsB,eAAA,CAAAjC,SAAA,uBAAA5C,IAAA,MAAsC;MAEtC,IAAA4J,WAAK,EACH,IAAI,EACJ;QAAA,IAAAC,qBAAA;QAAA,OAAM,CACJF,MAAI,CAACG,KAAK,EACVH,MAAI,CAACR,KAAK,CAACI,IAAI,CAACC,QAAQ,EACxBG,MAAI,CAACR,KAAK,CAACY,iBAAiB,CAACC,WAAW,GAAAH,qBAAA,GACxCF,MAAI,CAACR,KAAK,CAAC3D,YAAY,cAAAqE,qBAAA,uBAAvBA,qBAAA,CAAyBnE,SAAS,EAClCiE,MAAI,CAACM,UAAU,EACfN,MAAI,CAACrD,WAAW,CACjB;MAAA,GACD,YAAM;QAAA,IAAA4D,sBAAA;QACJ,IAAMC,WAAW,GACfR,MAAI,CAACR,KAAK,CAACY,iBAAiB,CAACC,WAAW,OAAAE,sBAAA,GACxCP,MAAI,CAACR,KAAK,CAAC3D,YAAY,cAAA0E,sBAAA,uBAAvBA,sBAAA,CAAyBxE,SAAS;QAEpC,IACEiE,MAAI,CAACG,KAAK,IACV,CAACH,MAAI,CAACR,KAAK,CAACI,IAAI,CAACC,QAAQ,IACzBW,WAAW,IACX,CAACR,MAAI,CAACM,UAAU,IAChB,CAACN,MAAI,CAACrD,WAAW,EACjB;UACAqD,MAAI,CAACS,UAAU,CAAC,CAAC;QACnB,CAAC,MAAM,IACLT,MAAI,CAACrD,WAAW,KACfqD,MAAI,CAACR,KAAK,CAACI,IAAI,CAACC,QAAQ,IAAI,CAACW,WAAW,CAAC,EAC1C;UACAR,MAAI,CAACU,YAAY,CAAC,CAAC;QACrB;QAEA,IAAIV,MAAI,CAACR,KAAK,CAACI,IAAI,CAACC,QAAQ,KAAKG,MAAI,CAACnD,SAAS,EAAE;QAEjDmD,MAAI,CAACnD,SAAS,GAAGmD,MAAI,CAACR,KAAK,CAACI,IAAI,CAACC,QAAQ;QAEzC,IAAIG,MAAI,CAACR,KAAK,CAACI,IAAI,CAACe,UAAU,EAAE;UAC9B,IAAIX,MAAI,CAACnD,SAAS,EAAE;YAClBmD,MAAI,CAACY,6BAA6B,CAAC,CAAC;UACtC,CAAC,MAAM,IAAI,CAACZ,MAAI,CAACnD,SAAS,EAAE;YAC1BmD,MAAI,CAACF,2BAA2B,CAAC,CAAC;YAElC,IAAIE,MAAI,CAACxD,yBAAyB,EAAE;cAClCuB,YAAY,CAACiC,MAAI,CAACxD,yBAAyB,CAAC;YAC9C;UACF;QACF;MACF,CAAC,EACD;QAAEqE,QAAQ,EAAE;MAAK,CACnB,CAAC;IACH,CAAC,CAED;EAAA;IAAA9H,GAAA;IAAApC,KAAA;MAAA,IAAAmK,mBAAA,GAAA9J,iBAAA,eAAAgG,kBAAA,CAAAC,IAAA,UAAA8D,SACyBzD,WAAmB;QAAA,IAAA0D,OAAA;UAAAC,MAAA,GAAAhK,SAAA;QAAA,OAAA+F,kBAAA,CAAAQ,IAAA,UAAA0D,UAAAC,SAAA;UAAA;YAAA,QAAAA,SAAA,CAAAxD,IAAA,GAAAwD,SAAA,CAAAvD,IAAA;cAAA;gBAAEoD,OAAO,GAAAC,MAAA,CAAAhJ,MAAA,QAAAgJ,MAAA,QAAAG,SAAA,GAAAH,MAAA,MAAG,KAAK;gBAAAE,SAAA,CAAAvD,IAAA;gBAAA,OAAArE,IAAA,CAAAK,eAAA,CAAAsB,eAAA,CAAAjC,SAAA,+BAAA5C,IAAA,OAC5BiH,WAAW,EAAE0D,OAAO;cAAA;gBAEnD,IAAI,IAAI,CAACxB,KAAK,CAACI,IAAI,CAACe,UAAU,IAAI,IAAI,CAACnB,KAAK,CAACI,IAAI,CAACC,QAAQ,EAAE;kBAC1D,IAAI,CAACe,6BAA6B,CAAC,CAAC;gBACtC;cAAC;cAAA;gBAAA,OAAAO,SAAA,CAAAlD,IAAA;YAAA;UAAA;QAAA,GAAA8C,QAAA;MAAA;MAAA,SAAAjD,mBAAAuD,GAAA;QAAA,OAAAP,mBAAA,CAAA5J,KAAA,OAAAD,SAAA;MAAA;MAAA,OAAA6G,kBAAA;IAAA,IAGH;EAAA;IAAA/E,GAAA;IAAApC,KAAA,WAAA2K,mBA2BmBC,GAAW,EAAE;MAC9B,IAAI,CAACC,eAAe,GAAGD,GAAG;IAC5B;EAAC;IAAAxI,GAAA;IAAApC,KAAA,WAAAqH,cAGsBuD,GAAY,EAAE;MACnChI,IAAA,CAAAK,eAAA,CAAAsB,eAAA,CAAAjC,SAAA,0BAAA5C,IAAA,OAAoBkL,GAAG;MACvB,IAAI,CAACD,kBAAkB,CAAC,CAAC,CAAC;IAC5B;EAAC;IAAAvI,GAAA;IAAApC,KAAA,WAAA4I,sBAAA,EAkD+B;MAC9B;MACA,IAAI,CAAChD,eAAe,GAAG,IAAI;MAC3B,IAAI,IAAI,CAAC+D,UAAU,EAAE;MAErB,IAAI,CAACgB,kBAAkB,CAAC,IAAI,CAACE,eAAe,GAAG,CAAC,CAAC;MACjD,IAAI,CAACC,kBAAkB,CAAC,CAAC;MACzB,IAAI,CAACtD,iBAAiB,CAAC,CAAC;IAC1B;EAAC;IAAApF,GAAA;IAAApC,KAAA,WAAA8K,mBAAA,EAE4B;MAC3BpD,QAAQ,CAACc,IAAI,CAACuC,WAAW,CAAC,IAAI,CAAC/E,WAAW,CAAC;MAC3C;MACA,IAAI,CAACA,WAAW,GAAG,IAAI;MACvBgC,MAAM,CAACgD,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC7E,gBAAgB,CAAC;IAC9D;EAAC;IAAA/D,GAAA;IAAApC,KAAA;MAAA,IAAAiL,WAAA,GAAA5K,iBAAA,eAAAgG,kBAAA,CAAAC,IAAA,UAAA4E,SAAA;QAAA,OAAA7E,kBAAA,CAAAQ,IAAA,UAAAsE,UAAAC,SAAA;UAAA;YAAA,QAAAA,SAAA,CAAApE,IAAA,GAAAoE,SAAA,CAAAnE,IAAA;cAAA;gBAAA,KAIK,IAAI,CAACjB,WAAW;kBAAAoF,SAAA,CAAAnE,IAAA;kBAAA;gBAAA;gBAAA,OAAAmE,SAAA,CAAAlE,MAAA;cAAA;gBAEpB,IAAI,CAACM,iBAAiB,CAAC,CAAC;gBACxB,IAAI,CAACmD,kBAAkB,CAAC,CAAC,CAAC;cAAC;cAAA;gBAAA,OAAAS,SAAA,CAAA9D,IAAA;YAAA;UAAA;QAAA,GAAA4D,QAAA;MAAA;MAAA,SAAApB,WAAA;QAAA,OAAAmB,WAAA,CAAA1K,KAAA,OAAAD,SAAA;MAAA;MAAA,OAAAwJ,UAAA;IAAA;EAAA;IAAA1H,GAAA;IAAApC,KAAA;MAAA,IAAAqL,aAAA,GAAAhL,iBAAA,eAAAgG,kBAAA,CAAAC,IAAA,UAAAgF,SAAA;QAAA,OAAAjF,kBAAA,CAAAQ,IAAA,UAAA0E,UAAAC,SAAA;UAAA;YAAA,QAAAA,SAAA,CAAAxE,IAAA,GAAAwE,SAAA,CAAAvE,IAAA;cAAA;gBAAA,IAMtB,IAAI,CAACjB,WAAW;kBAAAwF,SAAA,CAAAvE,IAAA;kBAAA;gBAAA;gBAAA,OAAAuE,SAAA,CAAAtE,MAAA;cAAA;gBAErB,IAAI,IAAI,CAACtB,eAAe,EAAE;kBACxBwB,YAAY,CAAC,IAAI,CAACxB,eAAe,CAAC;kBAClC;kBACA,IAAI,CAACA,eAAe,GAAG,IAAI;gBAC7B;gBAEA,IAAI,CAACkF,kBAAkB,CAAC,CAAC;gBACzB,IAAI,CAACzD,aAAa,CAAC,KAAK,CAAC;cAAC;cAAA;gBAAA,OAAAmE,SAAA,CAAAlE,IAAA;YAAA;UAAA;QAAA,GAAAgE,QAAA;MAAA;MAAA,SAAAvB,aAAA;QAAA,OAAAsB,aAAA,CAAA9K,KAAA,OAAAD,SAAA;MAAA;MAAA,OAAAyJ,YAAA;IAAA;EAAA;IAAA3H,GAAA;IAAApC,KAAA;MAAA,IAAAyL,cAAA,GAAApL,iBAAA,eAAAgG,kBAAA,CAAAC,IAAA,UAAAoF,SAAA;QAAA,OAAArF,kBAAA,CAAAQ,IAAA,UAAA8E,UAAAC,SAAA;UAAA;YAAA,QAAAA,SAAA,CAAA5E,IAAA,GAAA4E,SAAA,CAAA3E,IAAA;cAAA;gBAAA,IAMrB,IAAI,CAAC0C,UAAU;kBAAAiC,SAAA,CAAA3E,IAAA;kBAAA;gBAAA;gBAAA,OAAA2E,SAAA,CAAA1E,MAAA;cAAA;gBAAA,KAEhB,IAAI,CAAC2B,KAAK,CAACgD,MAAM,CAACC,OAAO,CAACC,QAAQ,CAAC,CAAC,CAACC,SAAS,CAAC,CAAC;kBAAAJ,SAAA,CAAA3E,IAAA;kBAAA;gBAAA;gBAAA2E,SAAA,CAAA3E,IAAA;gBAAA,OAC5C,IAAI,CAAC4B,KAAK,CAACgD,MAAM,CAACC,OAAO,CAACC,QAAQ,CAAC,CAAC,CAACE,qBAAqB,CAAC,CAAC;cAAA;gBAGpE;gBACA,IAAI,CAACjG,WAAW,CAACkG,aAAa,CAACC,WAAW,CACxC;kBACEC,QAAQ,EAAE,IAAI,CAACA;gBACjB,CAAC,EACD,GACF,CAAC;cAAC;cAAA;gBAAA,OAAAR,SAAA,CAAAtE,IAAA;YAAA;UAAA;QAAA,GAAAoE,QAAA;MAAA;MAAA,SAAAW,cAAA;QAAA,OAAAZ,cAAA,CAAAlL,KAAA,OAAAD,SAAA;MAAA;MAAA,OAAA+L,aAAA;IAAA;EAAA;IAAAjK,GAAA;IAAApC,KAAA,WAAAsM,6BAAA,EAWmC;MACrC,IAAI,CAACnD,2BAA2B,CAAC,CAAC;MAClC,IAAI,CAAClD,qBAAqB,GAAGyB,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;MAC7D,IAAI,CAAC1B,qBAAqB,CAAC2B,GAAG,GAAG,IAAI,CAAC2E,uBAAuB;MAC7D,IAAI,CAACtG,qBAAqB,CAAC4B,KAAK,CAACC,OAAO,GAAG,MAAM;MACjDJ,QAAQ,CAACc,IAAI,CAACC,WAAW,CAAC,IAAI,CAACxC,qBAAqB,CAAC;MACrD;;MAEA+B,MAAM,CAACU,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAACI,wBAAwB,CAAC;IACnE;EAAC;IAAA1G,GAAA;IAAApC,KAAA,WAAAmJ,4BAAA,EAEqC;MACpC,IAAI,CAAC,IAAI,CAAClD,qBAAqB,EAAE;MAEjCyB,QAAQ,CAACc,IAAI,CAACuC,WAAW,CAAC,IAAI,CAAC9E,qBAAqB,CAAC;MACrD;MACA,IAAI,CAACA,qBAAqB,GAAG,IAAI;MACjC+B,MAAM,CAACgD,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAClC,wBAAwB,CAAC;MACpE;MACA,IAAI,CAAC3C,gBAAgB,GAAG,IAAI;IAC9B,CAAC,CAED;EAAA;IAAA/D,GAAA;IAAApC,KAAA,WAAAiK,8BAAA,EACwC;MAAA,IAAAuC,MAAA;MACtC,IAAI,IAAI,CAAC3G,yBAAyB,EAAE;QAClCuB,YAAY,CAAC,IAAI,CAACvB,yBAAyB,CAAC;MAC9C;MACA,IAAM4G,QAAQ,GAAG,IAAI,CAAC5D,KAAK,CAACI,IAAI,CAACyD,KAAK;MACtC,IAAMC,qBAAqB,GAAGF,QAAQ,CAACG,SAAS;MAAC,IACzCC,UAAU,GAAKJ,QAAQ,CAAvBI,UAAU;MAElB,IAAI,CAACF,qBAAqB,IAAI,CAACE,UAAU,EAAE;;MAE3C;MACA,IAAIC,uBAAuB,GACxBC,QAAQ,IAAAC,MAAA,CAAIL,qBAAqB,GAAI,EAAE,CAAC,GAAG,IAAI,GAAI,CAAC;MAEvD,IAAIG,uBAAuB,GAAGG,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGL,UAAU,EAAE;QACrDC,uBAAuB,GAAGD,UAAU,GAAGI,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,IAAI;QACxD,IAAIJ,uBAAuB,GAAG,CAAC,EAAE;MACnC;MAEA,IAAI,CAACjH,yBAAyB,GAAG8C,UAAU,CAAC,YAAM;QAAA,IAAAwE,qBAAA;QAChD,IAAI,CAACX,MAAI,CAAC3D,KAAK,CAACI,IAAI,CAACC,QAAQ,EAAE;QAE/B,IAAI,GAAAiE,qBAAA,GAACX,MAAI,CAAC3D,KAAK,CAACuE,UAAU,cAAAD,qBAAA,uBAArBA,qBAAA,CAAuBE,MAAM,GAAE;UAClCb,MAAI,CAACvC,6BAA6B,CAAC,CAAC;UACpC;QACF;QAEAuC,MAAI,CAACF,4BAA4B,CAAC,CAAC;QACnC;QACAE,MAAI,CAAC3G,yBAAyB,GAAG,IAAI;MACvC,CAAC,EAAEiH,uBAAuB,CAAC;IAC7B;EAAC;IAAA1K,GAAA;IAAAnD,GAAA,WAAAA,IAAA,EA5MU;MACT,OAAO,iBAAiB;IAC1B;EAAC;IAAAmD,GAAA;IAAAnD,GAAA,WAAAA,IAAA,EAEY;MAAA,IAAAqO,sBAAA;MACX,QAAAA,sBAAA,GAAO,IAAI,CAACzE,KAAK,CAAC3D,YAAY,cAAAoI,sBAAA,uBAAvBA,sBAAA,CAAyBC,MAAM;IACxC;EAAC;IAAAnL,GAAA;IAAAnD,GAAA,WAAAA,IAAA,EAEc;MAAA,IAAAuO,sBAAA;MACb;MACA,IAAMD,MAAM,GAAGE,kBAAkB,CAAC,IAAI,CAACF,MAAM,CAAC;MAE9C,IAAM/H,QAAQ,GAAG,IAAIkI,GAAG,EAAAF,sBAAA,GACtB,IAAI,CAAC3E,KAAK,CAAC3D,YAAY,cAAAsI,sBAAA,uBAAvBA,sBAAA,CAAyBhI,QAAQ,EACjCwC,MAAM,CAAC2F,QAAQ,CAACC,IAClB,CAAC,CAACA,IAAI;MAEN,IAAMC,IAAI,GAAGJ,kBAAkB,CAACK,IAAI,CAAC,IAAI,CAAChI,KAAK,CAAC,CAAC;MAEjD,UAAAkH,MAAA,CAAUxH,QAAQ,YAAAwH,MAAA,CAASa,IAAI,cAAAb,MAAA,CAAWO,MAAM;IAClD;EAAC;EAAA,OAAAhJ,eAAA;AAAA,EAtHyDwJ,qBAAS,IAAAvP,WAAA,GAAAwF,yBAAA,CAAAzF,OAAA,CAAA+D,SAAA,sBAwHlE0L,WAAK;EAAAnN,YAAA;EAAAD,UAAA;EAAAE,QAAA;EAAAC,WAAA,WAAAA,YAAA;IAAA,OACY,CAAC;EAAA;AAAA,IAAAiD,yBAAA,CAAAzF,OAAA,CAAA+D,SAAA,yBAElB2L,YAAM,GAAA5O,MAAA,CAAAE,wBAAA,CAAAhB,OAAA,CAAA+D,SAAA,yBAAA/D,OAAA,CAAA+D,SAAA,GAAA0B,yBAAA,CAAAzF,OAAA,CAAA+D,SAAA,oBAKN2L,YAAM,GAAA5O,MAAA,CAAAE,wBAAA,CAAAhB,OAAA,CAAA+D,SAAA,oBAAA/D,OAAA,CAAA+D,SAAA,GAAA0B,yBAAA,CAAAzF,OAAA,CAAA+D,SAAA,iBAuEN4L,sBAAU,GAAA7O,MAAA,CAAAE,wBAAA,CAAAhB,OAAA,CAAA+D,SAAA,iBAAA/D,OAAA,CAAA+D,SAAA,GAAA0B,yBAAA,CAAAzF,OAAA,CAAA+D,SAAA,mBAQV4L,sBAAU,GAAA7O,MAAA,CAAAE,wBAAA,CAAAhB,OAAA,CAAA+D,SAAA,mBAAA/D,OAAA,CAAA+D,SAAA,GAAA0B,yBAAA,CAAAzF,OAAA,CAAA+D,SAAA,oBAeV6L,gBAAO,GAAA9O,MAAA,CAAAE,wBAAA,CAAAhB,OAAA,CAAA+D,SAAA,oBAAA/D,OAAA,CAAA+D,SAAA,IAAA/D,OAAA,MAAAD,MAAA;AAAA8P,OAAA,CAAA7J,eAAA,GAAAA,eAAA","ignoreList":[]}
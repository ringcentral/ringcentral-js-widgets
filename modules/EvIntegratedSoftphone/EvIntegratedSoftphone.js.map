{"version":3,"file":"EvIntegratedSoftphone.js","names":["_di","require","_utils","_core","_utils2","_events","_enums","_enums2","_IncomingModalText","_audios","_i18n","_interopRequireDefault","_runInActivityWebRTCTab","_dec","_dec2","_dec3","_class","_class2","_descriptor","_descriptor2","_descriptor3","_descriptor4","_descriptor5","e","__esModule","_regenerator","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","w","m","defineProperty","_regeneratorDefine","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_initializerDefineProperty","initializer","_classCallCheck","_defineProperties","_toPropertyKey","key","_createClass","_toPrimitive","_typeof","toPrimitive","String","Number","_callSuper","_getPrototypeOf","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","constructor","_assertThisInitialized","ReferenceError","Boolean","valueOf","_inherits","_setPrototypeOf","_applyDecoratedDescriptor","keys","forEach","slice","reverse","reduce","_initializerWarningHelper","Error","SECOND","RECONNECT_DEBOUNCE_TIME","RECONNECT_DEBOUNCE_TIME_WHEN_CONNECTED","SIP_MAX_CONNECTING_TIME","ModalContentRendererID","ModalContentRenderer","_ref","isInbound","inboundTextProps","outboundText","getModalText","EvIntegratedSoftphone","exports","Module","name","deps","dep","optional","runInActivityWebRTCTab","_ref2","_this","enableCache","storageKey","autoAnswerCheckFn","_isFirefox","_audio","_eventEmitter","EventEmitter","_answerModalId","_audioPermissionAlertId","_beforeunloadHandler","isWebRTCTab","_isCloseWhenCallConnected","_failedBlockId","_deps","evAuth","beforeAgentLogout","_resetAllState","beforeunload","onAfterUnload","_sendTabManager","tabManagerEvents","CLOSE_WHEN_CALL_CONNECTED","modalUI","registerRenderer","navigator","userAgent","indexOf","get","_this$_deps$tabManage","tabManager","enable","isMainTab","sipRegisterSuccess","evAgentSession","isIntegratedSoftphone","setConnectingAlertId","id","connectingAlertId","setAudioPermission","permission","audioPermission","resetController","muteActive","setMuteActive","state","resetSip","sipRegistering","setSipRegisterSuccess","setSipRegistering","onInitOnce","_this2","_initAudio","_bindingIntegratedSoftphone","onSetMainTabComplete","_callee","_context","console","log","connectWebRTC","onConfigSuccess","hasMultipleTabs","isConfigTabAlive","onReConfigFail","_emitRegistrationFailed","onReset","error","_closeWebRTCConnectingMask","evClient","sipTerminate","emit","EvSoftphoneEvents","RESET","evSubscription","EvCallbackTypes","SIP_REGISTRATION_FAILED","_onStateChange","_callee2","_context2","ready","_checkTabManagerEvent","onStateChange","_checkTabManagerEvent2","_callee3","event","data","_t","_context3","args","ASK_AUDIO_PERMISSION","SIP_CONNECTING","SIP_RINGING","SIP_RINGING_MODAL","MUTE_STATE_CHANGE","SIP_REGISTERED","SIP_UNREGISTERED","SIP_REGISTRATION_FAILED_RELOAD","SIP_CONNECTED","SIP_ENDED","MUTE","NOTIFY_ACTIVE_TAB_CALL_ACTIVE","_showAskAudioPermissionMask","_closeAskAudioPermissionMask","_showWebRTCConnectingMask","_showRingingModal","close","answerCall","rejectCall","_sipRegistered","_reloadApp","_handleRegistrationFailed","onceLogoutThenLogin","_closeFailReconnectedBlock","_sipConnected","_sipEnded","presence","setDialoutStatus","dialoutStatuses","idle","sipToggleMute","active","alert","warning","message","backdrop","ttl","block","unblock","onRinging","callback","on","_askAudioPermission","_callee4","showMask","_args4","_t2","_context4","undefined","mediaDevices","getUserMedia","audio","danger","AUDIO_STREAM_REJECTED","_registerSoftphone","askAudioPermission","_connectWebRTC","_callee5","_context5","_this3","subscribe","_callee6","_context6","ringingCall","_this3$_deps$evClient","_this3$_deps$evClient2","_this3$_deps$evClient3","bindBeforeunload","_sipAnswer","request","from","queueName","currentCall","queue","_this3$_deps$presence","dialoutStatus","isOffhooking","isManualOffhook","callType","info","removeBeforeunload","SIP_MUTE","SIP_UNMUTE","_closeRingingModal","setOffhook","REGISTERED","_this4","title","content","confirmButtonText","childrenSize","onConfirm","setMainTabId","window","location","reload","_showWebRTCConnectingMask2","_callee7","_t3","_context7","SIP_RECONNECTING_WHEN_CALL_CONNECTED","loading","dismiss","_showAskAudioPermissionMask2","_callee8","_context8","_ref5","_this5","_playAudioLoop","currentLocale","locale","confirm","i18n","getString","contentProps","incomingText","format","queueNameText","cancelButtonText","_onConfirm","_callee9","_context9","onCancel","_answerCall","_callee0","_context0","_resetRingingModal","tabManagerEnabled","showOffHookInitError","sipReject","CALL_REJECTED","_onceRegistered","_callee1","_this6","_resolve","resolveTrue","resolveFalse","success","_t4","_context1","waitUntilTo","once","timeout","off","onceRegistered","_stopAudio","_registerSoftphone2","_callee10","_context10","isReconnected","isForceLogin","sleep","_connectedWebRTC","_connectedWebRTC2","_callee11","_t5","_context11","sipInit","sipRegister","_sipAnswer2","_callee13","_t7","_context13","_callee12","_t6","_context12","sipAnswer","document","createElement","type","loop","_playAudio","currentTime","src","audios","play","pause","_this$_deps$tabManage2","send","add","remove","RcModuleV2","storage","action","getOwnPropertyDescriptor"],"sources":["modules/EvIntegratedSoftphone/EvIntegratedSoftphone.ts"],"sourcesContent":["import { Module } from '@ringcentral-integration/commons/lib/di';\nimport { sleep, waitUntilTo } from '@ringcentral-integration/commons/utils';\nimport {\n  action,\n  RcModuleV2,\n  state,\n  storage,\n} from '@ringcentral-integration/core';\nimport { format } from '@ringcentral-integration/utils';\nimport type { CustomRenderer } from '@ringcentral-integration/widgets/modules/ModalUI/ModalUI.interface';\nimport { EventEmitter } from 'events';\n\nimport {\n  dialoutStatuses,\n  EvSoftphoneEvents,\n  tabManagerEvents,\n} from '../../enums';\nimport type { EvSipRingingData } from '../../lib/EvClient';\nimport { EvCallbackTypes } from '../../lib/EvClient/enums';\n\nimport type {\n  Deps,\n  IntegratedSoftphone,\n  ShowRingingModalProps,\n} from './EvIntegratedSoftphone.interface';\nimport { getModalText } from './IncomingModalText';\nimport { audios } from './audios';\nimport i18n from './i18n';\nimport { runInActivityWebRTCTab } from './runInActivityWebRTCTab.decorator';\n\nconst SECOND = 1000;\nconst RECONNECT_DEBOUNCE_TIME = SECOND * 5;\nconst RECONNECT_DEBOUNCE_TIME_WHEN_CONNECTED = SECOND * 15;\nconst SIP_MAX_CONNECTING_TIME = SECOND * 30;\n\nconst ModalContentRendererID = 'EvIntegratedSoftphone.ModalContentRenderer';\nconst ModalContentRenderer: CustomRenderer = ({\n  isInbound,\n  inboundTextProps,\n  outboundText,\n}) => getModalText({ isInbound, inboundTextProps, outboundText });\n\n@Module({\n  name: 'EvIntegratedSoftphone',\n  deps: [\n    'Locale',\n    'RouterInteraction',\n    'EvAgentSession',\n    'EvSubscription',\n    'Beforeunload',\n    'EvSettings',\n    'EvClient',\n    'Presence',\n    'Storage',\n    'EvAuth',\n    'Block',\n    'Auth',\n    'ModalUI',\n    'Alert',\n    { dep: 'TabManager', optional: true },\n    { dep: 'EvIntegratedSoftphoneOptions', optional: true },\n  ],\n})\nclass EvIntegratedSoftphone\n  extends RcModuleV2<Deps>\n  implements IntegratedSoftphone\n{\n  autoAnswerCheckFn: () => boolean;\n\n  private _isFirefox: boolean;\n\n  private _audio: HTMLAudioElement;\n\n  private _eventEmitter = new EventEmitter();\n\n  private _answerModalId: string = null;\n\n  /** audio permission alert id */\n  private _audioPermissionAlertId: string = null;\n\n  // private _checkWebRTCIntervalId: NodeJS.Timeout;\n\n  // private _heartBeatIntervalTime: number;\n\n  private _beforeunloadHandler = () => this.isWebRTCTab;\n\n  private _isCloseWhenCallConnected = false;\n  private _failedBlockId: string;\n\n  get tabManagerEnabled() {\n    return this._deps.tabManager?.enable;\n  }\n\n  get isWebRTCTab() {\n    return this._deps.tabManager.isMainTab && this.sipRegisterSuccess;\n  }\n\n  get isIntegratedSoftphoneWithTabEnable() {\n    return (\n      this._deps.tabManager.enable &&\n      this._deps.evAgentSession.isIntegratedSoftphone\n    );\n  }\n\n  constructor(deps: Deps) {\n    super({\n      deps,\n      enableCache: true,\n      storageKey: 'EvIntegratedSoftphone',\n    });\n\n    this._deps.evAuth.beforeAgentLogout(() => {\n      this._resetAllState();\n    });\n\n    this._deps.beforeunload.onAfterUnload(() => {\n      this._sendTabManager(tabManagerEvents.CLOSE_WHEN_CALL_CONNECTED);\n    });\n\n    this._deps.modalUI.registerRenderer(\n      ModalContentRendererID,\n      ModalContentRenderer,\n    );\n    this._isFirefox = navigator.userAgent.indexOf('Firefox') !== -1;\n  }\n\n  // @state\n  // dtmfString: string = '';\n\n  @storage\n  @state\n  audioPermission = false;\n\n  @storage\n  @state\n  muteActive = false;\n\n  @state\n  sipRegisterSuccess = false;\n\n  @state\n  sipRegistering = false;\n\n  /** connecting webRTC alert id, for dialer call button disabled check */\n  @state\n  connectingAlertId: string = null;\n\n  // this is for dialPad click when on call\n  // @action\n  // sipSendDTMF(dtmf: string) {\n  // this.dtmfString += dtmf;\n  // this._deps.evClient.sipSendDTMF(dtmf);\n  // }\n\n  @action\n  setConnectingAlertId(id: string) {\n    this.connectingAlertId = id;\n  }\n\n  @action\n  setAudioPermission(permission: boolean) {\n    this.audioPermission = permission;\n  }\n\n  @action\n  resetController() {\n    // this.dtmfString = '';\n    this.muteActive = false;\n  }\n\n  @action\n  setMuteActive(state: boolean) {\n    this.muteActive = state;\n  }\n\n  @action\n  resetSip() {\n    this.audioPermission = false;\n    this.sipRegistering = false;\n    this.sipRegisterSuccess = false;\n  }\n\n  @action\n  setSipRegisterSuccess(state: boolean) {\n    this.sipRegisterSuccess = state;\n  }\n\n  @action\n  setSipRegistering(state: boolean) {\n    this.sipRegistering = state;\n  }\n\n  override onInitOnce() {\n    this._initAudio();\n\n    this._bindingIntegratedSoftphone();\n\n    this._deps.tabManager.onSetMainTabComplete(async () => {\n      console.log(\n        'onSetMainTabComplete~~',\n        this._deps.evAgentSession.isIntegratedSoftphone,\n      );\n      if (this._deps.evAgentSession.isIntegratedSoftphone) {\n        await this.connectWebRTC();\n      }\n    });\n\n    this._deps.evAgentSession.onConfigSuccess(() => {\n      if (\n        this._deps.tabManager.hasMultipleTabs &&\n        !this._deps.tabManager.isMainTab &&\n        this._deps.evAgentSession.isIntegratedSoftphone &&\n        this._deps.evAgentSession.isConfigTabAlive()\n      ) {\n        console.log('setSipRegisterSuccess in onConfigSuccess~~');\n        this.setSipRegisterSuccess(true);\n      }\n    });\n\n    this._deps.evAgentSession.onReConfigFail(() => {\n      if (this._deps.evAgentSession.isIntegratedSoftphone) {\n        this._emitRegistrationFailed();\n      }\n    });\n  }\n\n  override onReset() {\n    try {\n      console.log('onReset in EvIntegratedSoftphone~');\n      this._resetAllState();\n    } catch (error) {\n      // ignore error\n    }\n  }\n\n  private _resetAllState() {\n    this._closeWebRTCConnectingMask();\n    this.resetSip();\n\n    this._deps.evClient.sipTerminate();\n    this._eventEmitter.emit(EvSoftphoneEvents.RESET);\n  }\n\n  private _emitRegistrationFailed() {\n    this._deps.evSubscription.emit(\n      EvCallbackTypes.SIP_REGISTRATION_FAILED,\n      null,\n    );\n  }\n\n  override async onStateChange() {\n    if (\n      this.ready &&\n      this._deps.tabManager.enable &&\n      this._deps.tabManager.ready\n    ) {\n      this._checkTabManagerEvent();\n    }\n  }\n\n  private async _checkTabManagerEvent() {\n    const { event } = this._deps.tabManager;\n    if (event) {\n      const data = event.args[0];\n      switch (event.name) {\n        case tabManagerEvents.ASK_AUDIO_PERMISSION:\n          if (data) {\n            this._showAskAudioPermissionMask();\n          } else {\n            this._closeAskAudioPermissionMask();\n          }\n          break;\n        case tabManagerEvents.SIP_CONNECTING:\n          this._showWebRTCConnectingMask();\n          break;\n        case tabManagerEvents.SIP_RINGING:\n          this._showRingingModal(data);\n          break;\n        case tabManagerEvents.SIP_RINGING_MODAL:\n          // that event call from modal ok or cancel, that auto close modal\n          this._deps.modalUI.close(this._answerModalId);\n          if (data) {\n            await this.answerCall();\n          } else {\n            this.rejectCall();\n          }\n          break;\n        case tabManagerEvents.MUTE_STATE_CHANGE:\n          this.setMuteActive(data);\n          break;\n        case tabManagerEvents.SIP_REGISTERED:\n          console.log('_sipRegistered in other tabs~');\n          this._sipRegistered();\n          break;\n        case tabManagerEvents.SIP_UNREGISTERED:\n          this.setSipRegisterSuccess(false);\n          break;\n        case tabManagerEvents.SIP_REGISTRATION_FAILED_RELOAD:\n          this._reloadApp();\n          break;\n        case tabManagerEvents.SIP_REGISTRATION_FAILED:\n          this._handleRegistrationFailed();\n          await this._deps.evAgentSession.onceLogoutThenLogin();\n          this._closeFailReconnectedBlock();\n          break;\n        case tabManagerEvents.SIP_CONNECTED:\n          this._sipConnected();\n          break;\n        case tabManagerEvents.SIP_ENDED:\n          this._sipEnded();\n          // When sip end need reset Dialout Status to idle\n          this._deps.presence.setDialoutStatus(dialoutStatuses.idle);\n          break;\n        case tabManagerEvents.MUTE:\n          this.sipToggleMute(data);\n          break;\n        case tabManagerEvents.CLOSE_WHEN_CALL_CONNECTED:\n          this._isCloseWhenCallConnected = true;\n          break;\n        case tabManagerEvents.NOTIFY_ACTIVE_TAB_CALL_ACTIVE:\n          if (this._deps.tabManager.active) {\n            this._deps.alert.warning({\n              message: tabManagerEvents.NOTIFY_ACTIVE_TAB_CALL_ACTIVE,\n              backdrop: true,\n              ttl: 0,\n            });\n          }\n          break;\n        default:\n          break;\n      }\n    }\n  }\n\n  private _closeFailReconnectedBlock() {\n    this._deps.block.unblock(this._failedBlockId);\n    this._failedBlockId = null;\n  }\n\n  sipToggleMute(state: boolean) {\n    this._deps.evClient.sipToggleMute(state);\n  }\n\n  onRinging(callback: (call?: EvSipRingingData) => void) {\n    this._eventEmitter.on(EvCallbackTypes.SIP_RINGING, callback);\n  }\n\n  async askAudioPermission(showMask = true) {\n    console.log('askAudioPermission~~', showMask);\n    try {\n      if (showMask) {\n        if (!this.audioPermission) {\n          this._sendTabManager(tabManagerEvents.ASK_AUDIO_PERMISSION, true);\n          this._showAskAudioPermissionMask();\n        }\n\n        console.log('connect WEB_RTC');\n        await navigator.mediaDevices.getUserMedia({\n          audio: true,\n        });\n      }\n    } catch (error) {\n      this._deps.alert.danger({\n        message: EvSoftphoneEvents.AUDIO_STREAM_REJECTED,\n        backdrop: true,\n        ttl: 0,\n      });\n      console.log(error);\n      throw new Error('Need Audio permission');\n    } finally {\n      if (showMask) {\n        if (this._audioPermissionAlertId) {\n          this._sendTabManager(tabManagerEvents.ASK_AUDIO_PERMISSION, false);\n          this._closeAskAudioPermissionMask();\n        }\n      }\n    }\n\n    this.setAudioPermission(true);\n    if (!this.sipRegisterSuccess) {\n      await this._registerSoftphone();\n    }\n  }\n\n  private async connectWebRTC() {\n    console.log('connectWebRTC~');\n\n    this.resetSip();\n    await this.askAudioPermission();\n  }\n\n  private _bindingIntegratedSoftphone() {\n    console.log('_bindingIntegratedSoftphone~~');\n    this._deps.evSubscription.subscribe(EvCallbackTypes.SIP_REGISTERED, () => {\n      // That will call several times when reconnected.\n      console.log('!!!!!!!SIP_REGISTERED');\n      if (!this.sipRegisterSuccess) {\n        this._sendTabManager(tabManagerEvents.SIP_REGISTERED);\n        this._sipRegistered();\n      }\n    });\n\n    this._deps.evSubscription.subscribe(\n      EvCallbackTypes.SIP_UNREGISTERED,\n      () => {\n        console.log('!!!!!!!SIP_UNREGISTERED');\n        if (this.sipRegisterSuccess) {\n          this._sendTabManager(tabManagerEvents.SIP_UNREGISTERED);\n          this.setSipRegisterSuccess(false);\n        }\n      },\n    );\n\n    this._deps.evSubscription.subscribe(\n      EvCallbackTypes.SIP_REGISTRATION_FAILED,\n      async () => {\n        console.log('!!!!!!!SIP_REGISTRATION_FAILED');\n        this.setSipRegistering(false);\n\n        this._sendTabManager(tabManagerEvents.SIP_REGISTRATION_FAILED);\n        this._handleRegistrationFailed();\n\n        // await this._deps.evAgentSession.reLoginAgent();\n        // this._closeFailReconnectedBlock();\n      },\n    );\n\n    this._deps.evSubscription.subscribe(\n      EvCallbackTypes.SIP_RINGING,\n      (ringingCall) => {\n        this.bindBeforeunload();\n        console.log('!!!!!!!SIP_RINGING');\n        this._eventEmitter.emit(EvCallbackTypes.SIP_RINGING, ringingCall);\n\n        if (this.autoAnswerCheckFn()) {\n          return this._sipAnswer();\n        }\n\n        const { displayName } = ringingCall.data.request.from;\n        const queueName = this._deps.evClient.currentCall?.queue?.name;\n        const { dialoutStatus, isOffhooking, isManualOffhook } =\n          this._deps.presence;\n        // exclude outbound and offhook\n        const isInbound =\n          dialoutStatus !== 'dialing' &&\n          !(isManualOffhook && isOffhooking) &&\n          this._deps.evClient.currentCall?.callType === 'INBOUND';\n\n        this._sendTabManager(tabManagerEvents.SIP_RINGING, {\n          displayName,\n          queueName,\n          isInbound,\n        });\n        this._showRingingModal({ displayName, queueName, isInbound });\n      },\n    );\n\n    this._deps.evSubscription.subscribe(EvCallbackTypes.SIP_CONNECTED, () => {\n      console.info('!!!!!!!SIP_CONNECTED');\n      this._sendTabManager(tabManagerEvents.SIP_CONNECTED);\n      this._sipConnected();\n    });\n\n    this._deps.evSubscription.subscribe(EvCallbackTypes.SIP_ENDED, () => {\n      console.info('!!!!!!!SIP_ENDED');\n      this.removeBeforeunload();\n\n      this._sendTabManager(tabManagerEvents.SIP_ENDED);\n      this._sipEnded();\n    });\n\n    this._deps.evSubscription.subscribe(EvCallbackTypes.SIP_MUTE, () => {\n      console.info('!!!!!!!SIP_MUTE');\n      this._sendTabManager(tabManagerEvents.MUTE_STATE_CHANGE, true);\n      this.setMuteActive(true);\n    });\n\n    this._deps.evSubscription.subscribe(EvCallbackTypes.SIP_UNMUTE, () => {\n      console.info('!!!!!!!SIP_UNMUTE');\n      this._sendTabManager(tabManagerEvents.MUTE_STATE_CHANGE, false);\n      this.setMuteActive(false);\n    });\n\n    // TODO: that is update session config related feature\n    // triggered by agentSDK if dial destination is changed on softphone registration\n    // pass in autoStartOH, maintainOH and dial destination, needed for reconnect logic\n    // this._deps.evSubscription.subscribe(\n    // EvCallbackTypes.SIP_DIAL_DEST_CHANGED,\n    // (data) => {\n    // console.info('!!!!!!!SIP_DIAL_DEST_CHANGED');\n    // // AgentSvc.setDialDest(data.dialDest),\n    // // SessionSvc.attemptingSoftphoneReconnect &&\n    // // (data.autoStartOH\n    // // ? AgentSvc.offhookInit().then(\n    // // function(result) {\n    // // data.maintainOH && (AgentSvc.systemInitOffhook = !1);\n    // // },\n    // // function(err) {\n    // // SessionSvc.showOffhookError(err.detail, data.maintainOH);\n    // // },\n    // // )\n    // // : ($timeout(function() {\n    // // 'RNA-STATE' === AgentSvc.currentAgentState.baseState &&\n    // // AgentSvc.setAgentState('AVAILABLE');\n    // // }, 1e3),\n    // // (SessionSvc.attemptingSoftphoneReconnect = !1),\n    // // (SessionSvc.manualSoftphoneReconnect = !1)));\n    // },\n    // );\n  }\n\n  private _sipEnded() {\n    this._closeRingingModal();\n    this._deps.presence.setOffhook(false);\n  }\n\n  private _sipRegistered() {\n    console.log('_sipRegistered~');\n    this.setSipRegisterSuccess(true);\n    this._eventEmitter.emit(EvSoftphoneEvents.REGISTERED);\n\n    this._isCloseWhenCallConnected = false;\n    this._closeWebRTCConnectingMask();\n  }\n\n  private _handleRegistrationFailed() {\n    this._failedBlockId = this._deps.block.block();\n    this._deps.evClient.sipTerminate();\n\n    this._resetAllState();\n    this._closeWebRTCConnectingMask();\n    // this._deps.alert.danger({\n    //   message: EvCallbackTypes.SIP_REGISTRATION_FAILED,\n    //   backdrop: true,\n    //   ttl: 0,\n    //   allowDuplicates: false,\n    // });\n\n    this._deps.modalUI.alert({\n      title: 'Registration failed',\n      content: 'Will reload your pages and tabs for you',\n      confirmButtonText: 'Ok',\n      childrenSize: 'small',\n      onConfirm: () => {\n        this._sendTabManager(tabManagerEvents.SIP_REGISTRATION_FAILED_RELOAD);\n        this._reloadApp();\n      },\n    });\n\n    this._deps.tabManager.setMainTabId(null);\n    // this._deps.routerInteraction.push('/sessionConfig');\n  }\n\n  private _reloadApp() {\n    window.location.reload();\n  }\n\n  private _sipConnected() {\n    this._deps.presence.setOffhook(true);\n    // When connected reset all controller state\n    this.resetController();\n  }\n\n  private async _showWebRTCConnectingMask() {\n    this._closeWebRTCConnectingMask();\n    this.setConnectingAlertId(\n      await this._deps.alert.info({\n        message: this._isCloseWhenCallConnected\n          ? tabManagerEvents.SIP_RECONNECTING_WHEN_CALL_CONNECTED\n          : tabManagerEvents.SIP_CONNECTING,\n        loading: true,\n      }),\n    );\n  }\n\n  private _closeWebRTCConnectingMask() {\n    console.log('_closeWebRTCConnectingMask~~', this.connectingAlertId);\n    if (this.connectingAlertId) {\n      this._deps.alert.dismiss(this.connectingAlertId);\n\n      this.setConnectingAlertId(null);\n    }\n  }\n\n  private async _showAskAudioPermissionMask() {\n    this._closeAskAudioPermissionMask();\n    this._audioPermissionAlertId = await this._deps.alert.info({\n      message: tabManagerEvents.ASK_AUDIO_PERMISSION,\n      loading: true,\n      backdrop: true,\n    });\n  }\n\n  private _closeAskAudioPermissionMask() {\n    if (this._audioPermissionAlertId) {\n      this._deps.alert.dismiss(this._audioPermissionAlertId);\n      this._audioPermissionAlertId = null;\n    }\n  }\n\n  private _showRingingModal({\n    displayName,\n    queueName,\n    isInbound,\n  }: ShowRingingModalProps) {\n    // prevent open a lot of modal, that sdk event pass a lot of ringing state when re login\n    if (this._answerModalId) {\n      return;\n    }\n\n    this._playAudioLoop('ringtone');\n\n    const { currentLocale } = this._deps.locale;\n\n    this._answerModalId = this._deps.modalUI.confirm({\n      title: i18n.getString('inviteModalTitle', currentLocale),\n      content: ModalContentRendererID,\n      contentProps: {\n        isInbound,\n        inboundTextProps: queueName && {\n          incomingText: format(i18n.getString('incomingText', currentLocale), {\n            displayName,\n          }),\n          queueNameText: format(\n            i18n.getString('queueNameText', currentLocale),\n            {\n              queueName,\n            },\n          ),\n        },\n        outboundText: format(i18n.getString('outboundText', currentLocale), {\n          displayName,\n        }),\n      },\n      confirmButtonText: i18n.getString('inviteModalAnswer', currentLocale),\n      cancelButtonText: i18n.getString('inviteModalReject', currentLocale),\n      onConfirm: async () => {\n        this._sendTabManager(tabManagerEvents.SIP_RINGING_MODAL, true);\n        await this.answerCall();\n      },\n      onCancel: () => {\n        this._sendTabManager(tabManagerEvents.SIP_RINGING_MODAL, false);\n        this.rejectCall();\n      },\n      childrenSize: 'small',\n    });\n  }\n\n  private async answerCall() {\n    this._resetRingingModal();\n    if (\n      !this.tabManagerEnabled ||\n      (this.tabManagerEnabled && this._deps.tabManager.isMainTab)\n    ) {\n      await this._sipAnswer();\n    }\n  }\n\n  private rejectCall() {\n    this._resetRingingModal();\n    // when reject not show init fail\n    this._deps.presence.showOffHookInitError = false;\n    this._deps.evClient.sipReject();\n    this._eventEmitter.emit(EvSoftphoneEvents.CALL_REJECTED);\n    this.removeBeforeunload();\n  }\n\n  async onceRegistered() {\n    let _resolve: (value: boolean) => void;\n    const resolveTrue = () => _resolve(true);\n    const resolveFalse = () => _resolve(false);\n\n    try {\n      const success = await waitUntilTo(\n        () => {\n          return new Promise<boolean>((resolve) => {\n            _resolve = resolve;\n\n            this._eventEmitter.once(EvSoftphoneEvents.REGISTERED, resolveTrue);\n            // when reset sip also need reject that\n            this._eventEmitter.once(EvSoftphoneEvents.RESET, resolveFalse);\n          });\n        },\n        {\n          timeout: SIP_MAX_CONNECTING_TIME,\n        },\n      );\n\n      if (!success) {\n        this._emitRegistrationFailed();\n      }\n    } catch (error) {\n      this._emitRegistrationFailed();\n    }\n\n    this._eventEmitter.off(EvSoftphoneEvents.REGISTERED, resolveTrue);\n    this._eventEmitter.off(EvSoftphoneEvents.RESET, resolveFalse);\n  }\n\n  private _closeRingingModal() {\n    // if there is modal there, mean another cancel this call\n    if (this._answerModalId) {\n      this._deps.alert.info({\n        message: EvSoftphoneEvents.CALL_REJECTED,\n        ttl: 0,\n      });\n      this._deps.modalUI.close(this._answerModalId);\n      this._answerModalId = null;\n      this._stopAudio();\n    }\n  }\n\n  private async _registerSoftphone() {\n    if (!this.sipRegistering) {\n      this.setSipRegistering(true);\n\n      this._sendTabManager(tabManagerEvents.SIP_CONNECTING);\n      this._showWebRTCConnectingMask();\n\n      console.log(\n        'isReconnected, isForceLogin, _isCloseWhenCallConnected~',\n        this._deps.evAgentSession.isReconnected,\n        this._deps.evAgentSession.isForceLogin,\n        this._isCloseWhenCallConnected,\n      );\n\n      // When that is force login is also need delay to reconnect server\n      if (\n        this._deps.evAgentSession.isReconnected ||\n        this._deps.evAgentSession.isForceLogin\n      ) {\n        await sleep(\n          this._isCloseWhenCallConnected\n            ? RECONNECT_DEBOUNCE_TIME_WHEN_CONNECTED\n            : RECONNECT_DEBOUNCE_TIME,\n        );\n        await this._connectedWebRTC();\n      } else {\n        await this._connectedWebRTC();\n      }\n      return;\n    }\n\n    throw new Error('Sip is registering');\n  }\n\n  private async _connectedWebRTC() {\n    try {\n      this._deps.evClient.sipInit();\n      this._deps.evClient.sipRegister();\n\n      await this.onceRegistered();\n\n      this.setSipRegistering(false);\n      this._closeWebRTCConnectingMask();\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  private _resetRingingModal() {\n    this._stopAudio();\n    this._answerModalId = null;\n  }\n\n  private async _sipAnswer() {\n    if (this._isFirefox) {\n      try {\n        await waitUntilTo(\n          async () => {\n            try {\n              await navigator.mediaDevices.getUserMedia({\n                audio: true,\n              });\n            } catch (error) {\n              // ignore\n            }\n          },\n          {\n            timeout: 2000,\n          },\n        );\n      } catch (error) {\n        this._sendTabManager(tabManagerEvents.NOTIFY_ACTIVE_TAB_CALL_ACTIVE);\n        // eslint-disable-next-line no-alert\n        window.confirm(\n          i18n.getString('activeCallTip', this._deps.locale.currentLocale),\n        );\n      }\n    }\n    this._deps.evClient.sipAnswer();\n  }\n\n  private _initAudio() {\n    if (typeof document !== 'undefined' && document.createElement) {\n      this._audio = document.createElement('audio');\n    }\n  }\n\n  private _playAudioLoop(type: keyof typeof audios) {\n    this._audio.loop = true;\n    this._playAudio(type);\n  }\n\n  @runInActivityWebRTCTab()\n  private _playAudio(type: keyof typeof audios) {\n    this._audio.currentTime = 0;\n    this._audio.src = audios[type];\n    this._audio.play();\n  }\n\n  @runInActivityWebRTCTab()\n  private _stopAudio() {\n    this._audio.loop = false;\n    this._audio.pause();\n  }\n\n  private _sendTabManager(event: string, value?: any) {\n    this._deps.tabManager?.send(event, value);\n  }\n\n  bindBeforeunload() {\n    this._deps.beforeunload.add(this._beforeunloadHandler);\n  }\n\n  removeBeforeunload() {\n    this._deps.beforeunload.remove(this._beforeunloadHandler);\n  }\n}\n\nexport { EvIntegratedSoftphone };\n"],"mappings":"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","ignoreList":[]}
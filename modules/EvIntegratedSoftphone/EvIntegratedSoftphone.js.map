{"version":3,"file":"EvIntegratedSoftphone.js","names":["_events","require","_di","_utils","_core","_utils2","_enums","_enums2","_audios","_i18n","_interopRequireDefault","_IncomingModalText","_runInActivityWebRTCTab","_dec","_dec2","_dec3","_class","_class2","_descriptor","_descriptor2","_descriptor3","_descriptor4","_descriptor5","obj","__esModule","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","args","arguments","apply","err","undefined","_initializerDefineProperty","target","property","descriptor","context","Object","defineProperty","enumerable","configurable","writable","initializer","call","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","i","length","_toPropertyKey","_createClass","protoProps","staticProps","prototype","_toPrimitive","_typeof","String","input","hint","prim","Symbol","toPrimitive","res","Number","_inherits","subClass","superClass","create","constructor","_setPrototypeOf","o","p","setPrototypeOf","bind","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","_possibleConstructorReturn","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","_applyDecoratedDescriptor","decorators","desc","keys","forEach","slice","reverse","reduce","decorator","_initializerWarningHelper","Error","SECOND","RECONNECT_DEBOUNCE_TIME","RECONNECT_DEBOUNCE_TIME_WHEN_CONNECTED","SIP_MAX_CONNECTING_TIME","ModalContentRendererID","ModalContentRenderer","_ref","isInbound","inboundTextProps","outboundText","getModalText","EvIntegratedSoftphone","Module","name","deps","dep","optional","runInActivityWebRTCTab","_ref2","_super","get","_this$_deps$tabManage","_deps","tabManager","enable","isMainTab","sipRegisterSuccess","evAgentSession","isIntegratedSoftphone","_this","enableCache","storageKey","autoAnswerCheckFn","_isFirefox","_audio","_eventEmitter","EventEmitter","_answerModalId","_audioPermissionAlertId","_beforeunloadHandler","isWebRTCTab","_isCloseWhenCallConnected","_failedBlockId","evAuth","beforeAgentLogout","_resetAllState","beforeunload","onAfterUnload","_sendTabManager","tabManagerEvents","CLOSE_WHEN_CALL_CONNECTED","modalUI","registerRenderer","navigator","userAgent","indexOf","setConnectingAlertId","id","connectingAlertId","setAudioPermission","permission","audioPermission","resetController","muteActive","setMuteActive","state","resetSip","sipRegistering","setSipRegisterSuccess","setSipRegistering","onInitOnce","_this2","_initAudio","_bindingIntegratedSoftphone","onSetMainTabComplete","regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","console","log","connectWebRTC","stop","onConfigSuccess","hasMultipleTabs","isConfigTabAlive","onReConfigFail","_emitRegistrationFailed","onReset","_closeWebRTCConnectingMask","evClient","sipTerminate","emit","EvSoftphoneEvents","RESET","evSubscription","EvCallbackTypes","SIP_REGISTRATION_FAILED","_onStateChange","_callee2","_callee2$","_context2","ready","_checkTabManagerEvent","onStateChange","_checkTabManagerEvent2","_callee3","event","data","_callee3$","_context3","t0","ASK_AUDIO_PERMISSION","SIP_CONNECTING","SIP_RINGING","SIP_RINGING_MODAL","MUTE_STATE_CHANGE","SIP_REGISTERED","SIP_UNREGISTERED","SIP_REGISTRATION_FAILED_RELOAD","SIP_CONNECTED","SIP_ENDED","MUTE","NOTIFY_ACTIVE_TAB_CALL_ACTIVE","_showAskAudioPermissionMask","_closeAskAudioPermissionMask","abrupt","_showWebRTCConnectingMask","_showRingingModal","close","answerCall","rejectCall","_sipRegistered","_reloadApp","_handleRegistrationFailed","onceLogoutThenLogin","_closeFailReconnectedBlock","_sipConnected","_sipEnded","presence","setDialoutStatus","dialoutStatuses","idle","sipToggleMute","active","alert","warning","message","backdrop","ttl","block","unblock","onRinging","callback","on","_askAudioPermission","_callee4","showMask","_args4","_callee4$","_context4","mediaDevices","getUserMedia","audio","danger","AUDIO_STREAM_REJECTED","finish","_registerSoftphone","askAudioPermission","_connectWebRTC","_callee5","_callee5$","_context5","_this3","subscribe","_callee6","_callee6$","_context6","ringingCall","_this3$_deps$evClient","_this3$_deps$evClient2","_this3$_deps$evClient3","bindBeforeunload","_sipAnswer","displayName","request","from","queueName","currentCall","queue","_this3$_deps$presence","dialoutStatus","isOffhooking","isManualOffhook","callType","removeBeforeunload","SIP_MUTE","SIP_UNMUTE","_closeRingingModal","setOffhook","REGISTERED","_this4","title","content","confirmButtonText","childrenSize","onConfirm","setMainTabId","window","location","reload","_showWebRTCConnectingMask2","_callee7","_callee7$","_context7","SIP_RECONNECTING_WHEN_CALL_CONNECTED","loading","t1","sent","dismiss","_showAskAudioPermissionMask2","_callee8","_callee8$","_context8","_ref5","_this5","_playAudioLoop","currentLocale","locale","confirm","i18n","getString","contentProps","incomingText","format","queueNameText","cancelButtonText","_onConfirm","_callee9","_callee9$","_context9","onCancel","_answerCall","_callee10","_callee10$","_context10","_resetRingingModal","tabManagerEnabled","showOffHookInitError","sipReject","CALL_REJECTED","_onceRegistered","_callee11","_this6","_resolve","resolveTrue","resolveFalse","success","_callee11$","_context11","waitUntilTo","once","timeout","off","onceRegistered","_stopAudio","_registerSoftphone2","_callee12","_callee12$","_context12","isReconnected","isForceLogin","sleep","_connectedWebRTC","_connectedWebRTC2","_callee13","_callee13$","_context13","sipInit","sipRegister","_sipAnswer2","_callee15","_callee15$","_context15","_callee14","_callee14$","_context14","sipAnswer","document","createElement","type","loop","_playAudio","currentTime","src","audios","play","pause","_this$_deps$tabManage2","send","add","remove","RcModuleV2","storage","action","getOwnPropertyDescriptor","exports"],"sources":["modules/EvIntegratedSoftphone/EvIntegratedSoftphone.ts"],"sourcesContent":["import { EventEmitter } from 'events';\n\nimport { Module } from '@ringcentral-integration/commons/lib/di';\nimport { sleep, waitUntilTo } from '@ringcentral-integration/commons/utils';\nimport {\n  action,\n  RcModuleV2,\n  state,\n  storage,\n} from '@ringcentral-integration/core';\nimport { format } from '@ringcentral-integration/utils';\nimport type { CustomRenderer } from '@ringcentral-integration/widgets/modules/ModalUI/ModalUI.interface';\n\nimport {\n  dialoutStatuses,\n  EvSoftphoneEvents,\n  tabManagerEvents,\n} from '../../enums';\nimport type { EvSipRingingData } from '../../lib/EvClient';\nimport { EvCallbackTypes } from '../../lib/EvClient/enums';\nimport { audios } from './audios';\nimport type {\n  Deps,\n  IntegratedSoftphone,\n  ShowRingingModalProps,\n} from './EvIntegratedSoftphone.interface';\nimport i18n from './i18n';\nimport { getModalText } from './IncomingModalText';\nimport { runInActivityWebRTCTab } from './runInActivityWebRTCTab.decorator';\n\nconst SECOND = 1000;\nconst RECONNECT_DEBOUNCE_TIME = SECOND * 5;\nconst RECONNECT_DEBOUNCE_TIME_WHEN_CONNECTED = SECOND * 15;\nconst SIP_MAX_CONNECTING_TIME = SECOND * 30;\n\nconst ModalContentRendererID = 'EvIntegratedSoftphone.ModalContentRenderer';\nconst ModalContentRenderer: CustomRenderer = ({\n  isInbound,\n  inboundTextProps,\n  outboundText,\n}) => getModalText({ isInbound, inboundTextProps, outboundText });\n\n@Module({\n  name: 'EvIntegratedSoftphone',\n  deps: [\n    'Locale',\n    'RouterInteraction',\n    'EvAgentSession',\n    'EvSubscription',\n    'Beforeunload',\n    'EvSettings',\n    'EvClient',\n    'Presence',\n    'Storage',\n    'EvAuth',\n    'Block',\n    'Auth',\n    'ModalUI',\n    'Alert',\n    { dep: 'TabManager', optional: true },\n    { dep: 'EvIntegratedSoftphoneOptions', optional: true },\n  ],\n})\nclass EvIntegratedSoftphone\n  extends RcModuleV2<Deps>\n  implements IntegratedSoftphone\n{\n  autoAnswerCheckFn: () => boolean;\n\n  private _isFirefox: boolean;\n\n  private _audio: HTMLAudioElement;\n\n  private _eventEmitter = new EventEmitter();\n\n  private _answerModalId: string = null;\n\n  /** audio permission alert id */\n  private _audioPermissionAlertId: string = null;\n\n  // private _checkWebRTCIntervalId: NodeJS.Timeout;\n\n  // private _heartBeatIntervalTime: number;\n\n  private _beforeunloadHandler = () => this.isWebRTCTab;\n\n  private _isCloseWhenCallConnected = false;\n  private _failedBlockId: string;\n\n  get tabManagerEnabled() {\n    return this._deps.tabManager?.enable;\n  }\n\n  get isWebRTCTab() {\n    return this._deps.tabManager.isMainTab && this.sipRegisterSuccess;\n  }\n\n  get isIntegratedSoftphoneWithTabEnable() {\n    return (\n      this._deps.tabManager.enable &&\n      this._deps.evAgentSession.isIntegratedSoftphone\n    );\n  }\n\n  constructor(deps: Deps) {\n    super({\n      deps,\n      enableCache: true,\n      storageKey: 'EvIntegratedSoftphone',\n    });\n\n    this._deps.evAuth.beforeAgentLogout(() => {\n      this._resetAllState();\n    });\n\n    this._deps.beforeunload.onAfterUnload(() => {\n      this._sendTabManager(tabManagerEvents.CLOSE_WHEN_CALL_CONNECTED);\n    });\n\n    this._deps.modalUI.registerRenderer(\n      ModalContentRendererID,\n      ModalContentRenderer,\n    );\n    this._isFirefox = navigator.userAgent.indexOf('Firefox') !== -1;\n  }\n\n  // @state\n  // dtmfString: string = '';\n\n  @storage\n  @state\n  audioPermission = false;\n\n  @storage\n  @state\n  muteActive = false;\n\n  @state\n  sipRegisterSuccess = false;\n\n  @state\n  sipRegistering = false;\n\n  /** connecting webRTC alert id, for dialer call button disabled check */\n  @state\n  connectingAlertId: string = null;\n\n  // this is for dialPad click when on call\n  // @action\n  // sipSendDTMF(dtmf: string) {\n  // this.dtmfString += dtmf;\n  // this._deps.evClient.sipSendDTMF(dtmf);\n  // }\n\n  @action\n  setConnectingAlertId(id: string) {\n    this.connectingAlertId = id;\n  }\n\n  @action\n  setAudioPermission(permission: boolean) {\n    this.audioPermission = permission;\n  }\n\n  @action\n  resetController() {\n    // this.dtmfString = '';\n    this.muteActive = false;\n  }\n\n  @action\n  setMuteActive(state: boolean) {\n    this.muteActive = state;\n  }\n\n  @action\n  resetSip() {\n    this.audioPermission = false;\n    this.sipRegistering = false;\n    this.sipRegisterSuccess = false;\n  }\n\n  @action\n  setSipRegisterSuccess(state: boolean) {\n    this.sipRegisterSuccess = state;\n  }\n\n  @action\n  setSipRegistering(state: boolean) {\n    this.sipRegistering = state;\n  }\n\n  override onInitOnce() {\n    this._initAudio();\n\n    this._bindingIntegratedSoftphone();\n\n    this._deps.tabManager.onSetMainTabComplete(async () => {\n      console.log(\n        'onSetMainTabComplete~~',\n        this._deps.evAgentSession.isIntegratedSoftphone,\n      );\n      if (this._deps.evAgentSession.isIntegratedSoftphone) {\n        await this.connectWebRTC();\n      }\n    });\n\n    this._deps.evAgentSession.onConfigSuccess(() => {\n      if (\n        this._deps.tabManager.hasMultipleTabs &&\n        !this._deps.tabManager.isMainTab &&\n        this._deps.evAgentSession.isIntegratedSoftphone &&\n        this._deps.evAgentSession.isConfigTabAlive()\n      ) {\n        console.log('setSipRegisterSuccess in onConfigSuccess~~');\n        this.setSipRegisterSuccess(true);\n      }\n    });\n\n    this._deps.evAgentSession.onReConfigFail(() => {\n      if (this._deps.evAgentSession.isIntegratedSoftphone) {\n        this._emitRegistrationFailed();\n      }\n    });\n  }\n\n  override onReset() {\n    try {\n      console.log('onReset in EvIntegratedSoftphone~');\n      this._resetAllState();\n    } catch (error) {\n      // ignore error\n    }\n  }\n\n  private _resetAllState() {\n    this._closeWebRTCConnectingMask();\n    this.resetSip();\n\n    this._deps.evClient.sipTerminate();\n    this._eventEmitter.emit(EvSoftphoneEvents.RESET);\n  }\n\n  private _emitRegistrationFailed() {\n    this._deps.evSubscription.emit(\n      EvCallbackTypes.SIP_REGISTRATION_FAILED,\n      null,\n    );\n  }\n\n  override async onStateChange() {\n    if (\n      this.ready &&\n      this._deps.tabManager.enable &&\n      this._deps.tabManager.ready\n    ) {\n      this._checkTabManagerEvent();\n    }\n  }\n\n  private async _checkTabManagerEvent() {\n    const { event } = this._deps.tabManager;\n    if (event) {\n      const data = event.args[0];\n      switch (event.name) {\n        case tabManagerEvents.ASK_AUDIO_PERMISSION:\n          if (data) {\n            this._showAskAudioPermissionMask();\n          } else {\n            this._closeAskAudioPermissionMask();\n          }\n          break;\n        case tabManagerEvents.SIP_CONNECTING:\n          this._showWebRTCConnectingMask();\n          break;\n        case tabManagerEvents.SIP_RINGING:\n          this._showRingingModal(data);\n          break;\n        case tabManagerEvents.SIP_RINGING_MODAL:\n          // that event call from modal ok or cancel, that auto close modal\n          this._deps.modalUI.close(this._answerModalId);\n          if (data) {\n            await this.answerCall();\n          } else {\n            this.rejectCall();\n          }\n          break;\n        case tabManagerEvents.MUTE_STATE_CHANGE:\n          this.setMuteActive(data);\n          break;\n        case tabManagerEvents.SIP_REGISTERED:\n          console.log('_sipRegistered in other tabs~');\n          this._sipRegistered();\n          break;\n        case tabManagerEvents.SIP_UNREGISTERED:\n          this.setSipRegisterSuccess(false);\n          break;\n        case tabManagerEvents.SIP_REGISTRATION_FAILED_RELOAD:\n          this._reloadApp();\n          break;\n        case tabManagerEvents.SIP_REGISTRATION_FAILED:\n          this._handleRegistrationFailed();\n          await this._deps.evAgentSession.onceLogoutThenLogin();\n          this._closeFailReconnectedBlock();\n          break;\n        case tabManagerEvents.SIP_CONNECTED:\n          this._sipConnected();\n          break;\n        case tabManagerEvents.SIP_ENDED:\n          this._sipEnded();\n          // When sip end need reset Dialout Status to idle\n          this._deps.presence.setDialoutStatus(dialoutStatuses.idle);\n          break;\n        case tabManagerEvents.MUTE:\n          this.sipToggleMute(data);\n          break;\n        case tabManagerEvents.CLOSE_WHEN_CALL_CONNECTED:\n          this._isCloseWhenCallConnected = true;\n          break;\n        case tabManagerEvents.NOTIFY_ACTIVE_TAB_CALL_ACTIVE:\n          if (this._deps.tabManager.active) {\n            this._deps.alert.warning({\n              message: tabManagerEvents.NOTIFY_ACTIVE_TAB_CALL_ACTIVE,\n              backdrop: true,\n              ttl: 0,\n            });\n          }\n          break;\n        default:\n          break;\n      }\n    }\n  }\n\n  private _closeFailReconnectedBlock() {\n    this._deps.block.unblock(this._failedBlockId);\n    this._failedBlockId = null;\n  }\n\n  sipToggleMute(state: boolean) {\n    this._deps.evClient.sipToggleMute(state);\n  }\n\n  onRinging(callback: (call?: EvSipRingingData) => void) {\n    this._eventEmitter.on(EvCallbackTypes.SIP_RINGING, callback);\n  }\n\n  async askAudioPermission(showMask = true) {\n    console.log('askAudioPermission~~', showMask);\n    try {\n      if (showMask) {\n        if (!this.audioPermission) {\n          this._sendTabManager(tabManagerEvents.ASK_AUDIO_PERMISSION, true);\n          this._showAskAudioPermissionMask();\n        }\n\n        console.log('connect WEB_RTC');\n        await navigator.mediaDevices.getUserMedia({\n          audio: true,\n        });\n      }\n    } catch (error) {\n      this._deps.alert.danger({\n        message: EvSoftphoneEvents.AUDIO_STREAM_REJECTED,\n        backdrop: true,\n        ttl: 0,\n      });\n      console.log(error);\n      throw new Error('Need Audio permission');\n    } finally {\n      if (showMask) {\n        if (this._audioPermissionAlertId) {\n          this._sendTabManager(tabManagerEvents.ASK_AUDIO_PERMISSION, false);\n          this._closeAskAudioPermissionMask();\n        }\n      }\n    }\n\n    this.setAudioPermission(true);\n    if (!this.sipRegisterSuccess) {\n      await this._registerSoftphone();\n    }\n  }\n\n  private async connectWebRTC() {\n    console.log('connectWebRTC~');\n\n    this.resetSip();\n    await this.askAudioPermission();\n  }\n\n  private _bindingIntegratedSoftphone() {\n    console.log('_bindingIntegratedSoftphone~~');\n    this._deps.evSubscription.subscribe(EvCallbackTypes.SIP_REGISTERED, () => {\n      // That will call several times when reconnected.\n      console.log('!!!!!!!SIP_REGISTERED');\n      if (!this.sipRegisterSuccess) {\n        this._sendTabManager(tabManagerEvents.SIP_REGISTERED);\n        this._sipRegistered();\n      }\n    });\n\n    this._deps.evSubscription.subscribe(\n      EvCallbackTypes.SIP_UNREGISTERED,\n      () => {\n        console.log('!!!!!!!SIP_UNREGISTERED');\n        if (this.sipRegisterSuccess) {\n          this._sendTabManager(tabManagerEvents.SIP_UNREGISTERED);\n          this.setSipRegisterSuccess(false);\n        }\n      },\n    );\n\n    this._deps.evSubscription.subscribe(\n      EvCallbackTypes.SIP_REGISTRATION_FAILED,\n      async () => {\n        console.log('!!!!!!!SIP_REGISTRATION_FAILED');\n        this.setSipRegistering(false);\n\n        this._sendTabManager(tabManagerEvents.SIP_REGISTRATION_FAILED);\n        this._handleRegistrationFailed();\n\n        // await this._deps.evAgentSession.reLoginAgent();\n        // this._closeFailReconnectedBlock();\n      },\n    );\n\n    this._deps.evSubscription.subscribe(\n      EvCallbackTypes.SIP_RINGING,\n      (ringingCall) => {\n        this.bindBeforeunload();\n        console.log('!!!!!!!SIP_RINGING');\n        this._eventEmitter.emit(EvCallbackTypes.SIP_RINGING, ringingCall);\n\n        if (this.autoAnswerCheckFn()) {\n          return this._sipAnswer();\n        }\n\n        const { displayName } = ringingCall.data.request.from;\n        const queueName = this._deps.evClient.currentCall?.queue?.name;\n        const { dialoutStatus, isOffhooking, isManualOffhook } =\n          this._deps.presence;\n        // exclude outbound and offhook\n        const isInbound =\n          dialoutStatus !== 'dialing' &&\n          !(isManualOffhook && isOffhooking) &&\n          this._deps.evClient.currentCall?.callType === 'INBOUND';\n\n        this._sendTabManager(tabManagerEvents.SIP_RINGING, {\n          displayName,\n          queueName,\n          isInbound,\n        });\n        this._showRingingModal({ displayName, queueName, isInbound });\n      },\n    );\n\n    this._deps.evSubscription.subscribe(EvCallbackTypes.SIP_CONNECTED, () => {\n      console.info('!!!!!!!SIP_CONNECTED');\n      this._sendTabManager(tabManagerEvents.SIP_CONNECTED);\n      this._sipConnected();\n    });\n\n    this._deps.evSubscription.subscribe(EvCallbackTypes.SIP_ENDED, () => {\n      console.info('!!!!!!!SIP_ENDED');\n      this.removeBeforeunload();\n\n      this._sendTabManager(tabManagerEvents.SIP_ENDED);\n      this._sipEnded();\n    });\n\n    this._deps.evSubscription.subscribe(EvCallbackTypes.SIP_MUTE, () => {\n      console.info('!!!!!!!SIP_MUTE');\n      this._sendTabManager(tabManagerEvents.MUTE_STATE_CHANGE, true);\n      this.setMuteActive(true);\n    });\n\n    this._deps.evSubscription.subscribe(EvCallbackTypes.SIP_UNMUTE, () => {\n      console.info('!!!!!!!SIP_UNMUTE');\n      this._sendTabManager(tabManagerEvents.MUTE_STATE_CHANGE, false);\n      this.setMuteActive(false);\n    });\n\n    // TODO: that is update session config related feature\n    // triggered by agentSDK if dial destination is changed on softphone registration\n    // pass in autoStartOH, maintainOH and dial destination, needed for reconnect logic\n    // this._deps.evSubscription.subscribe(\n    // EvCallbackTypes.SIP_DIAL_DEST_CHANGED,\n    // (data) => {\n    // console.info('!!!!!!!SIP_DIAL_DEST_CHANGED');\n    // // AgentSvc.setDialDest(data.dialDest),\n    // // SessionSvc.attemptingSoftphoneReconnect &&\n    // // (data.autoStartOH\n    // // ? AgentSvc.offhookInit().then(\n    // // function(result) {\n    // // data.maintainOH && (AgentSvc.systemInitOffhook = !1);\n    // // },\n    // // function(err) {\n    // // SessionSvc.showOffhookError(err.detail, data.maintainOH);\n    // // },\n    // // )\n    // // : ($timeout(function() {\n    // // 'RNA-STATE' === AgentSvc.currentAgentState.baseState &&\n    // // AgentSvc.setAgentState('AVAILABLE');\n    // // }, 1e3),\n    // // (SessionSvc.attemptingSoftphoneReconnect = !1),\n    // // (SessionSvc.manualSoftphoneReconnect = !1)));\n    // },\n    // );\n  }\n\n  private _sipEnded() {\n    this._closeRingingModal();\n    this._deps.presence.setOffhook(false);\n  }\n\n  private _sipRegistered() {\n    console.log('_sipRegistered~');\n    this.setSipRegisterSuccess(true);\n    this._eventEmitter.emit(EvSoftphoneEvents.REGISTERED);\n\n    this._isCloseWhenCallConnected = false;\n    this._closeWebRTCConnectingMask();\n  }\n\n  private _handleRegistrationFailed() {\n    this._failedBlockId = this._deps.block.block();\n    this._deps.evClient.sipTerminate();\n\n    this._resetAllState();\n    this._closeWebRTCConnectingMask();\n    // this._deps.alert.danger({\n    //   message: EvCallbackTypes.SIP_REGISTRATION_FAILED,\n    //   backdrop: true,\n    //   ttl: 0,\n    //   allowDuplicates: false,\n    // });\n\n    this._deps.modalUI.alert({\n      title: 'Registration failed',\n      content: 'Will reload your pages and tabs for you',\n      confirmButtonText: 'Ok',\n      childrenSize: 'small',\n      onConfirm: () => {\n        this._sendTabManager(tabManagerEvents.SIP_REGISTRATION_FAILED_RELOAD);\n        this._reloadApp();\n      },\n    });\n\n    this._deps.tabManager.setMainTabId(null);\n    // this._deps.routerInteraction.push('/sessionConfig');\n  }\n\n  private _reloadApp() {\n    window.location.reload();\n  }\n\n  private _sipConnected() {\n    this._deps.presence.setOffhook(true);\n    // When connected reset all controller state\n    this.resetController();\n  }\n\n  private async _showWebRTCConnectingMask() {\n    this._closeWebRTCConnectingMask();\n    this.setConnectingAlertId(\n      await this._deps.alert.info({\n        message: this._isCloseWhenCallConnected\n          ? tabManagerEvents.SIP_RECONNECTING_WHEN_CALL_CONNECTED\n          : tabManagerEvents.SIP_CONNECTING,\n        loading: true,\n      }),\n    );\n  }\n\n  private _closeWebRTCConnectingMask() {\n    console.log('_closeWebRTCConnectingMask~~', this.connectingAlertId);\n    if (this.connectingAlertId) {\n      this._deps.alert.dismiss(this.connectingAlertId);\n\n      this.setConnectingAlertId(null);\n    }\n  }\n\n  private async _showAskAudioPermissionMask() {\n    this._closeAskAudioPermissionMask();\n    this._audioPermissionAlertId = await this._deps.alert.info({\n      message: tabManagerEvents.ASK_AUDIO_PERMISSION,\n      loading: true,\n      backdrop: true,\n    });\n  }\n\n  private _closeAskAudioPermissionMask() {\n    if (this._audioPermissionAlertId) {\n      this._deps.alert.dismiss(this._audioPermissionAlertId);\n      this._audioPermissionAlertId = null;\n    }\n  }\n\n  private _showRingingModal({\n    displayName,\n    queueName,\n    isInbound,\n  }: ShowRingingModalProps) {\n    // prevent open a lot of modal, that sdk event pass a lot of ringing state when re login\n    if (this._answerModalId) {\n      return;\n    }\n\n    this._playAudioLoop('ringtone');\n\n    const { currentLocale } = this._deps.locale;\n\n    this._answerModalId = this._deps.modalUI.confirm({\n      title: i18n.getString('inviteModalTitle', currentLocale),\n      content: ModalContentRendererID,\n      contentProps: {\n        isInbound,\n        inboundTextProps: queueName && {\n          incomingText: format(i18n.getString('incomingText', currentLocale), {\n            displayName,\n          }),\n          queueNameText: format(\n            i18n.getString('queueNameText', currentLocale),\n            {\n              queueName,\n            },\n          ),\n        },\n        outboundText: format(i18n.getString('outboundText', currentLocale), {\n          displayName,\n        }),\n      },\n      confirmButtonText: i18n.getString('inviteModalAnswer', currentLocale),\n      cancelButtonText: i18n.getString('inviteModalReject', currentLocale),\n      onConfirm: async () => {\n        this._sendTabManager(tabManagerEvents.SIP_RINGING_MODAL, true);\n        await this.answerCall();\n      },\n      onCancel: () => {\n        this._sendTabManager(tabManagerEvents.SIP_RINGING_MODAL, false);\n        this.rejectCall();\n      },\n      childrenSize: 'small',\n    });\n  }\n\n  private async answerCall() {\n    this._resetRingingModal();\n    if (\n      !this.tabManagerEnabled ||\n      (this.tabManagerEnabled && this._deps.tabManager.isMainTab)\n    ) {\n      await this._sipAnswer();\n    }\n  }\n\n  private rejectCall() {\n    this._resetRingingModal();\n    // when reject not show init fail\n    this._deps.presence.showOffHookInitError = false;\n    this._deps.evClient.sipReject();\n    this._eventEmitter.emit(EvSoftphoneEvents.CALL_REJECTED);\n    this.removeBeforeunload();\n  }\n\n  async onceRegistered() {\n    let _resolve: (value: boolean) => void;\n    const resolveTrue = () => _resolve(true);\n    const resolveFalse = () => _resolve(false);\n\n    try {\n      const success = await waitUntilTo(\n        () => {\n          return new Promise<boolean>((resolve) => {\n            _resolve = resolve;\n\n            this._eventEmitter.once(EvSoftphoneEvents.REGISTERED, resolveTrue);\n            // when reset sip also need reject that\n            this._eventEmitter.once(EvSoftphoneEvents.RESET, resolveFalse);\n          });\n        },\n        {\n          timeout: SIP_MAX_CONNECTING_TIME,\n        },\n      );\n\n      if (!success) {\n        this._emitRegistrationFailed();\n      }\n    } catch (error) {\n      this._emitRegistrationFailed();\n    }\n\n    this._eventEmitter.off(EvSoftphoneEvents.REGISTERED, resolveTrue);\n    this._eventEmitter.off(EvSoftphoneEvents.RESET, resolveFalse);\n  }\n\n  private _closeRingingModal() {\n    // if there is modal there, mean another cancel this call\n    if (this._answerModalId) {\n      this._deps.alert.info({\n        message: EvSoftphoneEvents.CALL_REJECTED,\n        ttl: 0,\n      });\n      this._deps.modalUI.close(this._answerModalId);\n      this._answerModalId = null;\n      this._stopAudio();\n    }\n  }\n\n  private async _registerSoftphone() {\n    if (!this.sipRegistering) {\n      this.setSipRegistering(true);\n\n      this._sendTabManager(tabManagerEvents.SIP_CONNECTING);\n      this._showWebRTCConnectingMask();\n\n      console.log(\n        'isReconnected, isForceLogin, _isCloseWhenCallConnected~',\n        this._deps.evAgentSession.isReconnected,\n        this._deps.evAgentSession.isForceLogin,\n        this._isCloseWhenCallConnected,\n      );\n\n      // When that is force login is also need delay to reconnect server\n      if (\n        this._deps.evAgentSession.isReconnected ||\n        this._deps.evAgentSession.isForceLogin\n      ) {\n        await sleep(\n          this._isCloseWhenCallConnected\n            ? RECONNECT_DEBOUNCE_TIME_WHEN_CONNECTED\n            : RECONNECT_DEBOUNCE_TIME,\n        );\n        await this._connectedWebRTC();\n      } else {\n        await this._connectedWebRTC();\n      }\n      return;\n    }\n\n    throw new Error('Sip is registering');\n  }\n\n  private async _connectedWebRTC() {\n    try {\n      this._deps.evClient.sipInit();\n      this._deps.evClient.sipRegister();\n\n      await this.onceRegistered();\n\n      this.setSipRegistering(false);\n      this._closeWebRTCConnectingMask();\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  private _resetRingingModal() {\n    this._stopAudio();\n    this._answerModalId = null;\n  }\n\n  private async _sipAnswer() {\n    if (this._isFirefox) {\n      try {\n        await waitUntilTo(\n          async () => {\n            try {\n              await navigator.mediaDevices.getUserMedia({\n                audio: true,\n              });\n            } catch (error) {\n              // ignore\n            }\n          },\n          {\n            timeout: 2000,\n          },\n        );\n      } catch (error) {\n        this._sendTabManager(tabManagerEvents.NOTIFY_ACTIVE_TAB_CALL_ACTIVE);\n        // eslint-disable-next-line no-alert\n        window.confirm(\n          i18n.getString('activeCallTip', this._deps.locale.currentLocale),\n        );\n      }\n    }\n    this._deps.evClient.sipAnswer();\n  }\n\n  private _initAudio() {\n    if (typeof document !== 'undefined' && document.createElement) {\n      this._audio = document.createElement('audio');\n    }\n  }\n\n  private _playAudioLoop(type: keyof typeof audios) {\n    this._audio.loop = true;\n    this._playAudio(type);\n  }\n\n  @runInActivityWebRTCTab()\n  private _playAudio(type: keyof typeof audios) {\n    this._audio.currentTime = 0;\n    this._audio.src = audios[type];\n    this._audio.play();\n  }\n\n  @runInActivityWebRTCTab()\n  private _stopAudio() {\n    this._audio.loop = false;\n    this._audio.pause();\n  }\n\n  private _sendTabManager(event: string, value?: any) {\n    this._deps.tabManager?.send(event, value);\n  }\n\n  bindBeforeunload() {\n    this._deps.beforeunload.add(this._beforeunloadHandler);\n  }\n\n  removeBeforeunload() {\n    this._deps.beforeunload.remove(this._beforeunloadHandler);\n  }\n}\n\nexport { EvIntegratedSoftphone };\n"],"mappings":"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"}
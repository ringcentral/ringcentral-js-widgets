{"version":3,"file":"EvIntegratedSoftphone.js","names":["_di","require","_utils","_core","_utils2","_events","_enums","_enums2","_IncomingModalText","_audios","_i18n","_interopRequireDefault","_runInActivityWebRTCTab","_dec","_dec2","_dec3","_class","_class2","_descriptor","_descriptor2","_descriptor3","_descriptor4","_descriptor5","e","__esModule","asyncGeneratorStep","n","t","r","o","a","c","i","u","value","done","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_initializerDefineProperty","l","Object","defineProperty","enumerable","configurable","writable","initializer","call","_classCallCheck","TypeError","_defineProperties","length","_toPropertyKey","key","_createClass","prototype","_toPrimitive","_typeof","Symbol","toPrimitive","String","Number","_inherits","create","constructor","_setPrototypeOf","setPrototypeOf","bind","__proto__","_createSuper","_isNativeReflectConstruct","_getPrototypeOf","s","Reflect","construct","_possibleConstructorReturn","_assertThisInitialized","ReferenceError","Boolean","valueOf","getPrototypeOf","_applyDecoratedDescriptor","keys","forEach","slice","reverse","reduce","_initializerWarningHelper","Error","SECOND","RECONNECT_DEBOUNCE_TIME","RECONNECT_DEBOUNCE_TIME_WHEN_CONNECTED","SIP_MAX_CONNECTING_TIME","ModalContentRendererID","ModalContentRenderer","_ref","isInbound","inboundTextProps","outboundText","getModalText","EvIntegratedSoftphone","Module","name","deps","dep","optional","runInActivityWebRTCTab","_ref2","_super","get","_this$_deps$tabManage","_deps","tabManager","enable","isMainTab","sipRegisterSuccess","evAgentSession","isIntegratedSoftphone","_this","enableCache","storageKey","autoAnswerCheckFn","_isFirefox","_audio","_eventEmitter","EventEmitter","_answerModalId","_audioPermissionAlertId","_beforeunloadHandler","isWebRTCTab","_isCloseWhenCallConnected","_failedBlockId","evAuth","beforeAgentLogout","_resetAllState","beforeunload","onAfterUnload","_sendTabManager","tabManagerEvents","CLOSE_WHEN_CALL_CONNECTED","modalUI","registerRenderer","navigator","userAgent","indexOf","setConnectingAlertId","id","connectingAlertId","setAudioPermission","permission","audioPermission","resetController","muteActive","setMuteActive","state","resetSip","sipRegistering","setSipRegisterSuccess","setSipRegistering","onInitOnce","_this2","_initAudio","_bindingIntegratedSoftphone","onSetMainTabComplete","regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","console","log","connectWebRTC","stop","onConfigSuccess","hasMultipleTabs","isConfigTabAlive","onReConfigFail","_emitRegistrationFailed","onReset","error","_closeWebRTCConnectingMask","evClient","sipTerminate","emit","EvSoftphoneEvents","RESET","evSubscription","EvCallbackTypes","SIP_REGISTRATION_FAILED","_onStateChange","_callee2","_callee2$","_context2","ready","_checkTabManagerEvent","onStateChange","_checkTabManagerEvent2","_callee3","event","data","_callee3$","_context3","args","t0","ASK_AUDIO_PERMISSION","SIP_CONNECTING","SIP_RINGING","SIP_RINGING_MODAL","MUTE_STATE_CHANGE","SIP_REGISTERED","SIP_UNREGISTERED","SIP_REGISTRATION_FAILED_RELOAD","SIP_CONNECTED","SIP_ENDED","MUTE","NOTIFY_ACTIVE_TAB_CALL_ACTIVE","_showAskAudioPermissionMask","_closeAskAudioPermissionMask","abrupt","_showWebRTCConnectingMask","_showRingingModal","close","answerCall","rejectCall","_sipRegistered","_reloadApp","_handleRegistrationFailed","onceLogoutThenLogin","_closeFailReconnectedBlock","_sipConnected","_sipEnded","presence","setDialoutStatus","dialoutStatuses","idle","sipToggleMute","active","alert","warning","message","backdrop","ttl","block","unblock","onRinging","callback","on","_askAudioPermission","_callee4","showMask","_args4","_callee4$","_context4","undefined","mediaDevices","getUserMedia","audio","danger","AUDIO_STREAM_REJECTED","finish","_registerSoftphone","askAudioPermission","_connectWebRTC","_callee5","_callee5$","_context5","_this3","subscribe","_callee6","_callee6$","_context6","ringingCall","_this3$_deps$evClient","_this3$_deps$evClient2","_this3$_deps$evClient3","bindBeforeunload","_sipAnswer","displayName","request","from","queueName","currentCall","queue","_this3$_deps$presence","dialoutStatus","isOffhooking","isManualOffhook","callType","info","removeBeforeunload","SIP_MUTE","SIP_UNMUTE","_closeRingingModal","setOffhook","REGISTERED","_this4","title","content","confirmButtonText","childrenSize","onConfirm","setMainTabId","window","location","reload","_showWebRTCConnectingMask2","_callee7","_callee7$","_context7","SIP_RECONNECTING_WHEN_CALL_CONNECTED","loading","t1","sent","dismiss","_showAskAudioPermissionMask2","_callee8","_callee8$","_context8","_ref5","_this5","_playAudioLoop","currentLocale","locale","confirm","i18n","getString","contentProps","incomingText","format","queueNameText","cancelButtonText","_onConfirm","_callee9","_callee9$","_context9","onCancel","_answerCall","_callee10","_callee10$","_context10","_resetRingingModal","tabManagerEnabled","showOffHookInitError","sipReject","CALL_REJECTED","_onceRegistered","_callee11","_this6","_resolve","resolveTrue","resolveFalse","success","_callee11$","_context11","waitUntilTo","once","timeout","off","onceRegistered","_stopAudio","_registerSoftphone2","_callee12","_callee12$","_context12","isReconnected","isForceLogin","sleep","_connectedWebRTC","_connectedWebRTC2","_callee13","_callee13$","_context13","sipInit","sipRegister","_sipAnswer2","_callee15","_callee15$","_context15","_callee14","_callee14$","_context14","sipAnswer","document","createElement","type","loop","_playAudio","currentTime","src","audios","play","pause","_this$_deps$tabManage2","send","add","remove","RcModuleV2","storage","action","getOwnPropertyDescriptor","exports"],"sources":["modules/EvIntegratedSoftphone/EvIntegratedSoftphone.ts"],"sourcesContent":["import { Module } from '@ringcentral-integration/commons/lib/di';\nimport { sleep, waitUntilTo } from '@ringcentral-integration/commons/utils';\nimport {\n  action,\n  RcModuleV2,\n  state,\n  storage,\n} from '@ringcentral-integration/core';\nimport { format } from '@ringcentral-integration/utils';\nimport type { CustomRenderer } from '@ringcentral-integration/widgets/modules/ModalUI/ModalUI.interface';\nimport { EventEmitter } from 'events';\n\nimport {\n  dialoutStatuses,\n  EvSoftphoneEvents,\n  tabManagerEvents,\n} from '../../enums';\nimport type { EvSipRingingData } from '../../lib/EvClient';\nimport { EvCallbackTypes } from '../../lib/EvClient/enums';\n\nimport type {\n  Deps,\n  IntegratedSoftphone,\n  ShowRingingModalProps,\n} from './EvIntegratedSoftphone.interface';\nimport { getModalText } from './IncomingModalText';\nimport { audios } from './audios';\nimport i18n from './i18n';\nimport { runInActivityWebRTCTab } from './runInActivityWebRTCTab.decorator';\n\nconst SECOND = 1000;\nconst RECONNECT_DEBOUNCE_TIME = SECOND * 5;\nconst RECONNECT_DEBOUNCE_TIME_WHEN_CONNECTED = SECOND * 15;\nconst SIP_MAX_CONNECTING_TIME = SECOND * 30;\n\nconst ModalContentRendererID = 'EvIntegratedSoftphone.ModalContentRenderer';\nconst ModalContentRenderer: CustomRenderer = ({\n  isInbound,\n  inboundTextProps,\n  outboundText,\n}) => getModalText({ isInbound, inboundTextProps, outboundText });\n\n@Module({\n  name: 'EvIntegratedSoftphone',\n  deps: [\n    'Locale',\n    'RouterInteraction',\n    'EvAgentSession',\n    'EvSubscription',\n    'Beforeunload',\n    'EvSettings',\n    'EvClient',\n    'Presence',\n    'Storage',\n    'EvAuth',\n    'Block',\n    'Auth',\n    'ModalUI',\n    'Alert',\n    { dep: 'TabManager', optional: true },\n    { dep: 'EvIntegratedSoftphoneOptions', optional: true },\n  ],\n})\nclass EvIntegratedSoftphone\n  extends RcModuleV2<Deps>\n  implements IntegratedSoftphone\n{\n  autoAnswerCheckFn: () => boolean;\n\n  private _isFirefox: boolean;\n\n  private _audio: HTMLAudioElement;\n\n  private _eventEmitter = new EventEmitter();\n\n  private _answerModalId: string = null;\n\n  /** audio permission alert id */\n  private _audioPermissionAlertId: string = null;\n\n  // private _checkWebRTCIntervalId: NodeJS.Timeout;\n\n  // private _heartBeatIntervalTime: number;\n\n  private _beforeunloadHandler = () => this.isWebRTCTab;\n\n  private _isCloseWhenCallConnected = false;\n  private _failedBlockId: string;\n\n  get tabManagerEnabled() {\n    return this._deps.tabManager?.enable;\n  }\n\n  get isWebRTCTab() {\n    return this._deps.tabManager.isMainTab && this.sipRegisterSuccess;\n  }\n\n  get isIntegratedSoftphoneWithTabEnable() {\n    return (\n      this._deps.tabManager.enable &&\n      this._deps.evAgentSession.isIntegratedSoftphone\n    );\n  }\n\n  constructor(deps: Deps) {\n    super({\n      deps,\n      enableCache: true,\n      storageKey: 'EvIntegratedSoftphone',\n    });\n\n    this._deps.evAuth.beforeAgentLogout(() => {\n      this._resetAllState();\n    });\n\n    this._deps.beforeunload.onAfterUnload(() => {\n      this._sendTabManager(tabManagerEvents.CLOSE_WHEN_CALL_CONNECTED);\n    });\n\n    this._deps.modalUI.registerRenderer(\n      ModalContentRendererID,\n      ModalContentRenderer,\n    );\n    this._isFirefox = navigator.userAgent.indexOf('Firefox') !== -1;\n  }\n\n  // @state\n  // dtmfString: string = '';\n\n  @storage\n  @state\n  audioPermission = false;\n\n  @storage\n  @state\n  muteActive = false;\n\n  @state\n  sipRegisterSuccess = false;\n\n  @state\n  sipRegistering = false;\n\n  /** connecting webRTC alert id, for dialer call button disabled check */\n  @state\n  connectingAlertId: string = null;\n\n  // this is for dialPad click when on call\n  // @action\n  // sipSendDTMF(dtmf: string) {\n  // this.dtmfString += dtmf;\n  // this._deps.evClient.sipSendDTMF(dtmf);\n  // }\n\n  @action\n  setConnectingAlertId(id: string) {\n    this.connectingAlertId = id;\n  }\n\n  @action\n  setAudioPermission(permission: boolean) {\n    this.audioPermission = permission;\n  }\n\n  @action\n  resetController() {\n    // this.dtmfString = '';\n    this.muteActive = false;\n  }\n\n  @action\n  setMuteActive(state: boolean) {\n    this.muteActive = state;\n  }\n\n  @action\n  resetSip() {\n    this.audioPermission = false;\n    this.sipRegistering = false;\n    this.sipRegisterSuccess = false;\n  }\n\n  @action\n  setSipRegisterSuccess(state: boolean) {\n    this.sipRegisterSuccess = state;\n  }\n\n  @action\n  setSipRegistering(state: boolean) {\n    this.sipRegistering = state;\n  }\n\n  override onInitOnce() {\n    this._initAudio();\n\n    this._bindingIntegratedSoftphone();\n\n    this._deps.tabManager.onSetMainTabComplete(async () => {\n      console.log(\n        'onSetMainTabComplete~~',\n        this._deps.evAgentSession.isIntegratedSoftphone,\n      );\n      if (this._deps.evAgentSession.isIntegratedSoftphone) {\n        await this.connectWebRTC();\n      }\n    });\n\n    this._deps.evAgentSession.onConfigSuccess(() => {\n      if (\n        this._deps.tabManager.hasMultipleTabs &&\n        !this._deps.tabManager.isMainTab &&\n        this._deps.evAgentSession.isIntegratedSoftphone &&\n        this._deps.evAgentSession.isConfigTabAlive()\n      ) {\n        console.log('setSipRegisterSuccess in onConfigSuccess~~');\n        this.setSipRegisterSuccess(true);\n      }\n    });\n\n    this._deps.evAgentSession.onReConfigFail(() => {\n      if (this._deps.evAgentSession.isIntegratedSoftphone) {\n        this._emitRegistrationFailed();\n      }\n    });\n  }\n\n  override onReset() {\n    try {\n      console.log('onReset in EvIntegratedSoftphone~');\n      this._resetAllState();\n    } catch (error) {\n      // ignore error\n    }\n  }\n\n  private _resetAllState() {\n    this._closeWebRTCConnectingMask();\n    this.resetSip();\n\n    this._deps.evClient.sipTerminate();\n    this._eventEmitter.emit(EvSoftphoneEvents.RESET);\n  }\n\n  private _emitRegistrationFailed() {\n    this._deps.evSubscription.emit(\n      EvCallbackTypes.SIP_REGISTRATION_FAILED,\n      null,\n    );\n  }\n\n  override async onStateChange() {\n    if (\n      this.ready &&\n      this._deps.tabManager.enable &&\n      this._deps.tabManager.ready\n    ) {\n      this._checkTabManagerEvent();\n    }\n  }\n\n  private async _checkTabManagerEvent() {\n    const { event } = this._deps.tabManager;\n    if (event) {\n      const data = event.args[0];\n      switch (event.name) {\n        case tabManagerEvents.ASK_AUDIO_PERMISSION:\n          if (data) {\n            this._showAskAudioPermissionMask();\n          } else {\n            this._closeAskAudioPermissionMask();\n          }\n          break;\n        case tabManagerEvents.SIP_CONNECTING:\n          this._showWebRTCConnectingMask();\n          break;\n        case tabManagerEvents.SIP_RINGING:\n          this._showRingingModal(data);\n          break;\n        case tabManagerEvents.SIP_RINGING_MODAL:\n          // that event call from modal ok or cancel, that auto close modal\n          this._deps.modalUI.close(this._answerModalId);\n          if (data) {\n            await this.answerCall();\n          } else {\n            this.rejectCall();\n          }\n          break;\n        case tabManagerEvents.MUTE_STATE_CHANGE:\n          this.setMuteActive(data);\n          break;\n        case tabManagerEvents.SIP_REGISTERED:\n          console.log('_sipRegistered in other tabs~');\n          this._sipRegistered();\n          break;\n        case tabManagerEvents.SIP_UNREGISTERED:\n          this.setSipRegisterSuccess(false);\n          break;\n        case tabManagerEvents.SIP_REGISTRATION_FAILED_RELOAD:\n          this._reloadApp();\n          break;\n        case tabManagerEvents.SIP_REGISTRATION_FAILED:\n          this._handleRegistrationFailed();\n          await this._deps.evAgentSession.onceLogoutThenLogin();\n          this._closeFailReconnectedBlock();\n          break;\n        case tabManagerEvents.SIP_CONNECTED:\n          this._sipConnected();\n          break;\n        case tabManagerEvents.SIP_ENDED:\n          this._sipEnded();\n          // When sip end need reset Dialout Status to idle\n          this._deps.presence.setDialoutStatus(dialoutStatuses.idle);\n          break;\n        case tabManagerEvents.MUTE:\n          this.sipToggleMute(data);\n          break;\n        case tabManagerEvents.CLOSE_WHEN_CALL_CONNECTED:\n          this._isCloseWhenCallConnected = true;\n          break;\n        case tabManagerEvents.NOTIFY_ACTIVE_TAB_CALL_ACTIVE:\n          if (this._deps.tabManager.active) {\n            this._deps.alert.warning({\n              message: tabManagerEvents.NOTIFY_ACTIVE_TAB_CALL_ACTIVE,\n              backdrop: true,\n              ttl: 0,\n            });\n          }\n          break;\n        default:\n          break;\n      }\n    }\n  }\n\n  private _closeFailReconnectedBlock() {\n    this._deps.block.unblock(this._failedBlockId);\n    this._failedBlockId = null;\n  }\n\n  sipToggleMute(state: boolean) {\n    this._deps.evClient.sipToggleMute(state);\n  }\n\n  onRinging(callback: (call?: EvSipRingingData) => void) {\n    this._eventEmitter.on(EvCallbackTypes.SIP_RINGING, callback);\n  }\n\n  async askAudioPermission(showMask = true) {\n    console.log('askAudioPermission~~', showMask);\n    try {\n      if (showMask) {\n        if (!this.audioPermission) {\n          this._sendTabManager(tabManagerEvents.ASK_AUDIO_PERMISSION, true);\n          this._showAskAudioPermissionMask();\n        }\n\n        console.log('connect WEB_RTC');\n        await navigator.mediaDevices.getUserMedia({\n          audio: true,\n        });\n      }\n    } catch (error) {\n      this._deps.alert.danger({\n        message: EvSoftphoneEvents.AUDIO_STREAM_REJECTED,\n        backdrop: true,\n        ttl: 0,\n      });\n      console.log(error);\n      throw new Error('Need Audio permission');\n    } finally {\n      if (showMask) {\n        if (this._audioPermissionAlertId) {\n          this._sendTabManager(tabManagerEvents.ASK_AUDIO_PERMISSION, false);\n          this._closeAskAudioPermissionMask();\n        }\n      }\n    }\n\n    this.setAudioPermission(true);\n    if (!this.sipRegisterSuccess) {\n      await this._registerSoftphone();\n    }\n  }\n\n  private async connectWebRTC() {\n    console.log('connectWebRTC~');\n\n    this.resetSip();\n    await this.askAudioPermission();\n  }\n\n  private _bindingIntegratedSoftphone() {\n    console.log('_bindingIntegratedSoftphone~~');\n    this._deps.evSubscription.subscribe(EvCallbackTypes.SIP_REGISTERED, () => {\n      // That will call several times when reconnected.\n      console.log('!!!!!!!SIP_REGISTERED');\n      if (!this.sipRegisterSuccess) {\n        this._sendTabManager(tabManagerEvents.SIP_REGISTERED);\n        this._sipRegistered();\n      }\n    });\n\n    this._deps.evSubscription.subscribe(\n      EvCallbackTypes.SIP_UNREGISTERED,\n      () => {\n        console.log('!!!!!!!SIP_UNREGISTERED');\n        if (this.sipRegisterSuccess) {\n          this._sendTabManager(tabManagerEvents.SIP_UNREGISTERED);\n          this.setSipRegisterSuccess(false);\n        }\n      },\n    );\n\n    this._deps.evSubscription.subscribe(\n      EvCallbackTypes.SIP_REGISTRATION_FAILED,\n      async () => {\n        console.log('!!!!!!!SIP_REGISTRATION_FAILED');\n        this.setSipRegistering(false);\n\n        this._sendTabManager(tabManagerEvents.SIP_REGISTRATION_FAILED);\n        this._handleRegistrationFailed();\n\n        // await this._deps.evAgentSession.reLoginAgent();\n        // this._closeFailReconnectedBlock();\n      },\n    );\n\n    this._deps.evSubscription.subscribe(\n      EvCallbackTypes.SIP_RINGING,\n      (ringingCall) => {\n        this.bindBeforeunload();\n        console.log('!!!!!!!SIP_RINGING');\n        this._eventEmitter.emit(EvCallbackTypes.SIP_RINGING, ringingCall);\n\n        if (this.autoAnswerCheckFn()) {\n          return this._sipAnswer();\n        }\n\n        const { displayName } = ringingCall.data.request.from;\n        const queueName = this._deps.evClient.currentCall?.queue?.name;\n        const { dialoutStatus, isOffhooking, isManualOffhook } =\n          this._deps.presence;\n        // exclude outbound and offhook\n        const isInbound =\n          dialoutStatus !== 'dialing' &&\n          !(isManualOffhook && isOffhooking) &&\n          this._deps.evClient.currentCall?.callType === 'INBOUND';\n\n        this._sendTabManager(tabManagerEvents.SIP_RINGING, {\n          displayName,\n          queueName,\n          isInbound,\n        });\n        this._showRingingModal({ displayName, queueName, isInbound });\n      },\n    );\n\n    this._deps.evSubscription.subscribe(EvCallbackTypes.SIP_CONNECTED, () => {\n      console.info('!!!!!!!SIP_CONNECTED');\n      this._sendTabManager(tabManagerEvents.SIP_CONNECTED);\n      this._sipConnected();\n    });\n\n    this._deps.evSubscription.subscribe(EvCallbackTypes.SIP_ENDED, () => {\n      console.info('!!!!!!!SIP_ENDED');\n      this.removeBeforeunload();\n\n      this._sendTabManager(tabManagerEvents.SIP_ENDED);\n      this._sipEnded();\n    });\n\n    this._deps.evSubscription.subscribe(EvCallbackTypes.SIP_MUTE, () => {\n      console.info('!!!!!!!SIP_MUTE');\n      this._sendTabManager(tabManagerEvents.MUTE_STATE_CHANGE, true);\n      this.setMuteActive(true);\n    });\n\n    this._deps.evSubscription.subscribe(EvCallbackTypes.SIP_UNMUTE, () => {\n      console.info('!!!!!!!SIP_UNMUTE');\n      this._sendTabManager(tabManagerEvents.MUTE_STATE_CHANGE, false);\n      this.setMuteActive(false);\n    });\n\n    // TODO: that is update session config related feature\n    // triggered by agentSDK if dial destination is changed on softphone registration\n    // pass in autoStartOH, maintainOH and dial destination, needed for reconnect logic\n    // this._deps.evSubscription.subscribe(\n    // EvCallbackTypes.SIP_DIAL_DEST_CHANGED,\n    // (data) => {\n    // console.info('!!!!!!!SIP_DIAL_DEST_CHANGED');\n    // // AgentSvc.setDialDest(data.dialDest),\n    // // SessionSvc.attemptingSoftphoneReconnect &&\n    // // (data.autoStartOH\n    // // ? AgentSvc.offhookInit().then(\n    // // function(result) {\n    // // data.maintainOH && (AgentSvc.systemInitOffhook = !1);\n    // // },\n    // // function(err) {\n    // // SessionSvc.showOffhookError(err.detail, data.maintainOH);\n    // // },\n    // // )\n    // // : ($timeout(function() {\n    // // 'RNA-STATE' === AgentSvc.currentAgentState.baseState &&\n    // // AgentSvc.setAgentState('AVAILABLE');\n    // // }, 1e3),\n    // // (SessionSvc.attemptingSoftphoneReconnect = !1),\n    // // (SessionSvc.manualSoftphoneReconnect = !1)));\n    // },\n    // );\n  }\n\n  private _sipEnded() {\n    this._closeRingingModal();\n    this._deps.presence.setOffhook(false);\n  }\n\n  private _sipRegistered() {\n    console.log('_sipRegistered~');\n    this.setSipRegisterSuccess(true);\n    this._eventEmitter.emit(EvSoftphoneEvents.REGISTERED);\n\n    this._isCloseWhenCallConnected = false;\n    this._closeWebRTCConnectingMask();\n  }\n\n  private _handleRegistrationFailed() {\n    this._failedBlockId = this._deps.block.block();\n    this._deps.evClient.sipTerminate();\n\n    this._resetAllState();\n    this._closeWebRTCConnectingMask();\n    // this._deps.alert.danger({\n    //   message: EvCallbackTypes.SIP_REGISTRATION_FAILED,\n    //   backdrop: true,\n    //   ttl: 0,\n    //   allowDuplicates: false,\n    // });\n\n    this._deps.modalUI.alert({\n      title: 'Registration failed',\n      content: 'Will reload your pages and tabs for you',\n      confirmButtonText: 'Ok',\n      childrenSize: 'small',\n      onConfirm: () => {\n        this._sendTabManager(tabManagerEvents.SIP_REGISTRATION_FAILED_RELOAD);\n        this._reloadApp();\n      },\n    });\n\n    this._deps.tabManager.setMainTabId(null);\n    // this._deps.routerInteraction.push('/sessionConfig');\n  }\n\n  private _reloadApp() {\n    window.location.reload();\n  }\n\n  private _sipConnected() {\n    this._deps.presence.setOffhook(true);\n    // When connected reset all controller state\n    this.resetController();\n  }\n\n  private async _showWebRTCConnectingMask() {\n    this._closeWebRTCConnectingMask();\n    this.setConnectingAlertId(\n      await this._deps.alert.info({\n        message: this._isCloseWhenCallConnected\n          ? tabManagerEvents.SIP_RECONNECTING_WHEN_CALL_CONNECTED\n          : tabManagerEvents.SIP_CONNECTING,\n        loading: true,\n      }),\n    );\n  }\n\n  private _closeWebRTCConnectingMask() {\n    console.log('_closeWebRTCConnectingMask~~', this.connectingAlertId);\n    if (this.connectingAlertId) {\n      this._deps.alert.dismiss(this.connectingAlertId);\n\n      this.setConnectingAlertId(null);\n    }\n  }\n\n  private async _showAskAudioPermissionMask() {\n    this._closeAskAudioPermissionMask();\n    this._audioPermissionAlertId = await this._deps.alert.info({\n      message: tabManagerEvents.ASK_AUDIO_PERMISSION,\n      loading: true,\n      backdrop: true,\n    });\n  }\n\n  private _closeAskAudioPermissionMask() {\n    if (this._audioPermissionAlertId) {\n      this._deps.alert.dismiss(this._audioPermissionAlertId);\n      this._audioPermissionAlertId = null;\n    }\n  }\n\n  private _showRingingModal({\n    displayName,\n    queueName,\n    isInbound,\n  }: ShowRingingModalProps) {\n    // prevent open a lot of modal, that sdk event pass a lot of ringing state when re login\n    if (this._answerModalId) {\n      return;\n    }\n\n    this._playAudioLoop('ringtone');\n\n    const { currentLocale } = this._deps.locale;\n\n    this._answerModalId = this._deps.modalUI.confirm({\n      title: i18n.getString('inviteModalTitle', currentLocale),\n      content: ModalContentRendererID,\n      contentProps: {\n        isInbound,\n        inboundTextProps: queueName && {\n          incomingText: format(i18n.getString('incomingText', currentLocale), {\n            displayName,\n          }),\n          queueNameText: format(\n            i18n.getString('queueNameText', currentLocale),\n            {\n              queueName,\n            },\n          ),\n        },\n        outboundText: format(i18n.getString('outboundText', currentLocale), {\n          displayName,\n        }),\n      },\n      confirmButtonText: i18n.getString('inviteModalAnswer', currentLocale),\n      cancelButtonText: i18n.getString('inviteModalReject', currentLocale),\n      onConfirm: async () => {\n        this._sendTabManager(tabManagerEvents.SIP_RINGING_MODAL, true);\n        await this.answerCall();\n      },\n      onCancel: () => {\n        this._sendTabManager(tabManagerEvents.SIP_RINGING_MODAL, false);\n        this.rejectCall();\n      },\n      childrenSize: 'small',\n    });\n  }\n\n  private async answerCall() {\n    this._resetRingingModal();\n    if (\n      !this.tabManagerEnabled ||\n      (this.tabManagerEnabled && this._deps.tabManager.isMainTab)\n    ) {\n      await this._sipAnswer();\n    }\n  }\n\n  private rejectCall() {\n    this._resetRingingModal();\n    // when reject not show init fail\n    this._deps.presence.showOffHookInitError = false;\n    this._deps.evClient.sipReject();\n    this._eventEmitter.emit(EvSoftphoneEvents.CALL_REJECTED);\n    this.removeBeforeunload();\n  }\n\n  async onceRegistered() {\n    let _resolve: (value: boolean) => void;\n    const resolveTrue = () => _resolve(true);\n    const resolveFalse = () => _resolve(false);\n\n    try {\n      const success = await waitUntilTo(\n        () => {\n          return new Promise<boolean>((resolve) => {\n            _resolve = resolve;\n\n            this._eventEmitter.once(EvSoftphoneEvents.REGISTERED, resolveTrue);\n            // when reset sip also need reject that\n            this._eventEmitter.once(EvSoftphoneEvents.RESET, resolveFalse);\n          });\n        },\n        {\n          timeout: SIP_MAX_CONNECTING_TIME,\n        },\n      );\n\n      if (!success) {\n        this._emitRegistrationFailed();\n      }\n    } catch (error) {\n      this._emitRegistrationFailed();\n    }\n\n    this._eventEmitter.off(EvSoftphoneEvents.REGISTERED, resolveTrue);\n    this._eventEmitter.off(EvSoftphoneEvents.RESET, resolveFalse);\n  }\n\n  private _closeRingingModal() {\n    // if there is modal there, mean another cancel this call\n    if (this._answerModalId) {\n      this._deps.alert.info({\n        message: EvSoftphoneEvents.CALL_REJECTED,\n        ttl: 0,\n      });\n      this._deps.modalUI.close(this._answerModalId);\n      this._answerModalId = null;\n      this._stopAudio();\n    }\n  }\n\n  private async _registerSoftphone() {\n    if (!this.sipRegistering) {\n      this.setSipRegistering(true);\n\n      this._sendTabManager(tabManagerEvents.SIP_CONNECTING);\n      this._showWebRTCConnectingMask();\n\n      console.log(\n        'isReconnected, isForceLogin, _isCloseWhenCallConnected~',\n        this._deps.evAgentSession.isReconnected,\n        this._deps.evAgentSession.isForceLogin,\n        this._isCloseWhenCallConnected,\n      );\n\n      // When that is force login is also need delay to reconnect server\n      if (\n        this._deps.evAgentSession.isReconnected ||\n        this._deps.evAgentSession.isForceLogin\n      ) {\n        await sleep(\n          this._isCloseWhenCallConnected\n            ? RECONNECT_DEBOUNCE_TIME_WHEN_CONNECTED\n            : RECONNECT_DEBOUNCE_TIME,\n        );\n        await this._connectedWebRTC();\n      } else {\n        await this._connectedWebRTC();\n      }\n      return;\n    }\n\n    throw new Error('Sip is registering');\n  }\n\n  private async _connectedWebRTC() {\n    try {\n      this._deps.evClient.sipInit();\n      this._deps.evClient.sipRegister();\n\n      await this.onceRegistered();\n\n      this.setSipRegistering(false);\n      this._closeWebRTCConnectingMask();\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  private _resetRingingModal() {\n    this._stopAudio();\n    this._answerModalId = null;\n  }\n\n  private async _sipAnswer() {\n    if (this._isFirefox) {\n      try {\n        await waitUntilTo(\n          async () => {\n            try {\n              await navigator.mediaDevices.getUserMedia({\n                audio: true,\n              });\n            } catch (error) {\n              // ignore\n            }\n          },\n          {\n            timeout: 2000,\n          },\n        );\n      } catch (error) {\n        this._sendTabManager(tabManagerEvents.NOTIFY_ACTIVE_TAB_CALL_ACTIVE);\n        // eslint-disable-next-line no-alert\n        window.confirm(\n          i18n.getString('activeCallTip', this._deps.locale.currentLocale),\n        );\n      }\n    }\n    this._deps.evClient.sipAnswer();\n  }\n\n  private _initAudio() {\n    if (typeof document !== 'undefined' && document.createElement) {\n      this._audio = document.createElement('audio');\n    }\n  }\n\n  private _playAudioLoop(type: keyof typeof audios) {\n    this._audio.loop = true;\n    this._playAudio(type);\n  }\n\n  @runInActivityWebRTCTab()\n  private _playAudio(type: keyof typeof audios) {\n    this._audio.currentTime = 0;\n    this._audio.src = audios[type];\n    this._audio.play();\n  }\n\n  @runInActivityWebRTCTab()\n  private _stopAudio() {\n    this._audio.loop = false;\n    this._audio.pause();\n  }\n\n  private _sendTabManager(event: string, value?: any) {\n    this._deps.tabManager?.send(event, value);\n  }\n\n  bindBeforeunload() {\n    this._deps.beforeunload.add(this._beforeunloadHandler);\n  }\n\n  removeBeforeunload() {\n    this._deps.beforeunload.remove(this._beforeunloadHandler);\n  }\n}\n\nexport { EvIntegratedSoftphone };\n"],"mappings":"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","ignoreList":[]}
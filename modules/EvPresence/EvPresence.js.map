{"version":3,"file":"EvPresence.js","names":["_di","require","_core","_events","_enums","_callbackTypes","_trackEvents","_dec","_dec2","_dec3","_dec4","_dec5","_class","_class2","_descriptor","_descriptor2","_descriptor3","_descriptor4","_descriptor5","_initializerDefineProperty","e","i","r","l","Object","defineProperty","enumerable","configurable","writable","value","initializer","call","_classCallCheck","a","n","TypeError","_defineProperties","t","length","o","_toPropertyKey","key","_createClass","prototype","_toPrimitive","_typeof","Symbol","toPrimitive","String","Number","_callSuper","_getPrototypeOf","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","constructor","apply","_assertThisInitialized","ReferenceError","Boolean","valueOf","setPrototypeOf","getPrototypeOf","bind","__proto__","_inherits","create","_setPrototypeOf","_applyDecoratedDescriptor","keys","forEach","slice","reverse","reduce","_initializerWarningHelper","Error","EvPresence","exports","Module","name","deps","dep","optional","computed","that","callIds","callsMapping","otherCallIds","callLogsIds","track","analytics","recordingSetting","getRecordingSettings","agentRecording","callType","trackEvents","callInboundCallConnected","outboundCallConnected","voiceConnection","loginType","isOffhook","isOffhooking","_RcModuleV","_this","enableCache","storageKey","beforeunloadHandler","eventEmitter","_deps","evCallDataSource","evPresenceEvents","EventEmitter","showOffHookInitError","get","rawCallsMapping","setCurrentCallUii","uii","currentCallUii","_this2","map","id","filter","_this3","_this4","setDialoutStatus","status","dialoutStatus","setOffhookInit","_checkBeforeunload","setOffhookTerm","isManualOffhook","setIsManualOffhook","setOffhook","setOffhooking","offhooking","addNewCall","addNewSession","session","dropSession","removeEndedCall","endedCall","setCallHoldStatus","res","clearCalls","onInitOnce","_bindSubscription","record","pause","_this5","evSubscription","subscribe","EvCallbackTypes","OFFHOOK_INIT","data","emit","alert","danger","message","messageTypes","OFFHOOK_INIT_ERROR","EARLY_UII","OFFHOOK_TERM","OFFHOOK_TERM_ERROR","console","error","ADD_SESSION","ADD_SESSION_ERROR","DROP_SESSION","DROP_SESSION_ERROR","HOLD","HOLD_ERROR","NEW_CALL","END_CALL","evClient","encodeUii","offhookTerm","beforeunload","add","remove","dialoutStatuses","callConnected","RcModuleV2","storage","state","idle","action","getOwnPropertyDescriptor"],"sources":["modules/EvPresence/EvPresence.ts"],"sourcesContent":["import { Module } from '@ringcentral-integration/commons/lib/di';\nimport {\n  action,\n  computed,\n  RcModuleV2,\n  state,\n  storage,\n  track,\n} from '@ringcentral-integration/core';\nimport { EventEmitter } from 'events';\n\nimport type { DialoutStatusesType } from '../../enums';\nimport { dialoutStatuses, messageTypes } from '../../enums';\nimport { EvCallbackTypes } from '../../lib/EvClient/enums/callbackTypes';\nimport type {\n  EvAddSessionNotification,\n  EvAgentRecording,\n  EvBaseCall,\n  EvDropSessionNotification,\n  EvEarlyUiiResponse,\n  EvEndedCall,\n  EvHoldResponse,\n  EvOffhookInitResponse,\n  EvOffhookTermResponse,\n} from '../../lib/EvClient/interfaces';\nimport { trackEvents } from '../../lib/trackEvents';\n\nimport type { Deps, Presence } from './EvPresence.interface';\n\n@Module({\n  name: 'EvPresence',\n  deps: [\n    'EvSubscription',\n    'EvCallDataSource',\n    'EvClient',\n    'Storage',\n    'Beforeunload',\n    'Alert',\n    { dep: 'PresenceOptions', optional: true },\n  ],\n})\nclass EvPresence extends RcModuleV2<Deps> implements Presence {\n  beforeunloadHandler = () => false;\n  eventEmitter = this._deps.evCallDataSource.eventEmitter;\n\n  evPresenceEvents = new EventEmitter();\n\n  showOffHookInitError = true;\n\n  get callIds() {\n    return this._deps.evCallDataSource.callIds;\n  }\n\n  get otherCallIds() {\n    return this._deps.evCallDataSource.otherCallIds;\n  }\n\n  get callLogsIds() {\n    return this._deps.evCallDataSource.callLogsIds;\n  }\n\n  get callsMapping() {\n    return this._deps.evCallDataSource.callsMapping;\n  }\n\n  get rawCallsMapping() {\n    return this._deps.evCallDataSource.rawCallsMapping;\n  }\n\n  constructor(deps: Deps) {\n    super({\n      deps,\n      enableCache: true,\n      storageKey: 'EvPresence',\n    });\n  }\n\n  @storage\n  @state\n  currentCallUii = '';\n\n  @storage\n  @state\n  isOffhook = false;\n\n  @storage\n  @state\n  isManualOffhook = false;\n\n  @storage\n  @state\n  isOffhooking = false;\n\n  @storage\n  @state\n  dialoutStatus: DialoutStatusesType = dialoutStatuses.idle;\n\n  @action\n  setCurrentCallUii(uii: string) {\n    this.currentCallUii = uii;\n  }\n\n  @computed((that: EvPresence) => [that.callIds, that.callsMapping])\n  get calls() {\n    return this.callIds\n      .map((id) => this.callsMapping[id])\n      .filter((call) => !!call);\n  }\n\n  @computed((that: EvPresence) => [that.otherCallIds, that.callsMapping])\n  get otherCalls() {\n    return this.otherCallIds.map((id) => this.callsMapping[id]);\n  }\n\n  @computed((that: EvPresence) => [that.callLogsIds, that.callsMapping])\n  get callLogs() {\n    return this.callLogsIds.map((id) => this.callsMapping[id]);\n  }\n\n  @action\n  setDialoutStatus(status: DialoutStatusesType) {\n    if (this.dialoutStatus !== status) {\n      this.dialoutStatus = status;\n    }\n  }\n\n  @action\n  setOffhookInit() {\n    this.isOffhooking = false;\n    this.isOffhook = true;\n    this._checkBeforeunload();\n  }\n\n  @action\n  setOffhookTerm() {\n    this.isOffhooking = false;\n    this.isOffhook = false;\n    this.isManualOffhook = false;\n    this._checkBeforeunload();\n  }\n\n  @action\n  setIsManualOffhook(isManualOffhook: boolean) {\n    this.isManualOffhook = isManualOffhook;\n  }\n\n  @action\n  setOffhook(status: boolean) {\n    this.isOffhook = status;\n    this._checkBeforeunload();\n  }\n\n  @action\n  setOffhooking(offhooking: boolean) {\n    this.isOffhooking = offhooking;\n  }\n\n  @track((that: EvPresence, call: EvBaseCall) => (analytics) => {\n    const recordingSetting = that.getRecordingSettings(call.agentRecording);\n    return [\n      call.callType === 'INBOUND'\n        ? trackEvents.callInboundCallConnected\n        : trackEvents.outboundCallConnected,\n      {\n        recordingSetting,\n        voiceConnection: analytics.loginType,\n        isOffhook: that.isOffhook,\n        isOffhooking: that.isOffhooking,\n      },\n    ];\n  })\n  addNewCall(call: EvBaseCall) {\n    this._deps.evCallDataSource.addNewCall(call);\n  }\n\n  addNewSession(session: EvAddSessionNotification) {\n    this._deps.evCallDataSource.addNewSession(session);\n  }\n\n  dropSession(dropSession: EvDropSessionNotification) {\n    this._deps.evCallDataSource.dropSession(dropSession);\n  }\n\n  removeEndedCall(endedCall: EvEndedCall) {\n    this._deps.evCallDataSource.removeEndedCall(endedCall);\n  }\n\n  setCallHoldStatus(res: EvHoldResponse) {\n    this._deps.evCallDataSource.setCallHoldStatus(res);\n  }\n\n  clearCalls() {\n    this._deps.evCallDataSource.clearCalls();\n  }\n\n  override onInitOnce() {\n    this._bindSubscription();\n  }\n\n  getRecordingSettings(record: EvAgentRecording) {\n    let recordingSetting = '';\n    if (record.agentRecording) {\n      if (record.default === 'ON') {\n        if (record.pause) {\n          recordingSetting = 'Yes - Record Call (Agent Pause)';\n        } else {\n          recordingSetting = 'Agent Triggered (Default: Record)';\n        }\n      } else {\n        recordingSetting = \"Agent Triggered (Default: Don't Record)\";\n      }\n    } else if (!record.agentRecording) {\n      if (record.default === 'ON') {\n        recordingSetting = 'Yes - Record Full Call';\n      } else {\n        recordingSetting = \"No - Don't Record Call\";\n      }\n    }\n    return recordingSetting;\n  }\n\n  private _bindSubscription() {\n    this._deps.evSubscription\n      .subscribe(\n        EvCallbackTypes.OFFHOOK_INIT,\n        (data: EvOffhookInitResponse) => {\n          this.evPresenceEvents.emit(EvCallbackTypes.OFFHOOK_INIT, data);\n          if (data.status === 'OK') {\n            this.setOffhookInit();\n          } else {\n            // when that is reject integrated softphone, we not alert error\n            if (this.showOffHookInitError) {\n              this._deps.alert.danger({\n                message: messageTypes.OFFHOOK_INIT_ERROR,\n              });\n            }\n            this.setOffhookTerm();\n            this.showOffHookInitError = true;\n          }\n        },\n      )\n      .subscribe(EvCallbackTypes.EARLY_UII, (data: EvEarlyUiiResponse) => {\n        if (data.status === 'OK') {\n          this.setCurrentCallUii(data.uii);\n        }\n      })\n      .subscribe(\n        EvCallbackTypes.OFFHOOK_TERM,\n        (data: EvOffhookTermResponse) => {\n          if (data.status === 'OK') {\n            this.setOffhookTerm();\n          } else {\n            this._deps.alert.danger({\n              message: messageTypes.OFFHOOK_TERM_ERROR,\n            });\n            console.error(data);\n          }\n        },\n      )\n      .subscribe(EvCallbackTypes.ADD_SESSION, (data) => {\n        if (data.status === 'OK') {\n          this.addNewSession(data);\n        } else {\n          this._deps.alert.danger({\n            message: messageTypes.ADD_SESSION_ERROR,\n          });\n        }\n      })\n      .subscribe(EvCallbackTypes.DROP_SESSION, (data) => {\n        if (data.status === 'OK') {\n          this.dropSession(data);\n        } else {\n          this._deps.alert.danger({\n            message: messageTypes.DROP_SESSION_ERROR,\n          });\n        }\n      })\n      .subscribe(EvCallbackTypes.HOLD, (data) => {\n        if (data.status === 'OK') {\n          this.setCallHoldStatus(data);\n        } else {\n          this._deps.alert.danger({\n            message: messageTypes.HOLD_ERROR,\n          });\n        }\n      })\n      .subscribe(EvCallbackTypes.NEW_CALL, (data) => {\n        this.addNewCall(data);\n      })\n      .subscribe(EvCallbackTypes.END_CALL, (data) => {\n        const id = this._deps.evClient.encodeUii(data);\n        if (!this.callsMapping[id]) return;\n        if (!this.isManualOffhook) {\n          this._deps.evClient.offhookTerm();\n        }\n        this.removeEndedCall(data);\n      });\n  }\n\n  private _checkBeforeunload() {\n    if (this.isOffhook) {\n      this._deps.beforeunload.add(this.beforeunloadHandler);\n    } else {\n      this._deps.beforeunload.remove(this.beforeunloadHandler);\n    }\n  }\n\n  get isCallConnected() {\n    return this.dialoutStatus === dialoutStatuses.callConnected;\n  }\n}\n\nexport { EvPresence };\n"],"mappings":"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","ignoreList":[]}
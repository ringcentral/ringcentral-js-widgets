{"version":3,"sources":["modules/AudioSettings/getStorageReducer.ts"],"names":["getOutputDeviceIdReducer","types","state","type","devices","outputDeviceId","setData","setAvailableDevices","getUserMediaError","isDeviceExist","device","deviceId","kind","hasDefaultDevice","firstDevice","getInputDeviceIdReducer","inputDeviceId","getDialButtonVolumeReducer","dialButtonVolume","Math","min","max","getDialButtonMutedReducer","dialButtonMuted","getRingtoneVolumeReducer","ringtoneVolume","getRingtoneMutedReducer","ringtoneMuted","getCallVolumeReducer","callVolume","getHasAutoPromptedReducer","autoPrompted","getStorageReducer","hasAutoPrompted"],"mappings":"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","sourcesContent":["import { find } from 'ramda';\nimport { combineReducers } from 'redux';\n\nfunction getOutputDeviceIdReducer(types) {\n  return (\n    state = 'default',\n    { type, devices = [], outputDeviceId = state },\n  ) => {\n    switch (type) {\n      case types.setData: {\n        return outputDeviceId;\n      }\n      case types.setAvailableDevices:\n      case types.getUserMediaError: {\n        const isDeviceExist = find(\n          (device) =>\n            device.deviceId === state && device.kind === 'audiooutput',\n          devices,\n        );\n        if (isDeviceExist) {\n          return state;\n        }\n        // For Firefox, don't have default device id\n        const hasDefaultDevice = find(\n          (device) =>\n            device.deviceId === 'default' && device.kind === 'audiooutput',\n          devices,\n        );\n        const firstDevice = find(\n          (device) => device.kind === 'audiooutput',\n          devices,\n        );\n        if (!hasDefaultDevice && firstDevice) {\n          return firstDevice.deviceId;\n        }\n        return 'default';\n      }\n      default:\n        return state;\n    }\n  };\n}\n\nfunction getInputDeviceIdReducer(types) {\n  return (state = 'default', { type, devices = [], inputDeviceId = state }) => {\n    switch (type) {\n      case types.setData: {\n        return inputDeviceId;\n      }\n      case types.setAvailableDevices:\n      case types.getUserMediaError: {\n        if (\n          find(\n            (device) =>\n              device.deviceId === state && device.kind === 'audioinput',\n            devices,\n          )\n        ) {\n          return state;\n        }\n        // For Firefox, don't have default device id\n        const hasDefaultDevice = find(\n          (device) =>\n            device.deviceId === 'default' && device.kind === 'audioinput',\n          devices,\n        );\n        const firstDevice = find(\n          (device) => device.kind === 'audioinput',\n          devices,\n        );\n        if (!hasDefaultDevice && firstDevice) {\n          return firstDevice.deviceId;\n        }\n        return 'default';\n      }\n      default:\n        return state;\n    }\n  };\n}\n\nfunction getDialButtonVolumeReducer(types) {\n  return (state = 1, { type, dialButtonVolume = state }) => {\n    if (type === types.setData) {\n      return Math.min(1, Math.max(0, dialButtonVolume));\n    }\n    return state;\n  };\n}\nfunction getDialButtonMutedReducer(types) {\n  return (state = false, { type, dialButtonMuted = state }) => {\n    if (type === types.setData) {\n      return !!dialButtonMuted;\n    }\n    return state;\n  };\n}\nfunction getRingtoneVolumeReducer(types) {\n  return (state = 0.3, { type, ringtoneVolume = state }) => {\n    if (type === types.setData) {\n      return Math.min(1, Math.max(0, ringtoneVolume));\n    }\n    return state;\n  };\n}\nfunction getRingtoneMutedReducer(types) {\n  return (state = false, { type, ringtoneMuted = state }) => {\n    if (type === types.setData) {\n      return !!ringtoneMuted;\n    }\n    return state;\n  };\n}\nfunction getCallVolumeReducer(types) {\n  return (state = 1, { type, callVolume = state }) => {\n    if (type === types.setData) {\n      return Math.min(1, Math.max(0.1, callVolume));\n    }\n    return state;\n  };\n}\n\nexport function getHasAutoPromptedReducer(types) {\n  return (state = false, { type }) => {\n    switch (type) {\n      case types.autoPrompted:\n        return true;\n      default:\n        return state;\n    }\n  };\n}\n\nexport default function getStorageReducer(types) {\n  return combineReducers({\n    dialButtonVolume: getDialButtonVolumeReducer(types),\n    dialButtonMuted: getDialButtonMutedReducer(types),\n    ringtoneVolume: getRingtoneVolumeReducer(types),\n    ringtoneMuted: getRingtoneMutedReducer(types),\n    callVolume: getCallVolumeReducer(types),\n    outputDeviceId: getOutputDeviceIdReducer(types),\n    inputDeviceId: getInputDeviceIdReducer(types),\n    hasAutoPrompted: getHasAutoPromptedReducer(types),\n  });\n}\n"],"file":"getStorageReducer.js"}
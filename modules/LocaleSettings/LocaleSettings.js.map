{"version":3,"file":"LocaleSettings.js","names":["_core","require","_i18n","_di","_proxify","_dec","_class","_class2","_descriptor","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","args","arguments","apply","err","undefined","_initializerDefineProperty","target","property","descriptor","context","Object","defineProperty","enumerable","configurable","writable","initializer","call","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","i","length","_toPropertyKey","_createClass","protoProps","staticProps","prototype","_toPrimitive","_typeof","String","input","hint","prim","Symbol","toPrimitive","res","Number","_inherits","subClass","superClass","create","constructor","_setPrototypeOf","o","p","setPrototypeOf","bind","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","_possibleConstructorReturn","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","_applyDecoratedDescriptor","decorators","desc","keys","forEach","slice","reverse","reduce","decorator","_initializerWarningHelper","Error","LocaleSettings","Module","name","deps","dep","optional","_RcModuleV","_super","_this$_deps$localeSet","_this$_deps$localeSet2","_this","enableGlobalCache","storageKey","_supportedLocales","supportedLocales","_deps","localeSettingsOptions","DEFAULT_LOCALE","sort","_saveLocale","locale","savedLocale","_onInit","regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","saveLocale","currentLocale","setLocale","stop","onInit","_saveLocale2","_callee2","_callee2$","_context2","_x","RcModuleV2","globalStorage","state","action","getOwnPropertyDescriptor","proxify","exports"],"sources":["modules/LocaleSettings/LocaleSettings.ts"],"sourcesContent":["import {\n  action,\n  globalStorage,\n  RcModuleV2,\n  state,\n} from '@ringcentral-integration/core';\nimport { DEFAULT_LOCALE } from '@ringcentral-integration/i18n';\n\nimport { Module } from '../../lib/di';\nimport { proxify } from '../../lib/proxy/proxify';\nimport type { Deps } from './LocaleSettings.interface';\n\n@Module({\n  name: 'LocaleSettings',\n  deps: [\n    'GlobalStorage',\n    'Locale',\n    { dep: 'LocaleSettingsOptions', optional: true },\n  ],\n})\nexport class LocaleSettings extends RcModuleV2<Deps> {\n  protected _supportedLocales: string[];\n  public supportedLocales: string[];\n\n  constructor(deps: Deps) {\n    super({\n      deps,\n      enableGlobalCache: true,\n      storageKey: 'LocaleSettings',\n    });\n    this._supportedLocales = this._deps.localeSettingsOptions\n      ?.supportedLocales ?? [DEFAULT_LOCALE];\n    this.supportedLocales = this._supportedLocales.slice().sort();\n  }\n\n  @globalStorage\n  @state\n  savedLocale: string = null;\n\n  @action\n  protected _saveLocale(locale: string) {\n    this.savedLocale = locale;\n  }\n\n  override async onInit() {\n    if (!this.savedLocale) {\n      this.saveLocale(this._deps.locale.currentLocale);\n    } else if (this.savedLocale !== this._deps.locale.currentLocale) {\n      await this._deps.locale.setLocale(this.savedLocale);\n    }\n  }\n\n  @proxify\n  async saveLocale(locale: string) {\n    await this._deps.locale.setLocale(locale);\n    this._saveLocale(locale);\n  }\n}\n"],"mappings":"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"}
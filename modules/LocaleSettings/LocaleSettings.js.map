{"version":3,"file":"LocaleSettings.js","names":["_core","require","_i18n","_di","_proxify","_dec","_class","_class2","_descriptor","asyncGeneratorStep","n","t","e","r","o","a","c","i","u","value","done","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_initializerDefineProperty","l","Object","defineProperty","enumerable","configurable","writable","initializer","call","_classCallCheck","TypeError","_defineProperties","length","_toPropertyKey","key","_createClass","prototype","_toPrimitive","_typeof","Symbol","toPrimitive","String","Number","_inherits","create","constructor","_setPrototypeOf","setPrototypeOf","bind","__proto__","_createSuper","_isNativeReflectConstruct","_getPrototypeOf","s","Reflect","construct","_possibleConstructorReturn","_assertThisInitialized","ReferenceError","Boolean","valueOf","getPrototypeOf","_applyDecoratedDescriptor","keys","forEach","slice","reverse","reduce","_initializerWarningHelper","Error","LocaleSettings","Module","name","deps","dep","optional","_RcModuleV","_super","_this$_deps$localeSet","_this$_deps$localeSet2","_this","enableGlobalCache","storageKey","_supportedLocales","supportedLocales","_deps","localeSettingsOptions","DEFAULT_LOCALE","sort","_saveLocale","locale","savedLocale","_onInit","regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","saveLocale","currentLocale","setLocale","stop","onInit","_saveLocale2","_callee2","_callee2$","_context2","_x","RcModuleV2","globalStorage","state","action","getOwnPropertyDescriptor","proxify","exports"],"sources":["modules/LocaleSettings/LocaleSettings.ts"],"sourcesContent":["import {\n  action,\n  globalStorage,\n  RcModuleV2,\n  state,\n} from '@ringcentral-integration/core';\nimport { DEFAULT_LOCALE } from '@ringcentral-integration/i18n';\n\nimport { Module } from '../../lib/di';\nimport { proxify } from '../../lib/proxy/proxify';\n\nimport type { Deps } from './LocaleSettings.interface';\n\n@Module({\n  name: 'LocaleSettings',\n  deps: [\n    'GlobalStorage',\n    'Locale',\n    { dep: 'LocaleSettingsOptions', optional: true },\n  ],\n})\nexport class LocaleSettings extends RcModuleV2<Deps> {\n  protected _supportedLocales: string[];\n  public supportedLocales: string[];\n\n  constructor(deps: Deps) {\n    super({\n      deps,\n      enableGlobalCache: true,\n      storageKey: 'LocaleSettings',\n    });\n    this._supportedLocales = this._deps.localeSettingsOptions\n      ?.supportedLocales ?? [DEFAULT_LOCALE];\n    this.supportedLocales = this._supportedLocales.slice().sort();\n  }\n\n  @globalStorage\n  @state\n  // @ts-expect-error TS(2322): Type 'null' is not assignable to type 'string'.\n  savedLocale: string = null;\n\n  @action\n  protected _saveLocale(locale: string) {\n    this.savedLocale = locale;\n  }\n\n  override async onInit() {\n    if (!this.savedLocale) {\n      this.saveLocale(this._deps.locale.currentLocale);\n    } else if (this.savedLocale !== this._deps.locale.currentLocale) {\n      await this._deps.locale.setLocale(this.savedLocale);\n    }\n  }\n\n  @proxify\n  async saveLocale(locale: string) {\n    await this._deps.locale.setLocale(locale);\n    this._saveLocale(locale);\n  }\n}\n"],"mappings":"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","ignoreList":[]}
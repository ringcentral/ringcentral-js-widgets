{"version":3,"sources":["modules/DateTimeFormatV2/DateTimeFormat.ts"],"names":["DateTimeFormat","name","deps","dep","optional","_formatters","_defaultFormatter","setDefaultFormatter","store","subscribe","formatter","Error","utcTimestamp","locale","_deps","currentLocale","type","formatDateTime","RcModuleV2"],"mappings":"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","sourcesContent":["import { RcModuleV2 } from '@ringcentral-integration/core';\n\nimport { Module } from '../../lib/di';\nimport getIntlDateTimeFormatter, {\n  DateTimeFormatter,\n} from '../../lib/getIntlDateTimeFormatter';\nimport {\n  AddFormatterOptions,\n  Deps,\n  FormatDateTimeOptions,\n  FormatOptions,\n} from './DateTimeFormat.interface';\n\n@Module({\n  name: 'DateTimeFormat',\n  deps: ['Locale', { dep: 'DateTimeFormatOptions', optional: true }],\n})\nexport class DateTimeFormat extends RcModuleV2<Deps> {\n  public _formatters: Record<string, DateTimeFormatter> = {};\n  protected _defaultFormatter?: DateTimeFormatter;\n\n  constructor(deps: Deps) {\n    super({\n      deps,\n    });\n  }\n\n  setDefaultFormatter() {\n    if (!this._defaultFormatter) {\n      this._defaultFormatter = getIntlDateTimeFormatter();\n    }\n  }\n\n  onInit() {\n    this.setDefaultFormatter();\n  }\n\n  initializeProxy() {\n    this.store.subscribe(() => {\n      this.setDefaultFormatter();\n    });\n  }\n\n  onReset() {\n    this._formatters = {};\n  }\n\n  addFormatter({ name, formatter }: AddFormatterOptions) {\n    if (!name) {\n      throw new Error('`name` property cannot be empty.');\n    }\n    if (this._formatters[name]) {\n      throw new Error(\n        `A formatter with the same name: ${name} already exists.`,\n      );\n    }\n    if (typeof formatter !== 'function') {\n      throw new Error('formatter must be a function.');\n    }\n    this._formatters[name] = formatter;\n  }\n\n  formatDateTime({\n    name,\n    utcTimestamp,\n    locale = this._deps.locale.currentLocale,\n    type,\n  }: Partial<FormatDateTimeOptions>) {\n    if (name && typeof this._formatters[name] === 'function') {\n      return this._formatters[name]({\n        utcTimestamp,\n        locale,\n        type,\n      });\n    }\n    return this._defaultFormatter({\n      utcTimestamp,\n      locale,\n      type,\n    });\n  }\n\n  formatDate({ name, utcTimestamp, locale }: FormatOptions) {\n    return this.formatDateTime({\n      name,\n      utcTimestamp,\n      locale,\n      type: 'date',\n    });\n  }\n\n  formatTime({ name, utcTimestamp, locale }: FormatOptions) {\n    return this.formatDateTime({\n      name,\n      utcTimestamp,\n      locale,\n      type: 'time',\n    });\n  }\n}\n"],"file":"DateTimeFormat.js"}
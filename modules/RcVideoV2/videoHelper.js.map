{"version":3,"sources":["modules/RcVideoV2/videoHelper.ts"],"names":["meetingProviderTypes","meeting","video","RcVideoTypes","call","RCV_CREATE_API_KEYS","RCV_WAITING_ROOM_API_KEYS","RCV_E2EE_API_KEYS","RCV_PREFERENCES_IDS","RCV_PREFERENCES_KEYS","RCV_E2EE_RELATED_KEYS","RCV_E2EE_DEFAULT_SECURITY_OPTIONS","allowJoinBeforeHost","isMeetingSecret","isOnlyAuthUserJoin","isOnlyCoworkersJoin","waitingRoomMode","RCV_WAITING_ROOM_MODE","notcoworker","getDefaultChars","DEFAULT_PASSWORD_CHARSET","validateRandomPassword","pwd","test","generateRandomPassword","length","charset","charLen","retVal","i","charAt","Math","floor","random","validatePasswordSettings","meetingPassword","RCV_PASSWORD_REGEX","getVideoSettings","data","name","params","settings","type","expiresIn","getDefaultVideoSettings","topic","accountId","extensionId","e2ee","muteAudio","muteVideo","allowScreenSharing","off","settingLock","startTime","Date","duration","saveAsDefault","isMeetingPasswordValid","usePersonalMeetingId","getTopic","extensionName","brandName","shortName","rcvMeetingTopic","pruneMeetingObject","omitArr","meetingDetail","forEach","condition","key","transformPreferences","preferences","isInstantMeeting","join_before_host","password_instant","password_scheduled","guest_join","join_authenticated_from_account_only","screen_sharing_host_only","waiting_room","waiting_room_guests_only","transformSettingLocks","settingLocks","reversePreferences","result","RCV_WAITING_ROOM_MODE_REVERSE","prunePreferencesObject","comparePreferences","preferencesChanged","Object","keys","settingKey","assignValue","a","b","assignObject","getLockedPreferences","lockedPreferences","entries","locked","getAvaliableWaitingRoomOpions","all","patchWaitingRoomRelated","isUpdatingMode","processedSettings","includes","formatMainPhoneNumber","dialInNumber","undefined","phoneNumber","formatPremiumNumbers","obj","locationField","country","location","formatRcvInvitationRequestData","numbers","dialInNumbers","map","item","number","unformattedNumber","joinUriInfo","joinUri","split","parameters","meetingName","hostName","meetingId","shortId","isSIPAvailable","participantCode","entryPoint","$Brand_Id","brandId","$Extension_FormattingLocaleCode","currentLocale","$Extension_LanguageLocaleCode","isE2eeEnabled","password","dialInPassword","meetingPasswordPSTN","maskedPassword","meetingPasswordMasked","notificationId","plainTextPreferred","isolatedMode","toPairs","parameterName","parameterValue"],"mappings":"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","sourcesContent":["import formatMessage from 'format-message';\nimport { map, omit, pick, pipe, toPairs, filter } from 'ramda';\n\nimport {\n  MeetingProviderTypesProps,\n  RcVDialInNumberObj,\n  RcvGSuiteMeetingModel,\n  RcVideoAPI,\n  RcVideoTypesProps,\n  RcvInvitationRequest,\n  RcVMeetingModel,\n  RcVPreferences,\n  RcVPreferencesGET,\n  RcVSettingId,\n  RcVSettingKey,\n  RcVSettingLocks,\n  RcVSettingLocksGET,\n} from '../../interfaces/Rcv.model';\nimport {\n  RCV_E2EE_API_KEYS,\n  RCV_PASSWORD_REGEX,\n  RCV_WAITING_ROOM_API_KEYS,\n  RCV_WAITING_ROOM_MODE,\n  RCV_WAITING_ROOM_MODE_REVERSE,\n} from './constants';\nimport { TopicProps } from './RcVideo.interface';\n\n/* TODO: this meetingProviderTypes is only used for calender-addon\n * if you want to use meetingProviderTypes\n * please turn to use MeetingProvider/interface\n */\nconst meetingProviderTypes: MeetingProviderTypesProps = {\n  meeting: 'RCMeetings',\n  video: 'RCVideo',\n};\n\nconst RcVideoTypes: RcVideoTypesProps = {\n  meeting: 0, // schedule\n  call: 1, // instant meeting\n};\n\nconst RCV_CREATE_API_KEYS: Array<keyof RcVideoAPI> = [\n  'name',\n  'type',\n  'startTime',\n  'expiresIn',\n  'duration',\n  'accountId',\n  'extensionId',\n  'allowJoinBeforeHost',\n  'muteAudio',\n  'muteVideo',\n  'isMeetingSecret',\n  'meetingPassword',\n  'isOnlyAuthUserJoin',\n  'isOnlyCoworkersJoin',\n  'allowScreenSharing',\n  RCV_WAITING_ROOM_API_KEYS,\n  RCV_E2EE_API_KEYS,\n];\n\nconst RCV_PREFERENCES_IDS: Array<RcVSettingId> = [\n  'e2ee',\n  'join_before_host',\n  // 'join_video_off',\n  // 'join_audio_mute',\n  'password_scheduled',\n  'password_instant',\n  'guest_join',\n  'join_authenticated_from_account_only',\n  'screen_sharing_host_only',\n  'waiting_room_guests_only',\n  'waiting_room',\n];\n\nconst RCV_PREFERENCES_KEYS: Array<RcVSettingKey> = [\n  'allowJoinBeforeHost',\n  // 'muteVideo',\n  // 'muteAudio',\n  'isMeetingSecret',\n  'isOnlyAuthUserJoin',\n  'isOnlyCoworkersJoin',\n  'allowScreenSharing',\n  RCV_WAITING_ROOM_API_KEYS,\n  RCV_E2EE_API_KEYS,\n];\n\nconst RCV_E2EE_RELATED_KEYS: Array<RcVSettingKey> = [\n  'allowJoinBeforeHost',\n  'isMeetingSecret',\n  'isOnlyAuthUserJoin',\n  'isOnlyCoworkersJoin',\n  RCV_WAITING_ROOM_API_KEYS,\n];\n\nconst RCV_E2EE_DEFAULT_SECURITY_OPTIONS: Partial<RcVideoAPI> = {\n  allowJoinBeforeHost: false,\n  isMeetingSecret: true,\n  isOnlyAuthUserJoin: true,\n  isOnlyCoworkersJoin: false,\n  waitingRoomMode: RCV_WAITING_ROOM_MODE.notcoworker,\n} as const;\n\n/* RCINT-14566\n * Exclude characters that are hard to visually differentiate [\"0\", \"o\", \"O\", \"I\", \"l\"]\n */\nfunction getDefaultChars(): string {\n  const DEFAULT_PASSWORD_CHARSET =\n    'abcdefghijkmnpqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ123456789';\n  return DEFAULT_PASSWORD_CHARSET;\n}\n\nfunction validateRandomPassword(pwd: string): boolean {\n  return /^(?=.*\\d)(?=.*[A-Z])(?=.*[a-z])[A-Za-z0-9]*$/.test(pwd);\n}\n\nfunction generateRandomPassword(length: number = 10): string {\n  const charset = getDefaultChars();\n  const charLen = charset.length;\n  let retVal = '';\n  for (let i = 0; i < length; i++) {\n    retVal += charset.charAt(Math.floor(Math.random() * charLen));\n  }\n  if (!validateRandomPassword(retVal)) {\n    return generateRandomPassword(length);\n  }\n  return retVal;\n}\n\nfunction validatePasswordSettings(\n  meetingPassword: string,\n  isMeetingSecret: boolean,\n): boolean {\n  if (!isMeetingSecret) {\n    return true;\n  }\n  if (meetingPassword && RCV_PASSWORD_REGEX.test(meetingPassword)) {\n    return true;\n  }\n  return false;\n}\n\n// gsuite\nfunction getVideoSettings(data: RcVideoAPI): RcvGSuiteMeetingModel {\n  const {\n    name = 'Scheduled meeting',\n    isMeetingSecret,\n    meetingPassword,\n    ...params\n  } = data;\n  const settings: RcvGSuiteMeetingModel = {\n    ...params,\n    name,\n    type: RcVideoTypes.meeting,\n    expiresIn: 31536000,\n  };\n\n  if (isMeetingSecret) {\n    settings.isMeetingSecret = true;\n    settings.meetingPassword = meetingPassword;\n  } else {\n    settings.isMeetingSecret = false;\n    settings.meetingPassword = '';\n  }\n\n  return settings;\n}\n\nfunction getDefaultVideoSettings({\n  topic,\n  accountId,\n  extensionId,\n}: {\n  topic: string;\n  accountId: string;\n  extensionId: string;\n}): RcVMeetingModel {\n  return {\n    // api fields\n    accountId,\n    extensionId,\n    name: topic,\n    type: RcVideoTypes.meeting,\n    expiresIn: 31536000,\n    e2ee: false,\n    allowJoinBeforeHost: false,\n    muteAudio: false,\n    muteVideo: false,\n    isMeetingSecret: true,\n    meetingPassword: '',\n    isOnlyAuthUserJoin: false,\n    isOnlyCoworkersJoin: false,\n    allowScreenSharing: true,\n    waitingRoomMode: RCV_WAITING_ROOM_MODE.off,\n    settingLock: {\n      allowJoinBeforeHost: false,\n      // muteVideo: false,\n      // muteAudio: false,\n      isMeetingSecret: false,\n      isOnlyAuthUserJoin: false,\n      isOnlyCoworkersJoin: false,\n      allowScreenSharing: false,\n      waitingRoomMode: false,\n      e2ee: false,\n    },\n    // ui fields\n    startTime: new Date(),\n    duration: 60,\n    saveAsDefault: false,\n    isMeetingPasswordValid: false,\n    usePersonalMeetingId: false,\n  };\n}\n\nfunction getTopic({\n  extensionName,\n  brandName,\n  shortName,\n  rcvMeetingTopic,\n}: TopicProps) {\n  return formatMessage(rcvMeetingTopic, {\n    extensionName,\n    shortName,\n    brandName,\n  });\n}\n\n/**\n * Remove client side properties before sending to RCV API\n */\nfunction pruneMeetingObject(\n  meeting: RcVMeetingModel,\n  omitArr: Array<{\n    condition: boolean;\n    key: keyof RcVideoAPI;\n  }>,\n): RcVideoAPI {\n  let meetingDetail = pick(RCV_CREATE_API_KEYS, meeting);\n  omitArr.forEach(({ condition, key }) => {\n    if (!condition) {\n      meetingDetail = omit([key], meetingDetail) as RcVideoAPI;\n    }\n  });\n  return meetingDetail;\n}\n\nfunction transformPreferences(\n  preferences: RcVPreferencesGET,\n  isInstantMeeting = false,\n): RcVPreferences {\n  return {\n    allowJoinBeforeHost: preferences.join_before_host,\n    // muteVideo: preferences.join_video_off,\n    // muteAudio: preferences.join_audio_mute,\n    e2ee: preferences.e2ee,\n    isMeetingSecret: isInstantMeeting\n      ? preferences.password_instant\n      : preferences.password_scheduled,\n    isOnlyAuthUserJoin: preferences.guest_join,\n    isOnlyCoworkersJoin: preferences.guest_join\n      ? preferences.join_authenticated_from_account_only === 'only_co_workers'\n      : false,\n    allowScreenSharing: preferences.screen_sharing_host_only === 'all',\n    waitingRoomMode: preferences.waiting_room\n      ? RCV_WAITING_ROOM_MODE[preferences.waiting_room_guests_only]\n      : RCV_WAITING_ROOM_MODE.off,\n  };\n}\n\nfunction transformSettingLocks(\n  settingLocks: RcVSettingLocksGET,\n  isInstantMeeting = false,\n): RcVSettingLocks {\n  return {\n    allowJoinBeforeHost: settingLocks.join_before_host,\n    // muteVideo: settingLocks.join_video_off,\n    // muteAudio: settingLocks.join_audio_mute,\n    e2ee: settingLocks.e2ee,\n    isMeetingSecret: isInstantMeeting\n      ? settingLocks.password_instant\n      : settingLocks.password_scheduled,\n    isOnlyAuthUserJoin: settingLocks.guest_join,\n    isOnlyCoworkersJoin: settingLocks.join_authenticated_from_account_only,\n    allowScreenSharing: settingLocks.screen_sharing_host_only,\n    waitingRoomMode: settingLocks.waiting_room,\n  };\n}\n\nfunction reversePreferences(\n  preferences: RcVPreferences,\n  isInstantMeeting = false,\n): Partial<RcVPreferencesGET> {\n  const result: Partial<RcVPreferencesGET> = {\n    join_before_host: preferences.allowJoinBeforeHost,\n    // join_video_off: preferences.muteVideo,\n    // join_audio_mute: preferences.muteAudio,\n    guest_join: preferences.isOnlyAuthUserJoin,\n    join_authenticated_from_account_only: preferences.isOnlyCoworkersJoin\n      ? 'only_co_workers'\n      : 'anyone_signed_into_rc',\n    screen_sharing_host_only: preferences.allowScreenSharing ? 'all' : 'host',\n    waiting_room: !!preferences.waitingRoomMode,\n    waiting_room_guests_only:\n      RCV_WAITING_ROOM_MODE_REVERSE[preferences.waitingRoomMode],\n    e2ee: preferences.e2ee,\n  };\n  if (isInstantMeeting) {\n    result.password_instant = preferences.isMeetingSecret;\n  } else {\n    result.password_scheduled = preferences.isMeetingSecret;\n  }\n  return result;\n}\n\n/**\n * Reserve only preferences fields\n */\nfunction prunePreferencesObject(meeting: RcVMeetingModel): RcVPreferences {\n  return pick(RCV_PREFERENCES_KEYS, meeting);\n}\n\nfunction comparePreferences(\n  preferences: RcVPreferences,\n  meeting: RcVMeetingModel,\n): boolean {\n  let preferencesChanged = false;\n  if (preferences && meeting) {\n    for (const key of Object.keys(preferences)) {\n      const settingKey = key as RcVSettingKey;\n      if (preferences[settingKey] !== meeting[settingKey]) {\n        preferencesChanged = true;\n        break;\n      }\n    }\n  }\n  return preferencesChanged;\n}\n\nfunction assignValue<T, K extends keyof T>(a: T, b: T, key: K) {\n  a[key] = b[key];\n}\n\nfunction assignObject<T, P extends T[K], K extends keyof T>(\n  a: T,\n  b: P,\n  key: K,\n) {\n  a[key] = b;\n}\n\nfunction getLockedPreferences(\n  settingLocks: RcVSettingLocks,\n  preferences: RcVPreferences,\n): Partial<RcVPreferences> {\n  const lockedPreferences: Partial<RcVPreferences> = {};\n  for (const [key, locked] of Object.entries(settingLocks)) {\n    if (locked) {\n      const settingKey = key as RcVSettingKey;\n      assignValue(lockedPreferences, preferences, settingKey);\n    }\n  }\n  return lockedPreferences;\n}\n\nfunction getAvaliableWaitingRoomOpions(\n  isOnlyCoworkersJoin: boolean,\n): Array<number> {\n  return isOnlyCoworkersJoin\n    ? [RCV_WAITING_ROOM_MODE.off, RCV_WAITING_ROOM_MODE.all]\n    : [\n        RCV_WAITING_ROOM_MODE.off,\n        RCV_WAITING_ROOM_MODE.all,\n        RCV_WAITING_ROOM_MODE.notcoworker,\n      ];\n}\n\nfunction patchWaitingRoomRelated(\n  settings: RcVMeetingModel,\n  { waitingRoomMode }: RcVPreferences,\n  isUpdatingMode: boolean = false,\n): Partial<RcVMeetingModel> {\n  const processedSettings: Partial<RcVMeetingModel> = {};\n  if (settings.isOnlyAuthUserJoin) {\n    // for pmi setting, waitingRoom, joinAfterMe option maybe not avaliable\n    if (\n      !getAvaliableWaitingRoomOpions(settings.isOnlyCoworkersJoin).includes(\n        settings.waitingRoomMode,\n      )\n    ) {\n      processedSettings.waitingRoomMode = isUpdatingMode\n        ? RCV_WAITING_ROOM_MODE.all\n        : waitingRoomMode;\n    }\n  }\n  // when waitingRoom is 'everyone', joinAfterMe should be always checked\n  if (\n    (processedSettings.waitingRoomMode === RCV_WAITING_ROOM_MODE.all ||\n      settings.waitingRoomMode === RCV_WAITING_ROOM_MODE.all) &&\n    settings.allowJoinBeforeHost\n  ) {\n    processedSettings.allowJoinBeforeHost = false;\n  }\n  return processedSettings;\n}\n\nfunction formatMainPhoneNumber(\n  dialInNumber: string | RcVDialInNumberObj[],\n): string {\n  if (typeof dialInNumber === 'string') {\n    return dialInNumber;\n  }\n\n  if (!dialInNumber || dialInNumber.length === 0) {\n    return undefined;\n  }\n\n  return dialInNumber[0].phoneNumber;\n}\n\nfunction formatPremiumNumbers(\n  dialInNumber: string | RcVDialInNumberObj[],\n): string[] {\n  if (typeof dialInNumber === 'string') {\n    return [dialInNumber];\n  }\n\n  if (!dialInNumber || dialInNumber.length === 0) {\n    return [];\n  }\n\n  return map((obj) => {\n    const locationField =\n      obj?.country?.name && obj.location\n        ? `${obj.country.name} (${obj.location})`\n        : obj?.country?.name || '';\n\n    return `${obj.phoneNumber} ${locationField}`;\n  }, dialInNumber);\n}\n\nconst formatRcvInvitationRequestData = (params: RcvInvitationRequest) => {\n  // format number\n  const numbers = params.dialInNumbers.map((item) => {\n    return {\n      number: item.phoneNumber,\n      unformattedNumber: item.phoneNumber,\n      country: item.country.name,\n      default: item.default,\n      location: item.location,\n    };\n  });\n  const joinUriInfo = params.joinUri?.split(`/join/`) || [];\n  // format request data\n  const parameters = {\n    numbers,\n    meetingName: `---`,\n    hostName: params.hostName,\n    meetingId: params.shortId,\n    isSIPAvailable: params.isSIPAvailable,\n    participantCode: params.shortId,\n    brandName: params.brandName,\n    entryPoint: joinUriInfo[0],\n    $Brand_Id: params.brandId,\n    $Extension_FormattingLocaleCode: params.currentLocale,\n    $Extension_LanguageLocaleCode: params.currentLocale,\n    isE2eeEnabled: !!params.e2ee,\n    password: params.isMeetingSecret ? params.meetingPassword : undefined,\n    dialInPassword: params.isMeetingSecret\n      ? params.meetingPasswordPSTN\n      : undefined,\n    maskedPassword: params.isMeetingSecret\n      ? params.meetingPasswordMasked\n      : undefined,\n  };\n  return {\n    notificationId: 'meetingInvite',\n    plainTextPreferred: true,\n    isolatedMode: true,\n    parameters: pipe(\n      toPairs,\n      map(([parameterName, parameterValue]) => ({\n        parameterName,\n        parameterValue,\n      })),\n      filter(\n        (item: { parameterName: string; parameterValue: any }) =>\n          item.parameterValue !== undefined,\n      ),\n    )(parameters),\n  };\n};\n\n// TODO: will remove this when google app script could support export seperately\n// export together because google app script not fully support export\nexport {\n  assignObject,\n  comparePreferences,\n  formatMainPhoneNumber,\n  formatPremiumNumbers,\n  generateRandomPassword,\n  getDefaultChars,\n  getDefaultVideoSettings,\n  getLockedPreferences,\n  getTopic,\n  getVideoSettings,\n  meetingProviderTypes,\n  patchWaitingRoomRelated,\n  pruneMeetingObject,\n  prunePreferencesObject,\n  RCV_E2EE_DEFAULT_SECURITY_OPTIONS,\n  RCV_E2EE_RELATED_KEYS,\n  RCV_PREFERENCES_IDS,\n  RCV_PREFERENCES_KEYS,\n  RcVideoTypes,\n  reversePreferences,\n  transformPreferences,\n  transformSettingLocks,\n  validatePasswordSettings,\n  validateRandomPassword,\n  formatRcvInvitationRequestData,\n};\n"],"file":"videoHelper.js"}
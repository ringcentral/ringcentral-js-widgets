{"version":3,"sources":["modules/Feedback/index.js"],"names":["Feedback","deps","auth","storage","options","actionTypes","_auth","_storageKey","_storage","_reducer","_cacheReducer","registerReducer","key","reducer","store","subscribe","_onStateChange","ready","dispatch","type","initSuccess","resetSuccess","email","updateEmail","value","topic","updateTopic","subjectText","updateSubject","descriptionText","updateDescription","clean","mailToUrl","window","location","href","state","status","moduleStatuses","getItem","data","subject","description","RcModule","proxify"],"mappings":"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","file":"index.js","sourcesContent":["import { Module } from '../../lib/di';\nimport RcModule from '../../lib/RcModule';\nimport getFeedbackReducer from './getFeedbackReducer';\nimport getCacheReducer from './getCacheReducer';\nimport actionTypes from './actionTypes';\nimport moduleStatuses from '../../enums/moduleStatuses';\nimport proxify from '../../lib/proxy/proxify';\n\n/**\n * @class\n * @description user feedback module\n */\n@Module({\n  deps: [\n    'Auth',\n    'Storage',\n  ]\n})\n\nexport default class Feedback extends RcModule {\n  /**\n   * @constructor\n   * @param {Object} params - params object\n   * @param {Auth} params.auth - auth module instance\n   * @param {Storage} params.storage - storage module instance\n   */\n  constructor({\n    auth,\n    storage,\n    ...options,\n  }) {\n    super({\n      ...options,\n      actionTypes\n    });\n    this._auth = auth;\n    this._storageKey = 'feedback';\n    this._storage = storage;\n    this._reducer = getFeedbackReducer(this.actionTypes);\n    this._cacheReducer = getCacheReducer(this.actionTypes);\n    this._storage.registerReducer({ key: this._storageKey, reducer: this._cacheReducer });\n  }\n  initialize() {\n    this.store.subscribe(() => this._onStateChange());\n  }\n  _onStateChange() {\n    if (this._auth.ready && this._storage.ready && !this.ready) {\n      this.store.dispatch({\n        type: this.actionTypes.initSuccess\n      });\n    } else if ((!this._auth.ready || !this._storage.ready) && this.ready) {\n      this.store.dispatch({\n        type: this.actionTypes.resetSuccess\n      });\n    }\n  }\n\n  @proxify\n  updateEmail(email) {\n    this.store.dispatch({\n      type: this.actionTypes.updateEmail,\n      value: email,\n    });\n  }\n\n  @proxify\n  updateTopic(topic) {\n    this.store.dispatch({\n      type: this.actionTypes.updateTopic,\n      value: topic,\n    });\n  }\n\n  @proxify\n  updateSubject(subjectText) {\n    this.store.dispatch({\n      type: this.actionTypes.updateSubject,\n      value: subjectText,\n    });\n  }\n\n  @proxify\n  updateDescription(descriptionText) {\n    this.store.dispatch({\n      type: this.actionTypes.updateDescription,\n      value: descriptionText,\n    });\n  }\n\n  @proxify\n  clean() {\n    this.store.dispatch({\n      type: this.actionTypes.clean\n    });\n  }\n\n  @proxify\n  sendFeedback(mailToUrl) {\n    window.location.href = mailToUrl;\n  }\n\n  get ready() {\n    return this.state.status === moduleStatuses.ready;\n  }\n\n  get data() {\n    return this._storage.getItem(this._storageKey);\n  }\n\n  get email() {\n    return this.data.email;\n  }\n\n  get topic() {\n    return this.data.topic;\n  }\n\n  get subject() {\n    return this.data.subject;\n  }\n\n  get description() {\n    return this.data.description;\n  }\n}\n"]}
{"version":3,"sources":["modules/EvManualDialSettingsUI/EvManualDialSettingsUI.ts"],"names":["EvManualDialSettingsUI","name","deps","that","_deps","evAuth","callerIds","evCall","formGroup","dialoutCallerId","availableQueues","dialoutQueueId","availableCountries","dialoutCountryId","queue","country","callerId","dialoutRingTime","ringTimeLimit","agentPermissions","allowManualOutboundGates","allowManualIntlCalls","locale","currentLocale","_renderProps","value","routerInteraction","push","text","toLowerCase","includes","props","settingFields","init","resetForm","goBack","_navigateToDialer","save","saveForm","find","number","gateId","countryId","dataSign","onChange","_validate","setFormGroup","select","label","i18n","getString","required","options","getItemValue","itemRenderer","renderCallerIdLabel","renderValue","description","searchOption","_searchMethod","gateName","renderQueueLabel","countryName","onBlur","checkDialoutRingTime","input","type","placeholder","RcUIModuleV2"],"mappings":"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","sourcesContent":["import { Module } from '@ringcentral-integration/commons/lib/di';\nimport { computed, RcUIModuleV2 } from '@ringcentral-integration/core';\n\nimport { QueueLabelProps } from '../../components/ManualDialSettingsPanel/QueueLabel';\nimport {\n  EvManualDialSettingsUIFunctions,\n  EvManualDialSettingsUIProps,\n} from '../../interfaces/EvManualDialSettingsUI.interface';\nimport {\n  EvAvailableCountry,\n  EvAvailableQueue,\n  EvCallerId,\n} from '../../lib/EvClient';\nimport {\n  Deps,\n  EvManualDialSettingsRenderProps,\n  ManualDialSettingsUI,\n} from './EvManualDialSettingsUI.interface';\nimport i18n from './i18n';\n\n@Module({\n  name: 'EvManualDialSettingsUI',\n  deps: ['Locale', 'RouterInteraction', 'EvCall', 'EvAuth'],\n})\nclass EvManualDialSettingsUI\n  extends RcUIModuleV2<Deps>\n  implements ManualDialSettingsUI\n{\n  private _renderProps: EvManualDialSettingsRenderProps;\n\n  constructor(deps: Deps) {\n    super({\n      deps,\n    });\n  }\n\n  @computed((that: EvManualDialSettingsUI) => [\n    that._deps.evAuth.callerIds,\n    that._deps.evCall.formGroup.dialoutCallerId,\n  ])\n  get callerId() {\n    return this._deps.evAuth.callerIds.find(\n      ({ number }) => number === this._deps.evCall.formGroup.dialoutCallerId,\n    );\n  }\n\n  @computed((that: EvManualDialSettingsUI) => [\n    that._deps.evAuth.availableQueues,\n    that._deps.evCall.formGroup.dialoutQueueId,\n  ])\n  get queue() {\n    return this._deps.evAuth.availableQueues.find(\n      (queue) => queue.gateId === this._deps.evCall.formGroup.dialoutQueueId,\n    );\n  }\n\n  @computed((that: EvManualDialSettingsUI) => [\n    that._deps.evAuth.availableCountries,\n    that._deps.evCall.formGroup.dialoutCountryId,\n  ])\n  get country() {\n    return this._deps.evAuth.availableCountries.find(\n      (country) =>\n        country.countryId === this._deps.evCall.formGroup.dialoutCountryId,\n    );\n  }\n\n  @computed((that: EvManualDialSettingsUI) => [\n    that.queue,\n    that.country,\n    that.callerId,\n    that._deps.evCall.formGroup.dialoutRingTime,\n    that._deps.evCall.ringTimeLimit,\n    that._deps.evAuth.callerIds,\n    that._deps.evAuth.availableQueues,\n    that._deps.evAuth.availableCountries,\n    that._deps.evAuth.agentPermissions.allowManualOutboundGates,\n    that._deps.evAuth.agentPermissions.allowManualIntlCalls,\n    that._deps.locale.currentLocale,\n  ])\n  get settingFields() {\n    return [\n      {\n        dataSign: 'callerId',\n        value: this.callerId.number,\n        onChange: (dialoutCallerId: string) => {\n          if (this._validate(dialoutCallerId)) {\n            this._deps.evCall.setFormGroup({\n              dialoutCallerId,\n            });\n          }\n        },\n        select: {\n          label: i18n.getString('callerId', this._deps.locale.currentLocale),\n          required: true,\n          options: this._deps.evAuth.callerIds,\n          getItemValue: (value: EvCallerId) => value.number,\n          itemRenderer: this._renderProps.renderCallerIdLabel,\n          renderValue: this.callerId.description,\n          searchOption: (value: EvCallerId, text: string) => {\n            return this._searchMethod(\n              `${value.description} ${value.number}`,\n              text,\n            );\n          },\n        },\n      },\n      ...(this._deps.evAuth.agentPermissions.allowManualOutboundGates\n        ? [\n            {\n              dataSign: 'queue',\n              value: this.queue.gateId,\n\n              onChange: (dialoutQueueId: string) => {\n                if (this._validate(dialoutQueueId)) {\n                  this._deps.evCall.setFormGroup({\n                    dialoutQueueId,\n                  });\n                }\n              },\n              select: {\n                label: i18n.getString('queue', this._deps.locale.currentLocale),\n                required: true,\n                options: this._deps.evAuth.availableQueues,\n                renderValue: this.queue.gateName,\n                itemRenderer: (value: QueueLabelProps) =>\n                  this._renderProps.renderQueueLabel({\n                    ...value,\n                    currentLocale: this._deps.locale.currentLocale,\n                  }),\n                getItemValue: (value: EvAvailableQueue) => value.gateId,\n                searchOption: (value: EvAvailableQueue, text: string) => {\n                  return this._searchMethod(\n                    `${value.gateName} ${value.gateId}`,\n                    text,\n                  );\n                },\n              },\n            },\n          ]\n        : []),\n      ...(this._deps.evAuth.agentPermissions.allowManualIntlCalls\n        ? [\n            {\n              dataSign: 'country',\n              value: this.country.countryId,\n              onChange: (dialoutCountryId: string) => {\n                if (this._validate(dialoutCountryId)) {\n                  this._deps.evCall.setFormGroup({\n                    dialoutCountryId,\n                  });\n                }\n              },\n              select: {\n                label: i18n.getString(\n                  'country',\n                  this._deps.locale.currentLocale,\n                ),\n                required: true,\n                options: this._deps.evAuth.availableCountries,\n                renderValue: `${this.country.countryName} (${this.country.countryId})`,\n                getItemValue: (value: EvAvailableCountry) => value.countryId,\n                itemRenderer: ({\n                  countryId,\n                  countryName,\n                }: EvAvailableCountry) => `${countryName} (${countryId})`,\n                searchOption: (value: EvAvailableCountry, text: string) => {\n                  return this._searchMethod(\n                    `${value.countryName}(${value.countryId})`,\n                    text,\n                  );\n                },\n              },\n            },\n          ]\n        : []),\n      {\n        dataSign: 'ringTime',\n        value: this._deps.evCall.formGroup.dialoutRingTime,\n        onChange: (dialoutRingTime: number) => {\n          this._deps.evCall.setFormGroup({\n            dialoutRingTime,\n          });\n        },\n        onBlur: () => {\n          this._deps.evCall.checkDialoutRingTime();\n        },\n        input: {\n          type: 'number',\n          label: i18n.getString('ringTime', this._deps.locale.currentLocale),\n          required: true,\n          placeholder: i18n.getString(\n            'ringTime',\n            this._deps.locale.currentLocale,\n          ),\n          ...this._deps.evCall.ringTimeLimit,\n        },\n      },\n    ];\n  }\n\n  private _validate(value: string) {\n    return !(typeof value === 'undefined' || value === null);\n  }\n\n  private _navigateToDialer() {\n    this._deps.routerInteraction.push('/dialer');\n  }\n\n  private _searchMethod(value: string, text: string) {\n    return value.toLowerCase().includes(text.toLowerCase());\n  }\n\n  getUIProps(\n    props: EvManualDialSettingsRenderProps = {},\n  ): EvManualDialSettingsUIProps {\n    this._renderProps = props;\n    return {\n      currentLocale: this._deps.locale.currentLocale,\n      settingFields: this.settingFields,\n    };\n  }\n\n  getUIFunctions(): EvManualDialSettingsUIFunctions {\n    return {\n      init: () => {\n        this._deps.evCall.resetForm();\n      },\n      goBack: () => this._navigateToDialer(),\n      save: () => {\n        this._deps.evCall.saveForm();\n        this._navigateToDialer();\n      },\n    };\n  }\n}\n\nexport { EvManualDialSettingsUI };\n"],"file":"EvManualDialSettingsUI.js"}
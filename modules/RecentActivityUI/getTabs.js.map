{"version":3,"file":"getTabs.js","names":["_react","_interopRequireDefault","require","_trackEvents","_DynamicsFont","_Fax","_VoicemailIcon","_RecentActivityCalls","_RecentActivityMessages","_i18n","obj","__esModule","trackTabsMap","recentCalls","trackEvents","clickRecentActivityCall","faxes","clickRecentActivityFaxes","recentMessages","clickRecentActivitySms","voicemails","clickRecentActivityVoicemails","exports","getTabs","_ref","ready","currentLocale","dateTimeFormatter","navigateTo","currentContact","sessionId","showRecentCalls","showRecentMessage","showFax","showVoiceMails","messages","calls","id","contactId","activityCardId","concat","icon","createElement","width","height","label","i18n","getString","path","isActive","view","getData","cleanUp","className","dynamicsFont","composeText","isMessagesLoaded","getMessages","cleanUpMessages","contact","active","isCallsLoaded","getCalls","cleanUpCalls","filter","item"],"sources":["modules/RecentActivityUI/getTabs.tsx"],"sourcesContent":["import type { ReactElement } from 'react';\nimport React from 'react';\n\nimport { trackEvents } from '@ringcentral-integration/commons/enums/trackEvents';\nimport type { Entity } from '@ringcentral-integration/commons/interfaces/Entity.interface';\nimport type { Message } from '@ringcentral-integration/commons/interfaces/MessageStore.model';\nimport type { HistoryCall } from '@ringcentral-integration/commons/modules/CallHistory';\nimport type { FormatDateTimeOptions } from '@ringcentral-integration/commons/modules/DateTimeFormat';\nimport type { RecentCalls } from '@ringcentral-integration/commons/modules/RecentCalls';\nimport type {\n  RecentMessage,\n  RecentMessages,\n} from '@ringcentral-integration/commons/modules/RecentMessages';\n\nimport dynamicsFont from '../../assets/DynamicsFont/DynamicsFont.scss';\nimport FaxIcon from '../../assets/images/Fax.svg';\nimport VoicemailIcon from '../../assets/images/VoicemailIcon.svg';\nimport RecentActivityCalls from '../../components/RecentActivityCalls';\nimport RecentActivityMessages from '../../components/RecentActivityMessages';\nimport i18n from './i18n';\n\nexport interface Tab {\n  icon: ReactElement;\n  label: string;\n  path: string;\n  isActive: (path: string) => boolean;\n  view: ReactElement;\n  getData: () => void;\n  cleanUp: () => void;\n}\n\nexport const trackTabsMap = {\n  recentCalls: trackEvents.clickRecentActivityCall,\n  faxes: trackEvents.clickRecentActivityFaxes,\n  recentMessages: trackEvents.clickRecentActivitySms,\n  voicemails: trackEvents.clickRecentActivityVoicemails,\n};\n\nexport interface GetTabsOptions {\n  ready: boolean;\n  currentLocale: string;\n  dateTimeFormatter: (options: Partial<FormatDateTimeOptions>) => string;\n  navigateTo: (path: string) => void;\n  recentMessages: RecentMessages;\n  recentCalls: RecentCalls;\n  currentContact: Entity;\n  sessionId: string;\n  showRecentCalls: boolean;\n  showRecentMessage: boolean;\n  showFax: boolean;\n  showVoiceMails: boolean;\n}\n\nexport const getTabs = ({\n  ready,\n  currentLocale,\n  dateTimeFormatter,\n  navigateTo,\n  recentMessages,\n  recentCalls,\n  currentContact,\n  sessionId,\n  showRecentCalls,\n  showRecentMessage,\n  showFax,\n  showVoiceMails,\n}: GetTabsOptions) => {\n  if (!ready) return [];\n  let messages: (Message | RecentMessage)[] = [];\n  let calls: HistoryCall[] = [];\n  if (currentContact && currentContact.id) {\n    const contactId = currentContact.id;\n    const activityCardId = sessionId ? `${contactId}-${sessionId}` : contactId;\n    if (recentMessages.messages[activityCardId]) {\n      messages = recentMessages.messages[activityCardId];\n    }\n    if (recentCalls.calls[activityCardId]) {\n      calls = recentCalls.calls[activityCardId];\n    }\n  }\n\n  return (\n    [\n      showVoiceMails\n        ? {\n            icon: <VoicemailIcon width={21} height={21} />,\n            label: i18n.getString('voicemail', currentLocale),\n            path: 'voicemails',\n            isActive: (path) => path === 'voicemails',\n            view: null,\n            getData() {},\n            cleanUp() {},\n          }\n        : null,\n      showRecentMessage\n        ? {\n            icon: <span className={dynamicsFont.composeText} />,\n            label: i18n.getString('text', currentLocale),\n            path: 'recentMessages',\n            isActive: (path) => path === 'recentMessages',\n            view: (\n              <RecentActivityMessages\n                // @ts-expect-error TS(2769): No overload matches this call.\n                messages={messages}\n                navigateTo={navigateTo}\n                dateTimeFormatter={dateTimeFormatter}\n                currentLocale={currentLocale}\n                isMessagesLoaded={recentMessages.isMessagesLoaded}\n              />\n            ),\n            getData() {\n              recentMessages.getMessages({ currentContact, sessionId });\n            },\n            cleanUp: () =>\n              recentMessages.cleanUpMessages({\n                contact: currentContact,\n                sessionId,\n              }),\n          }\n        : null,\n      showFax\n        ? {\n            icon: <FaxIcon width={21} height={21} />,\n            label: i18n.getString('fax', currentLocale),\n            path: 'faxes',\n            isActive: (path) => path === 'faxes',\n            view: null,\n            getData() {},\n            cleanUp() {},\n          }\n        : null,\n      showRecentCalls\n        ? {\n            icon: <span className={dynamicsFont.active} />,\n            label: i18n.getString('call', currentLocale),\n            path: 'recentCalls',\n            isActive: (path) => path === 'recentCalls',\n            view: (\n              <RecentActivityCalls\n                // @ts-expect-error TS(2769): No overload matches this call.\n                calls={calls}\n                dateTimeFormatter={dateTimeFormatter}\n                currentLocale={currentLocale}\n                isCallsLoaded={recentCalls.isCallsLoaded}\n              />\n            ),\n            getData() {\n              recentCalls.getCalls({ currentContact, sessionId });\n            },\n            cleanUp: () =>\n              recentCalls.cleanUpCalls({ contact: currentContact, sessionId }),\n          }\n        : null,\n    ] as Tab[]\n  ).filter((item) => item !== null);\n};\n"],"mappings":"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"}
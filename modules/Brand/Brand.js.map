{"version":3,"sources":["modules/Brand/Brand.ts"],"names":["Brand","name","deps","dep","optional","_dynamicConfig","locale","_deps","currentLocale","defaultLocale","brandConfig","_defaultConfig","_prefix","code","application","config","DEFAULT_LOCALE","assets","brandConfigOptions","assetOrigin","window","location","origin","prefix","id","shortName","appName","shortAppName","rcvProductName","rcvE2EESupportUrl","rcvTeleconference","RcModuleV2","state","action"],"mappings":"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","sourcesContent":["import {\n  action,\n  computed,\n  RcModuleV2,\n  state,\n} from '@ringcentral-integration/core';\nimport { DEFAULT_LOCALE } from '@ringcentral-integration/i18n';\n\nimport { camelCase } from '../../lib/camelCase';\nimport { Module } from '../../lib/di';\nimport { processI18n } from '../../lib/processI18n';\nimport { Deps } from './Brand.interface';\nimport { BrandConfig } from './BrandConfig.interface';\nimport { processAssets } from './helpers';\n\n@Module({\n  name: 'Brand',\n  deps: [\n    'BrandConfig',\n    'Locale',\n    { dep: 'Prefix', optional: true },\n    { dep: 'BrandConfigOptions', optional: true },\n  ],\n})\nexport class Brand<\n  T extends BrandConfig = BrandConfig,\n  D extends Deps<T> = Deps<T>,\n> extends RcModuleV2<D> {\n  protected _prefix: string = null;\n  constructor(deps: D) {\n    super({\n      deps,\n    });\n    this._prefix = `${this._deps.brandConfig.code}-${camelCase(\n      this._deps.brandConfig.application ?? '',\n    )}`;\n  }\n\n  @state\n  protected _dynamicConfig: T = null;\n\n  @action\n  setDynamicConfig(config: T) {\n    this._dynamicConfig = config;\n  }\n\n  /**\n   * dynamic brand config with i18n processed with currentLocale\n   */\n  @computed(({ _dynamicConfig, _deps: { locale } }: Brand<T, D>) => [\n    _dynamicConfig,\n    locale?.currentLocale,\n    locale?.defaultLocale,\n  ])\n  get dynamicConfig() {\n    return (\n      this._dynamicConfig &&\n      processI18n(\n        this._dynamicConfig,\n        this._deps.locale?.currentLocale ?? DEFAULT_LOCALE,\n        this._deps.locale?.defaultLocale ?? DEFAULT_LOCALE,\n      )\n    );\n  }\n\n  /**\n   * default brand config with assets processed\n   */\n  @computed(({ _deps: { brandConfig } }: Brand<T, D>) => [brandConfig])\n  protected get _defaultConfig() {\n    const brandConfig = this._deps.brandConfig;\n\n    if (!brandConfig?.assets) return brandConfig;\n\n    /**\n     * use current window location.origin as origin\n     * to avoid app inject into others page meet resource path issue\n     * like chrome extension content page\n     */\n    return {\n      ...brandConfig,\n      assets: processAssets(\n        brandConfig.assets,\n        this._deps.brandConfigOptions?.assetOrigin || window.location.origin,\n      ),\n    };\n  }\n\n  /**\n   * default brand config with assets and i18n processed using en-US\n   */\n  @computed(({ _defaultConfig }: Brand<T, D>) => [_defaultConfig])\n  get defaultConfig() {\n    return processI18n(this._defaultConfig);\n  }\n\n  /**\n   * Generic brand config accessor that returns dynamic config if available, and defaults\n   * to default config. The result is assets and i18n processed with current Locale.\n   */\n  @computed(\n    ({ _defaultConfig, _dynamicConfig, _deps: { locale } }: Brand<T, D>) => [\n      _defaultConfig,\n      _dynamicConfig,\n      locale?.currentLocale,\n      locale?.defaultLocale,\n    ],\n  )\n  get brandConfig() {\n    return processI18n(\n      this._dynamicConfig ?? this._defaultConfig,\n      this._deps.locale?.currentLocale ?? DEFAULT_LOCALE,\n      this._deps.locale?.defaultLocale ?? DEFAULT_LOCALE,\n    );\n  }\n\n  get prefix() {\n    return this._deps.prefix ?? this._prefix;\n  }\n\n  get id() {\n    return this.brandConfig.id;\n  }\n\n  get code() {\n    return this.brandConfig.code;\n  }\n\n  get name() {\n    return this.brandConfig.name;\n  }\n\n  get shortName() {\n    return this.brandConfig.shortName ?? this.brandConfig.name;\n  }\n\n  get appName() {\n    return this.brandConfig.appName;\n  }\n\n  get shortAppName() {\n    return this.brandConfig.shortAppName;\n  }\n\n  get rcvProductName() {\n    return this.brandConfig.rcvProductName;\n  }\n\n  get rcvE2EESupportUrl() {\n    return this.brandConfig.rcvE2EESupportUrl;\n  }\n\n  get application() {\n    return this.brandConfig.application;\n  }\n\n  get rcvTeleconference() {\n    return this.brandConfig.rcvTeleconference;\n  }\n\n  get assets() {\n    return this.brandConfig.assets;\n  }\n}\n"],"file":"Brand.js"}
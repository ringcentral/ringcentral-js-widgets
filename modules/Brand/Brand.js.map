{"version":3,"sources":["modules/Brand/Brand.ts"],"names":["Brand","name","deps","dep","optional","that","_deps","brandConfig","dynamicConfig","locale","currentLocale","defaultLocale","_prefix","code","application","config","assets","brandConfigOptions","assetOrigin","window","location","origin","defaultConfig","DEFAULT_LOCALE","prefix","id","shortName","appName","shortAppName","rcvProductName","rcvE2EESupportUrl","rcvTeleconference","RcModuleV2","state","action"],"mappings":"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","sourcesContent":["import {\n  action,\n  computed,\n  RcModuleV2,\n  state,\n} from '@ringcentral-integration/core';\nimport { DEFAULT_LOCALE } from '@ringcentral-integration/i18n';\n\nimport { camelCase } from '../../lib/camelCase';\nimport { Module } from '../../lib/di';\nimport { processI18n } from '../../lib/processI18n';\nimport { Deps } from './Brand.interface';\nimport { BrandConfig } from './BrandConfig.interface';\nimport { processAssets } from './helpers';\n\n@Module({\n  name: 'Brand',\n  deps: [\n    'BrandConfig',\n    'Locale',\n    { dep: 'Prefix', optional: true },\n    { dep: 'BrandConfigOptions', optional: true },\n  ],\n})\nexport class Brand<\n  T extends BrandConfig = BrandConfig,\n  D extends Deps<T> = Deps<T>,\n> extends RcModuleV2<D> {\n  protected _prefix: string = null;\n  constructor(deps: D) {\n    super({\n      deps,\n    });\n    this._prefix = `${this._deps.brandConfig.code}-${camelCase(\n      this._deps.brandConfig.application ?? '',\n    )}`;\n  }\n\n  @state\n  dynamicConfig: T = null;\n\n  @action\n  setDynamicConfig(config: T) {\n    this.dynamicConfig = config;\n  }\n\n  @computed((that: Brand<T, D>) => [that._deps.brandConfig])\n  get defaultConfig() {\n    const brandConfig = this._deps.brandConfig;\n\n    if (!brandConfig?.assets) return brandConfig;\n\n    /**\n     * use current window location.origin as origin\n     * to avoid app inject into others page meet resource path issue\n     * like chrome extension content page\n     */\n    return {\n      ...brandConfig,\n      assets: processAssets(\n        brandConfig.assets,\n        this._deps.brandConfigOptions?.assetOrigin || window.location.origin,\n      ),\n    };\n  }\n\n  @computed(({ dynamicConfig, _deps: { locale } }: Brand<T, D>) => [\n    dynamicConfig,\n    locale?.currentLocale,\n    locale?.defaultLocale,\n  ])\n  get brandConfig() {\n    return processI18n(\n      this.dynamicConfig ?? this.defaultConfig,\n      this._deps.locale?.currentLocale ?? DEFAULT_LOCALE,\n      this._deps.locale?.defaultLocale ?? DEFAULT_LOCALE,\n    );\n  }\n\n  get prefix() {\n    return this._deps.prefix ?? this._prefix;\n  }\n\n  get id() {\n    return this.brandConfig.id;\n  }\n\n  get code() {\n    return this.brandConfig.code;\n  }\n\n  get name() {\n    return this.brandConfig.name;\n  }\n\n  get shortName() {\n    return this.brandConfig.shortName ?? this.brandConfig.name;\n  }\n\n  get appName() {\n    return this.brandConfig.appName;\n  }\n\n  get shortAppName() {\n    return this.brandConfig.shortAppName;\n  }\n\n  get rcvProductName() {\n    return this.brandConfig.rcvProductName;\n  }\n\n  get rcvE2EESupportUrl() {\n    return this.brandConfig.rcvE2EESupportUrl;\n  }\n\n  get application() {\n    return this.brandConfig.application;\n  }\n\n  get rcvTeleconference() {\n    return this.brandConfig.rcvTeleconference;\n  }\n\n  get assets() {\n    return this.brandConfig.assets;\n  }\n}\n"],"file":"Brand.js"}
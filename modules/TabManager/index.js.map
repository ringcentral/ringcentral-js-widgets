{"version":3,"sources":["modules/TabManager/index.js"],"names":["TabManager","options","actionTypes","_tabbie","prefix","_reducer","store","initSuccess","checkIsMain","type","active","dispatch","enabled","on","mainTabId","mainTabIdChanged","event","args","send","state","status","ready"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA;;;;IAKqBA,U,WADpB,iB;;;AAEC,4BAEG;AAAA,QADEC,OACF;AAAA;;AAAA,yKAEIA,OAFJ;AAGCC;AAHD;;AAKD,UAAKC,OAAL,GAAe,qBAAW;AACxBC,cAAQ,MAAKA;AADW,KAAX,CAAf;AAGA,UAAKC,QAAL,GAAgB,oCAAqB,MAAKH,WAA1B,CAAhB;AARC;AASF;;;;;;;;;;;;+BAEC,KAAKI,K;+BACG,KAAKJ,WAAL,CAAiBK,W;;uBACT,KAAKJ,OAAL,CAAaK,WAAb,E;;;;;AADdC,sB;AACAC,wB;;;6BAFSC,Q;;AAIX,oBAAI,KAAKR,OAAL,CAAaS,OAAjB,EAA0B;AACxB,uBAAKT,OAAL,CAAaU,EAAb,CAAgB,kBAAhB;AAAA,2FAAoC,iBAAOC,SAAP;AAAA;AAAA;AAAA;AAAA;AAAA,4CAClC,OAAKR,KAD6B;AAAA,4CAE1B,OAAKJ,WAAL,CAAiBa,gBAFS;AAAA,4CAGhCD,SAHgC;AAAA;AAAA,qCAIlB,OAAKX,OAAL,CAAaK,WAAb,EAJkB;;AAAA;AAAA;AAAA;AAEhCC,oCAFgC;AAGhCK,yCAHgC;AAIhCJ,sCAJgC;AAAA;;AAAA,0CACvBC,QADuB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAApC;;AAAA;AAAA;AAAA;AAAA;AAOA,uBAAKR,OAAL,CAAaU,EAAb,CAAgB,OAAhB,EAAyB,UAACG,KAAD,EAAoB;AAAA,sDAATC,IAAS;AAATA,0BAAS;AAAA;;AAC3C,2BAAKX,KAAL,CAAWK,QAAX,CAAoB;AAClBF,4BAAM,OAAKP,WAAL,CAAiBc,KADL;AAElBA,kCAFkB;AAGlBC;AAHkB,qBAApB;AAKD,mBAND;AAOD;;;;;;;;;;;;;;;;;;yBAGED,K,EAAgB;AAAA;;AAAA,yCAANC,IAAM;AAANA,YAAM;AAAA;;AACnB,sBAAKd,OAAL,EAAae,IAAb,iBAAkBF,KAAlB,SAA4BC,IAA5B;AACD;;;;;;;;;kDAeQ,KAAKd,OAAL,CAAaK,WAAb,E;;;;;;;;;;;;;;;;;;wBAbI;AACX,aAAO,KAAKW,KAAL,CAAWC,MAAlB;AACD;;;wBAEW;AACV,aAAO,KAAKD,KAAL,CAAWC,MAAX,KAAsB,yBAAeC,KAA5C;AACD;;;wBAEY;AACX,aAAO,KAAKF,KAAL,CAAWT,MAAlB;AACD;;;wBAMW;AACV,aAAO,KAAKS,KAAL,CAAWH,KAAlB;AACD;;;;kBA1DkBhB,U","file":"index.js","sourcesContent":["import RcModule from '../../lib/RcModule';\nimport { Module } from '../../lib/di';\nimport Tabbie from '../../lib/Tabbie';\nimport moduleStatuses from '../../enums/moduleStatuses';\nimport actionTypes from './actionTypes';\nimport getTabManagerReducer from './getTabManagerReducer';\n\n/**\n * @class\n * @description To handle data between different tabs\n */\n@Module()\nexport default class TabManager extends RcModule {\n  constructor({\n    ...options\n  }) {\n    super({\n      ...options,\n      actionTypes,\n    });\n    this._tabbie = new Tabbie({\n      prefix: this.prefix,\n    });\n    this._reducer = getTabManagerReducer(this.actionTypes);\n  }\n  async initialize() {\n    this.store.dispatch({\n      type: this.actionTypes.initSuccess,\n      active: await this._tabbie.checkIsMain(),\n    });\n    if (this._tabbie.enabled) {\n      this._tabbie.on('mainTabIdChanged', async (mainTabId) => {\n        this.store.dispatch({\n          type: this.actionTypes.mainTabIdChanged,\n          mainTabId,\n          active: await this._tabbie.checkIsMain(),\n        });\n      });\n      this._tabbie.on('event', (event, ...args) => {\n        this.store.dispatch({\n          type: this.actionTypes.event,\n          event,\n          args,\n        });\n      });\n    }\n  }\n\n  send(event, ...args) {\n    this._tabbie.send(event, ...args);\n  }\n\n  get status() {\n    return this.state.status;\n  }\n\n  get ready() {\n    return this.state.status === moduleStatuses.ready;\n  }\n\n  get active() {\n    return this.state.active;\n  }\n\n  async ensureActive() {\n    return this._tabbie.checkIsMain();\n  }\n\n  get event() {\n    return this.state.event;\n  }\n}\n"]}
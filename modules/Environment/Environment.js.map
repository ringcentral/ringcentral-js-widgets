{"version":3,"file":"Environment.js","names":["_core","require","_sdk","_di","_proxify","_enabledDataTrackingTimestamp","_dec","_class","_class2","_descriptor","_descriptor2","_descriptor3","_descriptor4","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_toPropertyKey","value","configurable","writable","_regenerator","Symbol","n","iterator","toStringTag","i","c","prototype","Generator","u","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","l","TypeError","call","done","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","w","m","_regeneratorDefine","_invoke","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","_next","_throw","_initializerDefineProperty","initializer","_classCallCheck","_defineProperties","key","_createClass","_toPrimitive","_typeof","toPrimitive","String","Number","_callSuper","_getPrototypeOf","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","constructor","_assertThisInitialized","ReferenceError","Boolean","valueOf","_inherits","_setPrototypeOf","_applyDecoratedDescriptor","slice","reverse","reduce","_initializerWarningHelper","Error","DEFAULT_RECORDING_HOST","TWO_HOURS_IN_MILLISECONDS","Environment","exports","Module","name","deps","dep","optional","_RcModuleV","_this","enableGlobalCache","storageKey","recordingHostState","_defaultRecordingHost","onInit","enabled","changeEnvironment","get","localStorageDataTrackingTimestamp","setEnvData","_ref","server","recordingHost","allowDataTracking","set","Date","now","updateChangeCounter","changeCounter","_changeEnvironment","_callee","sdkConfig","discovery","_discovery$removeExte","_discovery$removeInit","_context","getSdkConfig","enableDiscovery","_deps","client","service","platform","removeExternalData","removeInitialData","SDK","removeSDKNonISO8859Chars","discoveryAutoInit","initDiscovery","newConfig","discoveryServer","_setData","_callee2","_ref2","_ref2$allowDataTracki","_ref2$environmentChan","environmentChanged","isEnvChanged","_context2","setData","_x","useDataTrackingSetting","timestamp","enabledDataTrackingTimestamp","isWithinTwoHours","process","env","NODE_ENV","BUILD_ENVIRONMENT","includes","_this$_deps$environme","_this$_deps$environme2","environmentOptions","defaultRecordingHost","RcModuleV2","globalStorage","state","sandbox","action","proxify"],"sources":["modules/Environment/Environment.ts"],"sourcesContent":["import {\n  action,\n  globalStorage,\n  RcModuleV2,\n  removeSDKNonISO8859Chars,\n  state,\n} from '@ringcentral-integration/core';\nimport { SDK } from '@ringcentral/sdk';\n\nimport type { SDKConfig } from '../../lib/createSdkConfig';\nimport { Module } from '../../lib/di';\nimport { proxify } from '../../lib/proxy/proxify';\n\nimport type { Deps, SetDataOptions } from './Environment.interface';\nimport { localStorageDataTrackingTimestamp } from './enabledDataTrackingTimestamp';\n\nconst DEFAULT_RECORDING_HOST =\n  'https://apps.ringcentral.com/integrations/recording/v3.0/rc/index.html';\nconst TWO_HOURS_IN_MILLISECONDS = 2 * 60 * 60 * 1000;\n\n@Module({\n  name: 'Environment',\n  deps: [\n    'Client',\n    'GlobalStorage',\n    'SdkConfig',\n    { dep: 'EnvironmentOptions', optional: true },\n  ],\n})\nexport class Environment extends RcModuleV2<Deps> {\n  constructor(deps: Deps) {\n    super({\n      deps,\n      enableGlobalCache: true,\n      storageKey: 'environment',\n    });\n    this.recordingHostState = this._defaultRecordingHost;\n  }\n\n  override onInit() {\n    if (this.enabled) {\n      this.changeEnvironment();\n    }\n  }\n\n  @globalStorage\n  @state\n  server: SDKConfig['server'] = SDK.server.sandbox;\n\n  @globalStorage\n  @state\n  recordingHostState: string | null = null;\n\n  get enabledDataTrackingTimestamp() {\n    return localStorageDataTrackingTimestamp.get();\n  }\n\n  @globalStorage\n  @state\n  enabled = false;\n\n  @state\n  changeCounter = 0;\n\n  @action\n  setEnvData({\n    server,\n    recordingHost,\n    enabled,\n    allowDataTracking,\n  }: SetDataOptions) {\n    this.server = server;\n    this.recordingHostState = recordingHost;\n    this.enabled = enabled;\n    localStorageDataTrackingTimestamp.set(\n      allowDataTracking ? Date.now() : null,\n    );\n  }\n\n  @action\n  updateChangeCounter() {\n    this.changeCounter++;\n  }\n\n  protected async changeEnvironment() {\n    const sdkConfig = this.getSdkConfig();\n    if (sdkConfig.enableDiscovery) {\n      // Clear discovery data before switching to new env\n      const discovery = this._deps.client.service.platform().discovery();\n      if (discovery) {\n        await discovery.removeExternalData?.();\n        await discovery.removeInitialData?.();\n      }\n    }\n    this._deps.client.service = new SDK(removeSDKNonISO8859Chars(sdkConfig));\n    if (sdkConfig.enableDiscovery && sdkConfig.discoveryAutoInit === false) {\n      // make sure to init discovery API if discoveryAutoInit is deliberately set to false\n      this._deps.client.service.platform().initDiscovery();\n    }\n  }\n\n  getSdkConfig() {\n    const newConfig = {\n      ...this._deps.sdkConfig,\n    };\n    if (this.enabled) {\n      newConfig.server = this.server;\n      newConfig.discoveryServer = this.server;\n    }\n    return newConfig;\n  }\n\n  @proxify\n  async setData({\n    server,\n    recordingHost,\n    enabled,\n    allowDataTracking = false,\n    environmentChanged = false,\n  }: SetDataOptions) {\n    // `recordingHost` change no need to set to SDK\n    const isEnvChanged =\n      environmentChanged ||\n      this.enabled !== enabled ||\n      (enabled && this.server !== server);\n\n    this.setEnvData({\n      server,\n      recordingHost,\n      enabled,\n      allowDataTracking,\n    });\n\n    if (isEnvChanged) {\n      // apply changes\n      await this.changeEnvironment();\n      // notify change at last\n      this.updateChangeCounter();\n    }\n  }\n\n  get recordingHost() {\n    return this.enabled ? this.recordingHostState : this._defaultRecordingHost;\n  }\n\n  get allowDataTracking() {\n    if (!this.useDataTrackingSetting) return true;\n\n    const timestamp = this.enabledDataTrackingTimestamp;\n    if (!timestamp) return false;\n\n    const isWithinTwoHours = Date.now() - timestamp < TWO_HOURS_IN_MILLISECONDS;\n\n    if (!isWithinTwoHours) {\n      // clear data tracking setting if it's expired for prevent get Date.now() anymore\n      localStorageDataTrackingTimestamp.set(null);\n    }\n\n    return isWithinTwoHours;\n  }\n\n  /**\n   * when that be true, the data tracking will not auto be tracked, will base on `allowDataTracking` setting to decide whether to track data\n   */\n  get useDataTrackingSetting() {\n    return Boolean(\n      // in production mode, use data tracking setting to avoid data tracking in those test environment\n      ((process.env.NODE_ENV === 'production' ||\n        // also in test mode same as production to able to test that\n        process.env.NODE_ENV === 'test') &&\n        process.env.BUILD_ENVIRONMENT &&\n        ['dev', 'local', 'reg'].includes(process.env.BUILD_ENVIRONMENT)) ||\n        // in development mode always use data tracking setting, to avoid data tracking in dev mode\n        process.env.NODE_ENV === 'development',\n    );\n  }\n\n  protected get _defaultRecordingHost() {\n    return (\n      this._deps.environmentOptions?.defaultRecordingHost ??\n      DEFAULT_RECORDING_HOST\n    );\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAAA,KAAA,GAAAC,OAAA;AAOA,IAAAC,IAAA,GAAAD,OAAA;AAGA,IAAAE,GAAA,GAAAF,OAAA;AACA,IAAAG,QAAA,GAAAH,OAAA;AAGA,IAAAI,6BAAA,GAAAJ,OAAA;AAAmF,IAAAK,IAAA,EAAAC,MAAA,EAAAC,OAAA,EAAAC,WAAA,EAAAC,YAAA,EAAAC,YAAA,EAAAC,YAAA;AAAA,SAAAC,QAAAC,CAAA,EAAAC,CAAA,QAAAC,CAAA,GAAAC,MAAA,CAAAC,IAAA,CAAAJ,CAAA,OAAAG,MAAA,CAAAE,qBAAA,QAAAC,CAAA,GAAAH,MAAA,CAAAE,qBAAA,CAAAL,CAAA,GAAAC,CAAA,KAAAK,CAAA,GAAAA,CAAA,CAAAC,MAAA,WAAAN,CAAA,WAAAE,MAAA,CAAAK,wBAAA,CAAAR,CAAA,EAAAC,CAAA,EAAAQ,UAAA,OAAAP,CAAA,CAAAQ,IAAA,CAAAC,KAAA,CAAAT,CAAA,EAAAI,CAAA,YAAAJ,CAAA;AAAA,SAAAU,cAAAZ,CAAA,aAAAC,CAAA,MAAAA,CAAA,GAAAY,SAAA,CAAAC,MAAA,EAAAb,CAAA,UAAAC,CAAA,WAAAW,SAAA,CAAAZ,CAAA,IAAAY,SAAA,CAAAZ,CAAA,QAAAA,CAAA,OAAAF,OAAA,CAAAI,MAAA,CAAAD,CAAA,OAAAa,OAAA,WAAAd,CAAA,IAAAe,eAAA,CAAAhB,CAAA,EAAAC,CAAA,EAAAC,CAAA,CAAAD,CAAA,SAAAE,MAAA,CAAAc,yBAAA,GAAAd,MAAA,CAAAe,gBAAA,CAAAlB,CAAA,EAAAG,MAAA,CAAAc,yBAAA,CAAAf,CAAA,KAAAH,OAAA,CAAAI,MAAA,CAAAD,CAAA,GAAAa,OAAA,WAAAd,CAAA,IAAAE,MAAA,CAAAgB,cAAA,CAAAnB,CAAA,EAAAC,CAAA,EAAAE,MAAA,CAAAK,wBAAA,CAAAN,CAAA,EAAAD,CAAA,iBAAAD,CAAA;AAAA,SAAAgB,gBAAAhB,CAAA,EAAAC,CAAA,EAAAC,CAAA,YAAAD,CAAA,GAAAmB,cAAA,CAAAnB,CAAA,MAAAD,CAAA,GAAAG,MAAA,CAAAgB,cAAA,CAAAnB,CAAA,EAAAC,CAAA,IAAAoB,KAAA,EAAAnB,CAAA,EAAAO,UAAA,MAAAa,YAAA,MAAAC,QAAA,UAAAvB,CAAA,CAAAC,CAAA,IAAAC,CAAA,EAAAF,CAAA;AAAA,SAAAwB,aAAA,IAbnF,uKAAAxB,CAAA,EAAAE,CAAA,EAAAD,CAAA,wBAAAwB,MAAA,GAAAA,MAAA,OAAAC,CAAA,GAAAzB,CAAA,CAAA0B,QAAA,kBAAArB,CAAA,GAAAL,CAAA,CAAA2B,WAAA,8BAAAC,EAAA5B,CAAA,EAAAyB,CAAA,EAAApB,CAAA,EAAAuB,CAAA,QAAAC,CAAA,GAAAJ,CAAA,IAAAA,CAAA,CAAAK,SAAA,YAAAC,SAAA,GAAAN,CAAA,GAAAM,SAAA,EAAAC,CAAA,GAAA9B,MAAA,CAAA+B,MAAA,CAAAJ,CAAA,CAAAC,SAAA,UAAAI,mBAAA,CAAAF,CAAA,uBAAAhC,CAAA,EAAAyB,CAAA,EAAApB,CAAA,QAAAuB,CAAA,EAAAC,CAAA,EAAAG,CAAA,EAAAG,CAAA,MAAAC,CAAA,GAAA/B,CAAA,QAAAgC,CAAA,OAAAC,CAAA,KAAAF,CAAA,KAAAX,CAAA,KAAAc,CAAA,EAAAxC,CAAA,EAAAyC,CAAA,EAAAC,CAAA,EAAAN,CAAA,EAAAM,CAAA,CAAAC,IAAA,CAAA3C,CAAA,MAAA0C,CAAA,WAAAA,EAAAxC,CAAA,EAAAD,CAAA,WAAA4B,CAAA,GAAA3B,CAAA,EAAA4B,CAAA,MAAAG,CAAA,GAAAjC,CAAA,EAAAuC,CAAA,CAAAb,CAAA,GAAAzB,CAAA,EAAAwC,CAAA,gBAAAC,EAAAzC,CAAA,EAAAyB,CAAA,SAAAI,CAAA,GAAA7B,CAAA,EAAAgC,CAAA,GAAAP,CAAA,EAAAxB,CAAA,OAAAoC,CAAA,IAAAF,CAAA,KAAA9B,CAAA,IAAAJ,CAAA,GAAAmC,CAAA,CAAAvB,MAAA,EAAAZ,CAAA,UAAAI,CAAA,EAAAuB,CAAA,GAAAQ,CAAA,CAAAnC,CAAA,GAAAwC,CAAA,GAAAH,CAAA,CAAAF,CAAA,EAAAO,CAAA,GAAAf,CAAA,KAAA5B,CAAA,QAAAK,CAAA,GAAAsC,CAAA,KAAAlB,CAAA,MAAAO,CAAA,GAAAJ,CAAA,EAAAC,CAAA,GAAAD,CAAA,YAAAC,CAAA,WAAAD,CAAA,MAAAA,CAAA,MAAA7B,CAAA,IAAA6B,CAAA,OAAAa,CAAA,MAAApC,CAAA,GAAAL,CAAA,QAAAyC,CAAA,GAAAb,CAAA,QAAAC,CAAA,MAAAS,CAAA,CAAAC,CAAA,GAAAd,CAAA,EAAAa,CAAA,CAAAb,CAAA,GAAAG,CAAA,OAAAa,CAAA,GAAAE,CAAA,KAAAtC,CAAA,GAAAL,CAAA,QAAA4B,CAAA,MAAAH,CAAA,IAAAA,CAAA,GAAAkB,CAAA,MAAAf,CAAA,MAAA5B,CAAA,EAAA4B,CAAA,MAAAH,CAAA,EAAAa,CAAA,CAAAb,CAAA,GAAAkB,CAAA,EAAAd,CAAA,cAAAxB,CAAA,IAAAL,CAAA,aAAAwC,CAAA,QAAAH,CAAA,OAAAZ,CAAA,qBAAApB,CAAA,EAAA+B,CAAA,EAAAO,CAAA,QAAAR,CAAA,YAAAS,SAAA,uCAAAP,CAAA,UAAAD,CAAA,IAAAK,CAAA,CAAAL,CAAA,EAAAO,CAAA,GAAAd,CAAA,GAAAO,CAAA,EAAAJ,CAAA,GAAAW,CAAA,GAAA1C,CAAA,GAAA4B,CAAA,OAAA9B,CAAA,GAAAiC,CAAA,MAAAK,CAAA,KAAAT,CAAA,KAAAC,CAAA,GAAAA,CAAA,QAAAA,CAAA,SAAAS,CAAA,CAAAb,CAAA,QAAAgB,CAAA,CAAAZ,CAAA,EAAAG,CAAA,KAAAM,CAAA,CAAAb,CAAA,GAAAO,CAAA,GAAAM,CAAA,CAAAC,CAAA,GAAAP,CAAA,aAAAG,CAAA,MAAAP,CAAA,QAAAC,CAAA,KAAAxB,CAAA,YAAAJ,CAAA,GAAA2B,CAAA,CAAAvB,CAAA,WAAAJ,CAAA,GAAAA,CAAA,CAAA4C,IAAA,CAAAjB,CAAA,EAAAI,CAAA,UAAAY,SAAA,2CAAA3C,CAAA,CAAA6C,IAAA,SAAA7C,CAAA,EAAA+B,CAAA,GAAA/B,CAAA,CAAAmB,KAAA,EAAAS,CAAA,SAAAA,CAAA,oBAAAA,CAAA,KAAA5B,CAAA,GAAA2B,CAAA,eAAA3B,CAAA,CAAA4C,IAAA,CAAAjB,CAAA,GAAAC,CAAA,SAAAG,CAAA,GAAAY,SAAA,uCAAAvC,CAAA,gBAAAwB,CAAA,OAAAD,CAAA,GAAA7B,CAAA,cAAAE,CAAA,IAAAoC,CAAA,GAAAC,CAAA,CAAAb,CAAA,QAAAO,CAAA,GAAAhC,CAAA,CAAA6C,IAAA,CAAApB,CAAA,EAAAa,CAAA,OAAAE,CAAA,kBAAAvC,CAAA,IAAA2B,CAAA,GAAA7B,CAAA,EAAA8B,CAAA,MAAAG,CAAA,GAAA/B,CAAA,cAAAkC,CAAA,mBAAAf,KAAA,EAAAnB,CAAA,EAAA6C,IAAA,EAAAT,CAAA,SAAArC,CAAA,EAAAK,CAAA,EAAAuB,CAAA,QAAAI,CAAA,QAAAQ,CAAA,gBAAAT,UAAA,cAAAgB,kBAAA,cAAAC,2BAAA,KAAA/C,CAAA,GAAAC,MAAA,CAAA+C,cAAA,MAAApB,CAAA,MAAAJ,CAAA,IAAAxB,CAAA,CAAAA,CAAA,IAAAwB,CAAA,SAAAS,mBAAA,CAAAjC,CAAA,OAAAwB,CAAA,iCAAAxB,CAAA,GAAA+B,CAAA,GAAAgB,0BAAA,CAAAlB,SAAA,GAAAC,SAAA,CAAAD,SAAA,GAAA5B,MAAA,CAAA+B,MAAA,CAAAJ,CAAA,YAAAM,EAAApC,CAAA,WAAAG,MAAA,CAAAgD,cAAA,GAAAhD,MAAA,CAAAgD,cAAA,CAAAnD,CAAA,EAAAiD,0BAAA,KAAAjD,CAAA,CAAAoD,SAAA,GAAAH,0BAAA,EAAAd,mBAAA,CAAAnC,CAAA,EAAAM,CAAA,yBAAAN,CAAA,CAAA+B,SAAA,GAAA5B,MAAA,CAAA+B,MAAA,CAAAD,CAAA,GAAAjC,CAAA,WAAAgD,iBAAA,CAAAjB,SAAA,GAAAkB,0BAAA,EAAAd,mBAAA,CAAAF,CAAA,iBAAAgB,0BAAA,GAAAd,mBAAA,CAAAc,0BAAA,iBAAAD,iBAAA,GAAAA,iBAAA,CAAAK,WAAA,wBAAAlB,mBAAA,CAAAc,0BAAA,EAAA3C,CAAA,wBAAA6B,mBAAA,CAAAF,CAAA,GAAAE,mBAAA,CAAAF,CAAA,EAAA3B,CAAA,gBAAA6B,mBAAA,CAAAF,CAAA,EAAAP,CAAA,iCAAAS,mBAAA,CAAAF,CAAA,8DAAAT,YAAA,YAAAA,aAAA,aAAA8B,CAAA,EAAAzB,CAAA,EAAA0B,CAAA,EAAAnB,CAAA;AAAA,SAAAD,oBAAAnC,CAAA,EAAAC,CAAA,EAAAyB,CAAA,EAAAxB,CAAA,QAAA2B,CAAA,GAAA1B,MAAA,CAAAgB,cAAA,QAAAU,CAAA,uBAAA7B,CAAA,IAAA6B,CAAA,QAAAM,mBAAA,YAAAqB,mBAAAxD,CAAA,EAAAC,CAAA,EAAAyB,CAAA,EAAAxB,CAAA,aAAAI,EAAAL,CAAA,EAAAyB,CAAA,IAAAS,mBAAA,CAAAnC,CAAA,EAAAC,CAAA,YAAAD,CAAA,gBAAAyD,OAAA,CAAAxD,CAAA,EAAAyB,CAAA,EAAA1B,CAAA,SAAAC,CAAA,GAAA4B,CAAA,GAAAA,CAAA,CAAA7B,CAAA,EAAAC,CAAA,IAAAoB,KAAA,EAAAK,CAAA,EAAAjB,UAAA,GAAAP,CAAA,EAAAoB,YAAA,GAAApB,CAAA,EAAAqB,QAAA,GAAArB,CAAA,MAAAF,CAAA,CAAAC,CAAA,IAAAyB,CAAA,IAAApB,CAAA,aAAAA,CAAA,cAAAA,CAAA,mBAAA6B,mBAAA,CAAAnC,CAAA,EAAAC,CAAA,EAAAyB,CAAA,EAAAxB,CAAA;AAAA,SAAAwD,mBAAAhC,CAAA,EAAAxB,CAAA,EAAAF,CAAA,EAAAC,CAAA,EAAAK,CAAA,EAAAmC,CAAA,EAAAX,CAAA,cAAAD,CAAA,GAAAH,CAAA,CAAAe,CAAA,EAAAX,CAAA,GAAAG,CAAA,GAAAJ,CAAA,CAAAR,KAAA,WAAAK,CAAA,gBAAA1B,CAAA,CAAA0B,CAAA,KAAAG,CAAA,CAAAkB,IAAA,GAAA7C,CAAA,CAAA+B,CAAA,IAAA0B,OAAA,CAAAC,OAAA,CAAA3B,CAAA,EAAA4B,IAAA,CAAA5D,CAAA,EAAAK,CAAA;AAAA,SAAAwD,kBAAApC,CAAA,6BAAAxB,CAAA,SAAAF,CAAA,GAAAa,SAAA,aAAA8C,OAAA,WAAA1D,CAAA,EAAAK,CAAA,QAAAmC,CAAA,GAAAf,CAAA,CAAAf,KAAA,CAAAT,CAAA,EAAAF,CAAA,YAAA+D,MAAArC,CAAA,IAAAgC,kBAAA,CAAAjB,CAAA,EAAAxC,CAAA,EAAAK,CAAA,EAAAyD,KAAA,EAAAC,MAAA,UAAAtC,CAAA,cAAAsC,OAAAtC,CAAA,IAAAgC,kBAAA,CAAAjB,CAAA,EAAAxC,CAAA,EAAAK,CAAA,EAAAyD,KAAA,EAAAC,MAAA,WAAAtC,CAAA,KAAAqC,KAAA;AAAA,SAAAE,2BAAAjE,CAAA,EAAA6B,CAAA,EAAA5B,CAAA,EAAA2C,CAAA,IAAA3C,CAAA,IAAAE,MAAA,CAAAgB,cAAA,CAAAnB,CAAA,EAAA6B,CAAA,IAAApB,UAAA,EAAAR,CAAA,CAAAQ,UAAA,EAAAa,YAAA,EAAArB,CAAA,CAAAqB,YAAA,EAAAC,QAAA,EAAAtB,CAAA,CAAAsB,QAAA,EAAAF,KAAA,EAAApB,CAAA,CAAAiE,WAAA,GAAAjE,CAAA,CAAAiE,WAAA,CAAApB,IAAA,CAAAF,CAAA;AAAA,SAAAuB,gBAAA1B,CAAA,EAAAf,CAAA,UAAAe,CAAA,YAAAf,CAAA,aAAAmB,SAAA;AAAA,SAAAuB,kBAAApE,CAAA,EAAAC,CAAA,aAAAC,CAAA,MAAAA,CAAA,GAAAD,CAAA,CAAAa,MAAA,EAAAZ,CAAA,UAAAI,CAAA,GAAAL,CAAA,CAAAC,CAAA,GAAAI,CAAA,CAAAG,UAAA,GAAAH,CAAA,CAAAG,UAAA,QAAAH,CAAA,CAAAgB,YAAA,kBAAAhB,CAAA,KAAAA,CAAA,CAAAiB,QAAA,QAAApB,MAAA,CAAAgB,cAAA,CAAAnB,CAAA,EAAAoB,cAAA,CAAAd,CAAA,CAAA+D,GAAA,GAAA/D,CAAA;AAAA,SAAAgE,aAAAtE,CAAA,EAAAC,CAAA,EAAAC,CAAA,WAAAD,CAAA,IAAAmE,iBAAA,CAAApE,CAAA,CAAA+B,SAAA,EAAA9B,CAAA,GAAAC,CAAA,IAAAkE,iBAAA,CAAApE,CAAA,EAAAE,CAAA,GAAAC,MAAA,CAAAgB,cAAA,CAAAnB,CAAA,iBAAAuB,QAAA,SAAAvB,CAAA;AAAA,SAAAoB,eAAAlB,CAAA,QAAA2B,CAAA,GAAA0C,YAAA,CAAArE,CAAA,gCAAAsE,OAAA,CAAA3C,CAAA,IAAAA,CAAA,GAAAA,CAAA;AAAA,SAAA0C,aAAArE,CAAA,EAAAD,CAAA,oBAAAuE,OAAA,CAAAtE,CAAA,MAAAA,CAAA,SAAAA,CAAA,MAAAF,CAAA,GAAAE,CAAA,CAAAuB,MAAA,CAAAgD,WAAA,kBAAAzE,CAAA,QAAA6B,CAAA,GAAA7B,CAAA,CAAA8C,IAAA,CAAA5C,CAAA,EAAAD,CAAA,gCAAAuE,OAAA,CAAA3C,CAAA,UAAAA,CAAA,YAAAgB,SAAA,yEAAA5C,CAAA,GAAAyE,MAAA,GAAAC,MAAA,EAAAzE,CAAA;AAAA,SAAA0E,WAAA1E,CAAA,EAAAI,CAAA,EAAAN,CAAA,WAAAM,CAAA,GAAAuE,eAAA,CAAAvE,CAAA,GAAAwE,0BAAA,CAAA5E,CAAA,EAAA6E,yBAAA,KAAAC,OAAA,CAAAC,SAAA,CAAA3E,CAAA,EAAAN,CAAA,QAAA6E,eAAA,CAAA3E,CAAA,EAAAgF,WAAA,IAAA5E,CAAA,CAAAK,KAAA,CAAAT,CAAA,EAAAF,CAAA;AAAA,SAAA8E,2BAAA5E,CAAA,EAAAF,CAAA,QAAAA,CAAA,iBAAAwE,OAAA,CAAAxE,CAAA,0BAAAA,CAAA,UAAAA,CAAA,iBAAAA,CAAA,YAAA6C,SAAA,qEAAAsC,sBAAA,CAAAjF,CAAA;AAAA,SAAAiF,uBAAAnF,CAAA,mBAAAA,CAAA,YAAAoF,cAAA,sEAAApF,CAAA;AAAA,SAAA+E,0BAAA,cAAA7E,CAAA,IAAAmF,OAAA,CAAAtD,SAAA,CAAAuD,OAAA,CAAAxC,IAAA,CAAAkC,OAAA,CAAAC,SAAA,CAAAI,OAAA,iCAAAnF,CAAA,aAAA6E,yBAAA,YAAAA,0BAAA,aAAA7E,CAAA;AAAA,SAAA2E,gBAAA3E,CAAA,WAAA2E,eAAA,GAAA1E,MAAA,CAAAgD,cAAA,GAAAhD,MAAA,CAAA+C,cAAA,CAAAP,IAAA,eAAAzC,CAAA,WAAAA,CAAA,CAAAkD,SAAA,IAAAjD,MAAA,CAAA+C,cAAA,CAAAhD,CAAA,MAAA2E,eAAA,CAAA3E,CAAA;AAAA,SAAAqF,UAAArF,CAAA,EAAAF,CAAA,6BAAAA,CAAA,aAAAA,CAAA,YAAA6C,SAAA,wDAAA3C,CAAA,CAAA6B,SAAA,GAAA5B,MAAA,CAAA+B,MAAA,CAAAlC,CAAA,IAAAA,CAAA,CAAA+B,SAAA,IAAAmD,WAAA,IAAA7D,KAAA,EAAAnB,CAAA,EAAAqB,QAAA,MAAAD,YAAA,WAAAnB,MAAA,CAAAgB,cAAA,CAAAjB,CAAA,iBAAAqB,QAAA,SAAAvB,CAAA,IAAAwF,eAAA,CAAAtF,CAAA,EAAAF,CAAA;AAAA,SAAAwF,gBAAAtF,CAAA,EAAAF,CAAA,WAAAwF,eAAA,GAAArF,MAAA,CAAAgD,cAAA,GAAAhD,MAAA,CAAAgD,cAAA,CAAAR,IAAA,eAAAzC,CAAA,EAAAF,CAAA,WAAAE,CAAA,CAAAkD,SAAA,GAAApD,CAAA,EAAAE,CAAA,KAAAsF,eAAA,CAAAtF,CAAA,EAAAF,CAAA;AAAA,SAAAyF,0BAAA5D,CAAA,EAAA7B,CAAA,EAAAC,CAAA,EAAAyB,CAAA,EAAAkB,CAAA,QAAAH,CAAA,cAAAtC,MAAA,CAAAC,IAAA,CAAAsB,CAAA,EAAAX,OAAA,WAAAc,CAAA,IAAAY,CAAA,CAAAZ,CAAA,IAAAH,CAAA,CAAAG,CAAA,OAAAY,CAAA,CAAAhC,UAAA,KAAAgC,CAAA,CAAAhC,UAAA,EAAAgC,CAAA,CAAAnB,YAAA,KAAAmB,CAAA,CAAAnB,YAAA,cAAAmB,CAAA,IAAAA,CAAA,CAAAyB,WAAA,MAAAzB,CAAA,CAAAlB,QAAA,QAAAkB,CAAA,GAAAxC,CAAA,CAAAyF,KAAA,GAAAC,OAAA,GAAAC,MAAA,WAAA3F,CAAA,EAAAyB,CAAA,WAAAA,CAAA,CAAAG,CAAA,EAAA7B,CAAA,EAAAC,CAAA,KAAAA,CAAA,KAAAwC,CAAA,GAAAG,CAAA,eAAAH,CAAA,CAAAyB,WAAA,KAAAzB,CAAA,CAAApB,KAAA,GAAAoB,CAAA,CAAAyB,WAAA,GAAAzB,CAAA,CAAAyB,WAAA,CAAApB,IAAA,CAAAF,CAAA,YAAAH,CAAA,CAAAyB,WAAA,uBAAAzB,CAAA,CAAAyB,WAAA,IAAA/D,MAAA,CAAAgB,cAAA,CAAAU,CAAA,EAAA7B,CAAA,EAAAyC,CAAA,WAAAA,CAAA;AAAA,SAAAoD,0BAAA5F,CAAA,EAAAD,CAAA,UAAA8F,KAAA;AAeA,IAAMC,sBAAsB,GAC1B,wEAAwE;AAC1E,IAAMC,yBAAyB,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI;AAAC,IAWxCC,WAAW,GAAAC,OAAA,CAAAD,WAAA,IAAAzG,IAAA,GATvB,IAAA2G,UAAM,EAAC;EACNC,IAAI,EAAE,aAAa;EACnBC,IAAI,EAAE,CACJ,QAAQ,EACR,eAAe,EACf,WAAW,EACX;IAAEC,GAAG,EAAE,oBAAoB;IAAEC,QAAQ,EAAE;EAAK,CAAC;AAEjD,CAAC,CAAC,EAAA/G,IAAA,CAAAC,MAAA,IAAAC,OAAA,0BAAA8G,UAAA;EAEA,SAAAP,YAAYI,IAAU,EAAE;IAAA,IAAAI,KAAA;IAAAtC,eAAA,OAAA8B,WAAA;IACtBQ,KAAA,GAAA7B,UAAA,OAAAqB,WAAA,GAAM;MACJI,IAAI,EAAJA,IAAI;MACJK,iBAAiB,EAAE,IAAI;MACvBC,UAAU,EAAE;IACd,CAAC;IAAE1C,0BAAA,CAAAwC,KAAA,YAAA9G,WAAA,EAAA8G,KAAA;IAAAxC,0BAAA,CAAAwC,KAAA,wBAAA7G,YAAA,EAAA6G,KAAA;IAAAxC,0BAAA,CAAAwC,KAAA,aAAA5G,YAAA,EAAA4G,KAAA;IAAAxC,0BAAA,CAAAwC,KAAA,mBAAA3G,YAAA,EAAA2G,KAAA;IACHA,KAAA,CAAKG,kBAAkB,GAAGH,KAAA,CAAKI,qBAAqB;IAAC,OAAAJ,KAAA;EACvD;EAAClB,SAAA,CAAAU,WAAA,EAAAO,UAAA;EAAA,OAAAlC,YAAA,CAAA2B,WAAA;IAAA5B,GAAA;IAAAhD,KAAA,EAED,SAASyF,MAAMA,CAAA,EAAG;MAChB,IAAI,IAAI,CAACC,OAAO,EAAE;QAChB,IAAI,CAACC,iBAAiB,CAAC,CAAC;MAC1B;IACF;EAAC;IAAA3C,GAAA;IAAA4C,GAAA,EAUD,SAAAA,IAAA,EAAmC;MACjC,OAAOC,+DAAiC,CAACD,GAAG,CAAC,CAAC;IAChD;EAAC;IAAA5C,GAAA;IAAAhD,KAAA,EASD,SACA8F,UAAUA,CAAAC,IAAA,EAKS;MAAA,IAJjBC,MAAM,GAAAD,IAAA,CAANC,MAAM;QACNC,aAAa,GAAAF,IAAA,CAAbE,aAAa;QACbP,OAAO,GAAAK,IAAA,CAAPL,OAAO;QACPQ,iBAAiB,GAAAH,IAAA,CAAjBG,iBAAiB;MAEjB,IAAI,CAACF,MAAM,GAAGA,MAAM;MACpB,IAAI,CAACT,kBAAkB,GAAGU,aAAa;MACvC,IAAI,CAACP,OAAO,GAAGA,OAAO;MACtBG,+DAAiC,CAACM,GAAG,CACnCD,iBAAiB,GAAGE,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,IACnC,CAAC;IACH;EAAC;IAAArD,GAAA;IAAAhD,KAAA,EAED,SACAsG,mBAAmBA,CAAA,EAAG;MACpB,IAAI,CAACC,aAAa,EAAE;IACtB;EAAC;IAAAvD,GAAA;IAAAhD,KAAA;MAAA,IAAAwG,kBAAA,GAAA/D,iBAAA,cAAAtC,YAAA,GAAA+B,CAAA,CAED,SAAAuE,QAAA;QAAA,IAAAC,SAAA,EAAAC,SAAA,EAAAC,qBAAA,EAAAC,qBAAA;QAAA,OAAA1G,YAAA,GAAA8B,CAAA,WAAA6E,QAAA;UAAA,kBAAAA,QAAA,CAAAzG,CAAA;YAAA;cACQqG,SAAS,GAAG,IAAI,CAACK,YAAY,CAAC,CAAC;cAAA,KACjCL,SAAS,CAACM,eAAe;gBAAAF,QAAA,CAAAzG,CAAA;gBAAA;cAAA;cAC3B;cACMsG,SAAS,GAAG,IAAI,CAACM,KAAK,CAACC,MAAM,CAACC,OAAO,CAACC,QAAQ,CAAC,CAAC,CAACT,SAAS,CAAC,CAAC;cAAA,KAC9DA,SAAS;gBAAAG,QAAA,CAAAzG,CAAA;gBAAA;cAAA;cAAAyG,QAAA,CAAAzG,CAAA;cAAA,QAAAuG,qBAAA,GACLD,SAAS,CAACU,kBAAkB,cAAAT,qBAAA,uBAA5BA,qBAAA,CAAAnF,IAAA,CAAAkF,SAA+B,CAAC;YAAA;cAAAG,QAAA,CAAAzG,CAAA;cAAA,QAAAwG,qBAAA,GAChCF,SAAS,CAACW,iBAAiB,cAAAT,qBAAA,uBAA3BA,qBAAA,CAAApF,IAAA,CAAAkF,SAA8B,CAAC;YAAA;cAGzC,IAAI,CAACM,KAAK,CAACC,MAAM,CAACC,OAAO,GAAG,IAAII,QAAG,CAAC,IAAAC,8BAAwB,EAACd,SAAS,CAAC,CAAC;cACxE,IAAIA,SAAS,CAACM,eAAe,IAAIN,SAAS,CAACe,iBAAiB,KAAK,KAAK,EAAE;gBACtE;gBACA,IAAI,CAACR,KAAK,CAACC,MAAM,CAACC,OAAO,CAACC,QAAQ,CAAC,CAAC,CAACM,aAAa,CAAC,CAAC;cACtD;YAAC;cAAA,OAAAZ,QAAA,CAAA1F,CAAA;UAAA;QAAA,GAAAqF,OAAA;MAAA,CACF;MAAA,SAfed,iBAAiBA,CAAA;QAAA,OAAAa,kBAAA,CAAAlH,KAAA,OAAAE,SAAA;MAAA;MAAA,OAAjBmG,iBAAiB;IAAA;EAAA;IAAA3C,GAAA;IAAAhD,KAAA,EAiBjC,SAAA+G,YAAYA,CAAA,EAAG;MACb,IAAMY,SAAS,GAAApI,aAAA,KACV,IAAI,CAAC0H,KAAK,CAACP,SAAS,CACxB;MACD,IAAI,IAAI,CAAChB,OAAO,EAAE;QAChBiC,SAAS,CAAC3B,MAAM,GAAG,IAAI,CAACA,MAAM;QAC9B2B,SAAS,CAACC,eAAe,GAAG,IAAI,CAAC5B,MAAM;MACzC;MACA,OAAO2B,SAAS;IAClB;EAAC;IAAA3E,GAAA;IAAAhD,KAAA;MAAA,IAAA6H,QAAA,GAAApF,iBAAA,cAAAtC,YAAA,GAAA+B,CAAA,CAED,SAAA4F,SAAAC,KAAA;QAAA,IAAA/B,MAAA,EAAAC,aAAA,EAAAP,OAAA,EAAAsC,qBAAA,EAAA9B,iBAAA,EAAA+B,qBAAA,EAAAC,kBAAA,EAAAC,YAAA;QAAA,OAAAhI,YAAA,GAAA8B,CAAA,WAAAmG,SAAA;UAAA,kBAAAA,SAAA,CAAA/H,CAAA;YAAA;cAEE2F,MAAM,GAAA+B,KAAA,CAAN/B,MAAM,EACNC,aAAa,GAAA8B,KAAA,CAAb9B,aAAa,EACbP,OAAO,GAAAqC,KAAA,CAAPrC,OAAO,EAAAsC,qBAAA,GAAAD,KAAA,CACP7B,iBAAiB,EAAjBA,iBAAiB,GAAA8B,qBAAA,cAAG,KAAK,GAAAA,qBAAA,EAAAC,qBAAA,GAAAF,KAAA,CACzBG,kBAAkB,EAAlBA,kBAAkB,GAAAD,qBAAA,cAAG,KAAK,GAAAA,qBAAA;cAE1B;cACME,YAAY,GAChBD,kBAAkB,IAClB,IAAI,CAACxC,OAAO,KAAKA,OAAO,IACvBA,OAAO,IAAI,IAAI,CAACM,MAAM,KAAKA,MAAO;cAErC,IAAI,CAACF,UAAU,CAAC;gBACdE,MAAM,EAANA,MAAM;gBACNC,aAAa,EAAbA,aAAa;gBACbP,OAAO,EAAPA,OAAO;gBACPQ,iBAAiB,EAAjBA;cACF,CAAC,CAAC;cAAC,KAECiC,YAAY;gBAAAC,SAAA,CAAA/H,CAAA;gBAAA;cAAA;cAAA+H,SAAA,CAAA/H,CAAA;cAAA,OAER,IAAI,CAACsF,iBAAiB,CAAC,CAAC;YAAA;cAC9B;cACA,IAAI,CAACW,mBAAmB,CAAC,CAAC;YAAC;cAAA,OAAA8B,SAAA,CAAAhH,CAAA;UAAA;QAAA,GAAA0G,QAAA;MAAA,CAE9B;MAAA,SA1BKO,OAAOA,CAAAC,EAAA;QAAA,OAAAT,QAAA,CAAAvI,KAAA,OAAAE,SAAA;MAAA;MAAA,OAAP6I,OAAO;IAAA;EAAA;IAAArF,GAAA;IAAA4C,GAAA,EA4Bb,SAAAA,IAAA,EAAoB;MAClB,OAAO,IAAI,CAACF,OAAO,GAAG,IAAI,CAACH,kBAAkB,GAAG,IAAI,CAACC,qBAAqB;IAC5E;EAAC;IAAAxC,GAAA;IAAA4C,GAAA,EAED,SAAAA,IAAA,EAAwB;MACtB,IAAI,CAAC,IAAI,CAAC2C,sBAAsB,EAAE,OAAO,IAAI;MAE7C,IAAMC,SAAS,GAAG,IAAI,CAACC,4BAA4B;MACnD,IAAI,CAACD,SAAS,EAAE,OAAO,KAAK;MAE5B,IAAME,gBAAgB,GAAGtC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGmC,SAAS,GAAG7D,yBAAyB;MAE3E,IAAI,CAAC+D,gBAAgB,EAAE;QACrB;QACA7C,+DAAiC,CAACM,GAAG,CAAC,IAAI,CAAC;MAC7C;MAEA,OAAOuC,gBAAgB;IACzB;;IAEA;AACF;AACA;EAFE;IAAA1F,GAAA;IAAA4C,GAAA,EAGA,SAAAA,IAAA,EAA6B;MAC3B,OAAO5B,OAAO;MACZ;MACC,CAAC2E,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,YAAY;MACrC;MACAF,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,MAAM,KAC/BF,OAAO,CAACC,GAAG,CAACE,iBAAiB,IAC7B,CAAC,KAAK,EAAE,OAAO,EAAE,KAAK,CAAC,CAACC,QAAQ,CAACJ,OAAO,CAACC,GAAG,CAACE,iBAAiB,CAAC;MAC/D;MACAH,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,aAC7B,CAAC;IACH;EAAC;IAAA7F,GAAA;IAAA4C,GAAA,EAED,SAAAA,IAAA,EAAsC;MAAA,IAAAoD,qBAAA,EAAAC,sBAAA;MACpC,QAAAD,qBAAA,IAAAC,sBAAA,GACE,IAAI,CAAChC,KAAK,CAACiC,kBAAkB,cAAAD,sBAAA,uBAA7BA,sBAAA,CAA+BE,oBAAoB,cAAAH,qBAAA,cAAAA,qBAAA,GACnDtE,sBAAsB;IAE1B;EAAC;AAAA,EAzJ8B0E,gBAAU,GAAA9K,WAAA,GAAA8F,yBAAA,CAAA/F,OAAA,CAAAqC,SAAA,aAgBxC2I,mBAAa,EACbC,WAAK;EAAArJ,YAAA;EAAAb,UAAA;EAAAc,QAAA;EAAA2C,WAAA,WAAAA,YAAA;IAAA,OACwB0E,QAAG,CAACvB,MAAM,CAACuD,OAAO;EAAA;AAAA,IAAAhL,YAAA,GAAA6F,yBAAA,CAAA/F,OAAA,CAAAqC,SAAA,yBAE/C2I,mBAAa,EACbC,WAAK;EAAArJ,YAAA;EAAAb,UAAA;EAAAc,QAAA;EAAA2C,WAAA,WAAAA,YAAA;IAAA,OAC8B,IAAI;EAAA;AAAA,IAAArE,YAAA,GAAA4F,yBAAA,CAAA/F,OAAA,CAAAqC,SAAA,cAMvC2I,mBAAa,EACbC,WAAK;EAAArJ,YAAA;EAAAb,UAAA;EAAAc,QAAA;EAAA2C,WAAA,WAAAA,YAAA;IAAA,OACI,KAAK;EAAA;AAAA,IAAApE,YAAA,GAAA2F,yBAAA,CAAA/F,OAAA,CAAAqC,SAAA,oBAEd4I,WAAK;EAAArJ,YAAA;EAAAb,UAAA;EAAAc,QAAA;EAAA2C,WAAA,WAAAA,YAAA;IAAA,OACU,CAAC;EAAA;AAAA,IAAAuB,yBAAA,CAAA/F,OAAA,CAAAqC,SAAA,iBAEhB8I,YAAM,GAAA1K,MAAA,CAAAK,wBAAA,CAAAd,OAAA,CAAAqC,SAAA,iBAAArC,OAAA,CAAAqC,SAAA,GAAA0D,yBAAA,CAAA/F,OAAA,CAAAqC,SAAA,0BAeN8I,YAAM,GAAA1K,MAAA,CAAAK,wBAAA,CAAAd,OAAA,CAAAqC,SAAA,0BAAArC,OAAA,CAAAqC,SAAA,GAAA0D,yBAAA,CAAA/F,OAAA,CAAAqC,SAAA,cAiCN+I,gBAAO,GAAA3K,MAAA,CAAAK,wBAAA,CAAAd,OAAA,CAAAqC,SAAA,cAAArC,OAAA,CAAAqC,SAAA,GAAArC,OAAA,MAAAD,MAAA","ignoreList":[]}
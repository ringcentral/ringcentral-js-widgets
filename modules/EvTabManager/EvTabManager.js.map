{"version":3,"file":"EvTabManager.js","names":["_events","require","_di","_TabManager2","_core","_enums","_dec","_class","_class2","_descriptor","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","args","arguments","apply","err","undefined","_initializerDefineProperty","target","property","descriptor","context","Object","defineProperty","enumerable","configurable","writable","initializer","call","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","i","length","_toPropertyKey","_createClass","protoProps","staticProps","prototype","_toPrimitive","_typeof","String","input","hint","prim","Symbol","toPrimitive","res","Number","_inherits","subClass","superClass","create","constructor","_setPrototypeOf","o","p","setPrototypeOf","bind","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","_possibleConstructorReturn","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","_applyDecoratedDescriptor","decorators","desc","keys","forEach","slice","reverse","reduce","decorator","_initializerWarningHelper","Error","EvTabManager","Module","name","deps","_TabManager","_super","_this","_len","Array","_key","concat","_eventEmitter","EventEmitter","setMainTabId","id","setMainTabIdInThisTab","_sendTabManager","tabManagerEvents","SET_MIAN_TAB_ID","mainTabId","event","send","emitSetMainTabComplete","console","log","emit","SET_MAIN_TAB_COMPLETE","onSetMainTabComplete","callback","on","_checkIsMainTabAlive","regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","abrupt","enable","checkTabAliveById","stop","checkIsMainTabAlive","get","_this2","tabbie","actualTabIds","find","tab","prefix","TabManager","globalStorage","state","action","getOwnPropertyDescriptor","exports"],"sources":["modules/EvTabManager/EvTabManager.ts"],"sourcesContent":["import { EventEmitter } from 'events';\n\nimport { Module } from '@ringcentral-integration/commons/lib/di';\nimport { TabManager } from '@ringcentral-integration/commons/modules/TabManager';\nimport { action, globalStorage, state } from '@ringcentral-integration/core';\n\nimport { tabManagerEvents } from '../../enums';\n\n@Module({\n  name: 'TabManager',\n  deps: ['GlobalStorage'],\n})\nclass EvTabManager extends TabManager {\n  private _eventEmitter = new EventEmitter();\n\n  @globalStorage\n  @state\n  mainTabId: string = null;\n\n  setMainTabId(id: string) {\n    this.setMainTabIdInThisTab(id);\n    // could not use Storage module because of DI circular dependency\n    this._sendTabManager(tabManagerEvents.SET_MIAN_TAB_ID, id);\n  }\n\n  @action\n  setMainTabIdInThisTab(id: string) {\n    this.mainTabId = id;\n  }\n\n  private _sendTabManager(event: string, value?: any) {\n    this.send(event, value);\n  }\n\n  emitSetMainTabComplete() {\n    console.log('_emitSetMainTabComplete~');\n    this._eventEmitter.emit(tabManagerEvents.SET_MAIN_TAB_COMPLETE);\n  }\n\n  onSetMainTabComplete(callback: () => void) {\n    this._eventEmitter.on(tabManagerEvents.SET_MAIN_TAB_COMPLETE, callback);\n  }\n\n  async checkIsMainTabAlive() {\n    return (\n      !this.enable ||\n      (this.mainTabId &&\n        // check if tab exist by finding in storaged tabs\n        this.checkTabAliveById(this.mainTabId))\n    );\n  }\n\n  get firstTabIdExcludeMainTab() {\n    return (\n      this.tabbie.actualTabIds.find((tab) => tab !== this.mainTabId) || null\n    );\n  }\n\n  get isMainTab() {\n    return !this.enable || this.mainTabId === this.id;\n  }\n\n  get prefix() {\n    return this.tabbie.prefix;\n  }\n}\n\nexport { EvTabManager };\n"],"mappings":"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"}
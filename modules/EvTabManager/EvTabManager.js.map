{"version":3,"sources":["modules/EvTabManager/EvTabManager.ts"],"names":["EvTabManager","name","deps","_eventEmitter","EventEmitter","id","setMainTabIdInThisTab","_sendTabManager","tabManagerEvents","SET_MIAN_TAB_ID","mainTabId","event","value","send","console","log","emit","SET_MAIN_TAB_COMPLETE","callback","on","enable","checkTabAliveById","tabbie","actualTabIds","find","tab","prefix","TabManager","globalStorage","state","action"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AAEA;;AACA;;AACA;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAMMA,Y,WAJL,gBAAO;AACNC,EAAAA,IAAI,EAAE,YADA;AAENC,EAAAA,IAAI,EAAE,CAAC,eAAD;AAFA,CAAP,C;;;;;;;;;;;;;;;UAKSC,a,GAAgB,IAAIC,oBAAJ,E;;;;;;;;;iCAMXC,E,EAAY;AACvB,WAAKC,qBAAL,CAA2BD,EAA3B,EADuB,CAEvB;;AACA,WAAKE,eAAL,CAAqBC,wBAAiBC,eAAtC,EAAuDJ,EAAvD;AACD;;;0CAGqBA,E,EAAY;AAChC,WAAKK,SAAL,GAAiBL,EAAjB;AACD;;;oCAEuBM,K,EAAeC,K,EAAa;AAClD,WAAKC,IAAL,CAAUF,KAAV,EAAiBC,KAAjB;AACD;;;6CAEwB;AACvBE,MAAAA,OAAO,CAACC,GAAR,CAAY,0BAAZ;;AACA,WAAKZ,aAAL,CAAmBa,IAAnB,CAAwBR,wBAAiBS,qBAAzC;AACD;;;yCAEoBC,Q,EAAsB;AACzC,WAAKf,aAAL,CAAmBgB,EAAnB,CAAsBX,wBAAiBS,qBAAvC,EAA8DC,QAA9D;AACD;;;;;;;;;iDAIG,CAAC,KAAKE,MAAN,IACC,KAAKV,SAAL,IACC;AACA,qBAAKW,iBAAL,CAAuB,KAAKX,SAA5B,C;;;;;;;;;;;;;;;;;;wBAIyB;AAAA;;AAC7B,aACE,KAAKY,MAAL,CAAYC,YAAZ,CAAyBC,IAAzB,CAA8B,UAACC,GAAD;AAAA,eAASA,GAAG,KAAK,MAAI,CAACf,SAAtB;AAAA,OAA9B,KAAkE,IADpE;AAGD;;;wBAEe;AACd,aAAO,CAAC,KAAKU,MAAN,IAAgB,KAAKV,SAAL,KAAmB,KAAKL,EAA/C;AACD;;;wBAEY;AACX,aAAO,KAAKiB,MAAL,CAAYI,MAAnB;AACD;;;;EApDwBC,uB,6EAGxBC,mB,EACAC,W;;;;;WACmB,I;;2EAQnBC,Y","sourcesContent":["import { EventEmitter } from 'events';\n\nimport { Module } from '@ringcentral-integration/commons/lib/di';\nimport { TabManager } from '@ringcentral-integration/commons/modules/TabManager';\nimport { action, globalStorage, state } from '@ringcentral-integration/core';\n\nimport { tabManagerEvents } from '../../enums';\n\n@Module({\n  name: 'TabManager',\n  deps: ['GlobalStorage'],\n})\nclass EvTabManager extends TabManager {\n  private _eventEmitter = new EventEmitter();\n\n  @globalStorage\n  @state\n  mainTabId: string = null;\n\n  setMainTabId(id: string) {\n    this.setMainTabIdInThisTab(id);\n    // could not use Storage module because of DI circular dependency\n    this._sendTabManager(tabManagerEvents.SET_MIAN_TAB_ID, id);\n  }\n\n  @action\n  setMainTabIdInThisTab(id: string) {\n    this.mainTabId = id;\n  }\n\n  private _sendTabManager(event: string, value?: any) {\n    this.send(event, value);\n  }\n\n  emitSetMainTabComplete() {\n    console.log('_emitSetMainTabComplete~');\n    this._eventEmitter.emit(tabManagerEvents.SET_MAIN_TAB_COMPLETE);\n  }\n\n  onSetMainTabComplete(callback: () => void) {\n    this._eventEmitter.on(tabManagerEvents.SET_MAIN_TAB_COMPLETE, callback);\n  }\n\n  async checkIsMainTabAlive() {\n    return (\n      !this.enable ||\n      (this.mainTabId &&\n        // check if tab exist by finding in storaged tabs\n        this.checkTabAliveById(this.mainTabId))\n    );\n  }\n\n  get firstTabIdExcludeMainTab() {\n    return (\n      this.tabbie.actualTabIds.find((tab) => tab !== this.mainTabId) || null\n    );\n  }\n\n  get isMainTab() {\n    return !this.enable || this.mainTabId === this.id;\n  }\n\n  get prefix() {\n    return this.tabbie.prefix;\n  }\n}\n\nexport { EvTabManager };\n"],"file":"EvTabManager.js"}
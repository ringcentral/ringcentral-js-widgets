{"version":3,"file":"EvTabManager.js","names":["_di","require","_TabManager2","_core","_events","_enums","_dec","_class","_class2","_descriptor","asyncGeneratorStep","n","t","e","r","o","a","c","i","u","value","done","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_initializerDefineProperty","l","Object","defineProperty","enumerable","configurable","writable","initializer","call","_classCallCheck","TypeError","_defineProperties","length","_toPropertyKey","key","_createClass","prototype","_toPrimitive","_typeof","Symbol","toPrimitive","String","Number","_inherits","create","constructor","_setPrototypeOf","setPrototypeOf","bind","__proto__","_createSuper","_isNativeReflectConstruct","_getPrototypeOf","s","Reflect","construct","_possibleConstructorReturn","_assertThisInitialized","ReferenceError","Boolean","valueOf","getPrototypeOf","_applyDecoratedDescriptor","keys","forEach","slice","reverse","reduce","_initializerWarningHelper","Error","EvTabManager","Module","name","deps","_TabManager","_super","_this","_len","args","Array","_key","concat","_eventEmitter","EventEmitter","setMainTabId","id","setMainTabIdInThisTab","_sendTabManager","tabManagerEvents","SET_MIAN_TAB_ID","mainTabId","event","send","emitSetMainTabComplete","console","log","emit","SET_MAIN_TAB_COMPLETE","onSetMainTabComplete","callback","on","_checkIsMainTabAlive","regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","abrupt","enable","checkTabAliveById","stop","checkIsMainTabAlive","get","_this2","tabbie","actualTabIds","find","tab","prefix","TabManager","globalStorage","state","action","getOwnPropertyDescriptor","exports"],"sources":["modules/EvTabManager/EvTabManager.ts"],"sourcesContent":["import { Module } from '@ringcentral-integration/commons/lib/di';\nimport { TabManager } from '@ringcentral-integration/commons/modules/TabManager';\nimport { action, globalStorage, state } from '@ringcentral-integration/core';\nimport { EventEmitter } from 'events';\n\nimport { tabManagerEvents } from '../../enums';\n\n@Module({\n  name: 'TabManager',\n  deps: ['GlobalStorage'],\n})\nclass EvTabManager extends TabManager {\n  private _eventEmitter = new EventEmitter();\n\n  @globalStorage\n  @state\n  mainTabId: string = null;\n\n  setMainTabId(id: string) {\n    this.setMainTabIdInThisTab(id);\n    // could not use Storage module because of DI circular dependency\n    this._sendTabManager(tabManagerEvents.SET_MIAN_TAB_ID, id);\n  }\n\n  @action\n  setMainTabIdInThisTab(id: string) {\n    this.mainTabId = id;\n  }\n\n  private _sendTabManager(event: string, value?: any) {\n    this.send(event, value);\n  }\n\n  emitSetMainTabComplete() {\n    console.log('_emitSetMainTabComplete~');\n    this._eventEmitter.emit(tabManagerEvents.SET_MAIN_TAB_COMPLETE);\n  }\n\n  onSetMainTabComplete(callback: () => void) {\n    this._eventEmitter.on(tabManagerEvents.SET_MAIN_TAB_COMPLETE, callback);\n  }\n\n  async checkIsMainTabAlive() {\n    return (\n      !this.enable ||\n      (this.mainTabId &&\n        // check if tab exist by finding in storaged tabs\n        this.checkTabAliveById(this.mainTabId))\n    );\n  }\n\n  get firstTabIdExcludeMainTab() {\n    return (\n      this.tabbie.actualTabIds.find((tab) => tab !== this.mainTabId) || null\n    );\n  }\n\n  get isMainTab() {\n    return !this.enable || this.mainTabId === this.id;\n  }\n\n  get prefix() {\n    return this.tabbie.prefix;\n  }\n}\n\nexport { EvTabManager };\n"],"mappings":"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","ignoreList":[]}
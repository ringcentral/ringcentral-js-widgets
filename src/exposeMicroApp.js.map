{"version":3,"file":"exposeMicroApp.js","names":["_nextCore","require","_mfeReact","_react","_interopRequireDefault","e","__esModule","_extends","Object","assign","bind","n","arguments","length","t","r","hasOwnProperty","call","apply","_regenerator","Symbol","iterator","o","toStringTag","i","c","prototype","Generator","u","create","_regeneratorDefine2","f","p","y","G","v","a","d","l","TypeError","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","w","m","defineProperty","_regeneratorDefine","_invoke","enumerable","configurable","writable","_typeof","constructor","ownKeys","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","push","_objectSpread","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","_toPropertyKey","_toPrimitive","toPrimitive","String","Number","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","_next","_throw","_objectDestructuringEmpty","exposeMicroApp","exports","_ref","options","BootstrapView","expose","init","_init","_callee","inject","view","_context","createSharedApp","render","app","target","undefined","_x","element","renderRoot","props","mfeId","global","bootstrap","createElement","unmountComponentAtNode"],"sources":["src/exposeMicroApp.tsx"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\nimport {\n  App,\n  createSharedApp,\n  render,\n  unmountComponentAtNode,\n} from '@ringcentral-integration/next-core';\nimport type {\n  RendererType,\n  SharedAppConfig,\n  PartialKeys,\n} from '@ringcentral-integration/next-core';\nimport { expose } from '@ringcentral/mfe-react';\nimport React from 'react';\n\ntype Options<T, S extends any[], R extends RendererType<S>> = PartialKeys<\n  SharedAppConfig<T, S, R>,\n  'render'\n>;\n\ninterface ExposeMicroAppOptions<T, S extends any[], R extends RendererType<S>>\n  extends Pick<Options<T, S, R>, Exclude<keyof Options<T, S, R>, 'render'>> {\n  /**\n   * As a app shell, it will render in the root element.\n   */\n  renderRoot?: () => HTMLElement | null;\n}\n\nexport const exposeMicroApp = <T, S extends any[], R extends RendererType<S>>({\n  ...options\n}: ExposeMicroAppOptions<T, S, R>) => {\n  let BootstrapView = () => null;\n  return expose({\n    init: async (inject: any) => {\n      if (inject) {\n        const view = await inject(options);\n        BootstrapView = view;\n        return;\n      }\n      return createSharedApp({\n        ...options,\n        render: (app: JSX.Element, ...args: any[]) => {\n          const target = args[0];\n          if (typeof target === 'object') {\n            return render(app, target) as ReturnType<R>;\n          }\n          return render(app, args[1]) as ReturnType<R>;\n        },\n      }) as Promise<App<T, S, R>>;\n    },\n    render: (element = options.renderRoot!(), props?: any, mfeId?: string) => {\n      if (props) {\n        global.app.bootstrap(\n          () => <BootstrapView {...props} mfeId={mfeId} />,\n          element,\n        );\n      } else {\n        global.app.bootstrap(element);\n      }\n      return () => {\n        unmountComponentAtNode(element!);\n      };\n    },\n  });\n};\n"],"mappings":"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","ignoreList":[]}
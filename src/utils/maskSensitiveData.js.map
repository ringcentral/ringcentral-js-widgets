{"version":3,"file":"maskSensitiveData.js","names":["maskSensitiveData","value","visibleLength","arguments","length","undefined","maskChar","str","String","repeat","visiblePart","substring","maskedPart","maskPhoneNumber","phoneNumber","visibleStart","visibleEnd","maskedMiddle","maskEmail","email","_email$split","split","_email$split2","_slicedToArray","username","domain","Math","max","visibleUsername","maskedUsername","concat","maskIdNumber","idNumber"],"sources":["src/utils/maskSensitiveData.ts"],"sourcesContent":["/**\n * Mask sensitive data - hide sensitive information\n * @param value Value to be masked\n * @param visibleLength Length to display from the beginning\n * @param maskChar Character used for masking\n * @returns Masked string\n */\nexport function maskSensitiveData(\n  value: string | number | undefined | null,\n  visibleLength: number = 3,\n  maskChar: string = '*',\n): string {\n  if (!value) return '***';\n\n  const str = String(value);\n  if (str.length <= visibleLength) {\n    return maskChar.repeat(str.length);\n  }\n\n  const visiblePart = str.substring(0, visibleLength);\n  const maskedPart = maskChar.repeat(str.length - visibleLength);\n  return visiblePart + maskedPart;\n}\n\n/**\n * Mask phone number - show first 3 and last 4 digits\n * @param phoneNumber Phone number to mask\n * @returns Masked phone number\n */\nexport function maskPhoneNumber(\n  phoneNumber: string | number | undefined | null,\n): string {\n  if (!phoneNumber) return '***';\n\n  const str = String(phoneNumber);\n  if (str.length <= 7) {\n    return maskSensitiveData(str, 3);\n  }\n\n  const visibleStart = str.substring(0, 3);\n  const visibleEnd = str.substring(str.length - 4);\n  const maskedMiddle = '*'.repeat(str.length - 7);\n  return visibleStart + maskedMiddle + visibleEnd;\n}\n\n/**\n * Mask email - show first 2 characters of username and domain\n * @param email Email address to mask\n * @returns Masked email\n */\nexport function maskEmail(email: string | undefined | null): string {\n  if (!email) return '***';\n\n  const [username, domain] = email.split('@');\n  if (!username || !domain) {\n    // For invalid emails, show first 2 characters and mask the rest\n    const visiblePart = email.substring(0, 2);\n    const maskedPart = '*'.repeat(Math.max(0, email.length - 2));\n    return visiblePart + maskedPart;\n  }\n\n  if (username.length <= 2) {\n    const visibleUsername = username.substring(0, 1);\n    const maskedUsername = '*'.repeat(Math.max(1, username.length - 1));\n    return `${visibleUsername}${maskedUsername}@${domain}`;\n  }\n\n  const visibleUsername = username.substring(0, 2);\n  const maskedUsername = '*'.repeat(username.length - 2);\n  return `${visibleUsername}${maskedUsername}@${domain}`;\n}\n\n/**\n * Mask ID number - show first 4 and last 4 digits\n * @param idNumber ID number to mask\n * @returns Masked ID number\n */\nexport function maskIdNumber(idNumber: string | undefined | null): string {\n  if (!idNumber) return '***';\n\n  const str = String(idNumber);\n  if (str.length <= 8) {\n    return maskSensitiveData(str, 4);\n  }\n\n  const visibleStart = str.substring(0, 4);\n  const visibleEnd = str.substring(str.length - 4);\n  const maskedMiddle = '*'.repeat(str.length - 8);\n  return visibleStart + maskedMiddle + visibleEnd;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASA,iBAAiBA,CAC/BC,KAAyC,EAGjC;EAAA,IAFRC,aAAqB,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,CAAC;EAAA,IACzBG,QAAgB,GAAAH,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,GAAG;EAEtB,IAAI,CAACF,KAAK,EAAE,OAAO,KAAK;EAExB,IAAMM,GAAG,GAAGC,MAAM,CAACP,KAAK,CAAC;EACzB,IAAIM,GAAG,CAACH,MAAM,IAAIF,aAAa,EAAE;IAC/B,OAAOI,QAAQ,CAACG,MAAM,CAACF,GAAG,CAACH,MAAM,CAAC;EACpC;EAEA,IAAMM,WAAW,GAAGH,GAAG,CAACI,SAAS,CAAC,CAAC,EAAET,aAAa,CAAC;EACnD,IAAMU,UAAU,GAAGN,QAAQ,CAACG,MAAM,CAACF,GAAG,CAACH,MAAM,GAAGF,aAAa,CAAC;EAC9D,OAAOQ,WAAW,GAAGE,UAAU;AACjC;;AAEA;AACA;AACA;AACA;AACA;AACO,SAASC,eAAeA,CAC7BC,WAA+C,EACvC;EACR,IAAI,CAACA,WAAW,EAAE,OAAO,KAAK;EAE9B,IAAMP,GAAG,GAAGC,MAAM,CAACM,WAAW,CAAC;EAC/B,IAAIP,GAAG,CAACH,MAAM,IAAI,CAAC,EAAE;IACnB,OAAOJ,iBAAiB,CAACO,GAAG,EAAE,CAAC,CAAC;EAClC;EAEA,IAAMQ,YAAY,GAAGR,GAAG,CAACI,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC;EACxC,IAAMK,UAAU,GAAGT,GAAG,CAACI,SAAS,CAACJ,GAAG,CAACH,MAAM,GAAG,CAAC,CAAC;EAChD,IAAMa,YAAY,GAAG,GAAG,CAACR,MAAM,CAACF,GAAG,CAACH,MAAM,GAAG,CAAC,CAAC;EAC/C,OAAOW,YAAY,GAAGE,YAAY,GAAGD,UAAU;AACjD;;AAEA;AACA;AACA;AACA;AACA;AACO,SAASE,SAASA,CAACC,KAAgC,EAAU;EAClE,IAAI,CAACA,KAAK,EAAE,OAAO,KAAK;EAExB,IAAAC,YAAA,GAA2BD,KAAK,CAACE,KAAK,CAAC,GAAG,CAAC;IAAAC,aAAA,GAAAC,cAAA,CAAAH,YAAA;IAApCI,QAAQ,GAAAF,aAAA;IAAEG,MAAM,GAAAH,aAAA;EACvB,IAAI,CAACE,QAAQ,IAAI,CAACC,MAAM,EAAE;IACxB;IACA,IAAMf,WAAW,GAAGS,KAAK,CAACR,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC;IACzC,IAAMC,UAAU,GAAG,GAAG,CAACH,MAAM,CAACiB,IAAI,CAACC,GAAG,CAAC,CAAC,EAAER,KAAK,CAACf,MAAM,GAAG,CAAC,CAAC,CAAC;IAC5D,OAAOM,WAAW,GAAGE,UAAU;EACjC;EAEA,IAAIY,QAAQ,CAACpB,MAAM,IAAI,CAAC,EAAE;IACxB,IAAMwB,gBAAe,GAAGJ,QAAQ,CAACb,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC;IAChD,IAAMkB,eAAc,GAAG,GAAG,CAACpB,MAAM,CAACiB,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEH,QAAQ,CAACpB,MAAM,GAAG,CAAC,CAAC,CAAC;IACnE,UAAA0B,MAAA,CAAUF,gBAAe,EAAAE,MAAA,CAAGD,eAAc,OAAAC,MAAA,CAAIL,MAAM;EACtD;EAEA,IAAMG,eAAe,GAAGJ,QAAQ,CAACb,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC;EAChD,IAAMkB,cAAc,GAAG,GAAG,CAACpB,MAAM,CAACe,QAAQ,CAACpB,MAAM,GAAG,CAAC,CAAC;EACtD,UAAA0B,MAAA,CAAUF,eAAe,EAAAE,MAAA,CAAGD,cAAc,OAAAC,MAAA,CAAIL,MAAM;AACtD;;AAEA;AACA;AACA;AACA;AACA;AACO,SAASM,YAAYA,CAACC,QAAmC,EAAU;EACxE,IAAI,CAACA,QAAQ,EAAE,OAAO,KAAK;EAE3B,IAAMzB,GAAG,GAAGC,MAAM,CAACwB,QAAQ,CAAC;EAC5B,IAAIzB,GAAG,CAACH,MAAM,IAAI,CAAC,EAAE;IACnB,OAAOJ,iBAAiB,CAACO,GAAG,EAAE,CAAC,CAAC;EAClC;EAEA,IAAMQ,YAAY,GAAGR,GAAG,CAACI,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC;EACxC,IAAMK,UAAU,GAAGT,GAAG,CAACI,SAAS,CAACJ,GAAG,CAACH,MAAM,GAAG,CAAC,CAAC;EAChD,IAAMa,YAAY,GAAG,GAAG,CAACR,MAAM,CAACF,GAAG,CAACH,MAAM,GAAG,CAAC,CAAC;EAC/C,OAAOW,YAAY,GAAGE,YAAY,GAAGD,UAAU;AACjD","ignoreList":[]}
{"version":3,"file":"getImagePositionColor.js","names":["_memoize","_interopRequireDefault","require","_loadImage","_rgbToHex","e","__esModule","_regenerator","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","w","m","defineProperty","_regeneratorDefine","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","getImagePositionColor","exports","_ref","_callee","url","position","_position$x","_position$y","img","canvas","ctx","hex","_t","_context","loadImage","document","createElement","getContext","width","height","drawImage","getImageData","x","data","rgbToHex","remove","_x","_x2","getImagePositionColorWithCache","memoize","_position$x2","_position$y2","concat","Date","toISOString","split","clearImagePositionColorCache","_getImagePositionColo","_getImagePositionColo2","cache","clear"],"sources":["src/utils/getImagePositionColor.ts"],"sourcesContent":["import memoize from 'lodash/memoize';\n\nimport { loadImage } from './loadImage';\nimport { rgbToHex } from './rgbToHex';\n\n/**\n * get image position color by url\n * @param url image url\n * @param position that color of position of the image in relative of `300x300`, by default is `left-center(0, 150)` of the image\n * @returns color hex\n *\n * ### Remember the url should be same origin or allow fetch the source image\n */\nexport const getImagePositionColor = async (\n  url: string,\n  position?: { x: number; y: number },\n) => {\n  try {\n    const img = await loadImage(url);\n\n    const canvas = document.createElement('canvas');\n    const ctx = canvas.getContext('2d')!;\n\n    canvas.width = 300;\n    canvas.height = 300;\n\n    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n    const p = ctx.getImageData(\n      position?.x ?? 0,\n      position?.y ?? 150, // canvas.height / 2,\n      1,\n      1,\n    ).data;\n    const hex = rgbToHex(p[0], p[1], p[2]);\n\n    canvas.remove();\n    img.remove();\n    return hex;\n  } catch (error) {\n    return '#FFF';\n  }\n};\n\n/**\n * same as `getImagePositionColor` but with cache based on url and position in one day\n */\nexport const getImagePositionColorWithCache = memoize(\n  getImagePositionColor,\n  (url, position) =>\n    `${url}_${position?.x ?? 0}_${position?.y ?? 150}_${\n      new Date().toISOString().split('T')[0]\n    }`,\n);\n\n/**\n * clear cache of `getImagePositionColorWithCache`\n */\nexport const clearImagePositionColorCache = () => {\n  getImagePositionColorWithCache.cache.clear?.();\n};\n"],"mappings":"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","ignoreList":[]}
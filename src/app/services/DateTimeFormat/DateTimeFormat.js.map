{"version":3,"file":"DateTimeFormat.js","names":["_getIntlDateTimeFormatter","_interopRequireDefault","require","_nextCore","_Locale","_dec","_dec2","_dec3","_dec4","_class","e","__esModule","_classCallCheck","a","n","TypeError","_defineProperties","r","t","length","o","enumerable","configurable","writable","Object","defineProperty","_toPropertyKey","key","_createClass","prototype","i","_toPrimitive","_typeof","Symbol","toPrimitive","call","String","Number","_callSuper","_getPrototypeOf","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","constructor","apply","_assertThisInitialized","ReferenceError","Boolean","valueOf","setPrototypeOf","getPrototypeOf","bind","__proto__","_inherits","create","value","_setPrototypeOf","DateTimeFormat","exports","injectable","name","target","optional","undefined","metadata","Function","Locale","PortManager","DateTimeFormatOptions","_RcModule","_locale","_portManager","_dateTimeFormatOptions","_this","_formatters","_defaultFormatter","onClient","subscribe","setDefaultFormatter","getIntlDateTimeFormatter","onInit","onReset","addFormatter","_ref","formatter","Error","concat","formatDateTime","_ref2","_this$_defaultFormatt","utcTimestamp","_ref2$locale","locale","currentLocale","type","formatDate","_ref3","formatTime","_ref4","RcModule"],"sources":["src/app/services/DateTimeFormat/DateTimeFormat.ts"],"sourcesContent":["import type { DateTimeFormatter } from '@ringcentral-integration/commons/lib/getIntlDateTimeFormatter';\nimport getIntlDateTimeFormatter from '@ringcentral-integration/commons/lib/getIntlDateTimeFormatter';\nimport {\n  injectable,\n  optional,\n  PortManager,\n  RcModule,\n  subscribe,\n} from '@ringcentral-integration/next-core';\n\nimport { Locale } from '../Locale';\n\nimport type {\n  AddFormatterOptions,\n  DateTimeFormatOptions,\n  FormatDateTimeOptions,\n  FormatOptions,\n} from './DateTimeFormat.interface';\n\n@injectable({\n  name: 'DateTimeFormat',\n})\nexport class DateTimeFormat extends RcModule {\n  public _formatters: Record<string, DateTimeFormatter> = {};\n  protected _defaultFormatter?: DateTimeFormatter;\n\n  constructor(\n    protected _locale: Locale,\n    protected _portManager: PortManager,\n    @optional('DateTimeFormatOptions')\n    protected _dateTimeFormatOptions?: DateTimeFormatOptions,\n  ) {\n    super();\n    this._portManager.onClient(() => {\n      return subscribe(this, () => {\n        this.setDefaultFormatter();\n      });\n    });\n  }\n\n  setDefaultFormatter() {\n    if (!this._defaultFormatter) {\n      this._defaultFormatter = getIntlDateTimeFormatter();\n    }\n  }\n\n  override onInit() {\n    this.setDefaultFormatter();\n  }\n\n  override onReset() {\n    this._formatters = {};\n  }\n\n  addFormatter({ name, formatter }: AddFormatterOptions) {\n    if (!name) {\n      throw new Error('`name` property cannot be empty.');\n    }\n    if (this._formatters[name]) {\n      throw new Error(\n        `A formatter with the same name: ${name} already exists.`,\n      );\n    }\n    if (typeof formatter !== 'function') {\n      throw new Error('formatter must be a function.');\n    }\n    this._formatters[name] = formatter;\n  }\n\n  formatDateTime({\n    name,\n    utcTimestamp,\n    locale = this._locale.currentLocale,\n    type,\n  }: Partial<FormatDateTimeOptions>) {\n    if (name && typeof this._formatters[name] === 'function') {\n      return this._formatters[name]({\n        utcTimestamp,\n        locale,\n        type,\n      });\n    }\n    return this._defaultFormatter?.({\n      utcTimestamp,\n      locale,\n      type,\n    });\n  }\n\n  formatDate({ name, utcTimestamp, locale }: FormatOptions) {\n    return this.formatDateTime({\n      name,\n      utcTimestamp,\n      locale,\n      type: 'date',\n    });\n  }\n\n  formatTime({ name, utcTimestamp, locale }: FormatOptions) {\n    return this.formatDateTime({\n      name,\n      utcTimestamp,\n      locale,\n      type: 'time',\n    });\n  }\n}\n"],"mappings":"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","ignoreList":[]}
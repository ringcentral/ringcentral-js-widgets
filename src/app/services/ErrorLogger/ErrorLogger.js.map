{"version":3,"file":"ErrorLogger.js","names":["_nextCore","require","_nextMicro","Sentry","_interopRequireWildcard","_tracing","_AccountInfo","_Auth","_dec","_dec2","_dec3","_dec4","_dec5","_dec6","_dec7","_class","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","_typeof","has","get","set","_t","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","ownKeys","keys","getOwnPropertySymbols","filter","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","_toPropertyKey","value","configurable","writable","_classCallCheck","a","TypeError","_defineProperties","key","_createClass","prototype","_toPrimitive","Symbol","toPrimitive","String","Number","_callSuper","_getPrototypeOf","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","constructor","_assertThisInitialized","ReferenceError","Boolean","valueOf","setPrototypeOf","getPrototypeOf","bind","_inherits","create","_setPrototypeOf","ignoreErrors","DEFAULT_INTERCEPTED_BRANDS","ErrorLogger","exports","injectable","name","target","inject","undefined","optional","metadata","Function","ErrorLoggerOptions","BrandConfig","Auth","AccountInfo","_RcModule","_errorLoggerOptions","_brandConfig","_auth","_accountInfo","_this","_sentryInitialized","_mfeSentry","_hub","intercepted","_bootstrap","tags","setTags","initialize","options","appVersion","appRelease","environment","sentryConfig","endpoint","_this$_brandConfig","_this$_brandConfig2","_init","dsn","sampleRate","release","integrations","global","document","BrowserTracing","appName","appBrand","code","getMfeMeta","onlyVersion","prefix","_this$_errorLoggerOpt","_ref","_this$_mfeSentry","_this2","initOptions","initMfeSentry","hub","init","beforeSend","event","getCurrentHub","_this3","watch","loggedIn","_this3$_auth","setUser","id","ownerId","accountInfoId","accountId","concat","userBrandId","interceptedBrands","includes","toggle","_this$_errorLoggerOpt2","_this$_errorLoggerOpt3","user","_this$hub","configureScope","scope","_this$hub2","_ref2","log","message","level","eventId","captureMessage","logError","error","captureException","test","testError","setTimeout","Error","RcModule"],"sources":["src/app/services/ErrorLogger/ErrorLogger.ts"],"sourcesContent":["import type { BrandConfig } from '@ringcentral-integration/micro-core/src/app/services';\nimport {\n  injectable,\n  inject,\n  optional,\n  RcModule,\n  watch,\n} from '@ringcentral-integration/next-core';\nimport { getMfeMeta } from '@ringcentral-integration/next-micro';\nimport type { useSentry } from '@ringcentral/mfe-sentry';\nimport * as Sentry from '@sentry/browser';\nimport { BrowserTracing } from '@sentry/tracing';\nimport type { SeverityLevel, User } from '@sentry/types';\n\nimport { AccountInfo } from '../AccountInfo';\nimport { Auth } from '../Auth';\n\nimport type { ErrorLoggerOptions } from './ErrorLogger.interface';\n\nconst ignoreErrors = [\n  '200 OK',\n  'Failed to fetch',\n  'Request Timeout',\n  'Service is overloaded',\n  'In order to call this API endpoint, user needs to have [ReadCallLog] permission for requested resource',\n  'INVALID_STATE_ERROR: Invalid status: 11',\n  'INVALID_STATE_ERROR: Invalid status: 1',\n  'rateLimiterErrorMessages-rateLimitReached',\n  // TODO: fix in JUNO repo with virtuoso\n  'ResizeObserver loop',\n  'Failed to sync full state from server port.',\n  'AbortError: The play() request was interrupted by a new load request',\n  `Document's Permissions Policy does not allow setSinkId()`,\n  // chrome error\n  '[executeScript] Cannot access contents of the page. Extension manifest must request permission to access the respective host.',\n  '[executeScript] The extensions gallery cannot be scripted.',\n  '[executeScript] Cannot access contents of url',\n  '[executeScript] This page cannot be scripted due to an ExtensionsSettings policy.',\n  '[executeScript] Cannot access a chrome',\n];\n\nconst DEFAULT_INTERCEPTED_BRANDS = ['3000.Brightspeed'];\n\n@injectable({\n  name: 'ErrorLogger',\n})\nexport class ErrorLogger extends RcModule {\n  private _sentryInitialized = false;\n\n  constructor(\n    @inject('ErrorLoggerOptions')\n    protected _errorLoggerOptions: ErrorLoggerOptions,\n    @optional('BrandConfig') protected _brandConfig?: BrandConfig,\n    @optional() protected _auth?: Auth,\n    @optional() protected _accountInfo?: AccountInfo,\n  ) {\n    super();\n\n    if (_errorLoggerOptions) {\n      this._bootstrap(_errorLoggerOptions);\n      if (_errorLoggerOptions.tags) {\n        this.setTags(_errorLoggerOptions.tags);\n      }\n      this.initialize();\n    }\n  }\n\n  private _bootstrap(options: ErrorLoggerOptions) {\n    const { appVersion, appRelease, environment, sentryConfig } = options;\n    if (sentryConfig?.endpoint) {\n      // init client\n      this._init({\n        dsn: sentryConfig.endpoint,\n        sampleRate: sentryConfig.sampleRate,\n        environment,\n        release: appRelease ?? appVersion,\n        integrations: global.document ? [new BrowserTracing()] : [],\n      });\n      // set tags\n      const appName = this._brandConfig?.appName;\n      const appBrand = this._brandConfig?.code;\n      this.setTags({\n        ...getMfeMeta({\n          onlyVersion: true,\n          prefix: 'mfe.',\n        }),\n        'app.name': appName as string,\n        'app.brand': appBrand!,\n        'app.version': appVersion!,\n      });\n    }\n  }\n\n  private _mfeSentry?: ReturnType<typeof useSentry>;\n\n  private _init(options: Sentry.BrowserOptions) {\n    this._sentryInitialized = true;\n    const initOptions = {\n      ...options,\n      ignoreErrors,\n    };\n    if (this._errorLoggerOptions?.initMfeSentry) {\n      this._mfeSentry = this._errorLoggerOptions.initMfeSentry(initOptions);\n    }\n    const hub =\n      (this._mfeSentry?.hub as Sentry.Hub | void) ??\n      Sentry.init({\n        ...initOptions,\n        beforeSend: (event) => {\n          if (this.intercepted) {\n            return null;\n          }\n          return event;\n        },\n      });\n    this._hub = hub ?? Sentry.getCurrentHub();\n  }\n\n  private _hub?: Sentry.Hub;\n\n  get hub() {\n    return this._hub;\n  }\n\n  initialize() {\n    if (this._sentryInitialized && this._auth) {\n      watch(\n        this,\n        () => this._auth!.loggedIn,\n        (loggedIn) => {\n          if (loggedIn) {\n            // set user\n            this.setUser({\n              id: this._auth?.ownerId,\n            });\n          }\n        },\n      );\n    }\n\n    if (this._sentryInitialized && this._accountInfo) {\n      watch(\n        this,\n        () => this._accountInfo!.id,\n        (accountInfoId) => {\n          if (accountInfoId) {\n            this.setTags({\n              accountId: `${accountInfoId}`,\n            });\n          }\n        },\n      );\n      watch(\n        this,\n        () => this._accountInfo!.userBrandId,\n        (userBrandId) => {\n          if (userBrandId && this.interceptedBrands.includes(userBrandId)) {\n            this.toggle({ intercepted: true });\n          } else {\n            this.toggle({ intercepted: false });\n          }\n        },\n      );\n    }\n  }\n\n  get interceptedBrands() {\n    return (\n      this._errorLoggerOptions?.interceptedBrands ?? DEFAULT_INTERCEPTED_BRANDS\n    );\n  }\n\n  setUser(user: User | null) {\n    if (this._mfeSentry) {\n      this._mfeSentry.setUser(user);\n      return;\n    }\n    this.hub?.configureScope((scope) => {\n      scope.setUser(user);\n    });\n  }\n\n  setTags(tags: NonNullable<ErrorLoggerOptions['tags']>) {\n    if (this._mfeSentry) {\n      this._mfeSentry.setTags(tags);\n      return;\n    }\n    this.hub?.configureScope((scope) => {\n      scope.setTags(tags);\n    });\n  }\n\n  private intercepted?: boolean;\n\n  toggle({ intercepted }: { intercepted: boolean }) {\n    if (this._mfeSentry) {\n      this._mfeSentry.setTags({ intercepted });\n    } else {\n      this.intercepted = intercepted;\n    }\n  }\n\n  log(message: string, level?: SeverityLevel) {\n    const eventId = Sentry.captureMessage(message, level);\n    return eventId;\n  }\n\n  logError(error: unknown) {\n    const eventId = Sentry.captureException(error);\n    return eventId;\n  }\n\n  test(message = '[ErrorLogger] test') {\n    const eventId = this.log(message, 'debug');\n    return eventId;\n  }\n\n  testError(message = '[ErrorLogger] test error') {\n    // To support test with devtool console, throw error within a new thread by using setTimeout\n    setTimeout(() => {\n      throw new Error(message);\n    }, 0);\n  }\n}\n"],"mappings":"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","ignoreList":[]}
{"version":3,"file":"helpers.js","names":["_activeCallControlStatus","_interopRequireDefault","require","_callDirections","_callResults","_telephonyStatus","_ramda","_Session","_recordStatus","e","__esModule","ownKeys","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_toPropertyKey","value","configurable","writable","i","_toPrimitive","_typeof","Symbol","toPrimitive","call","TypeError","String","Number","mapTelephonyStatus","telephonySessionStatus","PartyStatusCode","setup","proceeding","telephonyStatus","ringing","hold","onHold","answered","callConnected","parked","parkedCall","noCall","isHangUp","code","callResults","disconnected","isRejectCode","_ref","direction","callDirection","inbound","activeCallControlStatus","setUp","isOnRecording","recordings","recording","active","normalizeSession","session","webphoneSession","party","creationTime","sessionId","partyId","id","from","to","status","muted","formatValue","telephonySessionId","phoneNumber","fromNumber","fromUserName","name","toNumber","toUserName","callStatus","startTime","Date","getTime","recordStatus","idle","isReject","toMatches","fromMatches","isOnMute","Boolean","isOnHold","isForwarded","isOnFlip","isOnTransfer","isReplied","isToVoicemail","lastHoldingTime","minimized","removed","conflictError","_ref2","message","response","conflictErrRgx","conflictMsgRgx","test","_text","isOtherDeviceCall","exports","callItem","isRingingCall","telephonySession","isProceeding","getTargetCallQueueName","_call$webphoneSession","_find","callQueueName","find","match","isCallQueueNumber","getDisplayCallQueueName","isOutbound","outbound","isQueueCall","_call$webphoneSession2","some","isHoldingCall","isHolding","isRecording","isForwardedToVoiceMail","voicemail","isOnSetupStage","isFaxSession","faxReceive","isAtMainNumberPromptToneStage","_session$party","_session$party2","_session$otherParties","otherParties","getInboundSwitchedParty","parties","result","_party$status","_party$status2","reason","normalizeTelephonySession","accountId","data","extensionId","origin","requestOptions","serverId","voiceCallToken","WEBPHONE_REPLY_TIME_UNIT","Minute","Hour","Day","WEBPHONE_REPLY_TYPE","customMessage","callBack","onMyWay","inAMeeting","getWebphoneReplyMessageOption","params","_params$replyWithPatt","_params$replyWithPatt2","_params$replyWithPatt3","_params$replyWithPatt4","replyWithText","replyType","replyText","replyWithPattern","pattern","ReplyWithPattern","callbackDirection","includes","timeValue","time","timeUnits","timeUnit","CONFERENCE_ORIGIN_TYPE","checkIfConferenceCall","_session$origin","type","normalizeToActiveCallControlSession","conferenceParticipants","getPartyExtensionNumber","_session$party3","_session$party4","_session$origin2","_session$party5","_session$party6","_session$party7","_session$party8","inboundSwitchedParty","isConferenceCall","extensionNumber","getSessionQueueName","_session$party9","_session$party9$uiCal","primary","uiCallInfo","undefined","findConferenceParticipants","currentSession","sessions","selfExtensionInfo","checkStillExist","_currentSession$origi","_session$party0","_ref3","_ref3$peerId","peerId","conferenceRole","_selfExtensionInfo$co","unshift","isHost","sessionName","info","process","env","THEME_SYSTEM","contact","businessPhone","concat","gone","_party$from","_party$to","queueName","isConnectedCall","_session$party1","_party$status3","_session$party10","_session$party10$stat","checkRingOutCallDirection","_body$origin","body","originType","Array","isArray","ringOutRole","tempFrom"],"sources":["src/app/services/ActiveCallControl/helpers.ts"],"sourcesContent":["import type CallRecording from '@rc-ex/core/lib/definitions/CallRecording';\nimport type ExtensionTelephonySessionsEvent from '@rc-ex/core/lib/definitions/ExtensionTelephonySessionsEvent';\nimport type GetExtensionInfoResponse from '@rc-ex/core/lib/definitions/GetExtensionInfoResponse';\n// eslint-disable-next-line import/no-named-as-default\nimport activeCallControlStatus from '@ringcentral-integration/commons/enums/activeCallControlStatus';\nimport { callDirection } from '@ringcentral-integration/commons/enums/callDirections';\n// eslint-disable-next-line import/no-named-as-default\nimport callResults from '@ringcentral-integration/commons/enums/callResults';\nimport { telephonyStatus } from '@ringcentral-integration/commons/enums/telephonyStatus';\nimport type {\n  CallerInfo,\n  Call as ICall,\n} from '@ringcentral-integration/commons/interfaces/Call.interface';\nimport {\n  type NormalizedSession,\n  type Session,\n} from '@ringcentral-integration/commons/interfaces/Webphone.interface';\nimport { find } from 'ramda';\nimport {\n  Party,\n  PartyStatusCode,\n  PartyToFrom,\n  ReplyWithPattern,\n  ReplyWithTextParams,\n  Session as TelephonySession,\n} from 'ringcentral-call-control/lib/Session';\n\nimport { recordStatus } from '../Webphone/recordStatus';\n\nimport type {\n  ActiveCallControlSessionData,\n  ActiveSession,\n} from './ActiveCallControl.interface';\n\n// telephony session status match presence telephonyStatus\nexport function mapTelephonyStatus(telephonySessionStatus: PartyStatusCode) {\n  switch (telephonySessionStatus) {\n    case PartyStatusCode.setup:\n    case PartyStatusCode.proceeding:\n      return telephonyStatus.ringing;\n    case PartyStatusCode.hold:\n      return telephonyStatus.onHold;\n    case PartyStatusCode.answered:\n      return telephonyStatus.callConnected;\n    case PartyStatusCode.parked:\n      return telephonyStatus.parkedCall;\n    default:\n      return telephonyStatus.noCall;\n  }\n}\n\nexport function isHangUp(code: string) {\n  return code === callResults.disconnected;\n}\n\nexport function isRejectCode({\n  direction,\n  code,\n}: {\n  direction: string;\n  code: string;\n}) {\n  return (\n    direction === callDirection.inbound &&\n    (code === activeCallControlStatus.setUp ||\n      code === activeCallControlStatus.proceeding)\n  );\n}\n\nexport function isOnRecording(recordings: Array<CallRecording>) {\n  if (!recordings || recordings.length === 0) {\n    return false;\n  }\n  const recording = recordings[0];\n  return recording.active;\n}\n\nexport function normalizeSession(\n  session: ActiveCallControlSessionData,\n  webphoneSession: NormalizedSession | undefined,\n) {\n  const { party, creationTime, sessionId } = session;\n  const { id: partyId, direction, from, to, status, muted, recordings } = party;\n\n  const formatValue: ActiveSession = {\n    telephonySessionId: session.id,\n    partyId,\n    direction,\n    from: from?.phoneNumber!,\n    fromNumber: from?.phoneNumber!,\n    fromUserName: from?.name!,\n    to: to?.phoneNumber!,\n    toNumber: to?.phoneNumber!,\n    toUserName: to?.name!,\n    id: session.id,\n    sessionId,\n    callStatus: mapTelephonyStatus(status?.code!),\n    startTime: new Date(creationTime).getTime(),\n    creationTime,\n    recordStatus: isOnRecording(recordings!)\n      ? recordStatus.recording\n      : recordStatus.idle,\n    isReject: isRejectCode({ direction, code: status?.code! }),\n    toMatches: [],\n    fromMatches: [],\n    isOnMute: Boolean(\n      /**\n       * the server muted state\n       */\n      muted ||\n        /**\n         * the local muted state\n         */\n        webphoneSession?.isOnMute,\n    ),\n    isOnHold: status?.code === activeCallControlStatus.hold,\n    isForwarded: false,\n    isOnFlip: false,\n    isOnTransfer: false,\n    isReplied: false,\n    isToVoicemail: false,\n    lastHoldingTime: 0,\n    minimized: false,\n    removed: false,\n  };\n  return formatValue;\n}\n\nexport function conflictError({\n  message,\n  response,\n}: {\n  message: string;\n  response: any;\n}) {\n  const conflictErrRgx = /409/g;\n  const conflictMsgRgx = /Incorrect State/g;\n  return (\n    conflictErrRgx.test(message) &&\n    conflictMsgRgx.test(response && response._text)\n  );\n}\n\n/**\n * when have webphoneSession, means that is on current device webphone call,\n * ignore fake call when when is other device call, fake call always not have webphoneSession be that is in current device\n */\nexport const isOtherDeviceCall = (callItem: ICall): boolean => {\n  return Boolean(\n    !callItem.webphoneSession &&\n      // when not have id, means that is our fake call\n      callItem.id,\n  );\n};\n\nexport const isRingingCall = (callItem: ICall | undefined): boolean => {\n  return Boolean(\n    callItem &&\n      callItem.telephonySession &&\n      isProceeding(callItem.telephonySession),\n  );\n};\n\nconst getTargetCallQueueName = (call: ICall) => {\n  return (\n    call.callQueueName ||\n    call?.webphoneSession?.callQueueName ||\n    // after call in call data not able to know that is from queue call, the only way is use matches to find that, maybe should have better way to do that with platform data\n    (call.toMatches || []).find((match) => !!match.isCallQueueNumber)?.name ||\n    ''\n  );\n};\n\nexport function getDisplayCallQueueName(call: ICall) {\n  const isOutbound = call.direction === callDirection.outbound;\n  if (isOutbound) return '';\n\n  return getTargetCallQueueName(call);\n}\n\n/**\n * check call is department call during call connected, if you want check does call is queue call after call end, should use `isQueueHistoryCall`\n */\nexport const isQueueCall = (call: ICall) => {\n  if (call.direction === callDirection.outbound) {\n    return Boolean(\n      (call.toMatches || []).some((match) => !!match.isCallQueueNumber),\n    );\n  }\n\n  return Boolean(call.callQueueName || call?.webphoneSession?.callQueueName);\n};\n\nexport const isHoldingCall = (callItem: ICall | undefined): boolean => {\n  return Boolean(\n    callItem &&\n      callItem.telephonySession &&\n      isHolding(callItem.telephonySession),\n  );\n};\n\nexport function isProceeding(\n  telephonySession: ActiveCallControlSessionData | Session,\n) {\n  return (\n    telephonySession &&\n    (telephonySession.status === PartyStatusCode.proceeding ||\n      telephonySession.status === PartyStatusCode.setup) &&\n    telephonySession.direction === callDirection.inbound\n  );\n}\n\nexport function isHolding(\n  telephonySession: Pick<ActiveCallControlSessionData, 'status'>,\n) {\n  return telephonySession.status === PartyStatusCode.hold;\n}\n\nexport function isRecording(session: ActiveCallControlSessionData) {\n  const { party } = session;\n  return isOnRecording(party.recordings!);\n}\n\nexport function isForwardedToVoiceMail(session: ActiveCallControlSessionData) {\n  return session.status === PartyStatusCode.voicemail;\n}\n\nexport function isOnSetupStage(session: ActiveCallControlSessionData) {\n  return session.status === PartyStatusCode.setup;\n}\n\nexport function isFaxSession(session: ActiveCallControlSessionData) {\n  return session.status === PartyStatusCode.faxReceive;\n}\n\n// call to main company number but still at inputting extension number prompt tone stage\nexport function isAtMainNumberPromptToneStage(session: TelephonySession) {\n  if (!session) return false;\n  const { otherParties = [] } = session;\n  if (\n    session.party?.direction === callDirection.outbound &&\n    session.party?.status.code === PartyStatusCode.answered &&\n    !otherParties.length\n  ) {\n    return true;\n  }\n  return false;\n}\n\nexport function getInboundSwitchedParty(parties: Party[]) {\n  if (!parties.length) return false;\n  const result = find((party: Party) => {\n    return (\n      party.direction === callDirection.inbound &&\n      party.status?.code === PartyStatusCode.disconnected &&\n      // TODO: should add type to PartyStatusCode at ringcentral-call-control\n      // @ts-ignore\n      party.status?.reason === 'CallSwitch'\n    );\n  }, parties);\n  return result;\n}\n\nexport function normalizeTelephonySession(session?: TelephonySession) {\n  if (!session) {\n    return {};\n  }\n  return {\n    accountId: session.accountId,\n    creationTime: session.creationTime,\n    data: session.data,\n    extensionId: session.extensionId,\n    id: session.id,\n    origin: session.origin,\n    otherParties: session.otherParties,\n    parties: session.parties,\n    party: session.party,\n    recordings: session.recordings,\n    requestOptions: session.requestOptions,\n    serverId: session.serverId,\n    sessionId: session.sessionId,\n    voiceCallToken: session.voiceCallToken,\n  };\n}\n\n// fix call control api issue.\nexport const WEBPHONE_REPLY_TIME_UNIT = {\n  Minute: '0',\n  Hour: '1',\n  Day: '2',\n};\n\nexport const WEBPHONE_REPLY_TYPE = {\n  customMessage: 0,\n  callBack: 1,\n  onMyWay: 2,\n  inAMeeting: 5,\n};\n\nexport function getWebphoneReplyMessageOption(params: ReplyWithTextParams) {\n  if (params.replyWithText) {\n    return {\n      replyType: WEBPHONE_REPLY_TYPE.customMessage,\n      replyText: params.replyWithText,\n    };\n  }\n  if (params.replyWithPattern?.pattern === ReplyWithPattern.onMyWay) {\n    return {\n      replyType: WEBPHONE_REPLY_TYPE.onMyWay,\n    };\n  }\n  if (params.replyWithPattern?.pattern === ReplyWithPattern.inAMeeting) {\n    return {\n      replyType: WEBPHONE_REPLY_TYPE.inAMeeting,\n    };\n  }\n  const replyType = WEBPHONE_REPLY_TYPE.callBack;\n  let callbackDirection;\n  if (params.replyWithPattern?.pattern.includes('CallMe')) {\n    callbackDirection = `1`;\n  } else {\n    callbackDirection = `0`;\n  }\n  return {\n    replyType,\n    timeValue: params.replyWithPattern?.time || '',\n    timeUnits: WEBPHONE_REPLY_TIME_UNIT[params.replyWithPattern!.timeUnit!],\n    callbackDirection,\n  };\n}\n\nexport const CONFERENCE_ORIGIN_TYPE = 'Conference';\nexport function checkIfConferenceCall(session: TelephonySession) {\n  return session?.origin?.type === CONFERENCE_ORIGIN_TYPE;\n}\n\nexport function normalizeToActiveCallControlSession(\n  session: TelephonySession,\n  conferenceParticipants: ActiveCallControlSessionData['conferenceParticipants'],\n  getPartyExtensionNumber?: (party: PartyToFrom) => string | undefined,\n): ActiveCallControlSessionData {\n  const direction = session.party?.direction || callDirection.outbound;\n  const status = session.party?.status.code;\n\n  const { party, otherParties } = session;\n\n  // workaround of bug:\n  // switch an inbound call then call direction will change to outbound\n  if (\n    direction === callDirection.outbound &&\n    status !== PartyStatusCode.disconnected\n  ) {\n    const inboundSwitchedParty = getInboundSwitchedParty(otherParties);\n    if (inboundSwitchedParty) {\n      party.direction = inboundSwitchedParty.direction;\n      party.to = inboundSwitchedParty.to;\n      party.from = inboundSwitchedParty.from;\n    }\n  }\n\n  const isConferenceCall = session.origin?.type === CONFERENCE_ORIGIN_TYPE;\n  const sessionId = isConferenceCall ? session.id : session.data.sessionId;\n  const from = session.party?.from;\n  const to = session.party?.to;\n\n  return {\n    ...session.data,\n    direction: session.party?.direction || callDirection.outbound,\n    // in session call data not include the extensionNumber or phoneNumber, so we need check that in the parties\n    from: getPartyExtensionNumber\n      ? {\n          ...from,\n          extensionNumber: getPartyExtensionNumber(from),\n        }\n      : from,\n    to: getPartyExtensionNumber\n      ? {\n          ...to,\n          extensionNumber: getPartyExtensionNumber(to),\n        }\n      : to,\n    //\n    id: session.id,\n    otherParties: session.otherParties || [],\n    party: session.party || {},\n    recordings: session.recordings,\n    isRecording: isOnRecording(session.recordings),\n    sessionId,\n    startTime: new Date(session.data.creationTime).getTime(),\n    status: session.party?.status.code,\n    telephonySessionId: session.id,\n    telephonySession: normalizeTelephonySession(session),\n    isConferenceCall,\n    conferenceParticipants,\n    callQueueName: getSessionQueueName(session),\n  };\n}\n\nconst getSessionQueueName = (session: TelephonySession) => {\n  const primary = session.party?.uiCallInfo?.primary;\n  if (primary?.type === 'QueueName') return primary?.value;\n\n  return undefined;\n};\n\nexport const findConferenceParticipants = (\n  currentSession: TelephonySession,\n  sessions: TelephonySession[],\n  selfExtensionInfo: GetExtensionInfoResponse | undefined,\n  checkStillExist?: (session: TelephonySession, partyId: string) => boolean,\n) => {\n  if (currentSession.origin?.type !== CONFERENCE_ORIGIN_TYPE) {\n    return [];\n  }\n  const conferenceParticipants: ActiveCallControlSessionData['conferenceParticipants'] =\n    [];\n  sessions.forEach((session) => {\n    const { party = {} } = session;\n    const { code, peerId = {}, reason } = party.status || {};\n\n    if (checkStillExist && !checkStillExist(session, peerId.partyId)) {\n      return;\n    }\n    if (session === currentSession) {\n      if (\n        party.conferenceRole === 'Host' ||\n        (!party.conferenceRole && reason === 'CallSwitch')\n      ) {\n        conferenceParticipants.unshift({\n          sessionId: session.data.sessionId,\n          telephonySessionId: session.id,\n          partyId: peerId.partyId,\n          isHost: true,\n          sessionName: '',\n          // in new spring-ui, we need render the info of the host\n          info:\n            process.env.THEME_SYSTEM === 'spring-ui' && selfExtensionInfo\n              ? ({\n                  phoneNumber: selfExtensionInfo.contact?.businessPhone!,\n                  extensionNumber: selfExtensionInfo.extensionNumber!,\n                  name: selfExtensionInfo.name!,\n                  extensionId: `${selfExtensionInfo.id}`,\n                } satisfies CallerInfo)\n              : {},\n        });\n      }\n    }\n\n    if (\n      code === PartyStatusCode.gone &&\n      reason === CONFERENCE_ORIGIN_TYPE &&\n      peerId.telephonySessionId === currentSession.id\n    ) {\n      const inbound = party?.direction === callDirection.inbound;\n      conferenceParticipants.push({\n        sessionId: session.data.sessionId,\n        telephonySessionId: session.id,\n        partyId: peerId.partyId,\n        sessionName: inbound ? party.from?.name : party.to?.name,\n        info: inbound ? party.from : party.to,\n        queueName: getSessionQueueName(session),\n      });\n    }\n  });\n  return conferenceParticipants;\n};\n\nexport function isConnectedCall(session: TelephonySession) {\n  const status = session.party?.status.code;\n  const { party } = session;\n\n  const reason = party?.status?.reason;\n\n  if (!session?.party?.status?.code) {\n    return false;\n  }\n\n  return !(\n    (status === PartyStatusCode.disconnected && reason !== 'CallSwitch') ||\n    status === PartyStatusCode.gone\n  );\n}\n\n// TODO: workaround of PLA bug: https://jira_domain/browse/PLA-52742, remove these code after PLA\n// fixed this bug\nexport const checkRingOutCallDirection = (\n  message: ExtensionTelephonySessionsEvent,\n) => {\n  const { body } = message;\n  const originType = body?.origin?.type;\n\n  if (body && originType === 'RingOut') {\n    const { parties } = body;\n    if (Array.isArray(parties) && parties.length) {\n      parties.forEach((party: any) => {\n        if (\n          party.ringOutRole &&\n          party.ringOutRole === 'Initiator' &&\n          party.direction === 'Inbound'\n        ) {\n          const tempFrom = { ...party.from };\n          party.direction = 'Outbound';\n          party.from = party.to;\n          party.to = tempFrom;\n        }\n      });\n    }\n  }\n  return message;\n};\n"],"mappings":"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","ignoreList":[]}
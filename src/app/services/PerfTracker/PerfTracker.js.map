{"version":3,"file":"PerfTracker.js","names":["_nextCore","require","_utils","_ramda","_rxjs","_helper","_dec","_dec2","_dec3","_dec4","_class","_toConsumableArray","r","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","a","_arrayLikeToArray","t","toString","call","slice","constructor","name","Array","from","test","Symbol","iterator","isArray","length","e","n","_classCallCheck","_defineProperties","o","enumerable","configurable","writable","Object","defineProperty","_toPropertyKey","key","_createClass","prototype","i","_toPrimitive","_typeof","toPrimitive","String","Number","_callSuper","_getPrototypeOf","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","apply","_assertThisInitialized","ReferenceError","Boolean","valueOf","setPrototypeOf","getPrototypeOf","bind","__proto__","_inherits","create","value","_setPrototypeOf","APPLICATION_NAME","exports","DEFAULT_INTERVAL","PerfTracker","injectable","target","optional","undefined","metadata","Function","Root","PerfTrackerOptions","_RcModule","_root","_perfTrackerOption","_this","_marks","Set","_measures","_lastMeasurements","detailProcessor","intervalTime","interval","enabled","pipe","tap","flush","takeUntil","destroy$","subscribe","getProcessedDetail","size","reduce","acc","curr","get","_this$_perfTrackerOpt","_this$_perfTrackerOpt2","performanceProvider","performance","mark","markOptions","add","err","logger","log","markOnce","has","measure","_ref","startMark","endMark","detail","type","os","getOSType","memoryUsed","getMemoryUsed","applicationName","createAt","Date","now","env","start","end","measureOnce","_ref2","timeOrigin","transform","entries","map","_ref3","duration","concat","unit","labels","peakMeasurement","_ref4","_this$performance$get","_this$performance","_this$_perfTrackerOpt3","measured","getEntriesByType","_ref5","sortByName","bulk","sort","b","indexOf","equals","console","table","_this$_perfTrackerOpt4","RcModule"],"sources":["src/app/services/PerfTracker/PerfTracker.ts"],"sourcesContent":["import {\n  injectable,\n  optional,\n  RcModule,\n  Root,\n} from '@ringcentral-integration/next-core';\nimport { getOSType } from '@ringcentral-integration/utils';\nimport { equals } from 'ramda';\nimport { interval, takeUntil, tap } from 'rxjs';\n\nimport type {\n  PerfMetricsParams,\n  PerfTrackerOptions,\n} from './PerfTracker.interface';\nimport { getMemoryUsed } from './helper';\n\nexport const APPLICATION_NAME = 'int-teams-trace';\nexport const DEFAULT_INTERVAL = 60 * 1000;\n\n/**\n * performance tracking module, if you need custom report detail data, can use `detailProcessor` to custom that\n */\n@injectable({\n  name: 'PerfTracker',\n})\nexport class PerfTracker extends RcModule {\n  private _marks = new Set<string>();\n  private _measures = new Set<string>();\n  private _lastMeasurements?: PerfMetricsParams[];\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  detailProcessor = new Set<(value: any) => any>();\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private getProcessedDetail(value: any) {\n    if (this.detailProcessor.size > 0) {\n      return [...this.detailProcessor].reduce((acc, curr) => {\n        return curr(acc);\n      }, value);\n    }\n\n    return value;\n  }\n\n  get performance() {\n    return this._perfTrackerOption?.performanceProvider ?? performance;\n  }\n\n  constructor(\n    private _root: Root,\n    @optional('PerfTrackerOptions')\n    protected _perfTrackerOption: PerfTrackerOptions,\n  ) {\n    super();\n    const intervalTime = this._perfTrackerOption.interval || DEFAULT_INTERVAL;\n\n    if (this.enabled) {\n      interval(intervalTime)\n        .pipe(\n          tap(() => {\n            this.flush();\n          }),\n          // when app destroy remove that interval\n          takeUntil(this._root.destroy$),\n        )\n        .subscribe();\n    }\n  }\n  /**\n   * create a timestamp marker in the browser's performance timeline\n   * @param key\n   * @returns\n   */\n  public mark(key: string, markOptions?: PerformanceMarkOptions) {\n    if (!this.enabled) return;\n    try {\n      this.performance.mark(key, markOptions);\n      this._marks.add(key);\n    } catch (err) {\n      this.logger.log('performance mark error', err);\n    }\n  }\n\n  /**\n   * create a timestamp marker in the browser's performance timeline only one time\n   * if call this function multiple times, only create the first timestamp marker\n   * @param mark key\n   * @returns\n   */\n  public markOnce(key: string, markOptions?: PerformanceMarkOptions) {\n    if (!this.enabled || this._marks.has(key)) return;\n    this.mark(key, markOptions);\n  }\n\n  /**\n   * measure the time between two marks in the browser's performance timeline.\n   * @param param0\n   * @returns\n   */\n  public measure({\n    name,\n    startMark,\n    endMark,\n  }: {\n    name: string;\n    startMark?: string | number;\n    endMark?: string | number;\n  }) {\n    if (!this.enabled) return;\n    try {\n      const detail = this.getProcessedDetail({\n        type: 'duration',\n        os: getOSType(),\n        memoryUsed: getMemoryUsed(),\n        applicationName: APPLICATION_NAME,\n        // This is a temporary filed, will modified in the future\n        createAt: Date.now(),\n        env: this._perfTrackerOption.env,\n      });\n\n      this.performance.measure(name, {\n        start: startMark ? startMark : 0,\n        end: endMark || this.performance.now(),\n        detail,\n      });\n      this._measures.add(name);\n    } catch (err) {\n      this.logger.log('performance measure error', err);\n    }\n  }\n\n  /**\n   * measure the time between two marks in the browser's performance timeline.\n   * if call mulptile time, only measure the first time\n   * @param param0\n   * @returns\n   */\n  public measureOnce({\n    name,\n    startMark,\n    endMark,\n  }: {\n    name: string;\n    startMark?: string | number;\n    endMark?: string | number;\n  }) {\n    if (!this.enabled || this._measures.has(name)) return;\n    this.measure({ name, startMark, endMark });\n  }\n\n  public now() {\n    return this.performance.now() + this.performance.timeOrigin;\n  }\n\n  private transform(entries: PerformanceMeasure[]) {\n    return entries.map(\n      ({ name, duration, detail }) =>\n        ({\n          name,\n          value: `${duration}`,\n          unit: 'ms',\n          labels: detail,\n        } as PerfMetricsParams),\n    );\n  }\n\n  public peakMeasurement() {\n    const measured =\n      (this.performance.getEntriesByType?.(\n        'measure',\n      ) as PerformanceMeasure[]) ?? [];\n    const { sortByName } = this._perfTrackerOption ?? {};\n    const bulk = this.transform(\n      sortByName\n        ? measured.sort(\n            (a, b) => sortByName!.indexOf(a.name) - sortByName!.indexOf(b.name),\n          )\n        : measured,\n    );\n    return bulk;\n  }\n\n  public flush() {\n    const measured = this.peakMeasurement();\n    if (!measured.length) return;\n    if (!equals(measured, this._lastMeasurements)) {\n      this.logger.log(measured);\n      this._lastMeasurements = measured;\n      console.table(measured);\n    }\n  }\n\n  get enabled() {\n    return this._perfTrackerOption.enabled ?? false;\n  }\n}\n"],"mappings":"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","ignoreList":[]}
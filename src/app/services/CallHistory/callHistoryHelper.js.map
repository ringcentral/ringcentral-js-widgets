{"version":3,"file":"callHistoryHelper.js","names":["RC_EXTENSION_DELIMITER","addIfNotExist","exports","number","output","numberMap","push","pickPhoneNumber","phoneNumber","pickPhoneOrExtensionNumber","extension","formatExt","num","concat","pickFullPhoneNumber","extensionNumber","addNumbersFromCall","pickingFullNumber","arguments","length","undefined","call","pickNumber","from","to","isQueueHistoryCall","history","toMatches","some","match","isCallQueueNumber"],"sources":["src/app/services/CallHistory/callHistoryHelper.ts"],"sourcesContent":["import type { Call } from '@ringcentral-integration/commons/interfaces/Call.interface';\n\nimport type { HistoryCall } from './CallHistory.interface';\n\nconst RC_EXTENSION_DELIMITER = '*';\n\nexport type PhoneNumberPicker = (\n  phoneNumber: string,\n  extNumber?: string,\n) => string | undefined;\n\nexport const addIfNotExist = (\n  number: string,\n  output: string[],\n  numberMap: Record<string, boolean>,\n) => {\n  if (!numberMap[number]) {\n    output.push(number);\n    numberMap[number] = true;\n  }\n};\n\n// NOTE:\n// business logic for commons for now\n// return phone number only.\nconst pickPhoneNumber: PhoneNumberPicker = (phoneNumber: string) => phoneNumber;\n\nexport const pickPhoneOrExtensionNumber: PhoneNumberPicker = (\n  phoneNumber?: string,\n  extension?: string,\n) => phoneNumber || extension;\n\nconst formatExt = (num: string) => `${RC_EXTENSION_DELIMITER}${num}`;\n\nexport const pickFullPhoneNumber: PhoneNumberPicker = (\n  phoneNumber: string,\n  extensionNumber?: string,\n) => {\n  let number = phoneNumber;\n  if (phoneNumber && extensionNumber) {\n    number = `${phoneNumber}${formatExt(extensionNumber)}`;\n  } else if (extensionNumber) {\n    number = extensionNumber;\n  }\n  return number;\n};\n\nexport const addNumbersFromCall =\n  (\n    output: string[],\n    numberMap: Record<string, boolean>,\n    pickingFullNumber = false,\n  ) =>\n  (call: Call) => {\n    const pickNumber = pickingFullNumber\n      ? pickFullPhoneNumber\n      : pickPhoneNumber;\n    if (call.from && call.from.phoneNumber) {\n      const number = pickNumber(\n        call.from.phoneNumber,\n        call.from.extensionNumber,\n      );\n      addIfNotExist(number!, output, numberMap);\n    } else if (call.from && call.from.extensionNumber) {\n      addIfNotExist(call.from.extensionNumber, output, numberMap);\n    }\n    if (call.to && call.to.phoneNumber) {\n      const number = pickNumber(call.to.phoneNumber, call.to.extensionNumber);\n      addIfNotExist(number!, output, numberMap);\n    } else if (call.to && call.to.extensionNumber) {\n      addIfNotExist(call.to.extensionNumber, output, numberMap);\n    }\n  };\n\nexport const isQueueHistoryCall = (history: HistoryCall) => {\n  return (history.toMatches || []).some((match) => !!match.isCallQueueNumber);\n};\n"],"mappings":"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","ignoreList":[]}
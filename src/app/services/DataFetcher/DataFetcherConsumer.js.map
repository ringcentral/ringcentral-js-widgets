{"version":3,"file":"DataFetcherConsumer.js","names":["_ObjectMap","require","_nextCore","_events","_rxjs","_sourceStatus","_dec","_dec2","_dec3","_class","_slicedToArray","r","e","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","a","_arrayLikeToArray","t","toString","call","slice","constructor","name","Array","from","test","length","n","l","Symbol","iterator","i","u","f","o","next","Object","done","push","value","isArray","_regenerator","toStringTag","c","prototype","Generator","create","_regeneratorDefine2","p","y","G","v","d","bind","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","w","m","defineProperty","_regeneratorDefine","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_classCallCheck","_defineProperties","_toPropertyKey","key","_createClass","_toPrimitive","_typeof","toPrimitive","String","Number","_callSuper","_getPrototypeOf","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","_assertThisInitialized","ReferenceError","Boolean","valueOf","_superPropGet","_get","get","_superPropBase","getOwnPropertyDescriptor","hasOwnProperty","_inherits","_setPrototypeOf","_applyDecoratedDescriptor","keys","forEach","initializer","reverse","reduce","baseEvents","exports","ObjectMap","fromKeys","DataFetcherConsumer","delegate","metadata","Function","_RcModule","_dataFetcher","_this","_source","_emitter","EventEmitter","data$","fromWatchValue","data","dataReady$","pipe","filter","_refresh$","Subject","ready$","take","tap","source","props","refreshDataOnPageRefresh","initRefetchData","takeUntilAppDestroy","subscribe","throttle","throttleTimeMs","timer","_callee","_t","_context","fetchData","passive","_initRefetchData","_callee2","_context2","getData","getTimestamp","onInitOnce","_this2","watch","ready","_ref2","_ref3","emit","events","dataReady","multiple","on","_this$_emitter","off","_this$_emitter2","_shouldInit","getSourceStatus","sourceStatus","_shouldReset","_fetchData","_callee3","_ref4","_ref4$passive","_args3","_context3","undefined","updateData","Date","now","RcModule"],"sources":["src/app/services/DataFetcher/DataFetcherConsumer.ts"],"sourcesContent":["import { ObjectMap } from '@ringcentral-integration/core/lib/ObjectMap';\nimport {\n  delegate,\n  fromWatchValue,\n  RcModule,\n  takeUntilAppDestroy,\n  watch,\n} from '@ringcentral-integration/next-core';\nimport { EventEmitter } from 'events';\nimport { filter, Subject, take, tap, throttle, timer } from 'rxjs';\n\nimport type { DataFetcher } from './DataFetcher';\nimport type { DataSource } from './DataSource';\nimport { sourceStatus } from './sourceStatus';\n\nexport const baseEvents = ObjectMap.fromKeys(['dataReady']);\n\n/**\n * Base class for modules that consume data from the DataFetcher\n * Provides common functionality for accessing and managing fetched data\n *\n * @class\n * @template T Type of data this consumer accesses\n */\nexport abstract class DataFetcherConsumer<T> extends RcModule {\n  protected _source!: DataSource<T>;\n  protected _emitter = new EventEmitter();\n\n  /**\n   * the data observable\n   */\n  data$ = fromWatchValue(this, () => this.data);\n  /**\n   * emit when data have value\n   */\n  dataReady$ = this.data$.pipe(filter(Boolean));\n\n  private _refresh$ = new Subject<void>();\n\n  constructor(protected _dataFetcher: DataFetcher) {\n    super();\n\n    // any page refresh should trigger the refetch data because in hubspot there will some page never be closed in shared worker structure, so the life cycle will not be re-executed\n    this._dataFetcher.ready$\n      .pipe(\n        take(1),\n        tap(() => {\n          if (this.data && this.source.props.refreshDataOnPageRefresh) {\n            // emit to server to trigger the refetch data and with 10 seconds throttle time to avoid too many requests in worker mode\n            this.initRefetchData();\n          }\n        }),\n        takeUntilAppDestroy,\n      )\n      .subscribe();\n\n    this._refresh$\n      .pipe(\n        throttle(() => {\n          const refreshDataOnPageRefresh =\n            this.source.props.refreshDataOnPageRefresh;\n          const throttleTimeMs =\n            typeof refreshDataOnPageRefresh === 'number'\n              ? refreshDataOnPageRefresh\n              : 10_000;\n\n          return timer(throttleTimeMs);\n        }),\n        tap(async () => {\n          try {\n            await this.fetchData({ passive: true });\n          } catch (error) {\n            // ignore error to avoid the observable to be destroyed\n          }\n        }),\n        takeUntilAppDestroy,\n      )\n      .subscribe();\n  }\n\n  @delegate('server')\n  private async initRefetchData() {\n    this._refresh$.next();\n  }\n\n  /**\n   * Gets the data source used by this consumer\n   * @returns {DataSource<T>} The data source\n   */\n  get source() {\n    return this._source;\n  }\n\n  /**\n   * Gets the unique key of the data source\n   * @returns {string} The key\n   */\n  get key() {\n    return this._source.key;\n  }\n\n  /**\n   * Gets the data from the data source\n   * @returns {T|null} The retrieved data or null if not available\n   */\n  get data() {\n    return this._dataFetcher.getData(this._source);\n  }\n\n  /**\n   * Gets the timestamp of when data was last fetched\n   * @returns {number|null} Timestamp of when data was last fetched\n   */\n  get updatedTimestamp() {\n    return this._dataFetcher.getTimestamp(this._source);\n  }\n\n  /**\n   * Gets the events supported by this consumer\n   * @returns {object} Event map\n   */\n  get events() {\n    return baseEvents;\n  }\n\n  override onInitOnce() {\n    watch(\n      this,\n      () => [this.ready, this.data] as const,\n      ([ready, data]) => {\n        if (ready && data) {\n          this._emitter.emit(this.events.dataReady);\n        }\n      },\n      {\n        multiple: true,\n      },\n    );\n  }\n\n  /**\n   * Registers an event listener\n   * @param {...Parameters<EventEmitter['on']>} args - Event emitter parameters\n   * @returns {EventEmitter} The event emitter\n   */\n  on(...args: Parameters<EventEmitter['on']>) {\n    return this._emitter.on(...args);\n  }\n\n  /**\n   * Removes an event listener\n   * @param {...Parameters<EventEmitter['off']>} args - Event emitter parameters\n   * @returns {EventEmitter} The event emitter\n   */\n  off(...args: Parameters<EventEmitter['off']>) {\n    return this._emitter.off(...args);\n  }\n\n  override _shouldInit() {\n    return !!(\n      super._shouldInit() &&\n      this._dataFetcher.getSourceStatus(this._source) === sourceStatus.ready\n    );\n  }\n\n  override _shouldReset() {\n    return !!(\n      super._shouldReset() ||\n      (this.ready &&\n        this._dataFetcher.getSourceStatus(this._source) !== sourceStatus.ready)\n    );\n  }\n\n  /**\n   * Fetches data for this consumer's data source\n   * @param {object} options - Fetch options\n   * @param {boolean} [options.passive=false] - Whether to fetch even if not ready\n   * @returns {Promise<void>} Promise that resolves when fetching is complete\n   */\n  async fetchData({ passive = false } = {}) {\n    if (this.ready || passive) {\n      return this._dataFetcher.fetchData(this._source);\n    }\n  }\n\n  /**\n   * Updates the source data manually\n   *\n   * Use this method to trigger update\n   *\n   * ### ⚠️⚠️⚠️ should only use this method when you want to update the source data manually, like after put data, reset the source data into the new data without fetch again, should not use that in `test` environment with manually update the source data\n   *\n   * ### ⚠️⚠️⚠️ should trigger inside `server` post when running at `shared` mode\n   *\n   * @param {T} data - The new data to set\n   */\n  updateData(data: T) {\n    this._dataFetcher.updateData(this._source, data, Date.now());\n  }\n}\n"],"mappings":"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","ignoreList":[]}
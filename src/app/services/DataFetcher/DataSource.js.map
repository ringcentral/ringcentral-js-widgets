{"version":3,"file":"DataSource.js","names":["DEFAULT_TTL","exports","DEFAULT_RETRY","DEFAULT_RETRY_INTERVALS","DEFAULT_READY_CHECK","DEFAULT_PERMISSION_CHECK","DataSource","_props","_classCallCheck","_createClass","key","get","disableSetNull","value","fetchFunction","_this$_props$ttl","ttl","_this$_props$timeToRe","timeToRetry","_this$_props$retryInt","retryIntervals","disableCache","polling","_this$_props$pollingI","Math","max","pollingInterval","_ref","cleanOnReset","readyCheckFunction","_this$_props$readyChe","permissionCheckFunction","_this$_props$permissi"],"sources":["src/app/services/DataFetcher/DataSource.ts"],"sourcesContent":["import type { DataSourceProps } from './DataFetcher.interface';\n\nexport const DEFAULT_TTL = 30 * 60 * 1000;\nexport const DEFAULT_RETRY = 62 * 1000;\n\nexport const DEFAULT_RETRY_INTERVALS = [\n  2 * 1000,\n  5 * 1000,\n  10 * 1000,\n  30 * 1000,\n];\n\nconst DEFAULT_READY_CHECK = () => true;\nconst DEFAULT_PERMISSION_CHECK = () => true;\n\n/**\n * Data source for the DataFetcher service\n * Configures how data is fetched, cached, and polled\n *\n * @class\n * @template T Type of data this source fetches\n */\nexport class DataSource<T> {\n  constructor(private _props: DataSourceProps<T>) {}\n\n  get props() {\n    return this._props;\n  }\n\n  /**\n   * Unique key for this data source\n   * @type {string}\n   */\n  get key() {\n    return this._props.key;\n  }\n\n  /**\n   * Whether to disable setting null when permission check fails\n   * @type {boolean}\n   */\n  get disableSetNull() {\n    return this._props.disableSetNull;\n  }\n\n  /**\n   * Function that fetches data from the server\n   * @returns {Promise<T>} Promise that resolves with the fetched data\n   */\n  fetchFunction() {\n    return this._props.fetchFunction();\n  }\n\n  /**\n   * Time-to-live for cached data in milliseconds\n   * @type {number}\n   */\n  get ttl() {\n    return this._props.ttl ?? DEFAULT_TTL;\n  }\n\n  /**\n   * Time to wait before retrying after a failed fetch\n   * @type {number}\n   */\n  get timeToRetry() {\n    return this._props.timeToRetry ?? DEFAULT_RETRY;\n  }\n\n  /**\n   * Intervals to use for retry attempts\n   * @type {readonly number[]}\n   */\n  get retryIntervals() {\n    return this._props.retryIntervals ?? DEFAULT_RETRY_INTERVALS;\n  }\n\n  /**\n   * Whether to disable caching for this data source\n   * @type {boolean}\n   */\n  get disableCache() {\n    return !!this._props.disableCache;\n  }\n\n  /**\n   * Whether to enable polling for this data source\n   * @type {boolean}\n   */\n  get polling() {\n    return !!this._props.polling;\n  }\n\n  /**\n   * Interval for polling in milliseconds\n   * @type {number}\n   */\n  get pollingInterval() {\n    // polling interval should be >= than ttl\n    return Math.max(this._props.pollingInterval ?? this.ttl, this.ttl);\n  }\n\n  /**\n   * Whether to clean up data on reset/logout\n   * @default true\n   * @description Clean up data on logout. Default to true as DataFetcher\n   *  will always fetchData on login. This will also be always true if disableCache is true.\n   * @type {boolean}\n   */\n  get cleanOnReset() {\n    return !!((this.disableCache || this._props.cleanOnReset) ?? true);\n  }\n\n  /**\n   * Function that checks if the module is ready to fetch data\n   * @returns {boolean} Whether the module is ready\n   */\n  readyCheckFunction() {\n    return (this._props.readyCheckFunction ?? DEFAULT_READY_CHECK)();\n  }\n\n  /**\n   * Function that checks if the user has permission to fetch data\n   * @returns {boolean} Whether the user has permission\n   */\n  permissionCheckFunction() {\n    return (this._props.permissionCheckFunction ?? DEFAULT_PERMISSION_CHECK)();\n  }\n}\n"],"mappings":"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","ignoreList":[]}
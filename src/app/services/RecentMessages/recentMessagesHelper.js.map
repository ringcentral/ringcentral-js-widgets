{"version":3,"file":"recentMessagesHelper.js","names":["filterPhoneNumber","exports","message","_ref","phoneNumber","from","to","find","extensionNumber","flattenToMessageRecords","allMessages","reduce","acc","_ref2","records","concat","sortMessages","recentMessages","sort","a","b","Date","creationTime","getTime","markAsRemoteMessage","messages","map","_objectSpread","fromRemote","dedup","hash","cur","id"],"sources":["src/app/services/RecentMessages/recentMessagesHelper.ts"],"sourcesContent":["import type GetMessageInfoResponse from '@rc-ex/core/lib/definitions/GetMessageInfoResponse';\nimport type GetMessageList from '@rc-ex/core/lib/definitions/GetMessageList';\nimport type { EntityPhoneNumberItem } from '@ringcentral-integration/commons/interfaces/Entity.interface';\nimport type { Message } from '@ringcentral-integration/commons/interfaces/MessageStore.model';\n\nimport type { MessageStoreItem } from '../MessageStore';\n\nimport type { RecentMessage } from './RecentMessages.interface';\n\nexport const filterPhoneNumber = (message: MessageStoreItem) => {\n  return ({ phoneNumber }: EntityPhoneNumberItem) =>\n    phoneNumber === message.from!.phoneNumber ||\n    !!message.to!.find((to) => to.phoneNumber === phoneNumber) ||\n    phoneNumber === message.from!.extensionNumber ||\n    !!message.to!.find((to) => to.extensionNumber === phoneNumber);\n};\n\nexport const flattenToMessageRecords = (allMessages: GetMessageList[]) => {\n  return allMessages.reduce(\n    (acc, { records }) => acc.concat(records!),\n    [] as GetMessageInfoResponse[],\n  );\n};\n\nexport const sortMessages = (recentMessages: RecentMessage[]) => {\n  // Sort by time in descending order\n  return recentMessages.sort(\n    (a, b) =>\n      new Date(b.creationTime!).getTime() - new Date(a.creationTime!).getTime(),\n  );\n};\n\nexport const markAsRemoteMessage = (messages: GetMessageInfoResponse[]) => {\n  return messages.map((message) => {\n    return {\n      ...message,\n      fromRemote: true,\n    } as RecentMessage;\n  });\n};\n\nexport const dedup = (messages: (Message | RecentMessage)[]) => {\n  const hash: Record<string, boolean> = {};\n  return messages.reduce((acc, cur) => {\n    if (hash[cur.id!]) return acc;\n    hash[cur.id!] = true;\n    return acc.concat(cur);\n  }, [] as (Message | RecentMessage)[]);\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASO,IAAMA,iBAAiB,GAAAC,OAAA,CAAAD,iBAAA,GAAG,SAApBA,iBAAiBA,CAAIE,OAAyB,EAAK;EAC9D,OAAO,UAAAC,IAAA;IAAA,IAAGC,WAAW,GAAAD,IAAA,CAAXC,WAAW;IAAA,OACnBA,WAAW,KAAKF,OAAO,CAACG,IAAI,CAAED,WAAW,IACzC,CAAC,CAACF,OAAO,CAACI,EAAE,CAAEC,IAAI,CAAC,UAACD,EAAE;MAAA,OAAKA,EAAE,CAACF,WAAW,KAAKA,WAAW;IAAA,EAAC,IAC1DA,WAAW,KAAKF,OAAO,CAACG,IAAI,CAAEG,eAAe,IAC7C,CAAC,CAACN,OAAO,CAACI,EAAE,CAAEC,IAAI,CAAC,UAACD,EAAE;MAAA,OAAKA,EAAE,CAACE,eAAe,KAAKJ,WAAW;IAAA,EAAC;EAAA;AAClE,CAAC;AAEM,IAAMK,uBAAuB,GAAAR,OAAA,CAAAQ,uBAAA,GAAG,SAA1BA,uBAAuBA,CAAIC,WAA6B,EAAK;EACxE,OAAOA,WAAW,CAACC,MAAM,CACvB,UAACC,GAAG,EAAAC,KAAA;IAAA,IAAIC,OAAO,GAAAD,KAAA,CAAPC,OAAO;IAAA,OAAOF,GAAG,CAACG,MAAM,CAACD,OAAQ,CAAC;EAAA,GAC1C,EACF,CAAC;AACH,CAAC;AAEM,IAAME,YAAY,GAAAf,OAAA,CAAAe,YAAA,GAAG,SAAfA,YAAYA,CAAIC,cAA+B,EAAK;EAC/D;EACA,OAAOA,cAAc,CAACC,IAAI,CACxB,UAACC,CAAC,EAAEC,CAAC;IAAA,OACH,IAAIC,IAAI,CAACD,CAAC,CAACE,YAAa,CAAC,CAACC,OAAO,CAAC,CAAC,GAAG,IAAIF,IAAI,CAACF,CAAC,CAACG,YAAa,CAAC,CAACC,OAAO,CAAC,CAAC;EAAA,CAC7E,CAAC;AACH,CAAC;AAEM,IAAMC,mBAAmB,GAAAvB,OAAA,CAAAuB,mBAAA,GAAG,SAAtBA,mBAAmBA,CAAIC,QAAkC,EAAK;EACzE,OAAOA,QAAQ,CAACC,GAAG,CAAC,UAACxB,OAAO,EAAK;IAC/B,OAAAyB,aAAA,CAAAA,aAAA,KACKzB,OAAO;MACV0B,UAAU,EAAE;IAAI;EAEpB,CAAC,CAAC;AACJ,CAAC;AAEM,IAAMC,KAAK,GAAA5B,OAAA,CAAA4B,KAAA,GAAG,SAARA,KAAKA,CAAIJ,QAAqC,EAAK;EAC9D,IAAMK,IAA6B,GAAG,CAAC,CAAC;EACxC,OAAOL,QAAQ,CAACd,MAAM,CAAC,UAACC,GAAG,EAAEmB,GAAG,EAAK;IACnC,IAAID,IAAI,CAACC,GAAG,CAACC,EAAE,CAAE,EAAE,OAAOpB,GAAG;IAC7BkB,IAAI,CAACC,GAAG,CAACC,EAAE,CAAE,GAAG,IAAI;IACpB,OAAOpB,GAAG,CAACG,MAAM,CAACgB,GAAG,CAAC;EACxB,CAAC,EAAE,EAAiC,CAAC;AACvC,CAAC","ignoreList":[]}
{"version":3,"file":"SpringTheme.plugin.js","names":["_nextCore","require","_springTheme","_framerMotion","_react","_interopRequireWildcard","_services","_dec","_dec2","_dec3","_dec4","_dec5","_dec6","_class","_class2","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","_typeof","has","get","set","_t","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","_classCallCheck","a","TypeError","_defineProperties","length","enumerable","configurable","writable","_toPropertyKey","key","_createClass","prototype","_toPrimitive","Symbol","toPrimitive","String","Number","_callSuper","_getPrototypeOf","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","constructor","apply","_assertThisInitialized","ReferenceError","Boolean","valueOf","setPrototypeOf","getPrototypeOf","bind","_inherits","create","value","_setPrototypeOf","_applyDecoratedDescriptor","l","keys","forEach","initializer","slice","reverse","reduce","sprintDefaultThemeMap","dark","suiDark","contrast","suiHighContrast","SpringThemePlugin","exports","injectable","name","target","optional","undefined","metadata","Function","Brand","Theme","SpringThemePluginOptions","_PluginModule","_brand","_theme","_springThemePluginOptions","_this","provider","_ref","children","_useConnector","useConnector","themeProps","theme","themeType","prefersReducedMotion","useEffect","logger","log","concat","getRef","identifier","createElement","ThemeProvider","MotionConfig","reducedMotion","currType","localStorage","getItem","THEME_TYPE_STORAGE_KEY","getTheme","type","_this$_springThemePlu","_curr$","processTheme","suiJunoLight","brand","IDBTheme","brandConfig","force","_IDBTheme$suiThemeMap","suiThemeMap","curr","PluginModule","computed"],"sources":["src/app/plugins/SpringThemePlugin/SpringTheme.plugin.tsx"],"sourcesContent":["import {\n  computed,\n  getRef,\n  injectable,\n  logger,\n  optional,\n  PluginModule,\n  useConnector,\n} from '@ringcentral-integration/next-core';\nimport {\n  suiHighContrast,\n  suiDark,\n  suiJunoLight,\n  ThemeProvider,\n} from '@ringcentral/spring-theme';\nimport { MotionConfig } from 'framer-motion';\nimport React, { PropsWithChildren, useEffect } from 'react';\n\nimport { Brand, Theme, THEME_TYPE_STORAGE_KEY } from '../../services';\n\nimport type {\n  SpringThemePluginOptions,\n  SpringThemePluginProps,\n} from './SpringTheme.plugin.interface';\n\nconst sprintDefaultThemeMap = {\n  dark: suiDark,\n  contrast: suiHighContrast,\n};\n\n@injectable({\n  name: 'SpringThemePlugin',\n})\nexport class SpringThemePlugin extends PluginModule {\n  @computed\n  get themeProps() {\n    const currType =\n      this._theme.themeType ||\n      localStorage.getItem(THEME_TYPE_STORAGE_KEY) ||\n      'light';\n\n    return {\n      themeType: currType,\n      theme: this.getTheme(currType),\n      prefersReducedMotion: this._theme.prefersReducedMotion,\n    };\n  }\n\n  private getTheme(type: string) {\n    // spring only support dark rcDark and rcHighContact in rc brand\n    // so for those theme type use default theme map instead directly\n    if (type === 'dark' || type === 'contrast') {\n      return sprintDefaultThemeMap[type];\n    }\n\n    const processTheme = this._springThemePluginOptions?.processTheme;\n    if (processTheme) {\n      return processTheme(type) || suiJunoLight;\n    }\n\n    const brand = this._brand;\n    const IDBTheme = brand.brandConfig.theme;\n    if (\n      // when is force idb theme, never use brand assets data from brand.suiThemeMap\n      IDBTheme?.force\n    ) {\n      if (IDBTheme.suiThemeMap?.[type as keyof typeof IDBTheme.suiThemeMap]) {\n        return IDBTheme.suiThemeMap[type as keyof typeof IDBTheme.suiThemeMap];\n      }\n\n      return suiJunoLight;\n    }\n\n    const curr = brand.suiThemeMap[type as keyof typeof brand.suiThemeMap];\n    return curr?.[0]?.theme || suiJunoLight;\n  }\n\n  constructor(\n    private _brand: Brand,\n    private _theme: Theme,\n    @optional('SpringThemePluginOptions')\n    private _springThemePluginOptions: SpringThemePluginOptions,\n  ) {\n    super();\n  }\n\n  override provider = ({\n    children,\n  }: PropsWithChildren<SpringThemePluginProps>) => {\n    const { theme, themeType, prefersReducedMotion } = useConnector(\n      () => this.themeProps,\n    );\n\n    useEffect(() => {\n      logger.log(`[${getRef(this).identifier}] theme info`, {\n        themeType,\n      });\n    }, [themeType]);\n\n    return (\n      <ThemeProvider theme={theme}>\n        <MotionConfig reducedMotion={prefersReducedMotion}>\n          {children}\n        </MotionConfig>\n      </ThemeProvider>\n    );\n  };\n}\n"],"mappings":"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","ignoreList":[]}
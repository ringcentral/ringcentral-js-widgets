{"version":3,"file":"useLeaveGuard.js","names":["_hooks","require","_springUi","_react","_interopRequireWildcard","_i18n","_interopRequireDefault","e","__esModule","t","WeakMap","r","n","o","i","f","__proto__","_typeof","has","get","set","_t","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","a","_arrayLikeToArray","toString","slice","constructor","name","Array","from","test","length","l","Symbol","iterator","u","next","done","push","value","isArray","useLeaveGuard","exports","_ref","condition","onLeave","onCancel","_useLocale","useLocale","i18n","_useState","useState","_useState2","showConfirmDialog","setShowConfirmDialog","handleLeave","useEventCallback","handleCancel","attemptLeave","LeaveGuardDialog","useCallback","handleDiscardConfirm","handleDiscardCancel","createElement","Dialog","open","onClose","DialogTitle","DialogActions","Button","variant","color","onClick"],"sources":["src/app/views/SmsTemplateView/TemplatePopover/useLeaveGuard.tsx"],"sourcesContent":["import { useLocale } from '@ringcentral-integration/micro-core/src/app/hooks';\nimport {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogTitle,\n  useEventCallback,\n} from '@ringcentral/spring-ui';\nimport React, { useCallback, useState } from 'react';\n\nimport i18n from './i18n';\n\nexport interface UseLeaveGuardOptions {\n  condition: () => boolean;\n  onLeave: () => void;\n  onCancel?: () => void;\n}\n\nexport const useLeaveGuard = ({\n  condition,\n  onLeave,\n  onCancel,\n}: UseLeaveGuardOptions) => {\n  const { t } = useLocale(i18n);\n  const [showConfirmDialog, setShowConfirmDialog] = useState(false);\n\n  // memo that to avoid un-necessary re-render\n  const handleLeave = useEventCallback(onLeave);\n  const handleCancel = useEventCallback(onCancel ?? (() => {}));\n\n  const attemptLeave = () => {\n    if (condition()) {\n      setShowConfirmDialog(true);\n      return false; // Prevent leaving\n    }\n\n    handleLeave();\n    return true; // Allow leaving\n  };\n\n  const LeaveGuardDialog = useCallback(() => {\n    const handleDiscardConfirm = () => {\n      setShowConfirmDialog(false);\n      handleLeave();\n    };\n\n    const handleDiscardCancel = () => {\n      setShowConfirmDialog(false);\n      handleCancel();\n    };\n\n    return (\n      <Dialog\n        open={showConfirmDialog}\n        onClose={handleDiscardCancel}\n        data-sign=\"templateLeaveGuard\"\n      >\n        <DialogTitle>{t('discardChangesMessage')}</DialogTitle>\n        <DialogActions>\n          <Button\n            variant=\"outlined\"\n            color=\"secondary\"\n            onClick={handleDiscardCancel}\n            data-sign=\"discardCancel\"\n          >\n            {t('cancel')}\n          </Button>\n          <Button\n            variant=\"contained\"\n            color=\"danger\"\n            onClick={handleDiscardConfirm}\n            data-sign=\"discardConfirm\"\n          >\n            {t('discard')}\n          </Button>\n        </DialogActions>\n      </Dialog>\n    );\n  }, [handleCancel, handleLeave, showConfirmDialog, t]);\n\n  return {\n    attemptLeave,\n    LeaveGuardDialog,\n  };\n};\n"],"mappings":"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","ignoreList":[]}
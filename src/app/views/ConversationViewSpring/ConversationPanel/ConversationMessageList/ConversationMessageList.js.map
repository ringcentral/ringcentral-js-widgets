{"version":3,"file":"ConversationMessageList.js","names":["_isBlank","require","_hooks","_springUi","_clsx","_interopRequireDefault","_dayjs","_localizedFormat","_react","_interopRequireWildcard","_FileAttachmentRender","_ImageAttachmentRender","_SubjectRender","_i18n","_styles","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","_typeof","has","get","set","_t","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","_regenerator","Symbol","iterator","toStringTag","c","prototype","Generator","u","create","_regeneratorDefine2","p","y","G","v","a","d","bind","length","l","TypeError","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","displayName","w","m","_regeneratorDefine","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","_arrayLikeToArray","toString","slice","constructor","name","Array","from","test","next","push","isArray","dayjs","extend","localizedFormat","Message","_ref","subject","time","direction","mmsAttachments","currentLocale","onAttachmentDownload","onLinkClick","handleImageLoad","renderSenderName","title","subjectNode","isBlank","createElement","SubjectRender","imageAttachments","filter","contentType","indexOf","map","attachment","ImageAttachmentRender","key","id","otherAttachments","Block","concat","className","clsx","styles","messageBody","FileAttachmentRender","message","big","imageBody","Fragment","clear","ConversationMessageList","exports","_ref2","messages","_ref2$loadingNextPage","loadingNextPage","_ref2$currentLocale","_ref2$timeKey","timeKey","listRef","useRef","_useState","useState","_useState2","scrollHeight","setScrollHeight","_useState3","_useState4","scrollTop","setScrollTop","_useState5","_useState6","scrollUp","setScrollUp","endRef","scrollToLastMessage","useCallback","_endRef$current","current","scrollIntoView","handleScroll","_callee","currentScrollTop","currentScrollHeight","clientHeight","_context","useEffect","formattedDateFromNow","useFormattedDateFromNowFn","lastDate","messageList","date","Date","timestamp","getTime","getHours","undefined","messageType","format","lastModifiedTime","loading","i18n","getString","root","ref","onScroll"],"sources":["src/app/views/ConversationViewSpring/ConversationPanel/ConversationMessageList/ConversationMessageList.tsx"],"sourcesContent":["import type { Message as MessageData } from '@ringcentral-integration/commons/interfaces/MessageStore.model';\nimport { isBlank } from '@ringcentral-integration/commons/lib/isBlank';\nimport { useFormattedDateFromNowFn } from '@ringcentral-integration/micro-phone/src/app/hooks';\nimport { Block } from '@ringcentral/spring-ui';\nimport clsx from 'clsx';\nimport dayjs from 'dayjs';\nimport localizedFormat from 'dayjs/plugin/localizedFormat';\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\n\nimport { FileAttachmentRender } from './FileAttachmentRender';\nimport { ImageAttachmentRender } from './ImageAttachmentRender';\nimport { SubjectRender } from './SubjectRender';\nimport i18n from './i18n';\nimport styles from './styles.scss';\n\ndayjs.extend(localizedFormat);\n\ninterface MessageProps {\n  subject?: string;\n  time?: string;\n  direction: 'Inbound' | 'Outbound';\n  mmsAttachments: Array<{\n    id: string;\n    contentType: string;\n  }>;\n  currentLocale: string;\n  onAttachmentDownload?: (attachment: any) => void;\n  onLinkClick?: (url: string) => void;\n  handleImageLoad?: () => void;\n  renderSenderName?: () => React.ReactNode;\n  title?: string;\n}\n\nconst Message: React.FC<MessageProps> = ({\n  subject,\n  time,\n  direction,\n  mmsAttachments,\n  currentLocale,\n  onAttachmentDownload,\n  onLinkClick,\n  handleImageLoad,\n  renderSenderName,\n  title,\n}) => {\n  let subjectNode;\n  if (subject && !isBlank(subject)) {\n    subjectNode = (\n      <SubjectRender onLinkClick={onLinkClick}>{subject}</SubjectRender>\n    );\n  }\n  const imageAttachments = mmsAttachments\n    .filter((m: any) => m.contentType.indexOf('image') > -1)\n    .map((attachment: any) => {\n      return (\n        <ImageAttachmentRender\n          key={attachment.id}\n          attachment={attachment}\n          direction={direction}\n          handleImageLoad={handleImageLoad}\n        />\n      );\n    });\n  const otherAttachments = mmsAttachments\n    .filter((m: any) => m.contentType.indexOf('image') === -1)\n    .map((attachment: any) => {\n      return (\n        <Block\n          key={attachment.id}\n          data-sign={`${direction}Attachment`}\n          className={clsx(\n            styles.messageBody,\n            direction === 'Outbound' ? 'float-right clear-both' : '',\n            'text-neutral-b0 rounded-br-sui-md bg-neutral-base',\n          )}\n        >\n          <FileAttachmentRender\n            attachment={attachment}\n            currentLocale={currentLocale}\n            onLinkClick={onAttachmentDownload}\n          />\n        </Block>\n      );\n    });\n  return (\n    <div\n      data-sign=\"message\"\n      className={clsx(\n        styles.message,\n        'typography-mainText text-neutral-static-w0',\n      )}\n      title={title}\n    >\n      {time ? (\n        <div\n          className={clsx(styles.time, 'typography-detailBold text-neutral-b2')}\n          data-sign=\"conversationSendTime\"\n        >\n          {time}\n        </div>\n      ) : null}\n      {renderSenderName?.()}\n      {!isBlank(subject) && (\n        <div\n          data-sign={`${direction}Text`}\n          className={clsx(\n            styles.messageBody,\n            subject && subject.length > 500 && styles.big,\n            direction === 'Outbound'\n              ? 'bg-primary-b text-neutral-w0 float-right rounded-br-none'\n              : 'bg-neutral-b4 text-neutral-b0 float-left rounded-bl-none',\n          )}\n        >\n          {subjectNode}\n        </div>\n      )}\n      {imageAttachments.length > 0 && (\n        <div\n          data-sign={`${direction}Image`}\n          className={clsx(\n            styles.imageBody,\n            direction === 'Outbound' ? 'float-right' : 'float-left',\n          )}\n        >\n          {imageAttachments}\n        </div>\n      )}\n      {otherAttachments.length > 0 && <>{otherAttachments}</>}\n      <div className={styles.clear} />\n    </div>\n  );\n};\n\nexport interface ConversationMessageListProps {\n  className?: string;\n  messages: MessageData[];\n  showSender?: boolean;\n  loadingNextPage?: boolean;\n  currentLocale?: string;\n  onAttachmentDownload?: (attachment: any) => void;\n  onLinkClick?: (url: string) => void;\n  loadPreviousMessages?: () => void;\n  renderSenderName?: (message: MessageData) => React.ReactNode;\n  timeKey?: 'creationTime' | 'lastModifiedTime';\n}\n\nexport const ConversationMessageList: React.FC<\n  ConversationMessageListProps\n> = ({\n  className,\n  messages,\n  loadingNextPage = false,\n  currentLocale = 'en-US',\n  onAttachmentDownload,\n  onLinkClick,\n  renderSenderName,\n  timeKey = 'creationTime',\n}) => {\n  const listRef = useRef<HTMLDivElement>(null);\n  const [scrollHeight, setScrollHeight] = useState<number>(0);\n  const [scrollTop, setScrollTop] = useState<number>(0);\n  const [scrollUp, setScrollUp] = useState<boolean>(false);\n  const endRef = useRef<HTMLDivElement>(null);\n\n  const scrollToLastMessage = useCallback(() => {\n    endRef.current?.scrollIntoView();\n  }, []);\n\n  const handleScroll = useCallback(async () => {\n    if (!listRef.current) {\n      return;\n    }\n\n    const currentScrollTop = listRef.current.scrollTop;\n    const currentScrollHeight = listRef.current.scrollHeight;\n    const clientHeight = listRef.current.clientHeight;\n\n    setScrollHeight(currentScrollHeight);\n\n    if (currentScrollTop < scrollTop) {\n      // user scroll up\n      setScrollUp(true);\n    } else if (currentScrollTop + clientHeight > currentScrollHeight - 200) {\n      // user scroll down to bottom\n      setScrollUp(false);\n    }\n\n    setScrollTop(currentScrollTop);\n  }, [scrollTop]);\n\n  // Initial scroll to last message\n  useEffect(() => {\n    scrollToLastMessage();\n  }, [scrollToLastMessage]);\n\n  // Handle messages length change\n  useEffect(() => {\n    if (!scrollUp) {\n      scrollToLastMessage();\n    } else if (\n      listRef.current &&\n      scrollHeight !== listRef.current.scrollHeight\n    ) {\n      listRef.current.scrollTop += listRef.current.scrollHeight - scrollHeight;\n    }\n  }, [messages.length, scrollUp, scrollHeight, scrollToLastMessage]);\n\n  const formattedDateFromNow = useFormattedDateFromNowFn();\n\n  let lastDate = 0;\n  const messageList = messages.map((message) => {\n    const date = new Date(message[timeKey] || 0);\n    const timestamp = date.getTime();\n    const time =\n      timestamp - lastDate < 60 * 60 * 1000 &&\n      date.getHours() === new Date(lastDate).getHours()\n        ? undefined\n        : formattedDateFromNow(timestamp, 'withTime');\n\n    lastDate = date.getTime();\n\n    const direction = message.direction || 'Inbound';\n    const messageType = message.messageType || 'message';\n\n    // add a title for the message to show the full date and time for user and us easy to know the message time\n    const title = dayjs(timestamp).format('LLL');\n\n    if (messageType === 'info' && message.lastModifiedTime) {\n      return (\n        <div\n          key={message.id}\n          className=\"w-full text-center px-4 py-2 typography-detailBold text-primary-f\"\n          title={title}\n        >\n          <div>{message.subject}</div>\n          <div className=\"mt-1\">\n            {formattedDateFromNow(message.lastModifiedTime, 'withTime')}\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <Message\n        title={title}\n        key={message.id}\n        time={time}\n        direction={direction}\n        subject={message.subject}\n        mmsAttachments={message.mmsAttachments || []}\n        currentLocale={currentLocale}\n        onAttachmentDownload={onAttachmentDownload}\n        onLinkClick={onLinkClick}\n        handleImageLoad={() => {\n          if (!scrollUp) {\n            scrollToLastMessage();\n          }\n        }}\n        renderSenderName={\n          renderSenderName && direction === 'Inbound'\n            ? () => renderSenderName?.(message)\n            : undefined\n        }\n      />\n    );\n  });\n\n  const loading = loadingNextPage ? (\n    <div className={styles.loading}>\n      {i18n.getString('loading', currentLocale)}\n    </div>\n  ) : null;\n\n  return (\n    <div\n      className={clsx(styles.root, className)}\n      ref={listRef}\n      onScroll={handleScroll}\n    >\n      {loading}\n      {messageList}\n      <div ref={endRef} />\n    </div>\n  );\n};\n"],"mappings":"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","ignoreList":[]}
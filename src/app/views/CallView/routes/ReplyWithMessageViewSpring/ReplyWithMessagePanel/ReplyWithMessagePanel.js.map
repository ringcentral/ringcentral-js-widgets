{"version":3,"file":"ReplyWithMessagePanel.js","names":["_hooks","require","_reactHooks","_springIcon","_springUi","_react","_interopRequireWildcard","_hooks2","_i18n","_interopRequireDefault","_sanitizedMessage","e","__esModule","t","WeakMap","r","n","o","i","f","__proto__","_typeof","has","get","set","_t","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","TypeError","a","_arrayLikeToArray","toString","slice","constructor","name","Array","from","test","length","l","Symbol","iterator","u","next","done","push","value","isArray","useSpringTextareaDynamicMaxRows","_useState","useState","_useState2","maxRow","setMaxRow","textareaContainerRef","useRef","useResizeObserver","hullElm","current","formField","querySelector","clientHeight","style","display","spaceHeight","newMaxRow","Math","floor","mode","ReplyWithMessagePanel","exports","_ref","options","replayMessageProp","replayMessage","onAction","onOptionClick","onReplayMessageChangeProp","onReplayMessageChange","_useAsyncState","useAsyncState","_useAsyncState2","_useContactRenderInfo","useContactRenderInfoFromCall","phoneNumberDisplayMode","hideBlockedFromInfo","DisplayName","displayPhoneNumber","Avatar","_useLocale","useLocale","i18n","_useSpringTextareaDyn","createElement","className","IconButton","symbol","CaretLeftMd","color","variant","onClick","size","displayControl","maybe","viewable","matchCounts","List","map","item","index","ListItem","key","divider","text","ListItemText","primary","Icon","SendMd","ref","Textarea","fullWidth","minRows","maxRows","onChange","event","result","sanitizedMessage","target","label","placeholder","inputProps","maxLength","showCharacterCount","onKeyDown","_event$target","nativeEvent","isComposing","shiftKey","replyWithText","trim","preventDefault"],"sources":["src/app/views/CallView/routes/ReplyWithMessageViewSpring/ReplyWithMessagePanel/ReplyWithMessagePanel.tsx"],"sourcesContent":["import { useLocale } from '@ringcentral-integration/micro-core/src/app/hooks';\nimport { useAsyncState } from '@ringcentral-integration/react-hooks';\nimport { CaretLeftMd, SendMd } from '@ringcentral/spring-icon';\nimport {\n  Icon,\n  IconButton,\n  List,\n  ListItem,\n  ListItemText,\n  Textarea,\n  useResizeObserver,\n} from '@ringcentral/spring-ui';\nimport type { FunctionComponent } from 'react';\nimport React, { useRef, useState } from 'react';\n\nimport { useContactRenderInfoFromCall } from '../../../../../hooks';\nimport { ReplyWithMessageViewPanelProps } from '../ReplyWithMessage.view.interface';\n\nimport i18n from './i18n';\nimport { sanitizedMessage } from './sanitizedMessage';\n\n/**\n * base on container height, calculate the max row of textarea dynamically\n *\n * TODO: if other place need that, move to react-hooks and make that be more generic\n */\nconst useSpringTextareaDynamicMaxRows = () => {\n  const [maxRow, setMaxRow] = useState(20);\n  const textareaContainerRef = useRef<HTMLDivElement>(null);\n\n  useResizeObserver(\n    textareaContainerRef,\n    () => {\n      const hullElm = textareaContainerRef.current;\n      if (!hullElm) return;\n      const formField =\n        textareaContainerRef.current.querySelector<HTMLDivElement>(\n          '.sui-form-field-container',\n        );\n      if (!formField) return;\n\n      const clientHeight = hullElm.clientHeight;\n      formField.style.display = 'none';\n      const spaceHeight =\n        clientHeight -\n        formField.clientHeight -\n        // space\n        32 -\n        // textarea padding\n        32 -\n        // buffer\n        32;\n      formField.style.display = '';\n\n      const newMaxRow = Math.floor((spaceHeight || 16 * 20) / 16);\n\n      setMaxRow(newMaxRow);\n    },\n    {\n      mode: 'throttle',\n    },\n  );\n\n  return { textareaContainerRef, maxRow };\n};\n\nexport const ReplyWithMessagePanel: FunctionComponent<\n  ReplyWithMessageViewPanelProps\n> = ({\n  call,\n  options,\n  replayMessage: replayMessageProp,\n  onAction,\n  onOptionClick,\n  onReplayMessageChange: onReplayMessageChangeProp,\n}) => {\n  const [replayMessage, onReplayMessageChange] = useAsyncState(\n    replayMessageProp,\n    onReplayMessageChangeProp,\n  );\n  const { DisplayName, displayPhoneNumber, Avatar } =\n    useContactRenderInfoFromCall(call, {\n      phoneNumberDisplayMode: 'unknown',\n      hideBlockedFromInfo: true,\n    });\n\n  const { t } = useLocale(i18n);\n\n  const { textareaContainerRef, maxRow } = useSpringTextareaDynamicMaxRows();\n\n  return (\n    <div data-sign=\"replyWithMessagePage\" className=\"flex flex-col h-full\">\n      <div\n        data-sign=\"call-information\"\n        className=\"mt-5 mx-2 gap-1 flex items-center flex-none\"\n      >\n        <IconButton\n          symbol={CaretLeftMd}\n          color=\"secondary\"\n          variant=\"icon\"\n          data-sign=\"backButton\"\n          onClick={() => {\n            onAction('activeCall');\n          }}\n        />\n        <Avatar size=\"xlarge\" />\n\n        <div className=\"ml-2\">\n          <h3\n            className=\"typography-title text-neutral-b0 truncate w-full flex flex-col\"\n            data-sign=\"userDisplayName\"\n          >\n            <DisplayName\n              displayControl={{\n                maybe: true,\n                viewable: true,\n                matchCounts: true,\n              }}\n            />\n          </h3>\n          <p\n            className=\"typography-descriptorMini text-neutral-b0\"\n            data-sign=\"userPhoneNumber\"\n          >\n            {displayPhoneNumber}\n          </p>\n        </div>\n      </div>\n\n      <List className=\"mt-8 flex-none\">\n        {options.map((item, index) => (\n          <ListItem\n            key={index}\n            divider={false}\n            onClick={() => {\n              onOptionClick?.(item);\n            }}\n            className=\"group\"\n            data-sign={item.text}\n          >\n            <ListItemText primary={item.text} />\n            <i className=\"flex-auto\" />\n            {!item.options && (\n              <Icon\n                color=\"action.grayLight\"\n                size=\"small\"\n                symbol={SendMd}\n                className=\"hidden group-hover:block\"\n                data-sign=\"sendIcon\"\n              />\n            )}\n          </ListItem>\n        ))}\n      </List>\n      <div\n        className=\"mt-5 mb-3 mx-4 flex-auto overflow-hidden\"\n        ref={textareaContainerRef}\n        data-sign=\"customMessage\"\n      >\n        <Textarea\n          fullWidth\n          value={replayMessage}\n          minRows={2}\n          maxRows={maxRow}\n          onChange={(event) => {\n            const result = sanitizedMessage(event.target.value);\n\n            onReplayMessageChange(result);\n          }}\n          label={t('customMessage')}\n          placeholder={t('customMessagePlaceholder')}\n          inputProps={{ maxLength: 100 }}\n          showCharacterCount\n          onKeyDown={(e) => {\n            // when in composition mode, do not handle enter key, user still typing\n            if (e.nativeEvent.isComposing) return;\n\n            const event = e as React.KeyboardEvent;\n            const value = (event.target as HTMLTextAreaElement)?.value;\n\n            if (!event.shiftKey && event.key === 'Enter') {\n              onAction('startReply', {\n                // remove leading and trailing spaces\n                replyWithText: value.trim(),\n              });\n              e.preventDefault();\n            }\n          }}\n        />\n      </div>\n    </div>\n  );\n};\n"],"mappings":"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","ignoreList":[]}
{"version":3,"file":"ContactSearchHelper.js","names":["MaximizeDisplayLength","getPresenceStatus","exports","presence","dndStatus","presenceStatus","userStatus","toLowerCase","getRcFilteredContacts","_ref","lowCaseString","contacts","len","length","result","resultCount","_loop","i","_contacts$i","id","name","phoneNumbers","type","profileImageUrl","isNameInclude","includes","isPrimary","forEach","_ref2","phoneType","phoneNumber","push","contact","excludePhoneTypesFromContacts","excludePhoneTypes","arguments","undefined","filteredNumbers","filter","_objectSpread","Object","values","flat"],"sources":["src/app/views/ContactSearchView/ContactSearchHelper.ts"],"sourcesContent":["import { PhoneType } from '@ringcentral-integration/commons/enums/phoneTypes';\nimport type { RcPresenceType } from '@ringcentral/juno';\n\nimport type { Contact, Presence } from '../../services';\nimport type { IContactSearchItem } from '../ContactSearchView/ContactSearch.view.interface';\n\nconst MaximizeDisplayLength = 100;\n\nexport const getPresenceStatus = (\n  presence: Presence['presence'],\n): RcPresenceType | undefined => {\n  if (!presence) {\n    return;\n  }\n  const { dndStatus, presenceStatus, userStatus } = presence;\n  if (dndStatus === 'DoNotAcceptAnyCalls') {\n    return 'DND';\n  }\n\n  return (presenceStatus || userStatus || '').toLowerCase() as RcPresenceType;\n};\n\nexport const getRcFilteredContacts = ({\n  lowCaseString,\n  contacts,\n}: {\n  lowCaseString: string;\n  contacts: Array<Contact>;\n}): IContactSearchItem[] => {\n  const len = contacts.length;\n  const result: IContactSearchItem[] = [];\n  let resultCount = 0;\n  for (let i = 0; i < len; i++) {\n    const { id, name, phoneNumbers, type, profileImageUrl, presence } =\n      contacts[i];\n    const isNameInclude = name?.toLowerCase().includes(lowCaseString);\n    let isPrimary = true;\n    // eslint-disable-next-line no-loop-func\n    phoneNumbers!.forEach(({ phoneType, phoneNumber }) => {\n      if (isNameInclude || phoneNumber!.includes(lowCaseString)) {\n        result.push({\n          id,\n          name: name!,\n          type,\n          phoneType: phoneType!,\n          phoneNumber: phoneNumber!,\n          isPrimary,\n          profileImageUrl,\n          presenceStatus: getPresenceStatus(presence!),\n          contact: contacts[i],\n        });\n        if (isPrimary) {\n          isPrimary = false;\n          resultCount += 1;\n        }\n      }\n    });\n    if (resultCount === MaximizeDisplayLength) break;\n  }\n  return result;\n};\n\nexport const excludePhoneTypesFromContacts = (\n  contacts: Array<IContactSearchItem>,\n  excludePhoneTypes: PhoneType[] = [],\n) => {\n  const filteredNumbers: { [key: string]: IContactSearchItem[] } = {};\n\n  contacts\n    .filter(\n      (contact) => !excludePhoneTypes.includes(contact.phoneType as PhoneType),\n    )\n    .forEach((contact) => {\n      if (!filteredNumbers[contact.id]) {\n        filteredNumbers[contact.id] = [{ ...contact, isPrimary: true }];\n      } else {\n        filteredNumbers[contact.id].push(contact);\n      }\n    });\n  return Object.values(filteredNumbers).flat();\n};\n"],"mappings":"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","ignoreList":[]}
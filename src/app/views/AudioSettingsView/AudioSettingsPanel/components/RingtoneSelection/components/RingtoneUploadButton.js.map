{"version":3,"file":"RingtoneUploadButton.js","names":["_AudioSettings","require","_RingtoneConfiguration","_springUi","_react","_interopRequireWildcard","_helper","_styles","_interopRequireDefault","e","__esModule","t","WeakMap","r","n","o","i","f","__proto__","_typeof","has","get","set","_t2","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","_regenerator","Symbol","iterator","toStringTag","c","prototype","Generator","u","create","_regeneratorDefine2","p","y","G","v","a","d","bind","length","l","TypeError","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","displayName","w","m","_regeneratorDefine","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","RingtoneUploadButton","exports","forwardRef","_ref","ref","customRingtoneNameList","onUploadRingtone","showAlert","isMountedRef","useMountState","createElement","className","styles","hidden","type","accept","onChange","_ref3","_callee","_ref2","currentTarget","_currentTarget$files","file","isValidFile","audioInfo","_t","_context","files","current","includes","name","audioSettingsErrors","duplicateRingtone","size","MAX_RINGTONE_SIZE","ringtoneSizeOverLimit","isAudioFile","uploadRingtoneFailed","readAudioFile","console","error","_x"],"sources":["src/app/views/AudioSettingsView/AudioSettingsPanel/components/RingtoneSelection/components/RingtoneUploadButton.tsx"],"sourcesContent":["import { audioSettingsErrors } from '@ringcentral-integration/commons/modules/AudioSettings';\nimport {\n  AudioInfo,\n  MAX_RINGTONE_SIZE,\n} from '@ringcentral-integration/commons/modules/RingtoneConfiguration';\nimport { useMountState } from '@ringcentral/spring-ui';\nimport React, { forwardRef } from 'react';\n\nimport { isAudioFile, readAudioFile } from '../helper';\nimport styles from '../styles.scss';\n\ninterface RingtoneUploadButtonProps {\n  customRingtoneNameList: string[];\n  onUploadRingtone: ({ fileName, dataUrl }: AudioInfo) => void;\n  showAlert: (message: string) => void;\n}\n\nexport const RingtoneUploadButton = forwardRef<\n  HTMLInputElement,\n  RingtoneUploadButtonProps\n>(({ customRingtoneNameList, onUploadRingtone, showAlert }, ref) => {\n  const isMountedRef = useMountState();\n  return (\n    <input\n      ref={ref}\n      className={styles.hidden}\n      type=\"file\"\n      data-sign=\"uploadRingtoneInput\"\n      accept=\".mp3, .wav\"\n      onChange={async ({ currentTarget }) => {\n        try {\n          if (currentTarget?.files?.length && isMountedRef.current) {\n            const file = currentTarget.files[0];\n\n            // duplicate file\n            if (customRingtoneNameList.includes(file.name)) {\n              showAlert(audioSettingsErrors.duplicateRingtone);\n              return;\n            }\n\n            // over size limit\n            if (file.size > MAX_RINGTONE_SIZE) {\n              showAlert(audioSettingsErrors.ringtoneSizeOverLimit);\n              return;\n            }\n\n            const isValidFile = await isAudioFile(file);\n            if (!isValidFile) {\n              showAlert(audioSettingsErrors.uploadRingtoneFailed);\n              return;\n            }\n\n            const audioInfo = await readAudioFile(file);\n            onUploadRingtone(audioInfo);\n            // reset input\n            currentTarget.value = '';\n          }\n        } catch (e) {\n          console.error('upload ringtone failed', e);\n          showAlert(audioSettingsErrors.uploadRingtoneFailed);\n        }\n      }}\n    />\n  );\n});\n"],"mappings":"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","ignoreList":[]}
{"version":3,"file":"getTabs.js","names":["_DynamicsFont","_interopRequireDefault","require","_Fax","_VoicemailIcon","_RecentActivityCalls2","_RecentActivityMessages2","_react","_i18n","e","__esModule","RecentActivityCalls","_RecentActivityCalls","RecentActivityMessages","_RecentActivityMessages","getTabs","exports","_ref","ready","currentLocale","dateTimeFormatter","navigateTo","recentMessages","recentCalls","currentContact","sessionId","showRecentCalls","showRecentMessage","showFax","showVoiceMails","messages","calls","id","contactId","activityCardId","concat","icon","createElement","width","height","label","t","path","isActive","view","getData","cleanUp","className","dynamicsFont","composeText","isMessagesLoaded","getMessages","cleanUpMessages","contact","active","isCallsLoaded","getCalls","cleanUpCalls","filter","item"],"sources":["src/app/views/RecentActivityView/getTabs.tsx"],"sourcesContent":["import type { Entity } from '@ringcentral-integration/commons/interfaces/Entity.interface';\nimport type { Message } from '@ringcentral-integration/commons/interfaces/MessageStore.model';\nimport { FormatDateTimeOptions } from '@ringcentral-integration/micro-core/src/app/services';\nimport type {\n  RecentMessage,\n  RecentMessages,\n} from '@ringcentral-integration/micro-message/src/app/services';\nimport dynamicsFont from '@ringcentral-integration/widgets/assets/DynamicsFont/DynamicsFont.scss';\nimport FaxIcon from '@ringcentral-integration/widgets/assets/images/Fax.svg';\nimport VoicemailIcon from '@ringcentral-integration/widgets/assets/images/VoicemailIcon.svg';\nimport _RecentActivityCalls from '@ringcentral-integration/widgets/components/RecentActivityCalls';\nimport _RecentActivityMessages from '@ringcentral-integration/widgets/components/RecentActivityMessages';\nimport type { ComponentType, ReactElement } from 'react';\nimport React from 'react';\n\nimport type { HistoryCall, RecentCalls } from '../../services';\n\nimport { t } from './i18n';\n\n// TODO: fix type\nconst RecentActivityCalls = _RecentActivityCalls as ComponentType<any>;\nconst RecentActivityMessages = _RecentActivityMessages as ComponentType<any>;\n// TODO: move to components folder\n\nexport interface Tab {\n  icon: ReactElement;\n  label: string;\n  path: string;\n  isActive: (path: string) => boolean;\n  view: ReactElement;\n  getData: () => void;\n  cleanUp: () => void;\n}\n\nexport interface GetTabsOptions {\n  ready: boolean;\n  currentLocale: string;\n  dateTimeFormatter: (options: Partial<FormatDateTimeOptions>) => string;\n  navigateTo: (path: string) => void;\n  recentMessages?: RecentMessages;\n  recentCalls: RecentCalls;\n  currentContact: Entity;\n  sessionId: string;\n  showRecentCalls: boolean;\n  showRecentMessage: boolean;\n  showFax: boolean;\n  showVoiceMails: boolean;\n}\n\nexport const getTabs = ({\n  ready,\n  currentLocale,\n  dateTimeFormatter,\n  navigateTo,\n  recentMessages,\n  recentCalls,\n  currentContact,\n  sessionId,\n  showRecentCalls,\n  showRecentMessage,\n  showFax,\n  showVoiceMails,\n}: GetTabsOptions) => {\n  if (!ready) return [];\n  let messages: (Message | RecentMessage)[] = [];\n  let calls: HistoryCall[] = [];\n  if (currentContact && currentContact.id) {\n    const contactId = currentContact.id;\n    const activityCardId = sessionId ? `${contactId}-${sessionId}` : contactId;\n    if (recentMessages?.messages[activityCardId]) {\n      messages = recentMessages.messages[activityCardId];\n    }\n    if (recentCalls.calls[activityCardId]) {\n      calls = recentCalls.calls[activityCardId];\n    }\n  }\n\n  return (\n    [\n      showVoiceMails\n        ? {\n            icon: <VoicemailIcon width={21} height={21} />,\n            label: t('voicemail'),\n            path: 'voicemails',\n            isActive: (path) => path === 'voicemails',\n            view: null,\n            getData() {\n              //\n            },\n            cleanUp() {\n              //\n            },\n          }\n        : null,\n      showRecentMessage && recentMessages\n        ? {\n            icon: <span className={dynamicsFont.composeText} />,\n            label: t('text'),\n            path: 'recentMessages',\n            isActive: (path) => path === 'recentMessages',\n            view: (\n              <RecentActivityMessages\n                messages={messages}\n                navigateTo={navigateTo}\n                dateTimeFormatter={dateTimeFormatter}\n                currentLocale={currentLocale}\n                isMessagesLoaded={recentMessages.isMessagesLoaded}\n              />\n            ),\n            getData() {\n              recentMessages.getMessages({ currentContact, sessionId });\n            },\n            cleanUp: () =>\n              recentMessages.cleanUpMessages({\n                contact: currentContact,\n                sessionId,\n              }),\n          }\n        : null,\n      showFax\n        ? {\n            icon: <FaxIcon width={21} height={21} />,\n            label: t('fax'),\n            path: 'faxes',\n            isActive: (path) => path === 'faxes',\n            view: null,\n            getData() {\n              //\n            },\n            cleanUp() {\n              //\n            },\n          }\n        : null,\n      showRecentCalls\n        ? {\n            icon: <span className={dynamicsFont.active} />,\n            label: t('call'),\n            path: 'recentCalls',\n            isActive: (path) => path === 'recentCalls',\n            view: (\n              <RecentActivityCalls\n                calls={calls}\n                dateTimeFormatter={dateTimeFormatter}\n                currentLocale={currentLocale}\n                isCallsLoaded={recentCalls.isCallsLoaded}\n              />\n            ),\n            getData() {\n              recentCalls.getCalls({ currentContact, sessionId });\n            },\n            cleanUp: () =>\n              recentCalls.cleanUpCalls({ contact: currentContact, sessionId }),\n          }\n        : null,\n    ] as Tab[]\n  ).filter((item) => item !== null);\n};\n"],"mappings":"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","ignoreList":[]}
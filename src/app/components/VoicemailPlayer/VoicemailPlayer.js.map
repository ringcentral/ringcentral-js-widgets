{"version":3,"file":"VoicemailPlayer.js","names":["_components","require","_reactHooks","_utils","_springIcon","_springUi","_react","_interopRequireDefault","_excluded","e","__esModule","_extends","Object","assign","bind","n","arguments","length","t","r","hasOwnProperty","call","apply","_objectWithoutProperties","o","i","_objectWithoutPropertiesLoose","getOwnPropertySymbols","indexOf","propertyIsEnumerable","INVALID_DISPLAY","VoicemailPlayer","exports","_ref","uri","serverDuration","duration","onStartLoad","onDownload","audioStatusProp","audioStatus","updateAudioStatusProp","updateAudioStatus","_ref$loadSourceExtern","loadSourceExternally","rest","_useAudioPlayerWithEx","useAudioPlayerWithExternalStatus","status","onStatusChange","progress","togglePlay","currentTime","isPlaying","loading","onProgressChange","onProgressChangeCommitted","currentTimeDisplay","useFormatDuration","durationDisplay","createElement","className","CircularProgressIndicator","size","IconButton","symbol","HoldFilledMd","PlayMd","iconSize","variant","shape","onClick","result","Text","Slider","disabled","value","stopPropagation","onChange","_","onChangeCommitted","DownloadMd","color"],"sources":["src/app/components/VoicemailPlayer/VoicemailPlayer.tsx"],"sourcesContent":["import { useFormatDuration } from '@ringcentral-integration/micro-core/src/app/components';\nimport {\n  useAudioPlayerWithExternalStatus,\n  type UseAudioPlayerWithExternalStatusOptions,\n} from '@ringcentral-integration/react-hooks';\nimport { stopPropagation } from '@ringcentral-integration/utils';\nimport { DownloadMd, HoldFilledMd, PlayMd } from '@ringcentral/spring-icon';\nimport {\n  CircularProgressIndicator,\n  IconButton,\n  Slider,\n  Text,\n} from '@ringcentral/spring-ui';\nimport type { FunctionComponent } from 'react';\nimport React from 'react';\n\nexport interface VoicemailAudioStatus {\n  /**\n   * when the data url is ready, cache url\n   */\n  blobUrl?: string;\n  isPlaying?: boolean;\n  currentTime?: number;\n  loading?: boolean;\n  /**\n   * Duration in seconds\n   */\n  duration?: number;\n  isNetworkError?: boolean;\n}\n\nexport type VoicemailPlayerInterface = {\n  /**\n   * Callback when the audio starts loading\n   */\n  onStartLoad?: (uri: string) => void;\n  /**\n   * Callback when the download button is clicked\n   */\n  onDownload?: () => void;\n  /**\n   * the status of the audio\n   */\n  audioStatus?: VoicemailAudioStatus;\n  updateAudioStatus: (status: VoicemailAudioStatus) => void;\n} & Pick<\n  UseAudioPlayerWithExternalStatusOptions,\n  'uri' | 'duration' | 'loadSourceExternally'\n>;\n\nconst INVALID_DISPLAY = '00:00';\n\n/**\n * player which support multiple instances\n *\n * with same `audioStatus` will only one instance can play at the same time\n */\nexport const VoicemailPlayer: FunctionComponent<VoicemailPlayerInterface> = ({\n  uri,\n  duration: serverDuration,\n  onStartLoad,\n  onDownload,\n  audioStatus: audioStatusProp,\n  updateAudioStatus: updateAudioStatusProp,\n  loadSourceExternally = false,\n  ...rest\n}) => {\n  const {\n    progress,\n    togglePlay,\n    duration,\n    currentTime,\n    isPlaying,\n    loading,\n    onProgressChange,\n    onProgressChangeCommitted,\n  } = useAudioPlayerWithExternalStatus({\n    uri,\n    duration: serverDuration,\n    status: audioStatusProp,\n    onStatusChange: updateAudioStatusProp,\n    loadSourceExternally,\n  });\n\n  const currentTimeDisplay = useFormatDuration(currentTime, INVALID_DISPLAY);\n  const durationDisplay = useFormatDuration(duration, INVALID_DISPLAY);\n\n  return (\n    <div className=\"flex items-center justify-between\" {...rest}>\n      <div className=\"min-w-8 grow-0 flex items-center justify-center shrink-0\">\n        {loading ? (\n          <div className=\"size-8 flex items-center justify-center\">\n            <CircularProgressIndicator\n              size=\"small\"\n              data-sign=\"progress-indicator\"\n            />\n          </div>\n        ) : (\n          <IconButton\n            symbol={isPlaying ? HoldFilledMd : PlayMd}\n            size=\"medium\"\n            iconSize=\"small\"\n            variant=\"inverted\"\n            shape=\"squircle\"\n            data-sign={isPlaying ? 'pause' : 'play'}\n            onClick={() => {\n              const result = togglePlay();\n\n              if (result) {\n                onStartLoad?.(uri);\n              }\n            }}\n          />\n        )}\n        <Text className=\"mx-2 min-w-[3rem] text-center\" data-sign=\"current\">\n          {currentTimeDisplay}\n        </Text>\n      </div>\n      <div className=\"grow mx-2 leading-none\" data-sign=\"progress\">\n        <Slider\n          aria-label=\"audio slider\"\n          disabled={loading}\n          value={progress}\n          onClick={stopPropagation}\n          onChange={(_, value) => {\n            onProgressChange(value);\n          }}\n          onChangeCommitted={(_, value) => {\n            onProgressChangeCommitted(value as number);\n          }}\n          className=\"min-w-full\"\n        />\n      </div>\n      <div className=\"min-w-6 grow-0 flex items-center justify-center\">\n        <Text className=\"mx-2 min-w-[3rem] text-center\" data-sign=\"duration\">\n          {durationDisplay}\n        </Text>\n        {onDownload && (\n          <IconButton\n            symbol={DownloadMd}\n            color=\"secondary\"\n            size=\"small\"\n            variant=\"icon\"\n            onClick={onDownload}\n            data-sign=\"download\"\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n"],"mappings":"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","ignoreList":[]}
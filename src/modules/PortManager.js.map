{"version":3,"file":"PortManager.js","names":["_reactantShare","require","_rxjs","_constant","_applyMethod","_delegate","_parallel","_parallelClients","_handleMainClient","_dec","_dec2","_dec3","_dec4","_dec5","_dec6","_dec7","_dec8","_dec9","_dec0","_dec1","_dec10","_dec11","_dec12","_dec13","_dec14","_dec15","_dec16","_dec17","_dec18","_class","_class2","_descriptor","_descriptor2","_createForOfIteratorHelper","r","e","t","Symbol","iterator","Array","isArray","_unsupportedIterableToArray","length","_n","F","s","n","done","value","f","TypeError","o","a","u","call","next","_arrayLikeToArray","toString","slice","constructor","name","from","test","_regenerator","toStringTag","i","c","prototype","Generator","Object","create","_regeneratorDefine2","p","y","G","v","d","bind","l","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","w","m","defineProperty","_regeneratorDefine","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_initializerDefineProperty","initializer","_classCallCheck","_defineProperties","_toPropertyKey","key","_createClass","_toPrimitive","_typeof","toPrimitive","String","Number","_applyDecoratedDescriptor","keys","forEach","reverse","reduce","_initializerWarningHelper","Error","PortManager","exports","injectable","target","optional","undefined","Reflect","metadata","Function","PortDetector","PortManagerOptions","delegate","portDetector","prefix","portManagerOptions","_this","portType$","BehaviorSubject","onMainTabChange$","shared","Observable","subscriber","onMainTabChange","EMPTY","onServer","onClient","mainTabSyncStore","resolveMainTabClient","promiseMainTabClient","checkMainTabMapping","Map","customClientDelegateNameMapping","initMainClient$","ReplaySubject","mainClientId","changeClientCallbacks","Set","callback","isServer","add","mainTabCallbacks","onMainTab","_setAsVisibleTab","document","hidden","isActiveTab","setActiveTabId","clientId","isActiveNonMainTab","isMainTab","setActiveNonMainTabId","_handleMainClientOnServer","handleMainClientOnServer","serverHooks","mainClient","options","_handleParallelClientsOnServer","handleParallelClientsOnServer","clients","_handleAllPortsOnServer","handleAllPortsOnServer","all","transport","_this$portManagerOpti","listen","mainTabClientReload","_callee","_context","globalThis","location","reload","PortType","Client","isWorkerMode","initMainClient","_globalThis$__rc_shar","_globalThis$__rc_shar2","_this$prefix","sharedWorkerUrl","__rc_shared_worker__","url","lockName","concat","useLock","_callee3","_iterator","_step","_context3","MainClient","mainTabClientDelegate","_ref3","_callee2","module","result","_context2","getRef","modules","applyMethod","_x","console","error","err","emit","mainTabClientChange","respond","disableAutoPickMainTab","pipe","filter","Boolean","take","tap","subscribe","Server","window","addEventListener","_iterator2","_step2","_ref5","_callee4","_ref4","_this$resolveMainTabC","oldClient","_iterator3","_step3","_callback","_context4","_x2","setAsMainClient","_bindVisibilityListener","_bindUnloadListener","checkVisibleTabInAllClient","get","allowDisableSync","syncFullState","forceSync","isClient","portType","_setActiveTabId","tabId","activeTabId","_setActiveTabId2","_callee5","_context5","_x3","_setActiveNonMainTabId","activeNonMainTabId","_setActiveNonMainTabId2","_callee6","_context6","_x4","_this2","_checkVisibleTabInAllClient","_callee7","_context7","transports","state","action","getOwnPropertyDescriptor"],"sources":["src/modules/PortManager.ts"],"sourcesContent":["import type { ClientTransport, ServerTransport } from 'reactant-share';\nimport {\n  action,\n  getRef,\n  injectable,\n  optional,\n  PortDetector,\n  state,\n  useLock,\n} from 'reactant-share';\nimport {\n  BehaviorSubject,\n  EMPTY,\n  filter,\n  Observable,\n  ReplaySubject,\n  take,\n  tap,\n} from 'rxjs';\n\nimport {\n  mainClient,\n  mainTabClientChange,\n  mainTabClientDelegate,\n  mainTabClientReload,\n  PortType,\n} from '../constant';\nimport { applyMethod } from '../lib/applyMethod';\nimport { delegate } from '../lib/decorators/delegate';\nimport { handleAllPortsOnServer } from '../lib/decorators/parallel';\nimport { handleParallelClientsOnServer } from '../lib/decorators/parallelClients';\nimport { handleMainClientOnServer } from '../lib/handleMainClient';\n\ntype ClientToServer = {\n  [mainTabClientChange](options: { clientId: string }): Promise<void>;\n};\n\ntype ServerToClient = {\n  [mainTabClientReload]: () => Promise<void>;\n  [mainTabClientDelegate](options: {\n    module: string;\n    method: string;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    args: any[];\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  }): Promise<any>;\n};\n\ntype MainTabCallbacks = (\n  transport: ClientTransport<{ emit: ClientToServer; listen: ServerToClient }>,\n) => void;\n\ntype ChangeMainTabCallbacks = (\n  transport: ServerTransport<{ listen: ClientToServer; emit: ServerToClient }>,\n) => void;\n\nexport interface PortManagerOptions {\n  /**\n   * Disable auto picking main tab client\n   */\n  disableAutoPickMainTab?: boolean;\n}\n\n@injectable({\n  name: 'PortManager',\n})\nexport class PortManager {\n  /**\n   * sync state with main client\n   */\n  portType$ = new BehaviorSubject<PortType | null>(null);\n\n  /**\n   * emit when main tab change, only work in shared mode of server port\n   */\n  onMainTabChange$ = this.shared\n    ? new Observable((subscriber) => {\n        this.onMainTabChange(() => {\n          subscriber.next(true);\n        });\n      })\n    : EMPTY;\n\n  get portType() {\n    return this.portType$.value;\n  }\n\n  onServer = this.portDetector.onServer;\n\n  onClient = this.portDetector.onClient;\n\n  mainTabSyncStore = !this.shared;\n\n  private resolveMainTabClient?: () => void;\n\n  /**\n   * Parallel load main client and server, it ensures that waiting for main client in server\n   */\n  promiseMainTabClient: Promise<void>;\n\n  checkMainTabMapping = new Map<object, () => boolean>();\n\n  customClientDelegateNameMapping = new Map<object, string>();\n\n  public initMainClient$ = new ReplaySubject<boolean>();\n\n  constructor(\n    public portDetector: PortDetector,\n    @optional('Prefix') protected prefix?: string,\n    @optional('PortManagerOptions')\n    protected portManagerOptions?: PortManagerOptions,\n  ) {\n    const _handleMainClientOnServer = handleMainClientOnServer(this);\n    this.portDetector.serverHooks.mainClient = (options) =>\n      _handleMainClientOnServer(options);\n    const _handleParallelClientsOnServer = handleParallelClientsOnServer(this);\n    this.portDetector.serverHooks.clients = (options) =>\n      _handleParallelClientsOnServer(options);\n    const _handleAllPortsOnServer = handleAllPortsOnServer(this.portDetector);\n    this.portDetector.serverHooks.all = (options) =>\n      _handleAllPortsOnServer(options);\n    this.promiseMainTabClient = new Promise((resolve) => {\n      this.resolveMainTabClient = resolve;\n    });\n    this.onClient(\n      (\n        transport: ClientTransport<{\n          emit: ClientToServer;\n          listen: ServerToClient;\n        }>,\n      ) => {\n        transport.listen(mainTabClientReload, async () => {\n          globalThis.location.reload();\n        });\n        this.portType$.next(PortType.Client);\n        // non-main tab will sync full state\n        this.mainTabSyncStore = true;\n        if (!this.isWorkerMode) return;\n\n        const initMainClient = () => {\n          const sharedWorkerUrl = globalThis.__rc_shared_worker__?.url ?? '';\n          const lockName = `${mainClient}-${this.prefix ?? ''}-${\n            this.portDetector.name\n          }-${sharedWorkerUrl}`;\n          // eslint-disable-next-line react-hooks/rules-of-hooks\n          return useLock(lockName, async () => {\n            this.mainTabSyncStore = false;\n            this.portType$.next(PortType.MainClient);\n            transport.listen(mainTabClientDelegate, async (options) => {\n              const module = getRef(this).modules![options.module];\n              const result = await applyMethod(module, options);\n              return result;\n            });\n            for (const callback of this.mainTabCallbacks) {\n              try {\n                callback(transport);\n              } catch (e) {\n                // eslint-disable-next-line no-console\n                console.error(e);\n              }\n            }\n            transport.emit(\n              { name: mainTabClientChange, respond: false },\n              { clientId: this.clientId! },\n            );\n            return new Promise(() => {\n              // never end promise for all this client hold this lock and never release it\n              // until that client be closed or refreshed\n            });\n          });\n        };\n        if (!this.portManagerOptions?.disableAutoPickMainTab) {\n          return initMainClient();\n        } else {\n          this.initMainClient$\n            .pipe(\n              filter(Boolean),\n              take(1),\n              tap(() => initMainClient()),\n            )\n            .subscribe();\n        }\n      },\n    );\n\n    this.onServer(\n      (\n        transport: ServerTransport<{\n          listen: ClientToServer;\n          emit: ServerToClient;\n        }>,\n      ) => {\n        this.portType$.next(PortType.Server);\n        if (!this.isWorkerMode) {\n          // workaround: in safari, main tab will close and other tabs will reload\n          globalThis.window.addEventListener('pagehide', () => {\n            transport.emit(mainTabClientReload);\n          });\n          for (const callback of this.mainTabCallbacks) {\n            try {\n              callback(transport);\n            } catch (e) {\n              // eslint-disable-next-line no-console\n              console.error(e);\n            }\n          }\n          return;\n        }\n        return transport.listen(mainTabClientChange, async ({ clientId }) => {\n          const oldClient = this.mainClientId;\n          this.mainClientId = clientId;\n          this.resolveMainTabClient?.();\n          if (oldClient) {\n            for (const callback of this.changeClientCallbacks) {\n              try {\n                callback(transport);\n              } catch (e) {\n                // eslint-disable-next-line no-console\n                console.error(e);\n              }\n            }\n          }\n        });\n      },\n    );\n\n    this.onMainTab(() => {\n      if (this.isWorkerMode) {\n        this.setAsMainClient();\n      }\n    });\n\n    if (globalThis.document && this.shared) {\n      this._bindVisibilityListener();\n      this._bindUnloadListener();\n    }\n\n    this.onClient(() => {\n      // only set active tab id when the client is visible\n      this._setAsVisibleTab();\n    });\n\n    this.onServer(() => {\n      // trigger visibility check event when the server port is created\n      this.checkVisibleTabInAllClient();\n    });\n  }\n\n  get isWorkerMode() {\n    return this.portDetector.isWorkerMode;\n  }\n\n  get shared() {\n    return this.portDetector.shared;\n  }\n\n  setAsMainClient() {\n    this.portDetector.allowDisableSync = () => false;\n    this.portDetector.syncFullState({ forceSync: false });\n  }\n\n  get isServer() {\n    return this.portDetector.isServer;\n  }\n\n  get isClient() {\n    return this.portDetector.isClient;\n  }\n\n  get isMainTab() {\n    return this.isWorkerMode\n      ? this.portType === PortType.MainClient\n      : this.portType === PortType.Server;\n  }\n\n  mainClientId: string | null = null;\n\n  private changeClientCallbacks = new Set<MainTabCallbacks>();\n\n  /**\n   * It will be triggered on the server port if the main client is changed to another one.\n   */\n  onMainTabChange = (callback: ChangeMainTabCallbacks) => {\n    if (!this.portDetector.isServer) {\n      throw new Error('Only server can listen on main client change');\n    }\n    this.changeClientCallbacks.add(callback);\n    return () => {\n      this.changeClientCallbacks.delete(callback);\n    };\n  };\n\n  private mainTabCallbacks = new Set<MainTabCallbacks>();\n\n  /**\n   * It will be triggered if the current client is the main client.\n   */\n  onMainTab = (callback: MainTabCallbacks) => {\n    this.mainTabCallbacks.add(callback);\n    return () => {\n      this.mainTabCallbacks.delete(callback);\n    };\n  };\n\n  /**\n   * the active tab id means the user latest interacted tab\n   *\n   * ! this value possible be null, because the user may not interact with any tab\n   * ! if the active tab be close and user not open another tab again, the active tab id will be null\n   */\n  @state\n  activeTabId: string | null = null;\n\n  @action\n  private _setActiveTabId(tabId: string | null) {\n    this.activeTabId = tabId;\n  }\n\n  @delegate('server')\n  async setActiveTabId(tabId: string | null) {\n    this._setActiveTabId(tabId);\n  }\n\n  /**\n   * The active non-main tab id means the user latest interacted non-main tab\n   */\n  @state\n  activeNonMainTabId: string | null = null;\n\n  @action\n  private _setActiveNonMainTabId(tabId: string | null) {\n    this.activeNonMainTabId = tabId;\n  }\n\n  @delegate('server')\n  async setActiveNonMainTabId(tabId: string | null) {\n    this._setActiveNonMainTabId(tabId);\n  }\n\n  private _bindVisibilityListener() {\n    globalThis.document.addEventListener(\n      'visibilitychange',\n      this._setAsVisibleTab,\n    );\n    globalThis.window.addEventListener('focus', this._setAsVisibleTab);\n  }\n\n  private _bindUnloadListener() {\n    globalThis.window.addEventListener('pagehide', () => {\n      if (this.isActiveTab) {\n        this.setActiveTabId(null);\n      }\n    });\n  }\n\n  private _setAsVisibleTab = () => {\n    // avoid setting activeTabId repeatedly which may result in forced rendering\n    if (!document.hidden && !this.isActiveTab) {\n      this.setActiveTabId(this.clientId!);\n    }\n\n    if (!document.hidden && !this.isActiveNonMainTab && !this.isMainTab) {\n      this.setActiveNonMainTabId(this.clientId!);\n    }\n  };\n\n  @delegate('clients')\n  async checkVisibleTabInAllClient() {\n    this._setAsVisibleTab();\n  }\n\n  get isActiveTab() {\n    return this.activeTabId === this.clientId;\n  }\n\n  get isActiveNonMainTab() {\n    return this.activeNonMainTabId === this.clientId;\n  }\n\n  get clientId() {\n    return this.portDetector.clientId;\n  }\n\n  get transports() {\n    return this.portDetector.transports;\n  }\n\n  get transport() {\n    return this.portDetector.transport;\n  }\n}\n"],"mappings":"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","ignoreList":[]}
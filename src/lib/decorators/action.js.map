{"version":3,"file":"action.js","names":["_reactantShare","require","action","exports","process","env","NODE_ENV","target","key","descriptor","originalMethod","value","Error","concat","String","count","time","Date","now","getRef","identifier","_len","arguments","length","args","Array","_key","apply","originalAction"],"sources":["src/lib/decorators/action.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { action as originalAction, getRef } from 'reactant-share';\n\nexport const action =\n  process.env.NODE_ENV === 'development'\n    ? (\n        target: object,\n        key: string,\n        descriptor: TypedPropertyDescriptor<(...args: any[]) => void>,\n      ) => {\n        // in development mode, check the action call frequency\n        const originalMethod = descriptor.value!;\n        if (typeof originalMethod !== 'function') {\n          throw new Error(\n            `${String(\n              key,\n            )} can only be decorated by '@action' as a class method.`,\n          );\n        }\n        let count = 100;\n        let time = Date.now();\n        descriptor.value = function (this: any, ...args: any[]) {\n          if (count-- === 0) {\n            count = 100;\n            if (Date.now() - time < 5000) {\n              throw new Error(\n                `${getRef(this).identifier}.${key} is called too many times`,\n              );\n            }\n            time = Date.now();\n          }\n          return originalMethod.apply(this, args);\n        };\n        return originalAction(target, key, descriptor);\n      }\n    : originalAction;\n"],"mappings":";;;;;;;;;AACA,IAAAA,cAAA,GAAAC,OAAA;AADA;;AAGO,IAAMC,MAAM,GAAAC,OAAA,CAAAD,MAAA,GACjBE,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,aAAa,GAClC,UACEC,MAAc,EACdC,GAAW,EACXC,UAA6D,EAC1D;EACH;EACA,IAAMC,cAAc,GAAGD,UAAU,CAACE,KAAM;EACxC,IAAI,OAAOD,cAAc,KAAK,UAAU,EAAE;IACxC,MAAM,IAAIE,KAAK,IAAAC,MAAA,CACVC,MAAM,CACPN,GACF,CAAC,2DACH,CAAC;EACH;EACA,IAAIO,KAAK,GAAG,GAAG;EACf,IAAIC,IAAI,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC;EACrBT,UAAU,CAACE,KAAK,GAAG,YAAqC;IACtD,IAAII,KAAK,EAAE,KAAK,CAAC,EAAE;MACjBA,KAAK,GAAG,GAAG;MACX,IAAIE,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGF,IAAI,GAAG,IAAI,EAAE;QAC5B,MAAM,IAAIJ,KAAK,IAAAC,MAAA,CACV,IAAAM,qBAAM,EAAC,IAAI,CAAC,CAACC,UAAU,OAAAP,MAAA,CAAIL,GAAG,8BACnC,CAAC;MACH;MACAQ,IAAI,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC;IACnB;IAAC,SAAAG,IAAA,GAAAC,SAAA,CAAAC,MAAA,EATwCC,IAAI,OAAAC,KAAA,CAAAJ,IAAA,GAAAK,IAAA,MAAAA,IAAA,GAAAL,IAAA,EAAAK,IAAA;MAAJF,IAAI,CAAAE,IAAA,IAAAJ,SAAA,CAAAI,IAAA;IAAA;IAU7C,OAAOhB,cAAc,CAACiB,KAAK,CAAC,IAAI,EAAEH,IAAI,CAAC;EACzC,CAAC;EACD,OAAO,IAAAI,qBAAc,EAACrB,MAAM,EAAEC,GAAG,EAAEC,UAAU,CAAC;AAChD,CAAC,GACDmB,qBAAc","ignoreList":[]}
{"version":3,"file":"progressiveTimer.js","names":["_rxjs","require","_toConsumableArray","r","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","a","_arrayLikeToArray","t","toString","call","slice","constructor","name","Array","from","test","Symbol","iterator","isArray","length","e","n","progressiveTimer","exports","_ref","initTimeout","times","_ref$eachTimeout","eachTimeout","onEachTimeout","onFinalTimeout","timer","pipe","concatMap","of","apply","_","index","currTimeout","EMPTY"],"sources":["src/lib/rxjs/progressiveTimer.ts"],"sourcesContent":["import { concatMap, EMPTY, of, timer } from 'rxjs';\n\n/**\n * Creates a progressive timer that increases by eachTimeout ms each time, and when all times are reached, emit the final timeout event\n *\n * @example\n *\n * ```ts\n * progressiveTimer({\n *   initTimeout: 1000,\n *   times: 5,\n *   onEachTimeout: (times, timeout) => {\n *     console.log(times, timeout);\n *   },\n *   onFinalTimeout: () => {\n *     console.log('final timeout');\n *   },\n * });\n * ```\n *\n * that means the timer will be 1000ms, 2000ms, 3000ms, 4000ms, 5000ms, and then final emit the timeout event\n */\nexport const progressiveTimer = ({\n  initTimeout,\n  times,\n  eachTimeout = 1000,\n  onEachTimeout,\n  onFinalTimeout,\n}: {\n  initTimeout: number;\n  times: number;\n  eachTimeout?: number;\n  onEachTimeout?: (times: number, timeout: number) => void;\n  onFinalTimeout?: (timeout: number) => void;\n}) => {\n  return timer(initTimeout).pipe(\n    concatMap(() => of(...Array.from({ length: times + 1 }))),\n    concatMap((_, index) => {\n      const currTimeout = initTimeout + index * eachTimeout;\n\n      if (index === times) {\n        onFinalTimeout?.(currTimeout);\n        return of(false);\n      }\n\n      onEachTimeout?.(index, currTimeout);\n\n      return timer(currTimeout + eachTimeout).pipe(concatMap(() => EMPTY));\n    }),\n  );\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAA,IAAAA,KAAA,GAAAC,OAAA;AAAmD,SAAAC,mBAAAC,CAAA,WAAAC,kBAAA,CAAAD,CAAA,KAAAE,gBAAA,CAAAF,CAAA,KAAAG,2BAAA,CAAAH,CAAA,KAAAI,kBAAA;AAAA,SAAAA,mBAAA,cAAAC,SAAA;AAAA,SAAAF,4BAAAH,CAAA,EAAAM,CAAA,QAAAN,CAAA,2BAAAA,CAAA,SAAAO,iBAAA,CAAAP,CAAA,EAAAM,CAAA,OAAAE,CAAA,MAAAC,QAAA,CAAAC,IAAA,CAAAV,CAAA,EAAAW,KAAA,6BAAAH,CAAA,IAAAR,CAAA,CAAAY,WAAA,KAAAJ,CAAA,GAAAR,CAAA,CAAAY,WAAA,CAAAC,IAAA,aAAAL,CAAA,cAAAA,CAAA,GAAAM,KAAA,CAAAC,IAAA,CAAAf,CAAA,oBAAAQ,CAAA,+CAAAQ,IAAA,CAAAR,CAAA,IAAAD,iBAAA,CAAAP,CAAA,EAAAM,CAAA;AAAA,SAAAJ,iBAAAF,CAAA,8BAAAiB,MAAA,YAAAjB,CAAA,CAAAiB,MAAA,CAAAC,QAAA,aAAAlB,CAAA,uBAAAc,KAAA,CAAAC,IAAA,CAAAf,CAAA;AAAA,SAAAC,mBAAAD,CAAA,QAAAc,KAAA,CAAAK,OAAA,CAAAnB,CAAA,UAAAO,iBAAA,CAAAP,CAAA;AAAA,SAAAO,kBAAAP,CAAA,EAAAM,CAAA,aAAAA,CAAA,IAAAA,CAAA,GAAAN,CAAA,CAAAoB,MAAA,MAAAd,CAAA,GAAAN,CAAA,CAAAoB,MAAA,YAAAC,CAAA,MAAAC,CAAA,GAAAR,KAAA,CAAAR,CAAA,GAAAe,CAAA,GAAAf,CAAA,EAAAe,CAAA,IAAAC,CAAA,CAAAD,CAAA,IAAArB,CAAA,CAAAqB,CAAA,UAAAC,CAAA;AAEnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,IAAMC,gBAAgB,GAAAC,OAAA,CAAAD,gBAAA,GAAG,SAAnBA,gBAAgBA,CAAAE,IAAA,EAYvB;EAAA,IAXJC,WAAW,GAAAD,IAAA,CAAXC,WAAW;IACXC,KAAK,GAAAF,IAAA,CAALE,KAAK;IAAAC,gBAAA,GAAAH,IAAA,CACLI,WAAW;IAAXA,WAAW,GAAAD,gBAAA,cAAG,IAAI,GAAAA,gBAAA;IAClBE,aAAa,GAAAL,IAAA,CAAbK,aAAa;IACbC,cAAc,GAAAN,IAAA,CAAdM,cAAc;EAQd,OAAO,IAAAC,WAAK,EAACN,WAAW,CAAC,CAACO,IAAI,CAC5B,IAAAC,eAAS,EAAC;IAAA,OAAMC,QAAE,CAAAC,KAAA,SAAArC,kBAAA,CAAIe,KAAK,CAACC,IAAI,CAAC;MAAEK,MAAM,EAAEO,KAAK,GAAG;IAAE,CAAC,CAAC,EAAC;EAAA,EAAC,EACzD,IAAAO,eAAS,EAAC,UAACG,CAAC,EAAEC,KAAK,EAAK;IACtB,IAAMC,WAAW,GAAGb,WAAW,GAAGY,KAAK,GAAGT,WAAW;IAErD,IAAIS,KAAK,KAAKX,KAAK,EAAE;MACnBI,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAGQ,WAAW,CAAC;MAC7B,OAAO,IAAAJ,QAAE,EAAC,KAAK,CAAC;IAClB;IAEAL,aAAa,aAAbA,aAAa,uBAAbA,aAAa,CAAGQ,KAAK,EAAEC,WAAW,CAAC;IAEnC,OAAO,IAAAP,WAAK,EAACO,WAAW,GAAGV,WAAW,CAAC,CAACI,IAAI,CAAC,IAAAC,eAAS,EAAC;MAAA,OAAMM,WAAK;IAAA,EAAC,CAAC;EACtE,CAAC,CACH,CAAC;AACH,CAAC","ignoreList":[]}